/*! For license information please see main.nodejs.js.LICENSE.txt */
(()=>{var e={5747:(e,t,r)=>{"use strict";Object.defineProperty(t,"rh",{enumerable:!0,get:function(){return i.default}});var n=a(r(8257)),i=a(r(4816)),s=a(r(3243)),o=a(r(6828));function a(e){return e&&e.__esModule?e:{default:e}}const c=[i.default,s.default,o.default];i.default,s.default,o.default},4816:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(8257))&&n.__esModule?n:{default:n},s=r(7761);const o=["realm"],a=o,c={type:"Basic",parseWWWAuthenticateRest:function(e){return(0,s.parseHTTPHeadersQuotedKeyValueSet)(e,a,o)},buildWWWAuthenticateRest:function(e){return(0,s.buildHTTPHeadersQuotedKeyValueSet)(e,a,o)},parseAuthorizationRest:function(e){if(!e)throw new i.default("E_EMPTY_AUTH");const{username:t,password:r}=c.decodeHash(e);return{hash:e,username:t,password:r}},buildAuthorizationRest:function({hash:e,username:t,password:r}){if(t&&r)return c.computeHash({username:t,password:r});if(!e)throw new i.default("E_NO_HASH");return e},computeHash:function({username:e,password:t}){return Buffer.from(e+":"+t).toString("base64")},decodeHash:function(e){const[t,...r]=Buffer.from(e,"base64").toString().split(":");return{username:t,password:r.join(":")}}};var u=c;t.default=u},6828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=r(8257))&&n.__esModule?n:{default:n},s=r(7761);const o=["invalid_request","invalid_token","insufficient_scope"],a=["realm","scope","error","error_description"];var c={type:"Bearer",parseWWWAuthenticateRest:function(e){return(0,s.parseHTTPHeadersQuotedKeyValueSet)(e,a,[])},buildWWWAuthenticateRest:function(e){if(e.error&&-1===o.indexOf(e.error))throw new i.default("E_INVALID_ERROR",e.error,o);return(0,s.buildHTTPHeadersQuotedKeyValueSet)(e,a,[])},parseAuthorizationRest:function(e){if(!e)throw new i.default("E_EMPTY_AUTH");return{hash:e}},buildAuthorizationRest:function({hash:e}){if(!e)throw new i.default("E_NO_HASH");return e}};t.default=c},3243:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=r(7761),s=(n=r(6113))&&n.__esModule?n:{default:n};const o=["realm","nonce"],a=[...o,"domain","opaque","stale","algorithm","qop"],c=["username","realm","nonce","uri","response"],u=[...c,"algorithm","cnonce","opaque","qop","nc"];function h(e,t){const r=s.default.createHash(e);return r.update(t),r.digest("hex")}var d={type:"Digest",parseWWWAuthenticateRest:function(e){return(0,i.parseHTTPHeadersQuotedKeyValueSet)(e,a,o)},buildWWWAuthenticateRest:function(e){return(0,i.buildHTTPHeadersQuotedKeyValueSet)(e,a,o)},parseAuthorizationRest:function(e){return(0,i.parseHTTPHeadersQuotedKeyValueSet)(e,u,c)},buildAuthorizationRest:function(e){return(0,i.buildHTTPHeadersQuotedKeyValueSet)(e,u,c)},computeHash:function(e){const t=e.ha1||h(e.algorithm,[e.username,e.realm,e.password].join(":")),r=h(e.algorithm,[e.method,e.uri].join(":"));return h(e.algorithm,[t,e.nonce,e.nc,e.cnonce,e.qop,r].join(":"))}};t.default=d},7761:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseHTTPHeadersQuotedKeyValueSet=function(e,t,r=[]){const n=e.trim().match(s);if(!n)throw new i.default("E_MALFORMED_QUOTEDKEYVALUE",e);const a=n.map(((e,t)=>{const r=e.split("=");if(2!==r.length)throw new i.default("E_MALFORMED_QUOTEDKEYVALUE",t,e,r.length);return r})).reduce((function(e,[r,n],s){if(-1===t.indexOf(r))throw new i.default("E_UNAUTHORIZED_KEY",s,r);return e[r]=n.replace(/^"(.+(?="$))"$/,"$1"),e}),{});return o(r,a),a},t.buildHTTPHeadersQuotedKeyValueSet=function(e,t,r=[]){return o(r,e),t.reduce((function(t,r){return e[r]?t+(t?", ":"")+r+'="'+e[r]+'"':t}),"")};var n,i=(n=r(8257))&&n.__esModule?n:{default:n};const s=/\w+=(".*?"|[^",]+)(?=,|$)/g;function o(e,t){e.forEach((e=>{if(void 0===t[e])throw new i.default("E_REQUIRED_KEY",e)}))}},1562:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CiaoService=t.InternalServiceEvent=t.ServiceEvent=t.ServiceState=t.ServiceType=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(2790)),o=r(2361),a=(0,n.__importDefault)(r(1808)),c=r(3013),u=r(5742),h=r(4583),d=r(3491),l=r(1723),f=r(8730),p=r(7632),y=r(5816),m=r(3960),g=r(5007),v=(0,n.__importStar)(r(6425)),b=r(6425),E=(0,s.default)("ciao:CiaoService"),S=/^(.*) \((\d+)\)$/,A=/^(.*)-\((\d+)\)(\.\w{2,}.)$/;!function(e){e.AIRDROP="airdrop",e.AIRPLAY="airplay",e.AIRPORT="airport",e.COMPANION_LINK="companion-link",e.DACP="dacp",e.HAP="hap",e.HOMEKIT="homekit",e.HTTP="http",e.HTTP_ALT="http_alt",e.IPP="ipp",e.IPPS="ipps",e.RAOP="raop",e.scanner="scanner",e.TOUCH_ABLE="touch-able",e.DNS_SD="dns-sd",e.PRINTER="printer"}(t.ServiceType||(t.ServiceType={})),function(e){e.UNANNOUNCED="unannounced",e.PROBING="probing",e.PROBED="probed",e.ANNOUNCING="announcing",e.ANNOUNCED="announced"}(t.ServiceState||(t.ServiceState={})),function(e){e.NAME_CHANGED="name-change",e.HOSTNAME_CHANGED="hostname-change"}(t.ServiceEvent||(t.ServiceEvent={})),function(e){e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.REPUBLISH="republish",e.RECORD_UPDATE="records-update",e.RECORD_UPDATE_ON_INTERFACE="records-update-interface"}(t.InternalServiceEvent||(t.InternalServiceEvent={}));class I extends o.EventEmitter{constructor(e,t){if(super(),this.serviceState="unannounced",this.destroyed=!1,(0,i.default)(e,"networkManager is required"),(0,i.default)(t,"parameters options is required"),(0,i.default)(t.name,"service options parameter 'name' is required"),(0,i.default)(t.type,"service options parameter 'type' is required"),(0,i.default)(t.type.length<=15,"service options parameter 'type' must not be longer than 15 characters"),this.networkManager=e,this.name=t.name,this.type=t.type,this.subTypes=t.subtypes,this.protocol=t.protocol||"tcp",this.serviceDomain=t.domain||"local",this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,g.dnsLowerCase)(this.fqdn),this.typePTR=v.stringify({type:this.type,protocol:this.protocol,domain:this.serviceDomain}),this.loweredTypePTR=(0,g.dnsLowerCase)(this.typePTR),this.subTypes&&(this.subTypePTRs=this.subTypes.map((e=>v.stringify({subtype:e,type:this.type,protocol:this.protocol,domain:this.serviceDomain}))).map(g.dnsLowerCase)),this.hostname=v.formatHostname(t.hostname||this.name,this.serviceDomain).replace(/ /g,"-"),this.loweredHostname=(0,g.dnsLowerCase)(this.hostname),this.port=t.port,t.restrictedAddresses){(0,i.default)(t.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!"),this.restrictedAddresses=new Map;for(const e of t.restrictedAddresses)if(a.default.isIP(e)){if("0.0.0.0"===e||"::"===e)throw new Error(`[${this.fqdn}] Unspecified ip address (${e}) cannot be used to restrict on to!`);const t=m.NetworkManager.resolveInterface(e);if(!t)throw new Error(`[${this.fqdn}] Could not restrict service to address ${e} as we could not resolve it to an interface name!`);const r=this.restrictedAddresses.get(t);r?r.length&&!r.includes(e)&&r.push(e):this.restrictedAddresses.set(t,[e])}else this.restrictedAddresses.set(e,[])}this.disableIpv6=t.disabledIpv6,this.txt=t.txt?I.txtBuffersFromRecord(t.txt):[],this.incrementName(!0)}advertise(){return(0,i.default)(!this.destroyed,"Cannot publish destroyed service!"),(0,i.default)(this.port,"Service port must be defined before advertising the service on the network!"),0===this.listeners("name-change").length&&E("[%s] WARN: No listeners found for a potential name change on the 'name-change' event!",this.name),new Promise(((e,t)=>{this.emit("publish",(r=>r?t(r):e()))}))}end(){return(0,i.default)(!this.destroyed,"Cannot end destroyed service!"),"unannounced"===this.serviceState?Promise.resolve():new Promise(((e,t)=>{this.emit("unpublish",(r=>r?t(r):e()))}))}async destroy(){await this.end(),this.destroyed=!0,this.removeAllListeners()}getFQDN(){return this.fqdn}getTypePTR(){return this.typePTR}getLowerCasedSubtypePTRs(){return this.subTypePTRs}getHostname(){return this.hostname}getPort(){return this.port||-1}getTXT(){return this.txt}getLowerCasedFQDN(){return this.loweredFqdn}getLowerCasedTypePTR(){return this.loweredTypePTR}getLowerCasedHostname(){return this.loweredHostname}updateTxt(e,t=!1){if((0,i.default)(!this.destroyed,"Cannot update destroyed service!"),(0,i.default)(e,"txt cannot be undefined"),this.txt=I.txtBuffersFromRecord(e),E("[%s] Updating txt record%s...",this.name,t?" silently":""),"announcing"===this.serviceState){if(this.rebuildServiceRecords(),t)return;this.currentAnnouncer.hasSentLastAnnouncement()&&this.currentAnnouncer.awaitAnnouncement().then((()=>{this.queueTxtUpdate()}))}else if("announced"===this.serviceState){if(this.rebuildServiceRecords(),t)return;this.queueTxtUpdate()}}queueTxtUpdate(){this.txtTimer||(this.txtTimer=setTimeout((()=>{this.txtTimer=void 0,"announced"===this.serviceState&&this.emit("records-update",{answers:[this.txtRecord()],additionals:[this.serviceNSECRecord()]})}),50))}updatePort(e){(0,i.default)("unannounced"===this.serviceState,"Port number cannot be changed when service is already advertised!"),this.port=e}updateName(e){return"unannounced"===this.serviceState?(this.name=e,this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,g.dnsLowerCase)(this.fqdn),Promise.resolve()):this.end().then((()=>(this.name=e,this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,g.dnsLowerCase)(this.fqdn),this.advertise())))}static txtBuffersFromRecord(e){const t=[];return Object.entries(e).forEach((([e,r])=>{const n=e+"="+r;t.push(Buffer.from(n))})),t}handleNetworkInterfaceUpdate(e){(0,i.default)(!this.destroyed,"Cannot update network of destroyed service!"),"announced"===this.serviceState?(this.rebuildServiceRecords(),(e.added||e.changes)&&this.emit("republish",(e=>{e&&(console.log("FATAL Error occurred trying to reannounce service "+this.fqdn+"! We can't recover from this!"),console.log(e.stack),process.exit(1))}))):"announcing"===this.serviceState&&(this.rebuildServiceRecords(),this.currentAnnouncer.hasSentLastAnnouncement()&&this.currentAnnouncer.awaitAnnouncement().then((()=>{this.handleNetworkInterfaceUpdate(e)})))}incrementName(e){if("unannounced"!==this.serviceState)throw new Error("Service name can only be incremented when in state UNANNOUNCED!");const t=this.name,r=this.hostname;let n,s,o,a,c;const u=this.name.match(S);u?(n=u[1],s=parseInt(u[2]),(0,i.default)(s,`Failed to extract name number from ${this.name}. Resulted in ${s}`)):(n=this.name,s=1);const h=this.hostname.match(A);if(h)o=h[1],a=h[3],c=parseInt(h[2]),(0,i.default)(c,`Failed to extract hostname number from ${this.hostname}. Resulted in ${c}`);else{const e=this.hostname.substring(0,this.hostname.length-1).lastIndexOf(".");o=this.hostname.slice(0,e),a=this.hostname.slice(e),c=1}e||(s++,c++);const d=Math.max(s,c);this.name=1===d?n:`${n} (${d})`,this.hostname=1===d?`${o}${a}`:`${o}-(${d})${a}`,this.loweredHostname=(0,g.dnsLowerCase)(this.hostname),this.fqdn=this.formatFQDN(),this.loweredFqdn=(0,g.dnsLowerCase)(this.fqdn),this.name===t&&this.hostname===r||E("[%s] Service changed name '%s' -> '%s', '%s' -> '%s'",this.name,t,this.name,r,this.hostname),e||this.rebuildServiceRecords()}informAboutNameUpdates(){const e=this.emit("name-change",this.name),t=this.emit("hostname-change",v.removeTLD(this.hostname));e||t||console.warn(`CIAO: [${this.name}] Service changed name but nobody was listening on the 'name-change' event!`)}formatFQDN(){if("unannounced"!==this.serviceState)throw new Error("Name can't be changed after service was already announced!");const e=v.stringify({name:this.name,type:this.type,protocol:this.protocol,domain:this.serviceDomain});return(0,i.default)(e.length<=255,"A fully qualified domain name cannot be longer than 255 characters"),e}rebuildServiceRecords(){(0,i.default)(this.port,"port must be set before building records"),E("[%s] Rebuilding service records...",this.name);const e={},t={},r={},n={},s={};let o;for(const[i,o]of this.networkManager.getInterfaceMap()){if(!this.advertisesOnInterface(i,!0))continue;let a=this.restrictedAddresses?this.restrictedAddresses.get(i):void 0;a&&0===a.length&&(a=void 0),!o.ipv4||a&&!a.includes(o.ipv4)||(e[i]=new u.ARecord(this.hostname,o.ipv4,!0),s[o.ipv4]=new d.PTRRecord((0,b.formatReverseAddressPTRName)(o.ipv4),this.hostname)),!o.ipv6||this.disableIpv6||a&&!a.includes(o.ipv6)||(t[i]=new c.AAAARecord(this.hostname,o.ipv6,!0),s[o.ipv6]=new d.PTRRecord((0,b.formatReverseAddressPTRName)(o.ipv6),this.hostname)),!o.globallyRoutableIpv6||this.disableIpv6||a&&!a.includes(o.globallyRoutableIpv6)||(r[i]=new c.AAAARecord(this.hostname,o.globallyRoutableIpv6,!0),s[o.globallyRoutableIpv6]=new d.PTRRecord((0,b.formatReverseAddressPTRName)(o.globallyRoutableIpv6),this.hostname)),!o.uniqueLocalIpv6||this.disableIpv6||a&&!a.includes(o.uniqueLocalIpv6)||(n[i]=new c.AAAARecord(this.hostname,o.uniqueLocalIpv6,!0),s[o.uniqueLocalIpv6]=new d.PTRRecord((0,b.formatReverseAddressPTRName)(o.uniqueLocalIpv6),this.hostname))}if(this.subTypePTRs){o=[];for(const e of this.subTypePTRs)o.push(new d.PTRRecord(e,this.fqdn))}this.serviceRecords={ptr:new d.PTRRecord(this.typePTR,this.fqdn),subtypePTRs:o,metaQueryPtr:new d.PTRRecord(y.Responder.SERVICE_TYPE_ENUMERATION_NAME,this.typePTR),srv:new l.SRVRecord(this.fqdn,this.hostname,this.port,!0),txt:new f.TXTRecord(this.fqdn,this.txt,!0),serviceNSEC:new h.NSECRecord(this.fqdn,this.fqdn,[16,33],4500,!0),a:e,aaaa:t,aaaaR:r,aaaaULA:n,reverseAddressPTRs:s,addressNSEC:new h.NSECRecord(this.hostname,this.hostname,[1,28],120,!0)}}advertisesOnInterface(e,t){var r,n,i,s;return!this.restrictedAddresses||this.restrictedAddresses.has(e)&&(t||!!(null===(r=this.serviceRecords)||void 0===r?void 0:r.a[e])||!!(null===(n=this.serviceRecords)||void 0===n?void 0:n.aaaa[e])||!!(null===(i=this.serviceRecords)||void 0===i?void 0:i.aaaaR[e])||!!(null===(s=this.serviceRecords)||void 0===s?void 0:s.aaaaULA[e]))}ptrRecord(){return this.serviceRecords.ptr.clone()}subtypePtrRecords(){return this.serviceRecords.subtypePTRs?p.ResourceRecord.clone(this.serviceRecords.subtypePTRs):[]}metaQueryPtrRecord(){return this.serviceRecords.metaQueryPtr.clone()}srvRecord(){return this.serviceRecords.srv.clone()}txtRecord(){return this.serviceRecords.txt.clone()}aRecord(e){const t=this.serviceRecords.a[e];return t?t.clone():void 0}aaaaRecord(e){const t=this.serviceRecords.aaaa[e];return t?t.clone():void 0}aaaaRoutableRecord(e){const t=this.serviceRecords.aaaaR[e];return t?t.clone():void 0}aaaaUniqueLocalRecord(e){const t=this.serviceRecords.aaaaULA[e];return t?t.clone():void 0}allAddressRecords(){const e=[];return Object.values(this.serviceRecords.a).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaa).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaaR).forEach((t=>{e.push(t.clone())})),Object.values(this.serviceRecords.aaaaULA).forEach((t=>{e.push(t.clone())})),e}addressNSECRecord(){return this.serviceRecords.addressNSEC.clone()}serviceNSECRecord(e=!1){const t=this.serviceRecords.serviceNSEC.clone();return e&&(t.ttl=120),t}hasAddress(e){return!!this.serviceRecords.reverseAddressPTRs[e]}}t.CiaoService=I},706:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MDNSServer=t.SendResultFormatError=t.SendResultFailedRatio=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(2790)),o=(0,n.__importDefault)(r(1891)),a=r(6670),c=r(3960),u=r(6425),h=r(7877),d=r(9971),l=(0,s.default)("ciao:MDNSServer");t.SendResultFailedRatio=function(e){if(0===e.length)return 0;let t=0;for(const r of e)"fulfilled"!==r.status&&t++;return t/e.length},t.SendResultFormatError=function(e,t,r=!1){let n=0;for(const t of e)"fulfilled"!==t.status&&n++;if(t||(t="Failed to send packets"),n<e.length?t+=` (${n}/${e.length}):`:t+=":",r){let r="=============================\n"+t;for(const t of e)"rejected"===t.status?r+="\n--------------------\nFailed to send packet on interface "+t.interface+": "+t.reason.stack:"timeout"===t.status&&(r+="\n--------------------\nSending packet on interface "+t.interface+" timed out!");return r+="\n=============================",r}{let r=t;for(const t of e)"rejected"===t.status?r+="\n- Failed to send packet on interface "+t.interface+": "+t.reason.message:"timeout"===t.status&&(r+="\n- Sending packet on interface "+t.interface+" timed out!");return r}};class f{constructor(e,t){this.sockets=new Map,this.sentPackets=new Map,this.suppressUnicastResponseFlag=!1,this.bound=!1,this.closed=!1,(0,i.default)(e,"handler cannot be undefined"),this.handler=e,this.networkManager=new c.NetworkManager({interface:t&&t.interface,excludeIpv6:t&&t.disableIpv6,excludeIpv6Only:!0}),this.networkManager.on("network-update",this.handleUpdatedNetworkInterfaces.bind(this))}getNetworkManager(){return this.networkManager}getBoundInterfaceNames(){return this.sockets.keys()}async bind(){if(this.closed)throw new Error("Cannot rebind closed server!");this.suppressUnicastResponseFlag=!0,await this.networkManager.waitForInit();const e=[];for(const[t,r]of this.networkManager.getInterfaceMap()){const n=this.createDgramSocket(t,!0),i=this.bindSocket(n,r,"IPv4").catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}));e.push(i)}return Promise.all(e).then((()=>{this.bound=!0}))}shutdown(){this.networkManager.shutdown();for(const e of this.sockets.values())e.close();this.bound=!1,this.closed=!0,this.sockets.clear()}sendQueryBroadcast(e,t){const r=a.DNSPacket.createDNSQueryPackets(e);r.length>1&&l("Query broadcast is split into %d packets!",r.length);const n=[];for(const e of r)n.push(this.sendOnAllNetworksForService(e,t));return Promise.all(n).then((e=>{const t=[];for(const r of e)t.concat(r);return t}))}sendResponseBroadcast(e,t){const r=a.DNSPacket.createDNSResponsePacketsFromRRSet(e);return this.sendOnAllNetworksForService(r,t)}sendResponse(e,t,r){this.send(e,t).then((e=>{"rejected"===e.status?r?r(new Error("Encountered socket error on "+e.reason.name+": "+e.reason.message)):f.logSocketError(e.interface,e.reason):r&&r()}))}sendOnAllNetworksForService(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();this.assertBeforeSend(r,"IPv4");const n=[];for(const[e,i]of this.sockets){if(!t.advertisesOnInterface(e))continue;const s=new Promise((t=>{i.send(r,f.MDNS_PORT,f.MULTICAST_IPV4,(n=>{if(n){if(!f.isSilencedSocketError(n))return void t({status:"rejected",interface:e,reason:n})}else this.maintainSentPacketsInterface(e,r);t({status:"fulfilled",interface:e})}))}));n.push(Promise.race([s,(0,d.PromiseTimeout)(f.SEND_TIMEOUT).then((()=>({status:"timeout",interface:e})))]))}return Promise.all(n)}send(e,t){this.checkUnicastResponseFlag(e);const r=e.encode();let n,i,s;this.assertBeforeSend(r,"IPv4"),"string"==typeof t?(n=f.MULTICAST_IPV4,i=f.MDNS_PORT,s=t):(n=t.address,i=t.port,s=t.interface);const o=this.sockets.get(s);if(!o)throw new h.InterfaceNotFoundError(`Could not find socket for given network interface '${s}'`);return new Promise((e=>{o.send(r,i,n,(t=>{if(t){if(!f.isSilencedSocketError(t))return void e({status:"rejected",interface:s,reason:t})}else this.maintainSentPacketsInterface(s,r);e({status:"fulfilled",interface:s})}))}))}checkUnicastResponseFlag(e){this.suppressUnicastResponseFlag&&0===e.type&&e.questions.forEach((e=>e.unicastResponseFlag=!1))}assertBeforeSend(e,t){if(this.closed)throw new h.ServerClosedError("Cannot send packets on a closed mdns server!");(0,i.default)(this.bound,"Cannot send packets before server is not bound!");const r="IPv4"===t?f.DEFAULT_IP4_HEADER:f.DEFAULT_IP6_HEADER;(0,i.default)(r+f.UDP_HEADER+e.length<=9e3,"DNS cannot exceed the size of 9000 bytes even with IP Fragmentation!")}maintainSentPacketsInterface(e,t){const r=t.toString("base64"),n=this.sentPackets.get(e);n?n.push(r):this.sentPackets.set(e,[r])}checkIfPacketWasPreviouslySentFromUs(e,t){const r=t.toString("base64"),n=this.sentPackets.get(e);if(n){const e=n.indexOf(r);if(-1!==e)return n.splice(e,1),!0}return!1}createDgramSocket(e,t=!1,r="udp4"){const n=o.default.createSocket({type:r,reuseAddr:t});return n.on("message",this.handleMessage.bind(this,e)),n.on("error",(t=>{f.isSilencedSocketError(t)||f.logSocketError(e,t)})),n}bindSocket(e,t,r){return new Promise(((n,s)=>{const o=e=>s(new Error("Failed to bind on interface "+t.name+": "+e.message));e.once("error",o),e.on("close",(()=>{this.sockets.delete(t.name)})),e.bind(f.MDNS_PORT,(()=>{e.setRecvBufferSize(819200),e.removeListener("error",o);const a="IPv4"===r?f.MULTICAST_IPV4:f.MULTICAST_IPV6,c="IPv4"===r?t.ipv4:t.ipv6;(0,i.default)(c,"Interface address for "+t.name+" cannot be undefined!");try{e.addMembership(a,c),e.setMulticastInterface(c),e.setMulticastTTL(f.MDNS_TTL),e.setTTL(f.MDNS_TTL),e.setMulticastLoopback(!0),this.sockets.set(t.name,e),n()}catch(r){try{e.close()}catch(e){l("Error while closing socket which failed to bind. Error may be expected: "+e.message)}s(new Error("Error binding socket on "+t.name+": "+r.stack))}}))}))}handleMessage(e,t,r){if(!this.bound)return;const n=this.networkManager.getInterface(e);if(!n)return void l("Received packet on non existing network interface: %s!",e);if(this.checkIfPacketWasPreviouslySentFromUs(n.name,t))return;const i=(0,u.getNetAddress)(r.address,n.ip4Netmask);if(n.loopback){if(i!==n.ipv4Netaddress)return}else if(this.networkManager.isLoopbackNetaddressV4(i))return void l("Received packet on interface '%s' which is not coming from the same subnet: %o",e,{address:r.address,netaddress:i,interface:n.ipv4});let s;try{s=a.DNSPacket.decode(r,t)}catch(n){return void l("Received a malformed packet from %o on interface %s. This might or might not be a problem. Here is the received packet for debugging purposes '%s'. Packet decoding failed with %s",r,e,t.toString("base64"),n.stack)}if(0!==s.opcode)return;if(0!==s.rcode)return;const o={address:r.address,port:r.port,interface:e};if(0===s.type)try{this.handler.handleQuery(s,o)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns query packet: "+t.stack)}else if(1===s.type){if(r.port!==f.MDNS_PORT)return;try{this.handler.handleResponse(s,o)}catch(t){console.warn("Error occurred handling incoming (on "+e+") dns response packet: "+t.stack)}}}static isSilencedSocketError(e){const t=e.message.includes("EADDRNOTAVAIL")||e.message.includes("EHOSTDOWN")||e.message.includes("ENETUNREACH")||e.message.includes("EHOSTUNREACH")||e.message.includes("EPERM")||e.message.includes("EINVAL");return t&&l("Silenced and ignored error (This is/should not be a problem, this message is only for informational purposes): "+e.message),t}static logSocketError(e,t){console.warn(`Encountered MDNS socket error on socket '${e}' : ${t.stack}`)}handleUpdatedNetworkInterfaces(e){if(e.removed)for(const t of e.removed){const e=this.sockets.get(t.name);this.sockets.delete(t.name),e&&e.close()}if(e.changes)for(const t of e.changes){const e=this.sockets.get(t.name);if((0,i.default)(e,"Couldn't find socket for network change!"),!t.outdatedIpv4&&t.updatedIpv4)i.default.fail("Reached illegal state! IPv4 address changed from undefined to defined!");else if(t.outdatedIpv4&&!t.updatedIpv4)i.default.fail("Reached illegal state! IPV4 address change from defined to undefined!");else if(t.outdatedIpv4&&t.updatedIpv4){try{e.dropMembership(f.MULTICAST_IPV4,t.outdatedIpv4)}catch(e){l("Thrown expected error when dropping outdated address membership: "+e.message)}try{e.addMembership(f.MULTICAST_IPV4,t.updatedIpv4)}catch(e){l("Thrown expected error when adding new address membership: "+e.message)}e.setMulticastInterface(t.updatedIpv4)}}if(e.added)for(const t of e.added){const e=this.createDgramSocket(t.name,!0);this.bindSocket(e,t,"IPv4").catch((e=>{console.log("Could not bind detected network interface: "+e.stack)}))}}}t.MDNSServer=f,f.DEFAULT_IP4_HEADER=20,f.DEFAULT_IP6_HEADER=40,f.UDP_HEADER=8,f.MDNS_PORT=5353,f.MDNS_TTL=255,f.MULTICAST_IPV4="224.0.0.251",f.MULTICAST_IPV6="FF02::FB",f.SEND_TIMEOUT=200},3960:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkManager=t.NetworkManagerEvent=t.WifiState=t.IPFamily=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(2081)),o=(0,n.__importDefault)(r(2790)),a=r(2361),c=(0,n.__importDefault)(r(5011)),u=(0,n.__importDefault)(r(1808)),h=(0,n.__importDefault)(r(2037)),d=r(6425),l=(0,o.default)("ciao:NetworkManager");!function(e){e.IPv4="IPv4",e.IPv6="IPv6"}(t.IPFamily||(t.IPFamily={})),function(e){e[e.UNDEFINED=0]="UNDEFINED",e[e.NOT_A_WIFI_INTERFACE=1]="NOT_A_WIFI_INTERFACE",e[e.NOT_ASSOCIATED=2]="NOT_ASSOCIATED",e[e.CONNECTED=3]="CONNECTED"}(t.WifiState||(t.WifiState={})),function(e){e.NETWORK_UPDATE="network-update"}(t.NetworkManagerEvent||(t.NetworkManagerEvent={}));class f extends a.EventEmitter{constructor(e){if(super(),this.currentInterfaces=new Map,this.loopbackInterfaces=new Map,this.setMaxListeners(100),e&&e.interface){let t;if("string"==typeof e.interface)t=[e.interface];else{if(!Array.isArray(e.interface))throw new Error("Found invalid type for 'interfaces' NetworkManager option!");t=e.interface}const r=[];for(const n of t)if(u.default.isIP(n)){const t=f.resolveInterface(n);t?r.push(t):console.log("CIAO: Interface was specified as ip (%s), though couldn't find a matching interface for the given address.",e.interface)}else r.push(n);0===r.length?console.log("CIAO: 'restrictedInterfaces' array was empty. Going to fallback to bind on all available interfaces."):this.restrictedInterfaces=r}this.excludeIpv6=!(!e||!e.excludeIpv6),this.excludeIpv6Only=this.excludeIpv6||!(!e||!e.excludeIpv6Only),e&&l("Created NetworkManager with options: %s",JSON.stringify(e)),this.initPromise=new Promise((e=>{this.getCurrentNetworkInterfaces().then((t=>{this.currentInterfaces=t;const r=Object.keys(h.default.networkInterfaces()),n=[];for(const e of this.currentInterfaces.keys()){n.push(e);const t=r.indexOf(e);-1!==t&&r.splice(t,1)}l("Initial networks [%s] ignoring [%s]",n.join(", "),r.join(", ")),this.initPromise=void 0,e(),this.scheduleNextJob()}))}))}async waitForInit(){this.initPromise&&await this.initPromise}shutdown(){this.currentTimer&&(clearTimeout(this.currentTimer),this.currentTimer=void 0),this.removeAllListeners()}getInterfaceMap(){return this.initPromise&&i.default.fail("Not yet initialized!"),this.currentInterfaces}getInterface(e){return this.initPromise&&i.default.fail("Not yet initialized!"),this.currentInterfaces.get(e)}isLoopbackNetaddressV4(e){for(const t of this.loopbackInterfaces.values())if(t.ipv4Netaddress===e)return!0;return!1}scheduleNextJob(){this.currentTimer=setTimeout(this.checkForNewInterfaces.bind(this),f.POLLING_TIME),this.currentTimer.unref()}async checkForNewInterfaces(){const e=await this.getCurrentNetworkInterfaces();if(!this.currentTimer)return;let t,r,n;for(const[r,i]of e){const e=this.currentInterfaces.get(r);if(e){if(!(0,c.default)(e,i)){const t={name:r};e.ipv4!==i.ipv4&&(e.ipv4&&(t.outdatedIpv4=e.ipv4),i.ipv4&&(t.updatedIpv4=i.ipv4)),e.ipv6!==i.ipv6&&(e.ipv6&&(t.outdatedIpv6=e.ipv6),i.ipv6&&(t.updatedIpv6=i.ipv6)),e.globallyRoutableIpv6!==i.globallyRoutableIpv6&&(e.globallyRoutableIpv6&&(t.outdatedGloballyRoutableIpv6=e.globallyRoutableIpv6),i.globallyRoutableIpv6&&(t.updatedGloballyRoutableIpv6=i.globallyRoutableIpv6)),e.uniqueLocalIpv6!==i.uniqueLocalIpv6&&(e.uniqueLocalIpv6&&(t.outdatedUniqueLocalIpv6=e.uniqueLocalIpv6),i.uniqueLocalIpv6&&(t.updatedUniqueLocalIpv6=i.uniqueLocalIpv6)),this.currentInterfaces.set(r,i),i.loopback&&this.loopbackInterfaces.set(r,i),(null!=n?n:n=[]).push(t)}}else this.currentInterfaces.set(r,i),i.loopback&&this.currentInterfaces.set(r,i),(null!=t?t:t=[]).push(i)}if(this.currentInterfaces.size!==e.size)for(const[t,n]of this.currentInterfaces)e.has(t)||(this.currentInterfaces.delete(t),this.loopbackInterfaces.delete(t),(null!=r?r:r=[]).push(n));if(t||r||n){const e=t?t.map((e=>e.name)).join(","):"",i=r?r.map((e=>e.name)).join(","):"",s=n?n.map((e=>{let t=`{ name: ${e.name} `;return(e.outdatedIpv4||e.updatedIpv4)&&(t+=`, ${e.outdatedIpv4} -> ${e.updatedIpv4} `),(e.outdatedIpv6||e.updatedIpv6)&&(t+=`, ${e.outdatedIpv6} -> ${e.updatedIpv6} `),(e.outdatedGloballyRoutableIpv6||e.updatedGloballyRoutableIpv6)&&(t+=`, ${e.outdatedGloballyRoutableIpv6} -> ${e.updatedGloballyRoutableIpv6} `),(e.outdatedUniqueLocalIpv6||e.updatedUniqueLocalIpv6)&&(t+=`, ${e.outdatedUniqueLocalIpv6} -> ${e.updatedUniqueLocalIpv6} `),t+"}"})).join(","):"";l("Detected network changes: added: [%s], removed: [%s], changes: [%s]!",e,i,s),this.emit("network-update",{added:t,removed:r,changes:n})}this.scheduleNextJob()}async getCurrentNetworkInterfaces(){let e;if(this.restrictedInterfaces){e=this.restrictedInterfaces;const t=f.getLoopbackInterface();e.includes(t)||e.push(t)}else try{e=await f.getNetworkInterfaceNames()}catch(t){l(`WARNING Detecting network interfaces for platform '${h.default.platform()}' failed. Trying to assume network interfaces! (${t.message})`),e=f.assumeNetworkInterfaceNames()}const t=new Map,r=h.default.networkInterfaces();for(const n of e){const e=r[n];if(!e)continue;let s,o,a,c,u=!1;for(const t of e){if(t.internal&&(u=!0),"IPv4"!==t.family&&4!==t.family||s){if("IPv6"===t.family||6===t.family){if(this.excludeIpv6)continue;t.scopeid&&!o?o=t:0===t.scopeid&&(t.address.startsWith("fc")||t.address.startsWith("fd")?c||(c=t):a||(a=t))}}else s=t;if(s&&o&&a&&c)break}if((0,i.default)(s||o,"Could not find valid addresses for interface '"+n+"'"),this.excludeIpv6Only&&!s)continue;const h={name:n,loopback:u,mac:(null==s?void 0:s.mac)||(null==o?void 0:o.mac)};s&&(h.ipv4=s.address,h.ip4Netmask=s.netmask,h.ipv4Netaddress=(0,d.getNetAddress)(s.address,s.netmask)),o&&(h.ipv6=o.address,h.ipv6Netmask=o.netmask),a&&(h.globallyRoutableIpv6=a.address,h.globallyRoutableIpv6Netmask=a.netmask),c&&(h.uniqueLocalIpv6=c.address,h.uniqueLocalIpv6Netmask=c.netmask),t.set(n,h)}return t}static resolveInterface(e){let t;e:for(const[r,n]of Object.entries(h.default.networkInterfaces()))for(const i of n)if(i.address===e){t=r;break e}return t}static async getNetworkInterfaceNames(){let e,t;switch(h.default.platform()){case"win32":e=f.getWindowsNetworkInterfaces();break;case"linux":e=f.getLinuxNetworkInterfaces();break;case"darwin":e=f.getDarwinNetworkInterfaces();break;case"freebsd":e=f.getFreeBSDNetworkInterfaces();break;case"openbsd":case"sunos":e=f.getOpenBSD_SUNOS_NetworkInterfaces();break;default:return l("Found unsupported platform %s",h.default.platform()),Promise.reject(new Error("unsupported platform!"))}try{t=await e}catch(e){if(e.message!==f.NOTHING_FOUND_MESSAGE)throw e;t=[]}const r=f.getLoopbackInterface();return t.includes(r)||t.unshift(r),e}static assumeNetworkInterfaceNames(){const e=[];return Object.entries(h.default.networkInterfaces()).forEach((([t,r])=>{for(const n of r)if(n.internal||"IPv4"===n.family||4===n.family||("IPv6"===n.family||6===n.family)&&0===n.scopeid){e.includes(t)||e.push(t);break}})),e}static getLoopbackInterface(){for(const[e,t]of Object.entries(h.default.networkInterfaces()))for(const r of t)if(r.internal)return e;throw new Error("Could not detect loopback interface!")}static getWindowsNetworkInterfaces(){return new Promise(((e,t)=>{s.default.exec('arp -a | findstr /C:"---"',((r,n)=>{if(r)return void t(r);const i=n.split(h.default.EOL),s=[];for(let e=0;e<i.length-1;e++){const t=i[e].trim().split(" ");t[t.length-3]?s.push(t[t.length-3]):l(`WINDOWS: Failed to read interface name from line ${e}: '${i[e]}'`)}const o=[];for(const e of s){const t=f.resolveInterface(e);t?o.includes(t)||o.push(t):l(`WINDOWS: Couldn't resolve to an interface name from '${e}'`)}o.length?e(o):t(new Error(f.NOTHING_FOUND_MESSAGE))}))}))}static getDarwinNetworkInterfaces(){return new Promise(((e,t)=>{s.default.exec("arp -a -n -l",(async(r,n)=>{if(r)return void t(r);const i=n.split(h.default.EOL),s=[];for(let e=1;e<i.length-1;e++){const t=i[e].trim().split(f.SPACE_PATTERN)[4];t?s.includes(t)||s.push(t):l(`DARWIN: Failed to read interface name from line ${e}: '${i[e]}'`)}const o=[];for(const e of s){const t=f.getDarwinWifiNetworkState(e).then((t=>{if(1!==t&&3!==t){const t=s.indexOf(e);-1!==t&&s.splice(t,1)}}));o.push(t)}await Promise.all(o),s.length?e(s):t(new Error(f.NOTHING_FOUND_MESSAGE))}))}))}static getLinuxNetworkInterfaces(){return new Promise(((e,t)=>{s.default.exec("ip neigh show",((r,n)=>{if(r)return r.message.includes("ip: not found")?(l("LINUX: ip was not found on the system. Falling back to assuming network interfaces!"),void e(f.assumeNetworkInterfaceNames())):void t(r);const i=n.split(h.default.EOL),s=[];for(let e=0;e<i.length-1;e++){const t=i[e].trim().split(f.SPACE_PATTERN);let r=0;for(;r<t.length&&"dev"!==t[r];r++);if(r>=t.length){l(`LINUX: Out of bounds when reading interface name from line ${e}: '${i[e]}'`);continue}const n=t[r+1];n?s.includes(n)||s.push(n):l(`LINUX: Failed to read interface name from line ${e}: '${i[e]}'`)}s.length?e(s):t(new Error(f.NOTHING_FOUND_MESSAGE))}))}))}static getFreeBSDNetworkInterfaces(){return new Promise(((e,t)=>{s.default.exec("arp -a -n",((r,n)=>{if(r)return void t(r);const i=n.split(h.default.EOL),s=[];for(let e=0;e<i.length-1;e++){const t=i[e].trim().split(f.SPACE_PATTERN)[5];t?s.includes(t)||s.push(t):l(`FreeBSD: Failed to read interface name from line ${e}: '${i[e]}'`)}s.length?e(s):t(new Error(f.NOTHING_FOUND_MESSAGE))}))}))}static getOpenBSD_SUNOS_NetworkInterfaces(){return new Promise(((e,t)=>{s.default.exec("arp -a -n",((r,n)=>{if(r)return void t(r);const i="sunos"===h.default.platform()?0:2,s=n.split(h.default.EOL),o=[];for(let e=1;e<s.length-1;e++){const t=s[e].trim().split(f.SPACE_PATTERN)[i];t?o.includes(t)||o.push(t):l(`${h.default.platform()}: Failed to read interface name from line ${e}: '${s[e]}'`)}o.length?e(o):t(new Error(f.NOTHING_FOUND_MESSAGE))}))}))}static getDarwinWifiNetworkState(e){return new Promise((t=>{s.default.exec("networksetup -getairportnetwork "+e,((r,n)=>{if(r)return n.includes("not a Wi-Fi interface")?void t(1):(console.log(`CIAO WARN: While checking networksetup for ${e} encountered an error (${r.message}) with output: ${n.replace(h.default.EOL,"; ")}`),void t(0));let i=0;n.includes("not a Wi-Fi interface")?i=1:n.includes("Current Wi-Fi Network")?i=3:n.includes("not associated")?i=2:n.includes("All Wi-Fi network services are disabled")?i=1:console.log(`CIAO WARN: While checking networksetup for ${e} encountered an unknown output: ${n.replace(h.default.EOL,"; ")}`),t(i)}))}))}}t.NetworkManager=f,f.SPACE_PATTERN=/\s+/g,f.NOTHING_FOUND_MESSAGE="no interfaces found",f.POLLING_TIME=15e3},2842:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Responder=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(2790)),o=r(1562),a=r(6670),c=r(4961),u=r(3013),h=r(5742),d=r(3491),l=r(1723),f=r(8730),p=r(706),y=r(1152),m=r(8859),g=r(1329),v=r(9224),b=r(2449),E=r(7877),S=r(9971),A=r(6025),I=(0,s.default)("ciao:Responder"),w=(e,t)=>e.estimatedTimeToBeSent-t.estimatedTimeToBeSent;var T;!function(e){e[e.NO_CONFLICT=0]="NO_CONFLICT",e[e.CONFLICTING_RDATA=1]="CONFLICTING_RDATA",e[e.CONFLICTING_TTL=2]="CONFLICTING_TTL"}(T||(T={}));class C{constructor(e){this.refCount=1,this.optionsString="",this.bound=!1,this.announcedServices=new Map,this.servicePointer=new Map,this.truncatedQueries={},this.delayedMulticastResponses=[],this.server=new p.MDNSServer(this,e),this.promiseChain=this.start(),this.server.getNetworkManager().on("network-update",this.handleNetworkUpdate.bind(this)),this.ignoreUnicastResponseFlag=null==e?void 0:e.ignoreUnicastResponseFlag,(null==e?void 0:e.periodicBroadcasts)&&(this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e4).unref())}static getResponder(e){const t=e?JSON.stringify(e):"",r=this.INSTANCES.get(t);if(r)return r.refCount++,r;{const r=new C(e);return this.INSTANCES.set(t,r),r.optionsString=t,r}}handlePeriodicBroadcasts(){this.broadcastInterval=void 0,I("Sending periodic announcement on "+Array.from(this.server.getNetworkManager().getInterfaceMap().keys()).join(", "));for(const e of this.server.getNetworkManager().getInterfaceMap().values()){const t=new c.Question("_hap._tcp.local.",12,!1),r=this.answerQuestion(t,{port:5353,address:e.ipv4Netaddress||e.globallyRoutableIpv6||e.uniqueLocalIpv6||e.ipv6,interface:e.name});g.QueryResponse.combineResponses(r);for(const t of r)t.hasAnswers()&&this.server.sendResponse(t.asPacket(),e.name)}this.broadcastInterval=setTimeout(this.handlePeriodicBroadcasts.bind(this),3e3*Math.random()+27e3).unref()}createService(e){const t=new o.CiaoService(this.server.getNetworkManager(),e);return t.on("publish",this.advertiseService.bind(this,t)),t.on("unpublish",this.unpublishService.bind(this,t)),t.on("republish",this.republishService.bind(this,t)),t.on("records-update",this.handleServiceRecordUpdate.bind(this,t)),t.on("records-update-interface",this.handleServiceRecordUpdateOnInterface.bind(this,t)),t}shutdown(){if(this.refCount--,this.refCount>0)return Promise.resolve();this.currentProber&&this.currentProber.cancel(),this.broadcastInterval&&clearTimeout(this.broadcastInterval),C.INSTANCES.delete(this.optionsString),I("Shutting down Responder...");const e=[];for(const t of this.announcedServices.values())e.push(this.unpublishService(t));return Promise.all(e).then((()=>{this.server.shutdown(),this.bound=!1}))}getAnnouncedServices(){return this.announcedServices.values()}start(){if(this.bound)throw new Error("Server is already bound!");return this.bound=!0,this.server.bind()}advertiseService(e,t){if("announced"===e.serviceState)throw new Error("Can't publish a service that is already announced. Received "+e.serviceState+" for service "+e.getFQDN());return"probing"===e.serviceState?this.promiseChain.then((()=>{if(e.currentAnnouncer)return e.currentAnnouncer.awaitAnnouncement()})):"announcing"===e.serviceState?((0,i.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement().then((()=>this.advertiseService(e,t))):e.currentAnnouncer.cancel().then((()=>this.advertiseService(e,t)))):(I("[%s] Going to advertise service...",e.getFQDN()),this.promiseChain=this.promiseChain.then((()=>e.rebuildServiceRecords())).then((()=>this.probe(e))),this.promiseChain.then((()=>{this.announce(e).catch((t=>(console.log(`[${e.getFQDN()}] failed announcing with reason: ${t}. Trying again in 2 seconds!`),(0,S.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,(()=>{}))))))),t()}),(r=>{if(r!==m.Prober.CANCEL_REASON)return console.log(`[${e.getFQDN()}] failed probing with reason: ${r}. Trying again in 2 seconds!`),(0,S.PromiseTimeout)(2e3).then((()=>this.advertiseService(e,t)));t()})))}republishService(e,t,r=!1){if("announced"!==e.serviceState&&"announcing"!==e.serviceState)throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN());if(I("[%s] Readvertising service...",e.getFQDN()),"announcing"===e.serviceState){(0,i.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!");return(e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel()).then((()=>this.advertiseService(e,t)))}return this.clearService(e),e.serviceState="unannounced",r?(0,S.PromiseTimeout)(1e3).then((()=>this.advertiseService(e,t))):this.advertiseService(e,t)}unpublishService(e,t){if("unannounced"===e.serviceState)throw new Error("Can't unpublish a service which isn't announced yet. Received "+e.serviceState+" for service "+e.getFQDN());if("announced"===e.serviceState||"announcing"===e.serviceState){if("announcing"===e.serviceState)return(0,i.default)(e.currentAnnouncer,"Service is in state ANNOUNCING though has no linked announcer!"),e.currentAnnouncer.isSendingGoodbye()?e.currentAnnouncer.awaitAnnouncement():e.currentAnnouncer.cancel().then((()=>(e.serviceState="announced",this.unpublishService(e,t))));I("[%s] Removing service from the network",e.getFQDN()),this.clearService(e),e.serviceState="unannounced";let r=this.goodbye(e);return t&&(r=r.then((()=>t()),(r=>{console.log(`[${e.getFQDN()}] failed goodbye with reason: ${r}.`),t()}))),r}return"probing"===e.serviceState&&(I("[%s] Canceling probing",e.getFQDN()),this.currentProber&&this.currentProber.getService()===e&&(this.currentProber.cancel(),this.currentProber=void 0),e.serviceState="unannounced"),t&&t(),Promise.resolve()}clearService(e){const t=e.getLowerCasedFQDN(),r=e.getLowerCasedTypePTR(),n=e.getLowerCasedSubtypePTRs();if(this.removePTR(C.SERVICE_TYPE_ENUMERATION_NAME,r),this.removePTR(r,t),n)for(const e of n)this.removePTR(e,t);this.announcedServices.delete(e.getLowerCasedFQDN())}addPTR(e,t){const r=this.servicePointer.get(e);r?r.includes(t)||r.push(t):this.servicePointer.set(e,[t])}removePTR(e,t){const r=this.servicePointer.get(e);if(r){const n=r.indexOf(t);-1!==n&&r.splice(n,1),0===r.length&&this.servicePointer.delete(e)}}probe(e){if("unannounced"!==e.serviceState)throw new Error("Can't probe for a service which is announced already. Received "+e.serviceState+" for service "+e.getFQDN());return e.serviceState="probing",(0,i.default)(void 0===this.currentProber,"Tried creating new Prober when there already was one active!"),this.currentProber=new m.Prober(this,this.server,e),this.currentProber.probe().then((()=>{this.currentProber=void 0,e.serviceState="probed"}),(t=>(e.serviceState="unannounced",this.currentProber=void 0,Promise.reject(t))))}announce(e){if("probed"!==e.serviceState)throw new Error("Cannot announce service which was not probed unique. Received "+e.serviceState+" for service "+e.getFQDN());(0,i.default)(void 0===e.currentAnnouncer,"Service "+e.getFQDN()+" is already announcing!"),e.serviceState="announcing";const t=new y.Announcer(this.server,e,{repetitions:3});e.currentAnnouncer=t;const r=e.getLowerCasedFQDN(),n=e.getLowerCasedTypePTR(),s=e.getLowerCasedSubtypePTRs();if(this.addPTR(C.SERVICE_TYPE_ENUMERATION_NAME,n),this.addPTR(n,r),s)for(const e of s)this.addPTR(e,r);return this.announcedServices.set(r,e),t.announce().then((()=>{e.serviceState="announced",e.currentAnnouncer=void 0}),(t=>{if(e.serviceState="unannounced",e.currentAnnouncer=void 0,this.clearService(e),t!==y.Announcer.CANCEL_REASON)return Promise.reject(t)}))}handleServiceRecordUpdate(e,t,r){var n;if("announced"!==e.serviceState)throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN());I("[%s] Updating %d record(s) for given service!",e.getFQDN(),t.answers.length+((null===(n=t.additionals)||void 0===n?void 0:n.length)||0)),this.server.sendResponseBroadcast(t,e).then((t=>{const n=(0,p.SendResultFailedRatio)(t);if(1===n)return console.log((0,p.SendResultFormatError)(t,`Failed to send records update for '${e.getFQDN()}'`),!0),void(r&&r(new Error("Updating records failed as of socket errors!")));n>0&&I((0,p.SendResultFormatError)(t,`Some of the record updates for '${e.getFQDN()}' failed`)),r&&r()}))}handleServiceRecordUpdateOnInterface(e,t,r,n){if("announced"!==e.serviceState)throw new Error("Cannot update txt of service which is not announced yet. Received "+e.serviceState+" for service "+e.getFQDN());I("[%s] Updating %d record(s) for given service on interface %s!",e.getFQDN(),r.length,t);const i=a.DNSPacket.createDNSResponsePacketsFromRRSet({answers:r});this.server.sendResponse(i,t,n)}goodbye(e){(0,i.default)(void 0===e.currentAnnouncer,"Service "+e.getFQDN()+" is already announcing!"),e.serviceState="announcing";const t=new y.Announcer(this.server,e,{repetitions:1,goodbye:!0});return e.currentAnnouncer=t,t.announce().then((()=>{e.serviceState="unannounced",e.currentAnnouncer=void 0}),(t=>(e.serviceState="unannounced",e.currentAnnouncer=void 0,Promise.reject(t))))}handleNetworkUpdate(e){for(const t of this.announcedServices.values())t.handleNetworkInterfaceUpdate(e)}handleQuery(e,t){const r=(new Date).getTime(),n=t.address+":"+t.port+":"+t.interface,i=this.truncatedQueries[n];if(i){switch(i.appendDNSPacket(e)){case 1:return delete this.truncatedQueries[n],void I("[%s] Aborting to wait for more truncated queries. Waited a total of %d ms receiving %d queries",n,i.getTotalWaitTime(),i.getArrivedPacketCount());case 2:return void I("[%s] Received a query marked as truncated, waiting for more to arrive",n);case 3:delete this.truncatedQueries[n],e=i.getPacket(),I("[%s] Last part of the truncated query arrived. Received %d packets taking a total of %d ms",n,i.getArrivedPacketCount(),i.getTotalWaitTime())}}else if(e.flags.truncation){I("Received truncated query from "+JSON.stringify(t)+" waiting for more to come!");const r=new b.TruncatedQuery(e);return this.truncatedQueries[n]=r,void r.on("timeout",(()=>{I("[%s] Timeout passed since the last truncated query was received. Discarding %d packets received in %d ms.",n,r.getArrivedPacketCount(),r.getTotalWaitTime()),delete this.truncatedQueries[n]}))}const s=t.port!==p.MDNSServer.MDNS_PORT,o=e.authorities.size>0;let a;for(const t of e.additionals.values())if(41===t.type){a=t.udpPayloadSize;break}const c=[],u=[];if(e.questions.forEach((r=>{const n=this.answerQuestion(r,t,e.answers);s||r.unicastResponseFlag&&!this.ignoreUnicastResponseFlag?u.push(...n):c.push(...n)})),this.currentProber&&this.currentProber.handleQuery(e,t),s)for(let t=0;t<u.length;t++){u[t].markLegacyUnicastResponse(e.id,0===t?Array.from(e.questions.values()):void 0)}g.QueryResponse.combineResponses(c,a),g.QueryResponse.combineResponses(u,a),s&&u.length>1&&(u.splice(1,u.length-1),u[0].markTruncated());for(const e of u){if(!e.hasAnswers())continue;this.server.sendResponse(e.asPacket(),t);const n=(new Date).getTime()-r;I("Sending response via unicast to %s (took %d ms): %s",JSON.stringify(t),n,e.asString(a))}for(const n of c)if(n.hasAnswers())if((n.containsSharedAnswer()||e.questions.size>1)&&!o){const e=(new Date).getTime()-r;this.enqueueDelayedMulticastResponse(n.asPacket(),t.interface,e)}else{let e=!1;for(let i=0;i<this.delayedMulticastResponses.length;i++){const s=this.delayedMulticastResponses[i];if(s.getTimeTillSent()>v.QueuedResponse.MAX_DELAY)break;if(s.combineWithUniqueResponseIfPossible(n,t.interface)){const n=(new Date).getTime()-r;e=!0,I("Multicast response on interface %s containing unique records (took %d ms) was combined with response which is sent out later",t.interface,n);break}}if(!e){this.server.sendResponse(n.asPacket(),t.interface);const e=(new Date).getTime()-r;I("Sending response via multicast on network %s (took %d ms): %s",t.interface,e,n.asString(a))}}}handleResponse(e,t){this.currentProber&&this.currentProber.handleResponse(e,t);for(const r of this.announcedServices.values()){let n=!1,i=0;for(const s of e.answers.values()){const e=C.checkRecordConflictType(r,s,t);if(1===e){n=!0;break}2===e&&i++}if(!n)for(const s of e.additionals.values()){const e=C.checkRecordConflictType(r,s,t);if(1===e){n=!0;break}2===e&&i++}if(n)this.republishService(r,(e=>{e&&(console.log(`FATAL Error occurred trying to resolve conflict for service ${r.getFQDN()}! We can't recover from this!`),console.log(e.stack),process.exit(1))}),!0);else if(i&&!r.currentAnnouncer){r.serviceState="announcing";const e=new y.Announcer(this.server,r,{repetitions:1});r.currentAnnouncer=e,e.announce().then((()=>{r.currentAnnouncer=void 0,r.serviceState="announced"}),(e=>{r.currentAnnouncer=void 0,r.serviceState="announced",e!==y.Announcer.CANCEL_REASON&&console.warn("When trying to resolve a ttl conflict on the network, we were unable to send our response packet: "+e.message)}))}}}static checkRecordConflictType(e,t,r){if(!e.advertisesOnInterface(r.interface))return 0;const n=t.getLowerCasedName();if(n===e.getLowerCasedFQDN()){if(33===t.type){const r=t;if(r.getLowerCasedHostname()!==e.getLowerCasedHostname())return I("[%s] Noticed conflicting record on the network. SRV with hostname: %s",e.getFQDN(),r.hostname),1;if(r.port!==e.getPort())return I("[%s] Noticed conflicting record on the network. SRV with port: %s",e.getFQDN(),r.port),1;if(r.ttl<l.SRVRecord.DEFAULT_TTL/2)return 2}else if(16===t.type){const r=t,n=e.getTXT();if(n.length!==r.txt.length)return I("[%s] Noticed conflicting record on the network. TXT with differing data length",e.getFQDN()),1;for(let t=0;t<n.length;t++){const i=n[t],s=r.txt[t];if(i.length!==s.length||i.toString("hex")!==s.toString("hex"))return I("[%s] Noticed conflicting record on the network. TXT with differing data.",e.getFQDN()),1}if(r.ttl<f.TXTRecord.DEFAULT_TTL/2)return 2}}else if(n===e.getLowerCasedHostname()){if(1===t.type){const r=t;if(!e.hasAddress(r.ipAddress))return I("[%s] Noticed conflicting record on the network. A with ip address: %s",e.getFQDN(),r.ipAddress),1;if(r.ttl<h.ARecord.DEFAULT_TTL/2)return 2}else if(28===t.type){const r=t;if(!e.hasAddress(r.ipAddress))return I("[%s] Noticed conflicting record on the network. AAAA with ip address: %s",e.getFQDN(),r.ipAddress),1;if(r.ttl<u.AAAARecord.DEFAULT_TTL/2)return 2}}else if(12===t.type){const r=t;if(n===e.getLowerCasedTypePTR()){if(r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<d.PTRRecord.DEFAULT_TTL/2)return 2}else if(n===C.SERVICE_TYPE_ENUMERATION_NAME);else{const t=e.getLowerCasedSubtypePTRs();if(t&&t.includes(n)&&r.getLowerCasedPTRName()===e.getLowerCasedFQDN()&&r.ttl<d.PTRRecord.DEFAULT_TTL/2)return 2}}return 0}enqueueDelayedMulticastResponse(e,t,r){const n=new v.QueuedResponse(e,t);n.calculateRandomDelay(),(0,A.sortedInsert)(this.delayedMulticastResponses,n,w);for(let e=0;e<this.delayedMulticastResponses.length;e++){const t=this.delayedMulticastResponses[e];for(let r=e+1;r<this.delayedMulticastResponses.length;r++){const n=this.delayedMulticastResponses[r];if(!t.delayWouldBeInTimelyManner(n))break;if(t.combineWithNextPacketIfPossible(n)){const r=this.delayedMulticastResponses.indexOf(t);-1!==r&&this.delayedMulticastResponses.splice(r,1),e--;break}}}n.delayed||n.scheduleResponse((()=>{const e=this.delayedMulticastResponses.indexOf(n);-1!==e&&this.delayedMulticastResponses.splice(e,1);try{this.server.sendResponse(n.getPacket(),t),I("Sending (delayed %dms) response via multicast on network interface %s (took %d ms): %s",Math.round(n.getTimeSinceCreation()),t,r,n.getPacket().asLoggingString())}catch(e){if(e.name===E.ERR_INTERFACE_NOT_FOUND)I("Multicast response (delayed %dms) was cancelled as the network interface %s is no longer available!",Math.round(n.getTimeSinceCreation()),t);else{if(e.name!==E.ERR_SERVER_CLOSED)throw e;I("Multicast response (delayed %dms) was cancelled as the server is about to be shutdown!",Math.round(n.getTimeSinceCreation()))}}}))}answerQuestion(e,t,r){if(1!==e.class&&255!==e.class)return[];const n=[];let i;if(12===e.type||255===e.type||5===e.type){const s=this.servicePointer.get(e.getLowerCasedName());if(s){for(const o of s){const s=this.announcedServices.get(o);if(s){if(s.advertisesOnInterface(t.interface)){const i=C.answerServiceQuestion(s,e,t,r);i.hasAnswers()&&n.push(i)}}else i||(i=new g.QueryResponse(r),n.unshift(i)),i.addAnswer(new d.PTRRecord(e.name,o))}return n}}for(const i of this.announcedServices.values()){if(!i.advertisesOnInterface(t.interface))continue;const s=C.answerServiceQuestion(i,e,t,r);s.hasAnswers()&&n.push(s)}return n}static answerServiceQuestion(e,t,r,n){const s=new g.QueryResponse(n),o=t.getLowerCasedName(),a=255===t.type||5===t.type,c=s.addAnswer.bind(s),u=s.addAdditional.bind(s);if(o===e.getLowerCasedTypePTR()){if(a||12===t.type){s.addAnswer(e.ptrRecord())&&(s.addAdditional(e.txtRecord(),e.srvRecord()),this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),s.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}}else if(o===e.getLowerCasedFQDN())if(a){s.addAnswer(e.txtRecord());s.addAnswer(e.srvRecord())&&(this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),s.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}else if(33===t.type){s.addAnswer(e.srvRecord())&&(this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),s.addAdditional(e.serviceNSECRecord(!0),e.addressNSECRecord()))}else 16===t.type&&(s.addAnswer(e.txtRecord()),s.addAdditional(e.serviceNSECRecord()));else if(o===e.getLowerCasedHostname()||o+"local."===e.getLowerCasedHostname()){if(a)this.addAddressRecords(e,r,1,c),this.addAddressRecords(e,r,28,c),s.addAdditional(e.addressNSECRecord());else if(1===t.type){this.addAddressRecords(e,r,1,c)&&this.addAddressRecords(e,r,28,u),s.addAdditional(e.addressNSECRecord())}else if(28===t.type){this.addAddressRecords(e,r,28,c)&&this.addAddressRecords(e,r,1,u),s.addAdditional(e.addressNSECRecord())}}else if(e.getLowerCasedSubtypePTRs()&&(a||12===t.type)){const t=e.getLowerCasedSubtypePTRs().indexOf(o);if(-1!==t){const n=e.subtypePtrRecords()[t];(0,i.default)(o===n.name,"Question Name didn't match selected sub type ptr record!");s.addAnswer(n)&&(s.addAdditional(e.txtRecord(),e.srvRecord()),this.addAddressRecords(e,r,1,u),this.addAddressRecords(e,r,28,u),s.addAdditional(e.serviceNSECRecord(),e.addressNSECRecord()))}}return s}static addAddressRecords(e,t,r,n){if(1===r){const r=e.aRecord(t.interface);return!!r&&n(r)}if(28===r){const r=e.aaaaRecord(t.interface),i=e.aaaaRoutableRecord(t.interface),s=e.aaaaUniqueLocalRecord(t.interface);let o=!1;if(r&&(o=n(r)),i){const e=n(i);o=o||e}if(s){const e=n(s);o=o||e}return o}i.default.fail("Illegal argument!")}}t.Responder=C,C.SERVICE_TYPE_ENUMERATION_NAME="_services._dns-sd._udp.local.",C.INSTANCES=new Map},9556:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NonCompressionLabelCoder=t.DNSLabelCoder=void 0;const n=(0,r(5827).__importDefault)(r(9491));class i{constructor(e){this.trackedLengths=[],this.writtenNames=[],this.legacyUnicastEncoding=e||!1}initBuf(e){this.buffer=e}initRRLocation(e,t,r){this.startOfRR=e,this.startOfRData=t,this.rDataLength=r}clearRRLocation(){this.startOfRR=void 0,this.startOfRData=void 0,this.rDataLength=void 0}getUncompressedNameLength(e){if("."===e)return 1;(0,n.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");let t=0;const r=e.split(".");for(let s=0;s<r.length;s++){const o=r[s];!o&&s<r.length-1&&n.default.fail("Label "+s+" in name '"+e+"' was empty"),t+=i.getLabelLength(o)}return t}getNameLength(e){if(i.DISABLE_COMPRESSION)return this.getUncompressedNameLength(e);if("."===e)return 1;(0,n.default)(e.endsWith("."),"Supplied illegal name which doesn't end with the root label!");const t=e.split(".").map((e=>i.getLabelLength(e))),r={name:e,length:0,labelLengths:t};let s,o=0;for(let t=0;t<this.trackedLengths.length;t++){const r=this.trackedLengths[t],n=i.computeLabelSuffixLength(r.name,e);n>o&&(s=r,o=n)}let a=0;if(s){const e=t.length-1-o;for(let r=0;r<e;r++)a+=t[r];a+=2}else for(let e=0;e<t.length;e++)a+=t[e];return r.length=a,this.trackedLengths.push(r),r.length}encodeUncompressedName(e,t){return this.buffer||n.default.fail("Illegal state. Buffer not initialized!"),i.encodeUncompressedName(e,this.buffer,t)}static encodeUncompressedName(e,t,r){(0,n.default)(e.endsWith("."),"Name does not end with the root label");const i=r,s="."===e?[""]:e.split(".");for(let e=0;e<s.length;e++){const i=s[e];if(""===i){(0,n.default)(e===s.length-1,"Encountered root label being not at the end of the domain name"),t.writeUInt8(0,r++);break}const o=t.write(i,r+1);t.writeUInt8(o,r),r+=o+1}return r-i}encodeName(e,t){if(i.DISABLE_COMPRESSION)return this.encodeUncompressedName(e,t);if(this.buffer||n.default.fail("Illegal state. Buffer not initialized!"),"."===e)return this.buffer.writeUInt8(0,t),1;const r=t,s=e.split("."),o={name:e,writtenLabels:new Array(s.length).fill(-1)};let a,c=0;for(let t=0;t<this.writtenNames.length;t++){const r=this.writtenNames[t],n=i.computeLabelSuffixLength(r.name,e);n>c&&(a=r,c=n)}if(a){const e=s.length-1-c,r=a.writtenLabels.length-1-c;for(let r=0;r<e;r++)o.writtenLabels[r]=t,t+=i.writeLabel(s[r],this.buffer,t);const u=a.writtenLabels[r];(0,n.default)(-1!==u,"Label which was pointed at wasn't yet written to the buffer!"),(0,n.default)(u<=i.NOT_POINTER_MASK,"Pointer exceeds to length of a maximum of 14 bits"),(0,n.default)(u<t,"Pointer can only point to a prior location");const h=i.POINTER_MASK|u;this.buffer.writeUInt16BE(h,t),t+=2}else for(let e=0;e<s.length;e++)o.writtenLabels[e]=t,t+=i.writeLabel(s[e],this.buffer,t);return this.writtenNames.push(o),t-r}decodeName(e,t=!0){this.buffer||n.default.fail("Illegal state. Buffer not initialized!");const r=e;let s="";for(;;){const o=this.buffer.readUInt8(e++);if(0===o){s+=".";break}const a=o&i.POINTER_MASK_ONE_BYTE;if(a){if(a===i.POINTER_MASK_ONE_BYTE){const o=this.buffer.readUInt16BE(e-1)&i.NOT_POINTER_MASK;if(e++,!t){s+=s?".~":"~";break}(0,n.default)(o<r,"Pointer at "+(e-2)+" MUST point to a prior location!"),s+=(s?".":"")+this.decodeName(o).data;break}if(a===i.LOCAL_COMPRESSION_ONE_BYTE){let o=this.buffer.readUInt16BE(e-1)&i.NOT_POINTER_MASK;if(e++,!t){s+=s?".~":"~";break}o>=0&&o<255?((0,n.default)(void 0!==this.startOfRR,"Cannot decompress locally compressed name as record is not initialized!"),o+=this.startOfRR,(0,n.default)(o<r,"LocalPointer <255 at "+(e-2)+" MUST point to a prior location!"),s+=(s?".":"")+this.decodeName(o).data):o>=256?((0,n.default)(void 0!==this.startOfRData&&void 0!==this.rDataLength,"Cannot decompress locally compressed name as record is not initialized!"),o-=-256,o+=this.startOfRData,(0,n.default)(o<r,"LocationPoint >265 at "+(e+2)+" MUST point to a prior location!"),s+=(s?".":"")+this.decodeName(o).data):n.default.fail("Encountered unknown pointer range "+o);break}if(a===i.EXTENDED_LABEL_TYPE_ONE_BYTE){const t=o&i.NOT_POINTER_MASK_ONE_BYTE;n.default.fail("Received extended label type "+t+" at "+(e-1))}else n.default.fail("Encountered unknown pointer type: "+Buffer.from([a>>6]).toString("hex")+" (with original byte "+Buffer.from([o]).toString("hex")+")")}const c=this.buffer.toString("utf-8",e,e+o);e+=o,s+=(s?".":"")+c}return{data:s,readBytes:e-r}}static getLabelLength(e){if(e){const t=Buffer.byteLength(e);return(0,n.default)(t<=63,"Label cannot be longer than 63 bytes ("+e+")"),1+t}return 1}static writeLabel(e,t,r){if(e){const n=t.write(e,r+1);return t.writeUInt8(n,r),n+1}return t.writeUInt8(0,r),1}static computeLabelSuffixLength(e,t){(0,n.default)(0!==e.length&&0!==t.length,"Encountered empty name when comparing suffixes!");const r=e.length-1,i=t.length-1;let s=0,o=!1;for(let a=1;a<=r&&a<=i;a++){const c=e.charAt(r-a),u=t.charAt(i-a);if((0,n.default)(!!c&&!!u,"Seemingly encountered out of bounds trying to calculate suffixes"),c!==u){o=!0;break}"."===c&&s++}return o||s++,s}}t.DNSLabelCoder=i,i.DISABLE_COMPRESSION=!1,i.POINTER_MASK=49152,i.POINTER_MASK_ONE_BYTE=192,i.LOCAL_COMPRESSION_ONE_BYTE=128,i.EXTENDED_LABEL_TYPE_ONE_BYTE=64,i.NOT_POINTER_MASK=16383,i.NOT_POINTER_MASK_ONE_BYTE=63;class s extends i{getNameLength(e){return this.getUncompressedNameLength(e)}encodeName(e,t){return this.encodeUncompressedName(e,t)}}t.NonCompressionLabelCoder=s,s.INSTANCE=new s},6670:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DNSPacket=t.PacketType=t.QClass=t.RClass=t.QType=t.RType=t.RCode=t.OpCode=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(5011)),o=r(5215),a=r(9556),c=r(4961);r(8167);const u=r(7632);function h(e){return"answers"in e}!function(e){e[e.QUERY=0]="QUERY"}(t.OpCode||(t.OpCode={})),function(e){e[e.NoError=0]="NoError"}(t.RCode||(t.RCode={})),function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.PTR=12]="PTR",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA",e[e.SRV=33]="SRV",e[e.OPT=41]="OPT",e[e.NSEC=47]="NSEC"}(t.RType||(t.RType={})),function(e){e[e.A=1]="A",e[e.CNAME=5]="CNAME",e[e.PTR=12]="PTR",e[e.TXT=16]="TXT",e[e.AAAA=28]="AAAA",e[e.SRV=33]="SRV",e[e.NSEC=47]="NSEC",e[e.ANY=255]="ANY"}(t.QType||(t.QType={})),function(e){e[e.IN=1]="IN"}(t.RClass||(t.RClass={})),function(e){e[e.IN=1]="IN",e[e.ANY=255]="ANY"}(t.QClass||(t.QClass={})),function(e){e[e.QUERY=0]="QUERY",e[e.RESPONSE=1]="RESPONSE"}(t.PacketType||(t.PacketType={}));class d{constructor(e){this.questions=new Map,this.answers=new Map,this.authorities=new Map,this.additionals=new Map,this.estimatedEncodingLength=0,this.lastCalculatedLength=0,this.lengthDirty=!0,this.id=e.id||0,this.legacyUnicastEncoding=e.legacyUnicast||!1,this.type=e.type,this.opcode=e.opcode||0,this.flags=e.flags||{},this.rcode=e.rCode||0,1===this.type&&(this.flags.authoritativeAnswer=!0),e.questions&&this.addQuestions(...e.questions),e.answers&&this.addAnswers(...e.answers),e.authorities&&this.addAuthorities(...e.authorities),e.additionals&&this.addAdditionals(...e.additionals)}static createDNSQueryPacket(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=this.createDNSQueryPackets(e,t);return(0,i.default)(1===r.length,"Cannot user short method createDNSQueryPacket when query packets are more than one: is "+r.length),r[0]}static createDNSQueryPackets(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=[],n=new d({type:0,questions:e.questions,additionals:h(e)?e.additionals:void 0});if(r.push(n),n.getEstimatedEncodingLength()>t){const e=n.getEncodingLength();e>t&&i.default.fail("Cannot send query where already the query section is exceeding the udpPayloadSize ("+e+">"+t+")!")}if(h(e)&&e.answers){let i=n,s=0;const o=e.answers.concat([]);for(o.sort(((e,t)=>e.getEncodingLength(a.NonCompressionLabelCoder.INSTANCE)-t.getEncodingLength(a.NonCompressionLabelCoder.INSTANCE)));s<o.length;){for(;s<o.length;s++){const e=o[s],r=e.getEncodingLength(a.NonCompressionLabelCoder.INSTANCE);if(n.getEstimatedEncodingLength()+r<=t)i.addAnswers(e);else{if(!(n.getEncodingLength()+r<=t)){0===i.questions.size&&0===i.answers.size&&n.addAnswers(e);break}i.addAnswers(e)}}s<o.length&&(i.flags.truncation=!0,i=new d({type:0}),r.push(i))}}else if("authorities"in e&&e.authorities){n.addAuthorities(...e.authorities);const r=n.getEncodingLength();r>t&&i.default.fail(`Probe query packet exceeds the mtu size (${r}>${t}). Can't split probe queries at the moment!`)}return r}static createDNSResponsePacketsFromRRSet(e,t=this.UDP_PAYLOAD_SIZE_IPV4){const r=new d({id:e.id,legacyUnicast:e.legacyUnicast,type:1,flags:{authoritativeAnswer:!0},questions:e.questions,answers:e.answers,additionals:e.additionals});return r.getEncodingLength()>t&&i.default.fail("Couldn't construct a dns response packet from a rr set which fits in an udp payload sized packet!"),r}canBeCombinedWith(e,t=d.UDP_PAYLOAD_SIZE_IPV4){return this.id===e.id&&this.type===e.type&&this.opcode===e.opcode&&(0,s.default)(this.flags,e.flags)&&this.rcode===e.rcode&&this.getEncodingLength()+e.getEncodingLength()<=t}combineWith(e){this.setLegacyUnicastEncoding(this.legacyUnicastEncoding||e.legacyUnicastEncoding),this.addRecords(this.questions,e.questions.values()),this.addRecords(this.answers,e.answers.values(),this.additionals),this.addRecords(this.authorities,e.authorities.values()),this.addRecords(this.additionals,e.additionals.values())}addQuestions(...e){return this.addRecords(this.questions,e)}addAnswers(...e){return this.addRecords(this.answers,e,this.additionals)}addAuthorities(...e){return this.addRecords(this.authorities,e)}addAdditionals(...e){return this.addRecords(this.additionals,e)}addRecords(e,t,r){let n=!1;for(const i of t)e.has(i.asString())||(this.estimatedEncodingLength&&(this.estimatedEncodingLength+=i.getEncodingLength(a.NonCompressionLabelCoder.INSTANCE)),e.set(i.asString(),i),n=!0,this.lengthDirty=!0,r&&r.delete(i.asString()));return n}setLegacyUnicastEncoding(e){this.legacyUnicastEncoding!==e&&(this.lengthDirty=!0),this.legacyUnicastEncoding=e}legacyUnicastEncodingEnabled(){return this.legacyUnicastEncoding}getEstimatedEncodingLength(){if(this.estimatedEncodingLength)return this.estimatedEncodingLength;const e=a.NonCompressionLabelCoder.INSTANCE;let t=d.DNS_PACKET_HEADER_SIZE;for(const r of this.questions.values())t+=r.getEncodingLength(e);for(const r of this.answers.values())t+=r.getEncodingLength(e);for(const r of this.authorities.values())t+=r.getEncodingLength(e);for(const r of this.additionals.values())t+=r.getEncodingLength(e);return this.estimatedEncodingLength=t,t}getEncodingLength(e){if(!this.lengthDirty)return this.lastCalculatedLength;const t=e||new a.DNSLabelCoder(this.legacyUnicastEncoding);let r=d.DNS_PACKET_HEADER_SIZE;for(const e of this.questions.values())r+=e.getEncodingLength(t);for(const e of this.answers.values())r+=e.getEncodingLength(t);for(const e of this.authorities.values())r+=e.getEncodingLength(t);for(const e of this.additionals.values())r+=e.getEncodingLength(t);return this.lengthDirty=!1,this.lastCalculatedLength=r,this.estimatedEncodingLength=r,r}encode(){const e=new a.DNSLabelCoder(this.legacyUnicastEncoding),t=this.getEncodingLength(e),r=Buffer.allocUnsafe(t);e.initBuf(r);let n=0;r.writeUInt16BE(this.id,n),n+=2;let s=this.type<<15|this.opcode<<11|this.rcode;this.flags.authoritativeAnswer&&(s|=d.AUTHORITATIVE_ANSWER_MASK),this.flags.truncation&&(s|=d.TRUNCATION_MASK),this.flags.recursionDesired&&(s|=d.RECURSION_DESIRED_MASK),this.flags.recursionAvailable&&(s|=d.RECURSION_AVAILABLE_MASK),this.flags.zero&&(s|=d.ZERO_HEADER_MASK),this.flags.authenticData&&(s|=d.AUTHENTIC_DATA_MASK),this.flags.checkingDisabled&&(s|=d.CHECKING_DISABLED_MASK),r.writeUInt16BE(s,n),n+=2,r.writeUInt16BE(this.questions.size,n),n+=2,r.writeUInt16BE(this.answers.size,n),n+=2,r.writeUInt16BE(this.authorities.size,n),n+=2,r.writeUInt16BE(this.additionals.size,n),n+=2;for(const t of this.questions.values()){n+=t.encode(e,r,n)}for(const t of this.answers.values()){n+=t.encode(e,r,n)}for(const t of this.authorities.values()){n+=t.encode(e,r,n)}for(const t of this.additionals.values()){n+=t.encode(e,r,n)}return(0,i.default)(n===r.length,"Bytes written didn't match the buffer size!"),r}static decode(e,t,r=0){const n=new a.DNSLabelCoder;n.initBuf(t);const s=t.readUInt16BE(r);r+=2;const o=t.readUInt16BE(r);r+=2;const h=t.readUInt16BE(r);r+=2;const l=t.readUInt16BE(r);r+=2;const f=t.readUInt16BE(r);r+=2;const p=t.readUInt16BE(r);r+=2;const y=[],m=[],g=[],v=[];r+=d.decodeList(e,n,t,r,h,c.Question.decode.bind(c.Question),y),r+=d.decodeList(e,n,t,r,l,u.ResourceRecord.decode.bind(u.ResourceRecord),m),r+=d.decodeList(e,n,t,r,f,u.ResourceRecord.decode.bind(u.ResourceRecord),g),r+=d.decodeList(e,n,t,r,p,u.ResourceRecord.decode.bind(u.ResourceRecord),v),(0,i.default)(r===t.length,"Didn't read the full buffer (offset="+r+", length="+t.length+")");const b=o>>15,E=o>>11&15,S=15&o,A={};return o&this.AUTHORITATIVE_ANSWER_MASK&&(A.authoritativeAnswer=!0),o&this.TRUNCATION_MASK&&(A.truncation=!0),o&this.RECURSION_DESIRED_MASK&&(A.recursionDesired=!0),o&this.RECURSION_AVAILABLE_MASK&&(A.recursionAvailable=!0),o&this.ZERO_HEADER_MASK&&(A.zero=!0),o&this.AUTHENTIC_DATA_MASK&&(A.authenticData=!0),o&this.CHECKING_DISABLED_MASK&&(A.checkingDisabled=!0),new d({id:s,type:b,opcode:E,rCode:S,flags:A,questions:y,answers:m,authorities:g,additionals:v})}static decodeList(e,t,r,n,i,s,o){const a=n;for(let a=0;a<i;a++){const i=s(e,t,r,n);n+=i.readBytes,i.data&&o.push(i.data)}return n-a}asLoggingString(e){let t="",r="";for(const e of this.answers.values())t&&(t+=","),t+=(0,o.dnsTypeToString)(e.type);for(const e of this.additionals.values())r&&(r+=","),r+=(0,o.dnsTypeToString)(e.type);const n=[];this.legacyUnicastEncodingEnabled()&&n.push("U"),e&&n.push("UPS: "+e);const i=0!==n.length?` (${n})`:"";return`[${t}] answers and [${r}] additionals with size ${this.getEncodingLength()}B${i}`}}t.DNSPacket=d,d.UDP_PAYLOAD_SIZE_IPV4=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440,d.UDP_PAYLOAD_SIZE_IPV6=process.env.CIAO_UPS?parseInt(process.env.CIAO_UPS):1440,d.AUTHORITATIVE_ANSWER_MASK=1024,d.TRUNCATION_MASK=512,d.RECURSION_DESIRED_MASK=256,d.RECURSION_AVAILABLE_MASK=128,d.ZERO_HEADER_MASK=64,d.AUTHENTIC_DATA_MASK=32,d.CHECKING_DISABLED_MASK=16,d.DNS_PACKET_HEADER_SIZE=12},4961:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Question=void 0;const n=r(5007);class i{constructor(e,t,r=!1,n=1){this.unicastResponseFlag=!1,e.endsWith(".")||(e+="."),this.name=e,this.type=t,this.class=n,this.unicastResponseFlag=r}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,n.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+4}encode(e,t,r){const n=r;r+=e.encodeName(this.name,r),t.writeUInt16BE(this.type,r),r+=2;let s=this.class;return this.unicastResponseFlag&&(s|=i.QU_MASK),t.writeUInt16BE(s,r),(r+=2)-n}clone(){return new i(this.name,this.type,this.unicastResponseFlag,this.class)}asString(){return`Q ${this.name} ${this.type} ${this.class}`}static decode(e,t,r,n){const s=n,o=t.decodeName(n);n+=o.readBytes;const a=r.readUInt16BE(n);n+=2;const c=r.readUInt16BE(n);n+=2;const u=c&this.NOT_QU_MASK,h=!!(c&this.QU_MASK);return{data:new i(o.data,a,h,u),readBytes:n-s}}}t.Question=i,i.QU_MASK=32768,i.NOT_QU_MASK=32767},7632:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResourceRecord=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(2790)),o=r(5007),a=r(5215),c=r(9556),u=(0,s.default)("ciao:decoder");class h{constructor(e,t,r=h.RR_DEFAULT_TTL,n=!1,i=1){this.flushFlag=!1,"string"==typeof e?(e.endsWith(".")||(e+="."),this.name=e,this.type=t,this.class=i,this.ttl=r,this.flushFlag=n):(this.name=e.name,this.type=e.type,this.class=e.class,this.ttl=e.ttl,this.flushFlag=e.flushFlag)}getLowerCasedName(){return this.lowerCasedName||(this.lowerCasedName=(0,o.dnsLowerCase)(this.name))}getEncodingLength(e){return e.getNameLength(this.name)+10+this.getRDataEncodingLength(e)}encode(e,t,r){const n=r;r+=e.encodeName(this.name,r),t.writeUInt16BE(this.type,r),r+=2;let i=this.class;this.flushFlag&&(i|=h.FLUSH_MASK),t.writeUInt16BE(i,r),r+=2,t.writeUInt32BE(this.ttl,r),r+=4;const s=this.encodeRData(e,t,r+2);return t.writeUInt16BE(s,r),(r+=2+s)-n}getRawData(){const e=c.NonCompressionLabelCoder.INSTANCE,t=this.getRDataEncodingLength(e),r=Buffer.allocUnsafe(t);e.initBuf(r);const n=this.encodeRData(e,r,0);return(0,i.default)(n===r.length,"Didn't completely write to the buffer! ("+n+"!="+r.length+")"),e.initBuf(),r}static clone(e){return e.map((e=>e.clone()))}getRecordRepresentation(){return{name:this.name,type:this.type,class:this.class,ttl:this.ttl,flushFlag:this.flushFlag}}aboutEqual(e){return this.type===e.type&&this.name===e.name&&this.class===e.class&&this.dataEquals(e)}representsSameData(e){return this.type===e.type&&this.name===e.name&&this.class===e.class}asString(){return`RR ${this.name} ${this.type} ${this.class} ${this.dataAsString()}`}static decode(e,t,r,n){const i=n,s=this.decodeRecordHeader(t,r,n);n+=s.readBytes;const o=s.data,c=this.typeToRecordDecoder.get(o.type);if(!c)return{readBytes:n+o.rDataLength-i};t.initRRLocation(i,n,o.rDataLength);const h=r.slice(0,n+o.rDataLength);let d;try{d=c(t,o,h,n)}catch(t){return u(`Received malformed rdata section for ${(0,a.dnsTypeToString)(o.type)} ${o.name} ${o.ttl} from ${e.address}:${e.port} with data '${h.slice(n).toString("hex")}': ${t.stack}`),{readBytes:n+o.rDataLength-i}}return n+=d.readBytes,t.clearRRLocation(),{data:d.data,readBytes:n-i}}static decodeRecordHeader(e,t,r){const n=r,i=e.decodeName(r);r+=i.readBytes;const s=t.readUInt16BE(r);r+=2;const o=t.readUInt16BE(r);let a;r+=2;let c=!1;41!==s?(a=o&this.NOT_FLUSH_MASK,c=!!(o&this.FLUSH_MASK)):a=o;const u=t.readUInt32BE(r);r+=4;const h=t.readUInt16BE(r);r+=2;return{data:{name:i.data,type:s,class:a,ttl:u,flushFlag:c,rDataLength:h},readBytes:r-n}}}t.ResourceRecord=h,h.typeToRecordDecoder=new Map,h.FLUSH_MASK=32768,h.NOT_FLUSH_MASK=32767,h.RR_DEFAULT_TTL_SHORT=120,h.RR_DEFAULT_TTL=4500},5215:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dnsTypeToString=void 0,t.dnsTypeToString=function(e){switch(e){case 1:return"A";case 5:return"CNAME";case 12:return"PTR";case 16:return"TXT";case 28:return"AAAA";case 33:return"SRV";case 41:return"OPT";case 47:return"NSEC";case 255:return"ANY"}return"UNSUPPORTED_"+e}},3013:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AAAARecord=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(1808)),o=r(6425),a=r(7632);class c extends a.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,28,n||c.RR_DEFAULT_TTL_SHORT,r):((0,i.default)(28===e.type),super(e)),(0,i.default)(s.default.isIPv6(t),"IP address is not in v6 format!"),this.ipAddress=t}getRDataEncodingLength(){return 16}encodeRData(e,t,r){const n=r,s=(0,o.enlargeIPv6)(this.ipAddress).split(":");(0,i.default)(8===s.length,"invalid ip address");for(const e of s){const n=parseInt(e,16);t.writeUInt16BE(n,r),r+=2}return r-n}static decodeData(e,t,r,n){const i=n,s=new Array(8);for(let e=0;e<8;e++){const t=r.readUInt16BE(n);n+=2,s[e]=t.toString(16)}const a=(0,o.shortenIPv6)(s.join(":"));return{data:new c(t,a),readBytes:n-i}}clone(){return new c(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.AAAARecord=c,c.DEFAULT_TTL=120},5742:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ARecord=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(1808)),o=r(7632);class a extends o.ResourceRecord{constructor(e,t,r,n){"string"==typeof e?super(e,1,n||a.RR_DEFAULT_TTL_SHORT,r):((0,i.default)(1===e.type),super(e)),(0,i.default)(s.default.isIPv4(t),"IP address is not in v4 format!"),this.ipAddress=t}getRDataEncodingLength(){return 4}encodeRData(e,t,r){const n=r,s=this.ipAddress.split(".");(0,i.default)(4===s.length,"invalid ip address");for(const e of s){const n=parseInt(e,10);t.writeUInt8(n,r++)}return r-n}static decodeData(e,t,r,n){const i=n,s=new Array(4);for(let e=0;e<4;e++){const t=r.readUInt8(n++);s[e]=t.toString(10)}const o=s.join(".");return{data:new a(t,o),readBytes:n-i}}clone(){return new a(this.getRecordRepresentation(),this.ipAddress)}dataAsString(){return this.ipAddress}dataEquals(e){return this.ipAddress===e.ipAddress}}t.ARecord=a,a.DEFAULT_TTL=120},2092:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CNAMERecord=void 0;const n=(0,r(5827).__importDefault)(r(9491)),i=r(5007),s=r(7632);class o extends s.ResourceRecord{constructor(e,t,r,i){"string"==typeof e?super(e,5,i,r):((0,n.default)(5===e.type),super(e)),t.endsWith(".")||(t+="."),this.cname=t}getLowerCasedCName(){return this.lowerCasedCName||(this.lowerCasedCName=(0,i.dnsLowerCase)(this.cname))}getRDataEncodingLength(e){return e.getNameLength(this.cname)}encodeRData(e,t,r){const n=r;return(r+=e.encodeName(this.cname,r))-n}static decodeData(e,t,r,n){const i=n,s=e.decodeName(n);return n+=s.readBytes,{data:new o(t,s.data),readBytes:n-i}}clone(){return new o(this.getRecordRepresentation(),this.cname)}dataAsString(){return this.cname}dataEquals(e){return this.getLowerCasedCName()===e.getLowerCasedCName()}}t.CNAMERecord=o,o.DEFAULT_TTL=s.ResourceRecord.RR_DEFAULT_TTL},4583:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NSECRecord=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(5011)),o=r(5007),a=r(7632);class c extends a.ResourceRecord{constructor(e,t,r,n,s){"string"==typeof e?super(e,47,n||c.RR_DEFAULT_TTL_SHORT,s):((0,i.default)(47===e.type),super(e)),t.endsWith(".")||(t+="."),this.nextDomainName=t,this.rrTypeWindows=c.rrTypesToWindowMap(r)}getLowerCasedNextDomainName(){return this.lowerCasedNextDomainName||(this.lowerCasedNextDomainName=(0,o.dnsLowerCase)(this.nextDomainName))}getRRTypesBitMapEncodingLength(){let e=0;for(const t of this.rrTypeWindows)(0,i.default)(t.rrtypes.length>0,"types array for windowId "+t.windowId+" cannot be empty!"),e+=2+t.bitMapSize;return e}getRDataEncodingLength(e){return e.legacyUnicastEncoding,e.getUncompressedNameLength(this.nextDomainName)+this.getRRTypesBitMapEncodingLength()}encodeRData(e,t,r){const n=r;r+=(e.legacyUnicastEncoding,e.encodeUncompressedName(this.nextDomainName,r));for(const e of this.rrTypeWindows){t.writeUInt8(e.windowId,r++),t.writeUInt8(e.bitMapSize,r++);const n=Buffer.alloc(e.bitMapSize);for(const t of e.rrtypes){const e=(255&t)>>3;let r=n.readUInt8(e);r|=1<<7-(7&t),n.writeUInt8(r,e)}n.copy(t,r),r+=n.length}return r-n}static decodeData(e,t,r,n){const i=n,s=e.decodeName(n,!1);n+=s.readBytes;const o=[];for(;n<r.length;){const e=r.readUInt8(n++),t=r.readUInt8(n++),i=e<<8;for(let e=0;e<t;e++){const t=r.readUInt8(n++);for(let r=0;r<8;r++)if(t&1<<7-r){const t=i|e<<3|r;o.push(t)}}}return{data:new c(t,s.data,o),readBytes:n-i}}clone(){return new c(this.getRecordRepresentation(),this.nextDomainName,c.windowsToRRTypes(this.rrTypeWindows))}dataAsString(){return`${this.nextDomainName} [${c.windowsToRRTypes(this.rrTypeWindows).map((e=>""+e)).join(",")}]`}dataEquals(e){return this.getLowerCasedNextDomainName()===e.getLowerCasedNextDomainName()&&(0,s.default)(this.rrTypeWindows,e.rrTypeWindows)}static rrTypesToWindowMap(e){const t=[];for(const r of e){const e=r>>8;let n;for(const r of t)if(r.windowId===e){n=r;break}if(n){n.rrtypes.push(r);const e=Math.ceil((255&r)/8);e>n.bitMapSize&&(n.bitMapSize=e)}else n={windowId:e,bitMapSize:Math.ceil((255&r)/8),rrtypes:[r]},t.push(n)}return t.sort(((e,t)=>e.windowId-t.windowId)),t.forEach((e=>e.rrtypes.sort(((e,t)=>e-t)))),t}static windowsToRRTypes(e){const t=[];for(const r of e)t.push(...r.rrtypes);return t}}t.NSECRecord=c},7954:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OPTRecord=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(5011)),o=r(7632);class a extends o.ResourceRecord{constructor(e,t,r,n,s,o){"number"==typeof e?(super(".",41,o,!1,e),this.udpPayloadSize=e):((0,i.default)(41===e.type),super(e),this.udpPayloadSize=e.class),this.extendedRCode=r||0,this.ednsVersion=s||a.EDNS_VERSION,this.flags={dnsSecOK:(null==n?void 0:n.dnsSecOK)||!1,zero:(null==n?void 0:n.zero)||0,...n},this.options=t||[]}getRDataEncodingLength(){let e=0;for(const t of this.options)e+=4+t.data.length;return e}encodeRData(e,t,r){const n=r,i=r-8,s=r-6;t.writeUInt16BE(this.udpPayloadSize,i),t.writeUInt8(this.extendedRCode,s),t.writeUInt8(this.ednsVersion,s+1);let o=this.flags.zero||0;this.flags.dnsSecOK&&(o|=a.DNS_SEC_OK_MASK),t.writeUInt16BE(o,s+2);for(const e of this.options)t.writeUInt16BE(e.code,r),r+=2,t.writeUInt16BE(e.data.length,r),r+=2,e.data.copy(t,r),r+=e.data.length;return r-n}static decodeData(e,t,r,n){const i=n,s=n-8,o=n-6,c=r.readUInt16BE(s),u=r.readUInt8(o),h=r.readUInt8(o+1),d=r.readUInt16BE(o+2),l={dnsSecOK:!!(d&a.DNS_SEC_OK_MASK),zero:d&a.NOT_DNS_SEC_OK_MASK},f=[];for(;n<r.length;){const e=r.readUInt16BE(n);n+=2;const t=r.readUInt16BE(n);n+=2;const i=r.slice(n,n+t);n+=t,f.push({code:e,data:i})}return t.class=c,t.ttl=4500,{data:new a(t,f,u,l,h),readBytes:n-i}}clone(){return new a(this.getRecordRepresentation(),this.options,this.extendedRCode,this.flags,this.ednsVersion)}dataAsString(){return`${this.udpPayloadSize} ${this.extendedRCode} ${this.ednsVersion} ${JSON.stringify(this.flags)} [${this.options.map((e=>`${e.code} ${e.data.toString("base64")}`)).join(",")}]`}dataEquals(e){return this.udpPayloadSize===e.udpPayloadSize&&this.extendedRCode===e.extendedRCode&&this.ednsVersion===e.ednsVersion&&a.optionsEquality(this.options,e.options)&&(0,s.default)(this.flags,e.flags)}static optionsEquality(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){if(e[r].code!==t[r].code)return!1;if(e[r].data.toString("hex")!==t[r].data.toString("hex"))return!1}return!0}}t.OPTRecord=a,a.EDNS_VERSION=0,a.DNS_SEC_OK_MASK=32768,a.NOT_DNS_SEC_OK_MASK=32767},3491:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PTRRecord=void 0;const n=(0,r(5827).__importDefault)(r(9491)),i=r(5007),s=r(7632);class o extends s.ResourceRecord{constructor(e,t,r,i){"string"==typeof e?super(e,12,i,r):((0,n.default)(12===e.type),super(e)),t.endsWith(".")||(t+="."),this.ptrName=t}getLowerCasedPTRName(){return this.lowerCasedPtrName||(this.lowerCasedPtrName=(0,i.dnsLowerCase)(this.ptrName))}getRDataEncodingLength(e){return e.getNameLength(this.ptrName)}encodeRData(e,t,r){const n=r;return(r+=e.encodeName(this.ptrName,r))-n}static decodeData(e,t,r,n){const i=n,s=e.decodeName(n);return n+=s.readBytes,{data:new o(t,s.data),readBytes:n-i}}clone(){return new o(this.getRecordRepresentation(),this.ptrName)}dataAsString(){return this.ptrName}dataEquals(e){return this.getLowerCasedPTRName()===e.getLowerCasedPTRName()}}t.PTRRecord=o,o.DEFAULT_TTL=s.ResourceRecord.RR_DEFAULT_TTL},1723:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SRVRecord=void 0;const n=(0,r(5827).__importDefault)(r(9491)),i=r(5007),s=r(7632);class o extends s.ResourceRecord{constructor(e,t,r,i,s){"string"==typeof e?super(e,33,s||o.RR_DEFAULT_TTL_SHORT,i):((0,n.default)(33===e.type),super(e)),t.endsWith(".")?this.hostname=t:this.hostname=t+".",this.port=r,this.priority=0,this.weight=0}getLowerCasedHostname(){return this.lowerCasedHostname||(this.lowerCasedHostname=(0,i.dnsLowerCase)(this.hostname))}getRDataEncodingLength(e){return 6+(e.legacyUnicastEncoding?e.getUncompressedNameLength(this.hostname):e.getNameLength(this.hostname))}encodeRData(e,t,r){const n=r;t.writeUInt16BE(this.priority,r),r+=2,t.writeUInt16BE(this.weight,r),r+=2,t.writeUInt16BE(this.port,r),r+=2;return(r+=e.legacyUnicastEncoding?e.encodeUncompressedName(this.hostname,r):e.encodeName(this.hostname,r))-n}static decodeData(e,t,r,n){const i=n;n+=2,n+=2;const s=r.readUInt16BE(n);n+=2;const a=e.decodeName(n);return n+=a.readBytes,{data:new o(t,a.data,s),readBytes:n-i}}clone(){return new o(this.getRecordRepresentation(),this.hostname,this.port)}dataAsString(){return`${this.hostname} ${this.port} ${this.priority} ${this.weight}`}dataEquals(e){return this.getLowerCasedHostname()===e.getLowerCasedHostname()&&this.port===e.port&&this.weight===e.weight&&this.priority===e.priority}}t.SRVRecord=o,o.DEFAULT_TTL=120},8730:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TXTRecord=void 0;const n=(0,r(5827).__importDefault)(r(9491)),i=r(7632);class s extends i.ResourceRecord{constructor(e,t,r,i){"string"==typeof e?super(e,16,i,r):((0,n.default)(16===e.type),super(e)),this.txt=t}getRDataEncodingLength(){let e=0;for(const t of this.txt)e+=1+t.length,(0,n.default)(t.length<=255,"One txt character-string can only have a length of 255 chars");return e}encodeRData(e,t,r){const n=r;for(const e of this.txt)t.writeUInt8(e.length,r++),e.copy(t,r),r+=e.length;return r-n}clone(){return new s(this.getRecordRepresentation(),this.txt)}dataAsString(){return`[${this.txt.map((e=>`${e.toString("base64")}`)).join(",")}]`}dataEquals(e){if(this.txt.length!==e.txt.length)return!1;for(let t=0;t<this.txt.length;t++)if(this.txt[t].toString("hex")!==e.txt[t].toString("hex"))return!1;return!0}static decodeData(e,t,r,n){const i=n,o=[];for(;n<r.length;){const e=r.readUInt8(n++);o.push(r.slice(n,n+e)),n+=e}return{data:new s(t,o),readBytes:n-i}}}t.TXTRecord=s,s.DEFAULT_TTL=i.ResourceRecord.RR_DEFAULT_TTL},8167:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(7632),i=r(3013),s=r(5742),o=r(2092),a=r(4583),c=r(7954),u=r(3491),h=r(1723),d=r(8730);n.ResourceRecord.typeToRecordDecoder.set(28,i.AAAARecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(1,s.ARecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(5,o.CNAMERecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(47,a.NSECRecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(12,u.PTRRecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(33,h.SRVRecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(41,c.OPTRecord.decodeData),n.ResourceRecord.typeToRecordDecoder.set(16,d.TXTRecord.decodeData)},5816:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getResponder=t.Protocol=void 0;const n=r(5827);r(1629);const i=(0,n.__importDefault)(r(2790)),s=r(9518).i8;if(s.includes("beta")||process.env.BCT){const e=process.env.DEBUG;e&&e.includes("ciao")||(e?i.default.enable(e+",ciao:*"):i.default.enable("ciao:*"))}r(8167);const o=r(2842);function a(e){return o.Responder.getResponder(e)}(0,n.__exportStar)(r(1562),t),(0,n.__exportStar)(r(2842),t),(0,i.default)("ciao:init")("Loading ciao v"+s+"..."),function(e){e.TCP="tcp",e.UDP="udp"}(t.Protocol||(t.Protocol={})),t.getResponder=a,t.default={getResponder:a}},1152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Announcer=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(2790)),o=r(6670),a=r(706),c=r(9971),u=(0,s.default)("ciao:Announcer");class h{constructor(e,t,r){this.repetitions=1,this.announceIntervalIncreaseFactor=2,this.goodbye=!1,this.sentAnnouncements=0,this.sentLastAnnouncement=!1,this.nextInterval=1e3,this.nextAnnouncementTime=0,(0,i.default)(e,"server must be defined"),(0,i.default)(t,"service must be defined"),this.server=e,this.service=t,r&&(void 0!==r.repetitions&&(this.repetitions=r.repetitions),r.goodbye&&(this.goodbye=!0)),(0,i.default)(this.repetitions>0&&this.repetitions<=8,"repetitions must in [1;8]")}announce(){return u("[%s] Sending %s for service",this.service.getFQDN(),this.goodbye?"goodbye":"announcement"),this.goodbye||this.service.rebuildServiceRecords(),this.promise=new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.timer=setTimeout(this.sendAnnouncement.bind(this),0),this.timer.unref(),this.nextAnnouncementTime=(new Date).getTime()}))}async cancel(){return u("[%s] Canceling %s",this.service.getFQDN(),this.goodbye?"goodbye":"announcement"),this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.promiseReject(h.CANCEL_REASON),this.awaitAnnouncement().catch((e=>{if(e!==h.CANCEL_REASON)return Promise.reject(e)}))}hasSentLastAnnouncement(){return this.sentLastAnnouncement}async awaitAnnouncement(){await this.promise}isSendingGoodbye(){return this.goodbye}sendAnnouncement(){u("[%s] Sending %s number %d",this.service.getFQDN(),this.goodbye?"goodbye":"announcement",this.sentAnnouncements+1);const e=[this.service.ptrRecord(),...this.service.subtypePtrRecords(),this.service.srvRecord(),this.service.txtRecord()];if(this.goodbye)for(const t of e)t.ttl=0;else e.push(this.service.metaQueryPtrRecord());this.sentAnnouncements+1>=this.repetitions&&(this.sentLastAnnouncement=!0),h.sendResponseAddingAddressRecords(this.server,this.service,e,this.goodbye).then((e=>{const t=(0,a.SendResultFailedRatio)(e);if(1===t)return console.error((0,a.SendResultFormatError)(e,`[${this.service.getFQDN()}] Failed to send ${this.goodbye?"goodbye":"announcement"} requests`),!0),void this.promiseReject(new Error((this.goodbye?"Goodbye":"Announcement")+" failed as of socket errors!"));t>0&&u((0,a.SendResultFormatError)(e,`Some of the ${this.goodbye?"goodbye":"announcement"} requests for '${this.service.getFQDN()}' encountered an error`)),"announcing"===this.service.serviceState?(this.sentAnnouncements++,this.sentAnnouncements>=this.repetitions?this.promiseResolve():(this.timer=setTimeout(this.sendAnnouncement.bind(this),this.nextInterval),this.timer.unref(),this.nextAnnouncementTime=(new Date).getTime()+this.nextInterval,this.nextInterval*=this.announceIntervalIncreaseFactor)):u("[%s] Service is no longer in announcing state. Stopping. (Received %s)",this.service.getFQDN(),this.service.serviceState)}))}static sendResponseAddingAddressRecords(e,t,r,n){const i=[];for(const s of e.getBoundInterfaceNames()){if(!t.advertisesOnInterface(s))continue;const u=r.concat([]),h=t.aRecord(s),d=t.aaaaRecord(s),l=t.aaaaRoutableRecord(s),f=t.aaaaUniqueLocalRecord(s),p=t.addressNSECRecord(),y=t.serviceNSECRecord();h&&(n&&(h.ttl=0),u.push(h)),d&&(n&&(d.ttl=0),u.push(d)),l&&(n&&(l.ttl=0),u.push(l)),f&&(n&&(f.ttl=0),u.push(f)),n&&(p.ttl=0,y.ttl=0);const m=[];m.push(p,y);const g=o.DNSPacket.createDNSResponsePacketsFromRRSet({answers:u,additionals:m});i.push(Promise.race([e.send(g,s),(0,c.PromiseTimeout)(a.MDNSServer.SEND_TIMEOUT).then((()=>({status:"timeout",interface:s})))]))}return Promise.all(i)}}t.Announcer=h,h.CANCEL_REASON="CIAO ANNOUNCEMENT CANCELLED"},8859:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Prober=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(2790)),o=r(4961),a=r(706),c=(0,n.__importStar)(r(4793)),u=r(4793),h=(0,s.default)("ciao:Prober");class d{constructor(e,t,r){this.records=[],this.currentInterval=250,this.serviceEncounteredNameChange=!1,this.sentFirstProbeQuery=!1,this.sentQueriesForCurrentTry=0,this.sentQueries=0,(0,i.default)(e,"responder must be defined"),(0,i.default)(t,"server must be defined"),(0,i.default)(r,"service must be defined"),this.responder=e,this.server=t,this.service=r}getService(){return this.service}probe(){return h("Starting to probe for '%s'...",this.service.getFQDN()),new Promise(((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.timer=setTimeout(this.sendProbeRequest.bind(this),250*Math.random()),this.timer.unref()}))}cancel(){this.clear(),this.promiseReject(d.CANCEL_REASON)}clear(){this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.sentFirstProbeQuery=!1,this.sentQueriesForCurrentTry=0}endProbing(e){this.clear(),e&&(h("Probing for '%s' finished successfully",this.service.getFQDN()),this.promiseResolve(),this.serviceEncounteredNameChange&&this.service.informAboutNameUpdates())}sendProbeRequest(){if(0===this.sentQueriesForCurrentTry&&(this.records=[this.service.srvRecord(),this.service.txtRecord(),this.service.ptrRecord(),...this.service.subtypePtrRecords(),...this.service.allAddressRecords()].sort(u.rrComparator),this.records.forEach((e=>e.flushFlag=!1))),this.sentQueriesForCurrentTry>=3)return void this.endProbing(!0);this.sentQueries>=15&&(this.currentInterval=1e3),h("Sending prober query number %d for '%s'...",this.sentQueriesForCurrentTry+1,this.service.getFQDN()),(0,i.default)(this.records.length>0,"Tried sending probing request for zero record length!");const e=[new o.Question(this.service.getFQDN(),255,!0),new o.Question(this.service.getHostname(),255,!0)];this.server.sendQueryBroadcast({questions:e,authorities:this.records},this.service).then((e=>{const t=(0,a.SendResultFailedRatio)(e);if(1===t)return console.error((0,a.SendResultFormatError)(e,`Failed to send probe queries for '${this.service.getFQDN()}'`),!0),this.endProbing(!1),void this.promiseReject(new Error("Probing failed as of socket errors!"));t>0&&h((0,a.SendResultFormatError)(e,`Some of the probe queries for '${this.service.getFQDN()}' encountered an error`)),"probing"===this.service.serviceState?(this.sentFirstProbeQuery=!0,this.sentQueriesForCurrentTry++,this.sentQueries++,this.timer=setTimeout(this.sendProbeRequest.bind(this),this.currentInterval),this.timer.unref(),this.checkLocalConflicts()):h("Service '%s' is no longer in probing state. Stopping.",this.service.getFQDN())}))}checkLocalConflicts(){let e=!1;for(const t of this.responder.getAnnouncedServices())if(t.getLowerCasedFQDN()===this.service.getLowerCasedFQDN()||t.getLowerCasedHostname()===this.service.getLowerCasedHostname()){e=!0;break}e&&(h("Probing for '%s' failed as of local service. Doing a name change",this.service.getFQDN()),this.handleNameChange())}handleResponse(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface))return;let r=!1;for(const t of e.answers.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}for(const t of e.additionals.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}r&&(h("Probing for '%s' failed. Doing a name change",this.service.getFQDN()),this.handleNameChange())}handleNameChange(){this.endProbing(!1),this.service.serviceState="unannounced",this.service.incrementName(),this.service.serviceState="probing",this.serviceEncounteredNameChange=!0,this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3),this.timer.unref()}handleQuery(e,t){if(!this.sentFirstProbeQuery||!this.service.advertisesOnInterface(t.interface))return;let r=!1;for(const t of e.questions.values())if(t.getLowerCasedName()===this.service.getLowerCasedFQDN()||t.getLowerCasedName()===this.service.getLowerCasedHostname()){r=!0;break}r&&this.doTiebreaking(e)}doTiebreaking(e){if(!this.sentFirstProbeQuery)return;let t=0===e.authorities.size;for(const r of e.authorities.values())if(r.getLowerCasedName()===this.service.getLowerCasedFQDN()||r.getLowerCasedName()===this.service.getLowerCasedHostname()){t=!0;break}if(!t)return;const r=this.records,n=Array.from(e.authorities.values()).sort(c.rrComparator),i=c.runTiebreaking(r,n);1===i?h("'%s' won the tiebreak. We gonna ignore the other probing request!",this.service.getFQDN()):-1===i&&(h("'%s' lost the tiebreak. We are waiting a second and try to probe again...",this.service.getFQDN()),this.endProbing(!1),this.timer=setTimeout(this.sendProbeRequest.bind(this),1e3),this.timer.unref())}}t.Prober=d,d.CANCEL_REASON="CIAO PROBING CANCELLED"},1329:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueryResponse=void 0;const n=r(6670);t.QueryResponse=class{constructor(e){this.sharedAnswer=!1,this.dnsPacket=new n.DNSPacket({type:1}),this.knownAnswers=e}asPacket(){return this.dnsPacket}asString(e){return this.dnsPacket.asLoggingString(e)}containsSharedAnswer(){return this.sharedAnswer}addAnswer(...e){let t=!1;for(const r of e){if(this.isKnownAnswer(r))continue;this.dnsPacket.addAnswers(r)&&(t=!0,r.flushFlag||(this.sharedAnswer=!0))}return t}addAdditional(...e){let t=!1;for(const r of e){if(this.isKnownAnswer(r))continue;if(this.dnsPacket.answers.has(r.asString()))continue;this.dnsPacket.addAdditionals(r)&&(t=!0)}return t}markLegacyUnicastResponse(e,t){this.dnsPacket.id=e,t&&this.dnsPacket.addQuestions(...t),this.dnsPacket.answers.forEach((e=>{e.flushFlag=!1,e.ttl=10})),this.dnsPacket.additionals.forEach((e=>{e.flushFlag=!1,e.ttl=10})),this.dnsPacket.setLegacyUnicastEncoding(!0)}markTruncated(){this.dnsPacket.flags.truncation=!0}hasAnswers(){return this.dnsPacket.answers.size>0}isKnownAnswer(e){if(!this.knownAnswers)return!1;const t=this.knownAnswers.get(e.asString());return void 0!==t&&t.ttl>e.ttl/2}static combineResponses(e,t){for(let r=0;r<e.length-1;r++){const n=e[r],i=n.dnsPacket,s=e[r+1],o=s.dnsPacket;i.canBeCombinedWith(o,t)&&(i.combineWith(o),e.splice(r+1,1),n.sharedAnswer=n.sharedAnswer||s.sharedAnswer,r--)}}}},9224:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QueuedResponse=void 0;class r{constructor(e,t){this.timeOfCreation=(new Date).getTime(),this.estimatedTimeToBeSent=0,this.delay=-1,this.packet=e,this.interfaceName=t}getPacket(){return this.packet}getTimeSinceCreation(){return(new Date).getTime()-this.timeOfCreation}getTimeTillSent(){return Math.max(0,this.estimatedTimeToBeSent-(new Date).getTime())}calculateRandomDelay(){this.delay=100*Math.random()+20,this.estimatedTimeToBeSent=(new Date).getTime()+this.delay}scheduleResponse(e){this.timer=setTimeout(e,this.delay),this.timer.unref()}delayWouldBeInTimelyManner(e){return e.estimatedTimeToBeSent-this.timeOfCreation<=r.MAX_DELAY}combineWithNextPacketIfPossible(e){return this.interfaceName===e.interfaceName&&(!!e.packet.canBeCombinedWith(this.packet)&&(e.packet.combineWith(this.packet),e.timeOfCreation=Math.min(this.timeOfCreation,e.timeOfCreation),this.timer&&(clearTimeout(this.timer),this.timer=void 0),this.delayed=!0,!0))}combineWithUniqueResponseIfPossible(e,t){return this.interfaceName===t&&(!!this.packet.canBeCombinedWith(e.asPacket())&&(this.packet.combineWith(e.asPacket()),!0))}}t.QueuedResponse=r,r.MAX_DELAY=500},2449:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TruncatedQuery=t.TruncatedQueryEvent=t.TruncatedQueryResult=void 0;const n=r(2361);!function(e){e[e.ABORT=1]="ABORT",e[e.AGAIN_TRUNCATED=2]="AGAIN_TRUNCATED",e[e.FINISHED=3]="FINISHED"}(t.TruncatedQueryResult||(t.TruncatedQueryResult={})),function(e){e.TIMEOUT="timeout"}(t.TruncatedQueryEvent||(t.TruncatedQueryEvent={}));class i extends n.EventEmitter{constructor(e){super(),this.arrivedPackets=1,this.timeOfArrival=(new Date).getTime(),this.packet=e,this.timer=this.resetTimer()}getPacket(){return this.packet}getArrivedPacketCount(){return this.arrivedPackets}getTotalWaitTime(){return(new Date).getTime()-this.timeOfArrival}appendDNSPacket(e){if(this.packet.combineWith(e),this.arrivedPackets++,e.flags.truncation){return(new Date).getTime()-this.timeOfArrival>5e3?1:(this.resetTimer(),2)}return clearTimeout(this.timer),this.removeAllListeners(),3}resetTimer(){return this.timer&&clearTimeout(this.timer),this.timer=setTimeout(this.timeout.bind(this),400+100*Math.random())}timeout(){this.emit("timeout"),this.removeAllListeners()}}t.TruncatedQuery=i},5007:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dnsLowerCase=void 0;const r=/[A-Z]/g;t.dnsLowerCase=function(e){return e.replace(r,(e=>e.toLowerCase()))}},6425:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNetAddress=t.ipAddressFromReversAddressName=t.formatReverseAddressPTRName=t.shortenIPv6=t.enlargeIPv6=t.removeTLD=t.formatHostname=t.stringify=t.parseFQDN=void 0;const n=r(5827),i=(0,n.__importDefault)(r(9491)),s=(0,n.__importDefault)(r(1808));function o(e){return e.startsWith("_")?e.slice(1):e}function a(e){(0,i.default)(s.default.isIPv6(e),"Illegal argument. Must be ipv6 address!"),(0,i.default)(!e.includes("."),"ipv4-mapped ipv6 addresses are currently unsupported!");const t=e.split(":");if(""===t[0])for(t.splice(0,1);t.length<8;)t.unshift("0000");else if(""===t[t.length-1])for(t.splice(t.length-1,1);t.length<8;)t.push("0000");else if(t.length<8){let e;for(e=0;e<t.length&&""!==t[e];e++);const r=new Array(9-t.length).fill("0000");t.splice(e,1,...r)}for(let e=0;e<t.length;e++){const r=t[e];if(r.length<4){const n=new Array(4-r.length).fill("0").join("");t.splice(e,1,n+r)}}const r=t.join(":");return(0,i.default)(t.length<=8,`Resulting ipv6 address has more than 8 sections (${r})!`),r}function c(e){"string"==typeof e&&(e=e.split(":"));for(let t=0;t<e.length;t++){const r=e[t];let n=0;for(;n<Math.min(3,r.length-1)&&"0"===r.charAt(n);n++);e[t]=r.substr(n)}let t=-1,r=0;for(let n=0;n<e.length;n++){if("0"!==e[n])continue;let i=1,s=n+1;for(;s<e.length&&"0"===e[s];s++)i++;i>r&&(t=n,r=i),n=s}if(-1!==t){const n=0===t||t+r===8;e[t]=n?":":"",r>1&&e.splice(t+1,r-1)}const n=e.join(":");return":"===n?"::":n}t.parseFQDN=function(e){const t=e.split(".");(0,i.default)(t.length>=3,"Received illegal fqdn: "+e);let r=t.length-1,n="";for(;"_tcp"!==(s=t[r])&&"_udp"!==s;)n=o(t[r])+(n?"."+n:""),r--;var s;(0,i.default)(r>=1,"Failed to parse illegal fqdn: "+e);const a=o(t[r--]),c=o(t[r--]);if(r<0)return{domain:n,protocol:a,type:c};if(function(e){return"_sub"===e}(t[r])){r--,(0,i.default)(0===r,"Received illegal formatted sub type fqdn: "+e);return{domain:n,protocol:a,type:c,subtype:o(t[r])}}return{domain:n,protocol:a,type:c,name:o(t.slice(0,r+1).join("."))}},t.stringify=function(e){let t;return(0,i.default)(e.type,"type cannot be undefined"),(0,i.default)(e.type.length<=15,"type must not be longer than 15 characters"),t=function(e){return"subtype"in e}(e)?`_${e.subtype}._sub.`:e.name?`${e.name}.`:"",`${t}_${e.type}._${e.protocol||"tcp"}.${e.domain||"local"}.`},t.formatHostname=function(e,t="local"){(0,i.default)(!e.endsWith("."),"hostname must not end with the root label!");const r="."+t;return(e.endsWith(r)?e:e+r)+"."},t.removeTLD=function(e){e.endsWith(".")&&(e=e.substring(0,e.length-1));const t=e.lastIndexOf(".");return e.slice(0,t)},t.enlargeIPv6=a,t.shortenIPv6=c,t.formatReverseAddressPTRName=function(e){if(s.default.isIPv4(e)){return e.split(".").reverse().join(".")+".in-addr.arpa"}if(s.default.isIPv6(e)){const t=(e=a(e).toUpperCase()).replace(/:/g,"").split("").reverse();return(0,i.default)(32===t.length,"Encountered invalid ipv6 address length! "+t.length),t.join(".")+".ip6.arpa"}throw new Error("Supplied illegal ip address format: "+e)},t.ipAddressFromReversAddressName=function(e){if((e=e.toLowerCase()).endsWith(".in-addr.arpa")){return e.replace(".in-addr.arpa","").split(".").reverse().join(".")}if(e.endsWith(".ip6.arpa")){const t=e.replace(".ip6.arpa","").split(".").reverse();(0,i.default)(32===t.length,"Encountered illegal length for .ip6.arpa split!");const r=[];for(let e=0;e<t.length;e+=4)r.push(t.slice(e,e+4).join(""));return c(r.join(":"))}throw new Error("Supplied unknown reverse address name format: "+e)},t.getNetAddress=function(e,t){if((0,i.default)(s.default.isIP(e)===s.default.isIP(t),"IP address version must match. Netmask cannot have a version different from the address!"),s.default.isIPv4(e)){const r=e.split("."),n=t.split("."),i=new Array(4);for(let e=0;e<r.length;e++){const t=parseInt(r[e]),s=parseInt(n[e]);i[e]=(t&s).toString()}return i.join(".")}if(s.default.isIPv6(e)){const r=a(e).split(":"),n=a(t).split(":"),i=new Array(8);for(let e=0;e<r.length;e++){const t=parseInt(r[e],16),s=parseInt(n[e],16);i[e]=(t&s).toString(16)}return c(a(i.join(":")))}throw new Error("Illegal argument. Address is not an ip address!")}},7877:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ServerClosedError=t.InterfaceNotFoundError=t.ERR_SERVER_CLOSED=t.ERR_INTERFACE_NOT_FOUND=void 0,t.ERR_INTERFACE_NOT_FOUND="ERR_INTERFACE_NOT_FOUND",t.ERR_SERVER_CLOSED="ERR_SERVER_CLOSED";class r extends Error{constructor(e){super(e),this.name="ERR_INTERFACE_NOT_FOUND"}}t.InterfaceNotFoundError=r;class n extends Error{constructor(e){super(e),this.name=t.ERR_SERVER_CLOSED}}t.ServerClosedError=n},9971:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseTimeout=void 0,t.PromiseTimeout=function(e){return new Promise((t=>{setTimeout((()=>t()),e)}))}},6025:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sortedInsert=void 0,t.sortedInsert=function(e,t,r){let n=0,i=e.length-1,s=-1;for(;n<i;){const o=Math.floor((n+i)/2),a=r(t,e[o]);if(0===a){s=o+1;break}a<0?i=o-1:n=o+1}0===e.length?s=0:s<0&&(s=r(t,e[n])>0?n+1:n),e.splice(s,0,t)}},4793:(e,t)=>{"use strict";function r(e,t){if(e.class!==t.class)return e.class-t.class;if(e.type!==t.type)return e.type-t.type;const r=e.getRawData(),n=t.getRawData(),i=Math.max(r.length,n.length);for(let e=0;e<i;e++){if(e>=r.length&&e<n.length)return-1;if(e>=n.length&&e<r.length)return 1;const t=r.readUInt8(e),i=n.readUInt8(e);if(t!==i)return t<i?-1:1}return 0}Object.defineProperty(t,"__esModule",{value:!0}),t.runTiebreaking=t.TiebreakingResult=t.rrComparator=void 0,t.rrComparator=r,function(e){e[e.OPPONENT=-1]="OPPONENT",e[e.TIE=0]="TIE",e[e.HOST=1]="HOST"}(t.TiebreakingResult||(t.TiebreakingResult={})),t.runTiebreaking=function(e,t){const n=Math.max(e.length,t.length);for(let i=0;i<n;i++){if(i>=e.length&&i<t.length)return-1;if(i>=t.length&&i<e.length)return 1;const n=r(e[i],t[i]);if(0!==n)return n}return 0}},8332:(e,t,r)=>{const n=r(2361).EventEmitter,i=r(1808),s=r(1575),o=r(8102),a=r(534),c=r(387),u=r(1628),h=r(3294);function d(e){var t=new n;e||(e={});var s=t.stream=function(e){if(e.stream)return e.stream;var t=e.host,n=e.port,s=e.socket;if(s)return i.createConnection(s);if(n)return i.createConnection(n,t);var o=e.busAddress||process.env.DBUS_SESSION_BUS_ADDRESS;if(!o)throw new Error("unknown bus address");for(var a=o.split(";"),c=0;c<a.length;++c){var u=a[c].split(":"),h=u[0],d={};u[1].split(",").map((function(e){var t=e.split("=");d[t[0]]=t[1]}));try{switch(h.toLowerCase()){case"tcp":return t=d.host||"localhost",n=d.port,i.createConnection(n,t);case"unix":if(d.socket)return i.createConnection(d.socket);if(d.abstract)return r(Object(function(){var e=new Error("Cannot find module 'abstract-socket'");throw e.code="MODULE_NOT_FOUND",e}())).connect("\0"+d.abstract);if(d.path)return i.createConnection(d.path);throw new Error("not enough parameters for 'unix' connection - you need to specify 'socket' or 'abstract' or 'path' parameter");case"unixexec":for(var l=r(9776),f=r(2081).spawn,p=[],y=1;d["arg"+y];y++)p.push(d["arg"+y]);var m=f(d.path,p);return l.duplex(m.stdin,m.stdout);default:throw new Error("unknown address type:"+h)}}catch(e){if(c<a.length-1){console.warn(e.message);continue}throw e}}}(e);return s.setNoDelay(),s.on("error",(function(e){t.emit("error",e)})),s.on("end",(function(){t.emit("end"),t.message=function(){console.warn("Didn't write bytes to closed stream")}})),t.end=function(){return s.end(),t},(e.server?c:a)(s,e,(function(r,n){if(r)return t.emit("error",r);t.guid=n,t.emit("connect"),o.unmarshalMessages(s,(function(e){t.emit("message",e)}),e)})),t._messages=[],t.message=function(e){t._messages.push(e)},t.once("connect",(function(){t.state="connected";for(var e=0;e<t._messages.length;++e)s.write(o.marshall(t._messages[e]));t._messages.length=0,t.message=function(e){s.write(o.marshall(e))}})),t}e.exports.createClient=function(e){var t=d(e||{});return new u(t,e||{})},e.exports.systemBus=function(){return e.exports.createClient({busAddress:process.env.DBUS_SYSTEM_BUS_ADDRESS||"unix:path=/var/run/dbus/system_bus_socket"})},e.exports.sessionBus=function(t){return e.exports.createClient(t)},e.exports.messageType=s.messageType,e.exports.createConnection=d,e.exports.createServer=h.createServer},9617:(e,t,r)=>{const n=r(1444).Buffer;t.A=function(e,t){var r=t-e._offset%t;if(0!==r&&r!==t){var i=n.alloc(r);e.put(n.from(i)),e._offset+=r}}},1628:(e,t,r)=>{const n=r(2361).EventEmitter,i=r(1575),s=r(4995),o=r(7287).introspectBus;e.exports=function e(t,r){if(!(this instanceof e))return new e(t);r||(r={});var a=this;function c(e,t){this.name=e,this.service=t,this.as=function(e){return this.proxy[e]}}function u(e,t){this.name=e,this.bus=t,this.getObject=function(e,t){if(void 0===e)return t(new Error("Object name is null or undefined"));var r=new c(e,this);o(r,(function(e,n,i){if(e)return t(e);r.proxy=n,r.nodes=i,t(null,r)}))},this.getInterface=function(e,t,r){this.getObject(e,(function(e,n){if(e)return r(e);r(null,n.as(t))}))}}this.connection=t,this.serial=1,this.cookies={},this.methodCallHandlers={},this.signals=new n,this.exportedObjects={},this.invoke=function(e,t){e.type||(e.type=i.messageType.methodCall),e.serial=a.serial++,this.cookies[e.serial]=t,a.connection.message(e)},this.invokeDbus=function(e,t){e.path||(e.path="/org/freedesktop/DBus"),e.destination||(e.destination="org.freedesktop.DBus"),e.interface||(e.interface="org.freedesktop.DBus"),a.invoke(e,t)},this.mangle=function(e,t,r){var n={};return"object"==typeof e?(n.path=e.path,n.interface=e.interface,n.member=e.member):(n.path=e,n.interface=t,n.member=r),JSON.stringify(n)},this.sendSignal=function(e,t,r,n,s){var o={type:i.messageType.signal,serial:a.serial++,interface:t,path:e,member:r};n&&(o.signature=n,o.body=s),a.connection.message(o)},this.sendError=function(e,t,r){var n={type:i.messageType.error,serial:a.serial++,replySerial:e.serial,destination:e.sender,errorName:t,signature:"s",body:[r]};this.connection.message(n)},this.sendReply=function(e,t,r){var n={type:i.messageType.methodReturn,serial:a.serial++,replySerial:e.serial,destination:e.sender,signature:t,body:r};this.connection.message(n)},this.connection.on("message",(function(e){function t(t,r,n){Promise.resolve().then((function(){return r.apply(t,(e.body||[]).concat(e))})).then((function(t){var r={type:i.messageType.methodReturn,serial:a.serial++,destination:e.sender,replySerial:e.serial};null!==t&&(r.signature=n,r.body=[t]),a.connection.message(r)}),(function(t){a.sendError(e,t.dbusName||"org.freedesktop.DBus.Error.Failed",t.message||"")}))}var r;if(e.type===i.messageType.methodReturn||e.type===i.messageType.error){if(r=a.cookies[e.replySerial]){delete a.cookies[e.replySerial];var n={connection:a.connection,bus:a,message:e,signature:e.signature},o=e.body||[];e.type===i.messageType.methodReturn?(o=[null].concat(o),r.apply(n,o)):r.call(n,{name:e.errorName,message:o})}}else if(e.type===i.messageType.signal)a.signals.emit(a.mangle(e),e.body,e.signature);else{if(s(e,a))return;var c,u,h;if(c=a.exportedObjects[e.path]){if(u=c[e.interface]){var d=(h=u[1])[e.member];return d?void t(h,d,u[0].methods[e.member][1]):void a.sendError(e,"org.freedesktop.DBus.Error.UnknownMethod",`Method "${e.member}" on interface "${e.interface}" doesn't exist`)}console.error(`Interface ${e.interface} is not supported`)}(r=a.methodCallHandlers[a.mangle(e)])?t(null,r[0],r[1]):a.sendError(e,"org.freedesktop.DBus.Error.UnknownService","Uh oh oh")}})),this.setMethodCallHandler=function(e,t,r,n){var i=a.mangle(e,t,r);a.methodCallHandlers[i]=n},this.exportInterface=function(e,t,r){if((a.exportedObjects[t]?a.exportedObjects[t]:a.exportedObjects[t]={})[r.name]=[r,e],"function"==typeof e.emit){var n=e.emit;e.emit=function(){var s,o=Array.prototype.slice.apply(arguments),c=o[0];if(!c)throw new Error("Trying to emit undefined signa");if(r.signals&&r.signals[c]){s=r.signals[c];var u={type:i.messageType.signal,serial:a.serial++,interface:r.name,path:t,member:c};s[0]&&(u.signature=s[0],u.body=o.slice(1)),a.connection.message(u),a.serial++}n.apply(e,o)}}},!0!==r.direct?this.invokeDbus({member:"Hello"},(function(e,t){if(e)throw new Error(e);a.name=t})):a.name=null,this.getService=function(e){return new u(e,this)},this.getObject=function(e,t,r){return this.getService(e).getObject(t,r)},this.getInterface=function(e,t,r,n){return this.getObject(e,t,(function(e,t){if(e)return n(e);n(null,t.as(r))}))},this.addMatch=function(e,t){this.invokeDbus({member:"AddMatch",signature:"s",body:[e]},t)},this.removeMatch=function(e,t){this.invokeDbus({member:"RemoveMatch",signature:"s",body:[e]},t)},this.getId=function(e){this.invokeDbus({member:"GetId"},e)},this.requestName=function(e,t,r){this.invokeDbus({member:"RequestName",signature:"su",body:[e,t]},(function(e,t){r&&r(e,t)}))},this.releaseName=function(e,t){this.invokeDbus({member:"ReleaseName",signature:"s",body:[e]},t)},this.listNames=function(e){this.invokeDbus({member:"ListNames"},e)},this.listActivatableNames=function(e){this.invokeDbus({member:"ListActivatableNames"},e)},this.updateActivationEnvironment=function(e,t){this.invokeDbus({member:"UpdateActivationEnvironment",signature:"a{ss}",body:[e]},t)},this.startServiceByName=function(e,t,r){this.invokeDbus({member:"StartServiceByName",signature:"su",body:[e,t]},r)},this.getConnectionUnixUser=function(e,t){this.invokeDbus({member:"GetConnectionUnixUser",signature:"s",body:[e]},t)},this.getConnectionUnixProcessId=function(e,t){this.invokeDbus({member:"GetConnectionUnixProcessID",signature:"s",body:[e]},t)},this.getNameOwner=function(e,t){this.invokeDbus({member:"GetNameOwner",signature:"s",body:[e]},t)},this.nameHasOwner=function(e,t){this.invokeDbus({member:"NameHasOwner",signature:"s",body:[e]},t)}}},1575:e=>{e.exports={messageType:{invalid:0,methodCall:1,methodReturn:2,error:3,signal:4},headerTypeName:[null,"path","interface","member","errorName","replySerial","destination","sender","signature"],fieldSignature:{path:"o",interface:"s",member:"s",errorName:"s",replySerial:"u",destination:"s",sender:"s",signature:"g"},headerTypeId:{path:1,interface:2,member:3,errorName:4,replySerial:5,destination:6,sender:7,signature:8},protocolVersion:1,flags:{noReplyExpected:1,noAutoStart:2},endianness:{le:108,be:66},messageSignature:"yyyyuua(yv)",defaultAuthMethods:["EXTERNAL","DBUS_COOKIE_SHA1","ANONYMOUS"]}},8387:(e,t,r)=>{const n=r(2736),i=r(5824);function s(e,t,r){"object"!=typeof r?r={ayBuffer:!0,ReturnLongjs:!1}:void 0===r.ayBuffer&&(r.ayBuffer=!0),this.options=r,this.buffer=e,this.startPos=t||0,this.pos=0}s.prototype.align=function(e){var t=(1<<e)-1,r=this.pos+this.startPos+t>>e<<e;this.pos=r-this.startPos},s.prototype.readInt8=function(){return this.pos++,this.buffer[this.pos-1]},s.prototype.readSInt16=function(){this.align(1);var e=this.buffer.readInt16LE(this.pos);return this.pos+=2,e},s.prototype.readInt16=function(){this.align(1);var e=this.buffer.readUInt16LE(this.pos);return this.pos+=2,e},s.prototype.readSInt32=function(){this.align(2);var e=this.buffer.readInt32LE(this.pos);return this.pos+=4,e},s.prototype.readInt32=function(){this.align(2);var e=this.buffer.readUInt32LE(this.pos);return this.pos+=4,e},s.prototype.readDouble=function(){this.align(3);var e=this.buffer.readDoubleLE(this.pos);return this.pos+=8,e},s.prototype.readString=function(e){if(0===e)return this.pos++,"";var t=this.buffer.toString("utf8",this.pos,this.pos+e);return this.pos+=e+1,t},s.prototype.readTree=function(e){switch(e.type){case"(":case"{":case"r":return this.align(3),this.readStruct(e.child);case"a":if(!e.child||1!==e.child.length)throw new Error("Incorrect array element signature");var t=this.readInt32();return this.readArray(e.child[0],t);case"v":return this.readVariant();default:return this.readSimpleType(e.type)}},s.prototype.read=function(e){var t=i(e);return this.readStruct(t)},s.prototype.readVariant=function(){var e=this.readSimpleType("g"),t=i(e);return[t,this.readStruct(t)]},s.prototype.readStruct=function(e){for(var t=[],r=0;r<e.length;++r)t.push(this.readTree(e[r]));return t},s.prototype.readArray=function(e,t){var r,n=this.pos;if("y"===e.type&&this.options.ayBuffer)return this.pos+=t,this.buffer.slice(n,this.pos);-1!==["x","t","d","{","(","r"].indexOf(e.type)&&this.align(3);var i=this.pos+t;for(r=[];this.pos<i;)r.push(this.readTree(e));return r},s.prototype.readSimpleType=function(e){var t,r,i,s;switch(e){case"y":return this.readInt8();case"b":return!!this.readInt32();case"n":return this.readSInt16();case"q":return this.readInt16();case"u":return this.readInt32();case"i":return this.readSInt32();case"g":return r=this.readInt8(),this.readString(r);case"s":case"o":return r=this.readInt32(),this.readString(r);case"x":return this.align(3),i=this.readInt32(),s=this.readInt32(),t=n.fromBits(i,s,!1),this.options.ReturnLongjs?t:t.toNumber();case"t":return this.align(3),i=this.readInt32(),s=this.readInt32(),t=n.fromBits(i,s,!0),this.options.ReturnLongjs?t:t.toNumber();case"d":return this.readDouble();default:throw new Error(`Unsupported type: ${e}`)}},e.exports=s},534:(e,t,r)=>{const n=r(1444).Buffer,i=r(6113),s=r(7147),o=r(1017),a=r(1575),c=r(9644);function u(e,t,r){var n=o.join(process.env[process.platform.match(/$win/)?"USERPROFILE":"HOME"],".dbus-keyrings");0===e.length&&(e="org_freedesktop_general");var i=o.join(n,e);s.stat(n,(function(e,n){return e?r(e):18&n.mode?r(new Error("User keyrings directory is writeable by other users. Aborting authentication")):process.hasOwnProperty("getuid")&&n.uid!==process.getuid()?r(new Error("Keyrings directory is not owned by the current user. Aborting authentication!")):void s.readFile(i,"ascii",(function(e,n){if(e)return r(e);for(var i=n.split("\n"),s=0;s<i.length;++s){var o=i[s].split(" ");if(t===o[0])return r(null,o[2])}return r(new Error("cookie not found"))}))}))}function h(e){return n.from(e.toString(),"ascii").toString("hex")}function d(e,t,r){if(0===t.length)return r(new Error("No authentication methods left to try"));var s=t.shift(),o=h(process.hasOwnProperty("getuid")?process.getuid():0);function a(){c(e,(function(n){var i=n.toString("ascii").match(/^([A-Za-z]+) (.*)/);return i&&"OK"===i[1]?(e.write("BEGIN\r\n"),r(null,i[2])):t.empty?r(n):void d(e,t,r)}))}switch(s){case"EXTERNAL":e.write(`AUTH ${s} ${o}\r\n`),a();break;case"DBUS_COOKIE_SHA1":e.write(`AUTH ${s} ${o}\r\n`),c(e,(function(t){var s=n.from(t.toString().split(" ")[1].trim(),"hex").toString().split(" "),o=s[0],c=s[1],d=s[2],l=i.randomBytes(16).toString("hex");u(o,c,(function(t,n){if(t)return r(t);var s,o,c=(s=[d,l,n].join(":"),(o=i.createHash("sha1")).update(s),o.digest("hex")),u=h(l+c);e.write(`DATA ${u}\r\n`),a()}))}));break;case"ANONYMOUS":e.write("AUTH ANONYMOUS \r\n"),a();break;default:console.error(`Unsupported auth method: ${s}`),a()}}e.exports=function(e,t,r){var n;n=t.authMethods?t.authMethods:a.defaultAuthMethods,e.write("\0"),d(e,n.slice(),r)}},7287:(e,t,r)=>{const n=r(6227);function i(e,t){this.$parent=e,this.$name=t,this.$methods={},this.$properties={},this.$callbacks=[],this.$sigHandlers=[]}function s(e,t,r){return`type='signal',path='${e}',interface='${t}',member='${r}'`}e.exports.introspectBus=function(t,r){t.service.bus.invoke({destination:t.service.name,path:t.name,interface:"org.freedesktop.DBus.Introspectable",member:"Introspect"},(function(n,i){e.exports.processXML(n,i,t,r)}))},e.exports.processXML=function(t,r,s,o){if(t)return o(t);(new n.Parser).parseString(r,(function(t,r){if(t)return o(t);if(!r.node)throw new Error("No root XML node");if(!(r=r.node).interface){if(r.node&&r.node.length>0&&r.node[0].$){var n=Object.assign(s,{});return"/"!==n.name.slice(-1)&&(n.name+="/"),n.name+=r.node[0].$.name,e.exports.introspectBus(n,o)}return o(new Error("No such interface found"))}for(var a,c,u,h,d,l,f,p={},y=[],m=r.interface,g=r.node||[],v=1;v<g.length;++v)y.push(g[v].$.name);for(var b=0;b<m.length;++b){f=p[a=(h=m[b]).$.name]=new i(s,a);for(var E=0;h.method&&E<h.method.length;++E){l="";for(var S=(c=h.method[E]).$.name,A=0;c.arg&&A<c.arg.length;++A)"in"===(d=c.arg[A].$).direction&&(l+=d.type);f.$createMethod(S,l)}for(var I=0;h.property&&I<h.property.length;++I)u=h.property[I],f.$createProp(u.$.name,u.$.type,u.$.access)}o(null,p,y)}))},i.prototype.$getSigHandler=function(e){var t;return-1===(t=this.$callbacks.indexOf(e))&&(t=this.$callbacks.push(e)-1,this.$sigHandlers[t]=function(t){e.apply(null,t)}),this.$sigHandlers[t]},i.prototype.addListener=i.prototype.on=function(e,t){var r=this.$parent.service.bus,n=r.mangle(this.$parent.name,this.$name,e);if(r.signals.listeners(n).length)r.signals.on(n,this.$getSigHandler(t));else{var i=s(this.$parent.name,this.$name,e);r.addMatch(i,function(e){if(e)throw new Error(e);r.signals.on(n,this.$getSigHandler(t))}.bind(this))}},i.prototype.removeListener=i.prototype.off=function(e,t){var r=this.$parent.service.bus,n=r.mangle(this.$parent.name,this.$name,e);if(r.signals.removeListener(n,this.$getSigHandler(t)),!r.signals.listeners(n).length){var i=s(this.$parent.name,this.$name,e);r.removeMatch(i,function(e){if(e)throw new Error(e);this.$callbacks.length=0,this.$sigHandlers.length=0}.bind(this))}},i.prototype.$createMethod=function(e,t){this.$methods[e]=t,this[e]=function(){this.$callMethod(e,arguments)}},i.prototype.$callMethod=function(e,t){var r=this.$parent.service.bus;Array.isArray(t)||(t=Array.from(t));var n="function"==typeof t[t.length-1]?t.pop():function(){},i={destination:this.$parent.service.name,path:this.$parent.name,interface:this.$name,member:e};""!==this.$methods[e]&&(i.signature=this.$methods[e],i.body=t),r.invoke(i,n)},i.prototype.$createProp=function(e,t,r){this.$properties[e]={type:t,access:r},Object.defineProperty(this,e,{enumerable:!0,get:()=>t=>this.$readProp(e,t),set:function(t){this.$writeProp(e,t)}})},i.prototype.$readProp=function(e,t){this.$parent.service.bus.invoke({destination:this.$parent.service.name,path:this.$parent.name,interface:"org.freedesktop.DBus.Properties",member:"Get",signature:"ss",body:[this.$name,e]},(function(e,r){e?t(e):1===r[0].length?t(e,r[1][0]):t(e,r[1])}))},i.prototype.$writeProp=function(e,t){this.$parent.service.bus.invoke({destination:this.$parent.service.name,path:this.$parent.name,interface:"org.freedesktop.DBus.Properties",member:"Set",signature:"ssv",body:[this.$name,e,[this.$properties[e].type,t]]})}},3802:(e,t,r)=>{const n=r(9491),i=r(5824),s=r(2759),o=r(865),a=r(9617).A;function c(e,t,r){if(t.length!==r.length)throw new Error("Invalid struct data");for(var n=0;n<t.length;++n)u(e,t[n],r[n]);return e}function u(e,t,r){switch(t.type){case"(":case"{":a(e,8),c(e,t.child,r);break;case"a":var o=s();o._offset=e._offset;var h=o._offset;d(o,"u",0);var l=o._offset-4-h;-1!==["x","t","d","{","("].indexOf(t.child[0].type)&&a(o,8);for(var f=o._offset,p=0;p<r.length;++p)u(o,t.child[0],r[p]);var y=o.buffer(),m=o._offset-f;y.writeUInt32LE(m,l),e.put(y),e._offset+=y.length;break;case"v":n.equal(r.length,2,"variant data should be [signature, data]");u(e,{type:"g",child:[]},r[0]);var g=i(r[0]);n(1===g.length),u(e,g[0],r[1]);break;default:return d(e,t.type,r)}}e.exports=function(e,t,r){void 0===r&&(r=0);var n=i(e);if(!Array.isArray(t)||t.length!==n.length)throw new Error(`message body does not match message signature. Body:${JSON.stringify(t)}, signature:${e}`);var o=s();return o._offset=r,c(o,n,t).buffer()};var h=["g","o","s"];function d(e,t,r){if(void 0===r)throw new Error("Serialisation of JS 'undefined' type is not supported by d-bus");if(null===r)throw new Error("Serialisation of null value is not supported by d-bus");if(Buffer.isBuffer(r)&&(r=r.toString()),-1!==h.indexOf(t)&&"string"!=typeof r)throw new Error(`Expected string or buffer argument, got ${JSON.stringify(r)} of type '${t}'`);return o.MakeSimpleMarshaller(t).marshall(e,r),e}},865:(e,t,r)=>{const n=r(1444).Buffer,i=r(9617).A,s=r(5824),o=r(2736);t.MakeSimpleMarshaller=function(e){var t={};function r(e){if("string"!=typeof e)throw new Error(`Data: ${e} was not of type string`);if(-1!==e.indexOf("\0"))throw new Error("String contains null byte")}switch(e){case"o":case"s":t.check=function(e){r(e)},t.marshall=function(e,t){this.check(t),i(e,4);const r=n.from(t,"utf8");e.word32le(r.length).put(r).word8(0),e._offset+=5+r.length};break;case"g":t.check=function(e){r(e),function(e){if(e.length>255)throw new Error(`Data: ${e} is too long for signature type (${e.length} > 255)`);for(var t=0,r=0;r<e.length;++r){if(t>32)throw new Error(`Maximum container type nesting exceeded in signature type:${e}`);switch(e[r]){case"(":++t;break;case")":--t}}s(e)}(e)},t.marshall=function(e,t){this.check(t);const r=n.from(t,"ascii");e.word8(t.length).put(r).word8(0),e._offset+=2+r.length};break;case"y":t.check=function(e){c(e),a(0,255,e)},t.marshall=function(e,t){this.check(t),e.word8(t),e._offset++};break;case"b":t.check=function(e){u(e)},t.marshall=function(e,t){this.check(t),t=t?1:0,i(e,4),e.word32le(t),e._offset+=4};break;case"n":t.check=function(e){c(e),a(-32768,32767,e)},t.marshall=function(e,t){this.check(t),i(e,2);const r=n.alloc(2);r.writeInt16LE(parseInt(t),0),e.put(r),e._offset+=2};break;case"q":t.check=function(e){c(e),a(0,65535,e)},t.marshall=function(e,t){this.check(t),i(e,2),e.word16le(t),e._offset+=2};break;case"i":t.check=function(e){c(e),a(-2147483648,2147483647,e)},t.marshall=function(e,t){this.check(t),i(e,4);const r=n.alloc(4);r.writeInt32LE(parseInt(t),0),e.put(r),e._offset+=4};break;case"u":t.check=function(e){c(e),a(0,4294967295,e)},t.marshall=function(e,t){this.check(t),i(e,4),e.word32le(t),e._offset+=4};break;case"t":t.check=function(e){return h(e,!1)},t.marshall=function(e,t){t=this.check(t),i(e,8),e.word32le(t.low),e.word32le(t.high),e._offset+=8};break;case"x":t.check=function(e){return h(e,!0)},t.marshall=function(e,t){t=this.check(t),i(e,8),e.word32le(t.low),e.word32le(t.high),e._offset+=8};break;case"d":t.check=function(e){if("number"!=typeof e)throw new Error(`Data: ${e} was not of type number`);if(Number.isNaN(e))throw new Error(`Data: ${e} was not a number`);if(!Number.isFinite(e))throw new Error("Number outside range")},t.marshall=function(e,t){this.check(t),i(e,8);const r=n.alloc(8);r.writeDoubleLE(parseFloat(t),0),e.put(r),e._offset+=8};break;default:throw new Error(`Unknown data type format: ${e}`)}return t};var a=function(e,t,r){if(r>t||r<e)throw new Error("Number outside range")},c=function(e){if("number"!=typeof e)throw new Error(`Data: ${e} was not of type number`);if(Math.floor(e)!==e)throw new Error(`Data: ${e} was not an integer`)},u=function(e){if("boolean"!=typeof e&&0!==e&&1!==e)throw new Error(`Data: ${e} was not of type boolean`)},h=function(e,t){if(o.isLong(e)||(e=function(e,t){if(e instanceof o)return e;if(e instanceof Number&&(e=e.valueOf()),"number"==typeof e){try{c(e),a(t?-9007199254740991:0,9007199254740991,e)}catch(e){throw e.message+=" (Number type can only carry 53 bit integer)",e}try{return o.fromNumber(e,!t)}catch(e){throw e.message=`Error converting number to 64bit integer "${e.message}"`,e}}if("string"==typeof e||e instanceof String){var r,n=10;"0X"===(e=e.trim().toUpperCase()).substring(0,2)?(n=16,e=e.substring(2)):"-0X"===e.substring(0,3)&&(n=16,e=`-${e.substring(3)}`),e=e.replace(/^0+(?=\d)/,"");try{r=o.fromString(e,!t,n)}catch(e){throw e.message=`Error converting string to 64bit integer '${e.message}'`,e}if(r.toString(n).toUpperCase()!==e)throw new Error(`Data: '${e}' did not convert correctly to ${t?"signed":"unsigned"} 64 bit`);return r}try{return o.fromBits(e.low,e.high,e.unsigned)}catch(e){throw e.message=`Error converting object to 64bit integer '${e.message}'`,e}}(e,t)),t){if(e.unsigned)throw new Error("Longjs object is unsigned, but marshalling into signed 64 bit field");if(e.gt(o.MAX_VALUE)||e.lt(o.MIN_VALUE))throw new Error(`Data: ${e} was out of range (64-bit signed)`)}else{if(!e.unsigned)throw new Error("Longjs object is signed, but marshalling into unsigned 64 bit field");if(e.gt(o.MAX_UNSIGNED_VALUE)||e.lt(0))throw new Error(`Data: ${e} was out of range (64-bit unsigned)`)}return e}},8102:(e,t,r)=>{const n=r(1444).Buffer,i=r(3802),s=r(1575),o=r(8387),a=r(1761);e.exports.unmarshalMessages=function(e,t,r){var n,i,c,u,h=0,d=0,l=0;e.on("readable",(function(){for(;;)if(0===h){if(!(n=e.read(16)))break;h=1,c=n.readUInt32LE(12),u=c+7>>3<<3,l=n.readUInt32LE(4),d=u+l}else{if(!(i=e.read(d)))break;h=0;var f=new o(i,void 0,r),p=f.readArray(a[0].child[0],c);f.align(3);var y={};y.serial=n.readUInt32LE(8);for(var m=0;m<p.length;++m)y[s.headerTypeName[p[m][0]]]=p[m][1][1][0];y.type=n[1],y.flags=n[2],l>0&&y.signature&&(y.body=f.read(y.signature)),t(y)}}))},e.exports.unmarshall=function(e,t){for(var r=new o(e,void 0,t),n=r.read("yyyyuua(yv)"),i={},a=0;a<n[6].length;++a){i[s.headerTypeName[n[6][a][0]]]=n[6][a][1][1][0]}return i.type=n[1],i.flags=n[2],i.serial=n[5],r.align(3),i.body=r.read(i.signature),i},e.exports.marshall=function(e){if(!e.serial)throw new Error("Missing or invalid serial");var t,r=e.flags||0,o=e.type||s.messageType.methodCall,a=0;e.signature&&e.body&&(a=(t=i(e.signature,e.body)).length);var c=[s.endianness.le,o,r,s.protocolVersion,a,e.serial],u=i("yyyyuu",c),h=[];s.headerTypeName.forEach((function(t){var r=e[t];r&&h.push([s.headerTypeId[t],[s.fieldSignature[t],r]])}));var d=i("a(yv)",[h],12),l=u.length+d.length+7>>3<<3,f=l+a,p=n.alloc(f);return u.copy(p),d.copy(p,u.length),a>0&&t.copy(p,l),p}},9644:(e,t,r)=>{const n=r(1444).Buffer;e.exports=function(e,t){var r=[];e.on("readable",(function i(){for(;;){var s=e.read(1);if(!s)return;var o=s[0];if(10===o){try{t(n.from(r))}catch(t){e.emit("error",t)}return void e.removeListener("readable",i)}r.push(o)}}))}},387:(e,t,r)=>{const n=r(1444).Buffer,i=r(9644);e.exports=function(e,t,r){e.name="SERVER SERVER",i(e,(function(t){console.log(["hello string: ",t.toString(),t]),e.write("REJECTED EXTERNAL DBUS_COOKIE_SHA1 ANONYMOUS\r\n"),i(e,(function(){e.write(`DATA ${n.from("org_freedesktop_general 642038150 b9ce247a275f427c8586e4c9de9bb951").toString("hex")}\r\n`),i(e,(function(){e.write("OK 6f72675f667265656465736b746f705f67656e6572616c20353631303331333937206239636532343761323735663432376338353836653463396465396262393531\r\n"),i(e,(function(e){console.log(["AFTER begin: ",e.toString()]),r(null)}))}))}))}))}},3294:(e,t,r)=>{const n=r(8332),i=r(1808);e.exports.createServer=function(e){return new function(){var t=123;this.server=i.createServer((function(r){r.idd=t,t++;var i=n.createConnection({stream:r,server:!0});e&&e(i)})),this.listen=this.server.listen.bind(this.server)}}},5824:e=>{var t={"{":"}","(":")"},r={};"(){}ybnqiuxtdsogarvehm*?@&^".split("").forEach((function(e){r[e]=!0})),e.exports=function(e){var n=0;function i(){if(n<e.length){var t=e[n];return++n,t}return null}function s(n){function o(e){if(!e)throw new Error("Bad signature: unexpected end");return e}if(!r[n])throw new Error(`Unknown type: "${n}" in signature "${e}"`);var a,c={type:n,child:[]};switch(n){case"a":return o(a=i()),c.child.push(s(a)),c;case"{":case"(":for(;null!==(a=i())&&a!==t[n];)c.child.push(s(a));return o(a),c}return c}for(var o,a=[];null!==(o=i());)a.push(s(o));return a}},4995:(e,t,r)=>{const n=r(1575),i=r(5824);var s;function o(e){var t=[],r=function(e,r,n){e&&i(e).forEach((function(e,i){var s=r?r[i]:n+i,o="signal"===n?"":`" direction="${n}`;t.push(`      <arg type="${a([e])}" name="${s}${o}" />`)}))};if(t.push(`  <interface name="${e.name}">`),e.methods)for(var n in e.methods){var s=e.methods[n];t.push(`    <method name="${n}">`),r(s[0],s[2],"in"),r(s[1],s[3],"out"),t.push("    </method>")}if(e.signals)for(var o in e.signals){var c=e.signals[o];t.push(`    <signal name="${o}">`),r(c[0],c.slice(1),"signal"),t.push("    </signal>")}if(e.properties)for(const r in e.properties)t.push(`    <property name="${r}" type="${e.properties[r]}" access="readwrite"/>`);return t.push("  </interface>"),t.join("\n")}function a(e){var t=[];return e.forEach((function(e){t.push(e.type+a(e.child)),"{"===e.type&&t.push("}"),"("===e.type&&t.push(")")})),t.join("")}e.exports=function(e,t){if("org.freedesktop.DBus.Introspectable"===e.interface&&"Introspect"===e.member){"/"===e.path&&(e.path="");var r=['<!DOCTYPE node PUBLIC "-//freedesktop//DTD D-BUS Object Introspection 1.0//EN"\n    "http://www.freedesktop.org/standards/dbus/1.0/introspect.dtd">'],i={};for(var a in t.exportedObjects)if(0===a.indexOf(e.path)){var c=t.exportedObjects[e.path];if(c)i[e.path]=c;else{if("/"!==a[e.path.length])continue;i[a.substr(e.path.length).split("/")[1]]=null}}var u=Object.keys(i).length;if(0===u)r.push("<node/>");else if(1===u){var h=i[Object.keys(i)[0]];if(h){for(var d in r.push("<node>"),h)r.push(o(h[d][0]));r.push(s),r.push("</node>")}else r.push(`<node>\n  <node name="${Object.keys(i)[0]}"/>\n  </node>`)}else{for(var l in r.push("<node>"),i)if(null===i[l])r.push(`  <node name="${l}" />`);else{for(var f in h=i[l],r.push(`  <node name="${l}" >`),h)r.push(o(h[f][0]));r.push(s),r.push("  </node>")}r.push("</node>")}const p={type:n.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender,signature:"s",body:[r.join("\n")]};return t.connection.message(p),1}if("org.freedesktop.DBus.Properties"===e.interface){var p=e.body[0],y=t.exportedObjects[e.path];if(!y||!y[p])return t.sendError(e,"org.freedesktop.DBus.Error.UnknownMethod","Uh oh oh"),1;var m=y[p][1];const r={type:n.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender};if("Get"===e.member||"Set"===e.member){var g=e.body[1],v=y[p][0].properties[g];if("Get"===e.member){var b=m[g];r.signature="v",r.body=[[v,b]]}else m[g]=1234}else if("GetAll"===e.member){r.signature="a{sv}";var E=[];for(var S in y[p][0].properties){var A=y[p][0].properties[S];E.push([S,[A,m[S]]])}r.body=[E]}return t.connection.message(r),1}if("org.freedesktop.DBus.Peer"===e.interface){const r={type:n.messageType.methodReturn,serial:t.serial++,replySerial:e.serial,destination:e.sender};return"Ping"===e.member||"GetMachineId"===e.member&&(r.signature="s",r.body=["This is a machine id. TODO: implement"]),t.connection.message(r),1}return 0},s='  <interface name="org.freedesktop.DBus.Properties">\n    <method name="Get">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="s" name="property_name" direction="in"/>\n      <arg type="v" name="value" direction="out"/>\n    </method>\n    <method name="GetAll">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="a{sv}" name="properties" direction="out"/>\n    </method>\n    <method name="Set">\n      <arg type="s" name="interface_name" direction="in"/>\n      <arg type="s" name="property_name" direction="in"/>\n      <arg type="v" name="value" direction="in"/>\n    </method>\n    <signal name="PropertiesChanged">\n      <arg type="s" name="interface_name"/>\n      <arg type="a{sv}" name="changed_properties"/>\n      <arg type="as" name="invalidated_properties"/>\n    </signal>\n  </interface>\n  <interface name="org.freedesktop.DBus.Introspectable">\n    <method name="Introspect">\n      <arg type="s" name="xml_data" direction="out"/>\n    </method>\n  </interface>\n  <interface name="org.freedesktop.DBus.Peer">\n    <method name="Ping"/>\n    <method name="GetMachineId">\n      <arg type="s" name="machine_uuid" direction="out"/>\n    </method>\n  </interface>'},2759:(e,t,r)=>{const n=r(9491);e.exports=function e(){if(!(this instanceof e))return new e;var t=[],r=0;this.put=function(e){return t.push({buffer:e}),r+=e.length,this},this.word8=function(e){return t.push({bytes:1,value:e}),r+=1,this},this.floatle=function(e){return t.push({bytes:"float",endian:"little",value:e}),r+=4,this},[8,16,24,32,64].forEach(function(e){this["word"+e+"be"]=function(n){return t.push({endian:"big",bytes:e/8,value:n}),r+=e/8,this},this["word"+e+"le"]=function(n){return t.push({endian:"little",bytes:e/8,value:n}),r+=e/8,this}}.bind(this)),this.pad=function(e){return n(Number.isInteger(e),"pad(bytes) must be supplied with an integer!"),t.push({endian:"big",bytes:e,value:0}),r+=e,this},this.length=function(){return r},this.buffer=function(){var e=Buffer.alloc(r),n=0;return t.forEach((function(t){if(t.buffer)t.buffer.copy(e,n,0),n+=t.buffer.length;else if("float"===t.bytes){var r=Math.abs(t.value),i=1*(t.value>=0),s=Math.ceil(Math.log(r)/Math.LN2),o=r/(1<<s);console.dir([i,s,o]),console.log(t.value),e[n++]=i<<7&~~(s/2),e[n++]=(1&s)<<7&~~(o/65536),e[n++]=0,e[n++]=0,n+=4}else for(var a="big"===t.endian,c=a?[8*(t.bytes-1),-8]:[0,8],u=c[0];a?u>=0:u<8*t.bytes;u+=c[1])e[n++]=u>=32?255&Math.floor(t.value/Math.pow(2,u)):t.value>>u&255})),e},this.write=function(e){e.write(this.buffer())}}},9907:e=>{"use strict";function t(e){return n(e,[])}function r(e,t){if("number"!=typeof t)throw new TypeError("Expected the depth to be a number");return i(e,[],t)}function n(e,t){for(var r=0;r<e.length;r++){var i=e[r];Array.isArray(i)?n(i,t):t.push(i)}return t}function i(e,t,r){r--;for(var n=0;n<e.length;n++){var s=e[n];r>-1&&Array.isArray(s)?i(s,t,r):t.push(s)}return t}e.exports=function(e){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return t(e)},e.exports.from=t,e.exports.depth=function(e,t){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return r(e,t)},e.exports.fromDepth=r},1382:(e,t,r)=>{"use strict";const n=r(2814),i=r(3467),s=r(431);function o(e){if(!(this instanceof o))return new o(e);this._server=new i(e),this._registry=new n(this._server)}o.prototype={publish:function(e){return this._registry.publish(e)},unpublishAll:function(e){this._registry.unpublishAll(e)},find:function(e,t){return new s(this._server.mdns,e,t)},findOne:function(e,t){const r=new s(this._server.mdns,e);return r.once("up",(function(e){r.stop(),t&&t(e)})),r},destroy:function(){this._registry.destroy(),this._server.mdns.destroy()}},e.exports=o},431:(e,t,r)=>{"use strict";const n=r(3837),i=r(2361).EventEmitter,s=r(7211),o=r(7614),a=r(8039),c=".local";function u(e,t,r){if("function"==typeof t)return new u(e,null,t);i.call(this),this._mdns=e,this._onresponse=null,this._serviceMap={},this._txt=a(t.txt),t&&t.type?(this._name=s.stringify(t.type,t.protocol||"tcp")+c,t.name&&(this._name=t.name+"."+this._name),this._wildcard=!1):(this._name="_services._dns-sd._udp.local",this._wildcard=!0),this.services=[],r&&this.on("up",r),this.start()}e.exports=u,n.inherits(u,i),u.prototype.start=function(){if(this._onresponse)return;const e=this,t={};this._wildcard||(t[this._name]=!0),this._onresponse=function(r,n){e._wildcard&&r.answers.forEach((function(r){"PTR"!==r.type||r.name!==e._name||r.name in t||(t[r.data]=!0,e._mdns.query(r.data,"PTR"))})),Object.keys(t).forEach((function(t){(function(e,t){return t.answers.concat(t.additionals).filter((function(t){return"PTR"===t.type&&0===t.ttl&&o(t.name,e)})).map((function(e){return e.data}))})(t,r).forEach(e._removeService.bind(e));const i=function(e,t,r,n){const i=t.answers.concat(t.additionals).filter((function(e){return e.ttl>0}));return i.filter((function(t){return"PTR"===t.type&&o(t.name,e)})).map((function(e){const t={addresses:[]};if(i.filter((function(t){return("SRV"===t.type||"TXT"===t.type)&&o(t.name,e.data)})).forEach((function(e){if("SRV"===e.type){const r=e.name.split("."),i=r[0],o=s.parse(r.slice(1,-1).join("."));t.name=i,t.fqdn=e.name,t.host=e.data.target,t.referer=n,t.port=e.data.port,t.type=o.name,t.protocol=o.protocol,t.subtypes=o.subtypes}else"TXT"===e.type&&(t.rawTxt=e.data,t.txt=r.decodeBlocks(t.rawTxt))})),t.name)return i.filter((function(e){return("A"===e.type||"AAAA"===e.type)&&o(e.name,t.host)})).forEach((function(e){t.addresses.push(e.data)})),t})).filter((function(e){return!!e}))}(t,r,e._txt,n);0!==i.length&&i.forEach((function(t){e._serviceMap[t.fqdn]||e._addService(t)}))}))},this._mdns.on("response",this._onresponse),this.update()},u.prototype.stop=function(){this._onresponse&&(this._mdns.removeListener("response",this._onresponse),this._onresponse=null)},u.prototype.update=function(){this._mdns.query(this._name,"PTR")},u.prototype._addService=function(e){this.services.push(e),this._serviceMap[e.fqdn]=!0,this.emit("up",e)},u.prototype._removeService=function(e){let t,r;this.services.some((function(n,i){return!!o(n.fqdn,e)&&(t=n,r=i,!0)})),t&&(this.services.splice(r,1),delete this._serviceMap[e],this.emit("down",t))}},6212:(e,t,r)=>{"use strict";const n=r(7614),i=function(e,t,r){this.sent=!1,this.retries=0,this.timer=null,this.cb=r,this.mdns=e,this.service=t,this.bound=this.onMDNSresponse.bind(this),this.matchRRBound=this.matchRR.bind(this)};i.prototype={start:function(){this.mdns.on("response",this.bound),setTimeout(this.try.bind(this),250*Math.random())},try:function(){this.service._activated&&!this.service._destroyed&&this.mdns.query(this.service.fqdn,"ANY",function(){this.sent=!0,this.timer=setTimeout(++this.retries<3?this.try.bind(this):this.done.bind(this,!1),250),this.timer.unref()}.bind(this))},matchRR:function(e){return n(e.name,this.service.fqdn)},onMDNSresponse:function(e){this.sent&&(e.answers.some(this.matchRRBound)||e.additionals.some(this.matchRRBound))&&this.done(!0)},done:function(e){this.mdns.removeListener("response",this.bound),clearTimeout(this.timer),this.cb(e)}},e.exports=i},2814:(e,t,r)=>{"use strict";const n=r(9907),i=r(5403),s=r(6212),o=function(e){this._server=e,this._services=[]};o.prototype={publish:function(e){const t=new i(e=e||{});return t.on("service-publish",this._onServicePublish.bind(this)),t.on("service-unpublish",this._onServiceUnpublish.bind(this)),t.on("service-announce-request",this._onAnnounceRequest.bind(this)),t.on("service-packet-change",this._onServiceChange.bind(this)),t.start(),t},unpublishAll:function(e){this._tearDown(this._services,e),this._services=[]},destroy:function(){for(let e=0;e<this._services.length;e++)this._services[e].destroy()},_tearDown:function(e,t){Array.isArray(e)||(e=[e]),e=e.filter((function(e){return e._activated}));const r=n.depth(e.map((function(e){e.deactivate();const t=e._records(!0);return t.forEach((function(e){e.ttl=0})),t})),1);if(0===r.length)return t&&t();this._server.unregister(r),this._server.mdns.respond(r,this._onTearDownComplete.bind(this,e,t))},_onTearDownComplete:function(e,t){for(let t=0;t<e.length;t++)e[t].published=!1;t&&t.apply(null,Array.prototype.slice.call(arguments,2))},_onServiceChange:function(e){this._server.unregister(e)},_onAnnounceRequest:function(e,t,r){this._server.register(e),t||this._server.mdns.respond(e,r)},_onServiceUnpublish:function(e,t){const r=this._services.indexOf(e);this._tearDown(e,t),-1!==r&&this._services.splice(r,1)},_onServicePublish:function(e){this._services.push(e),e.probe?new s(this._server.mdns,e,this._onProbeComplete.bind(this,e)).start():e.announce()},_onProbeComplete:function(e,t){if(!t)return e.announce();e.stop(),e.emit("error",new Error("Service name is already in use on the network"))}},e.exports=o},3467:(e,t,r)=>{"use strict";const n=r(9695),i=r(7614),s=r(9907),o=r(8556),a=function(e){this.mdns=n(e),this.mdns.setMaxListeners(0),this.registry={},this.mdns.on("query",this._respondToQuery.bind(this))};a.prototype={_respondToQuery:function(e){for(let t=0;t<e.questions.length;t++){const r=e.questions[t],n=r.type,i=r.name,a="ANY"===n?s.depth(Object.keys(this.registry).map(this._recordsFor.bind(this,i)),1):this._recordsFor(i,n);if(0===a.length)return;let c=[];"ANY"!==n&&(a.forEach((e=>{"PTR"===e.type&&(c=c.concat(this._recordsFor(e.data,"SRV")).concat(this._recordsFor(e.data,"TXT")))})),c.filter((e=>"SRV"===e.type)).map((e=>e.data.target)).filter(o.unique()).forEach((e=>{c=c.concat(this._recordsFor(e,"A")).concat(this._recordsFor(e,"AAAA"))}))),this.mdns.respond({answers:a,additionals:c},(e=>{if(e)throw e}))}},register:function(e){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const r=e[t];let n=this.registry[r.type];if(n){if(n.some(o.isDuplicateRecord(r)))continue}else n=this.registry[r.type]=[];n.push(r)}},unregister:function(e){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++){const r=e[t],n=r.type;n in this.registry&&(this.registry[n]=this.registry[n].filter((e=>e.name!==r.name)))}},_recordsFor:function(e,t){return t in this.registry?this.registry[t].filter((t=>{const r=~e.indexOf(".")?t.name:t.name.split(".")[0];return i(r,e)})):[]}},e.exports=a},5403:(e,t,r)=>{"use strict";const n=r(2037),i=r(3837),s=r(1808),o=r(9491),a=r(2361).EventEmitter,c=r(7211),u=r(1885),h=".local",d=function(e){if(!e.name)throw new Error("Required name not given");if(!e.type)throw new Error("Required type not given");if(!e.port)throw new Error("Required port not given");if(this.name=e.name,this.protocol=e.protocol||"tcp",this.probe=!1!==e.probe,this.type=c.stringify(e.type,this.protocol),this.host=e.host||n.hostname(),this.port=e.port,this.fqdn=this.name+"."+this.type+h,this.subtypes=e.subtypes||null,this.txt=e.txt||null,this.published=!1,this.addUnsafeServiceEnumerationRecord=e.addUnsafeServiceEnumerationRecord||!1,this.restrictedAddresses=void 0,e.restrictedAddresses){o(e.restrictedAddresses.length,"The service property 'restrictedAddresses' cannot be an empty array!"),this.restrictedAddresses=new Map;for(const t of e.restrictedAddresses)if(s.isIP(t)){if("0.0.0.0"===t||"::"===t)throw new Error(`[${this.fqdn}] Unspecified ip address (${t}) cannot be used to restrict on to!`);const e=u.resolveInterface(t);if(!e)throw new Error(`[${this.fqdn}] Could not restrict service to address ${t} as we could not resolve it to an interface name!`);const r=this.restrictedAddresses.get(e);r?r.length&&!r.includes(t)&&r.push(t):this.restrictedAddresses.set(e,[t])}else this.restrictedAddresses.set(t,[])}this.disabledIpv6=e.disabledIpv6||!1,this._activated=!1};i.inherits(d,a);const l={start:function(){this._activated||(this._activated=!0,this.emit("service-publish",this))},stop:function(e){this._activated?this.emit("service-unpublish",this,e):e()},updateTxt:function(e,t){this.packet&&this.emit("service-packet-change",this.packet,this.onAnnounceComplete.bind(this)),this.packet=null,this.txt=e,this.published&&(this._unpublish(),this.announce(t))},announce:function(e){this._destroyed||(this.packet||(this.packet=this._records()),this.timer&&clearTimeout(this.timer),this.delay=1e3,this.emit("service-announce-request",this.packet,e||!1,this.onAnnounceComplete.bind(this)))},onAnnounceComplete:function(){this.published||(this._activated=!0,this.published=!0,this.emit("up")),this.delay=3*this.delay,this.delay<36e5&&!this._destroyed&&this._activated?this.timer=setTimeout(this.announce.bind(this),this.delay).unref():(this.timer=void 0,this.delay=void 0)},deactivate:function(){this._unpublish(),this._activated=!1},destroy:function(){this._unpublish(),this.removeAllListeners(),this._destroyed=!0},_unpublish:function(){this.timer&&clearTimeout(this.timer),this.published=!1},_records:function(e){const t=[this._rrPtr(),this._rrSrv(),this._rrTxt()];return t.push(...this._addressRecords()),!e&&this.addUnsafeServiceEnumerationRecord&&t.push(this._rrMetaPtr()),t},_addressRecords:function(){const e=[],t=[];return Object.entries(n.networkInterfaces()).forEach((([r,n])=>{let i=this.restrictedAddresses?this.restrictedAddresses.get(r):void 0;this.restrictedAddresses&&!i||(i&&0===i.length&&(i=void 0),n.forEach((r=>{r.internal||t.includes(r.address)||i&&i.includes(r.address)||("IPv4"===r.family?(e.push(this._rrA(r.address)),t.push(r.address)):this.disabledIpv6||(e.push(this._rrAaaa(r.address)),t.push(r.address)))})))})),e},_rrMetaPtr:function(){return{name:"_services._dns-sd._udp.local",type:"PTR",ttl:4500,data:this.type+h}},_rrPtr:function(){return{name:this.type+h,type:"PTR",ttl:4500,data:this.fqdn}},_rrSrv:function(){return{name:this.fqdn,type:"SRV",ttl:120,flush:!0,data:{port:this.port,target:this.host}}},_rrTxt:function(){const e=[];if(this.txt){const t=this.txt;Object.keys(t).forEach((r=>{const n=t[r];e.push(r+"="+n)}))}return{name:this.fqdn,type:"TXT",ttl:4500,flush:!0,data:e}},_rrA:function(e){return{name:this.host,type:"A",ttl:120,flush:!0,data:e}},_rrAaaa:function(e){return{name:this.host,type:"AAAA",ttl:120,flush:!0,data:e}}};for(const e in l)d.prototype[e]=l[e];e.exports=d},8556:(e,t,r)=>{const n=r(2125);e.exports={isDuplicateRecord:function(e){return function(t){return e.type===t.type&&e.name===t.name&&n(e.data,t.data)}},unique:function(){const e=[];return function(t){return!~e.indexOf(t)&&(e.push(t),!0)}}}},7614:e=>{"use strict";const t=/[A-Z]/g;function r(e){return e.toLowerCase()}e.exports=function(e,n){return(e=e.replace(t,r))===(n=n.replace(t,r))}},1885:(e,t,r)=>{const n=r(2037);e.exports={resolveInterface:function(e){for(const[t,r]of Object.entries(n.networkInterfaces()))for(const n of r)if(n.address===e)return t}}},8039:e=>{"use strict";const t=Buffer.from("=");e.exports=function(e){const r=!!e&&e.binary,n={decodeBlocks:function(e){const n={};return e.forEach((e=>{if(0===e.length)return;const i=e.indexOf(t);if(-1===i)n[e.toString().toLowerCase()]=!0;else if(i>0){const t=e.slice(0,i).toString().toLowerCase();if(t in n)return;const s=e.slice(i+1);n[t]=r?s:s.toString()}})),n}};return n}},6610:(e,t,r)=>{"use strict";var n=r(49),i=r(2269),s=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&s(e,".prototype.")>-1?i(r):r}},2269:(e,t,r)=>{"use strict";var n=r(8689),i=r(49),s=i("%Function.prototype.apply%"),o=i("%Function.prototype.call%"),a=i("%Reflect.apply%",!0)||n.call(o,s),c=i("%Object.getOwnPropertyDescriptor%",!0),u=i("%Object.defineProperty%",!0),h=i("%Math.max%");if(u)try{u({},"a",{value:1})}catch(e){u=null}e.exports=function(e){var t=a(n,o,arguments);if(c&&u){var r=c(t,"length");r.configurable&&u(t,"length",{value:1+h(0,e.length-(arguments.length-1))})}return t};var d=function(){return a(n,s,arguments)};u?u(e.exports,"apply",{value:d}):e.exports.apply=d},9287:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(3058)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},3058:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,s,o=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),s=i-(r||i);n.diff=s,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";o++;const s=t.formatters[i];if("function"==typeof s){const t=e[o];r=s.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,s=t.enabled(e)),s),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(5285),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},2790:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(9287):e.exports=r(9631)},9631:(e,t,r)=>{const n=r(6224),i=r(3837);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(i.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),s=`  ${i};1m${n} [0m`;r[0]=s+r[0].split("\n").join("\n"+s),r.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=i.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(5416);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(3058)(t);const{formatters:s}=e.exports;s.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},2125:(e,t,r)=>{"use strict";var n=r(2680),i=r(7440),s=r(8211),o=r(3688),a=r(728),c=r(9394),u=r(6319),h=r(639),d=r(49),l=r(6610),f=r(1163),p=r(6892),y=r(8373),m=r(7945),g=r(381),v=l("Date.prototype.getTime"),b=Object.getPrototypeOf,E=l("Object.prototype.toString"),S=d("%Set%",!0),A=l("Map.prototype.has",!0),I=l("Map.prototype.get",!0),w=l("Map.prototype.size",!0),T=l("Set.prototype.add",!0),C=l("Set.prototype.delete",!0),_=l("Set.prototype.has",!0),D=l("Set.prototype.size",!0);function R(e,t,r,n){for(var i,s=p(e);(i=s.next())&&!i.done;)if(B(t,i.value,r,n))return C(e,i.value),!0;return!1}function N(e){return void 0===e?null:"object"!=typeof e?"symbol"!=typeof e&&("string"!=typeof e&&"number"!=typeof e||+e==+e):void 0}function O(e,t,r,n,i,s){var o=N(r);if(null!=o)return o;var a=I(t,o),c=g({},i,{strict:!1});return!(void 0===a&&!A(t,o)||!B(n,a,c,s))&&(!A(e,o)&&B(n,a,c,s))}function U(e,t,r){var n=N(r);return null!=n?n:_(t,n)&&!_(e,n)}function P(e,t,r,n,i,s){for(var o,a,c=p(e);(o=c.next())&&!o.done;)if(B(r,a=o.value,i,s)&&B(n,I(t,a),i,s))return C(e,a),!0;return!1}function B(e,t,r,d){var l=r||{};if(l.strict?s(e,t):e===t)return!0;if(h(e)!==h(t))return!1;if(!e||!t||"object"!=typeof e&&"object"!=typeof t)return l.strict?s(e,t):e==t;var y,C=d.has(e),N=d.has(t);if(C&&N){if(d.get(e)===d.get(t))return!0}else y={};return C||d.set(e,y),N||d.set(t,y),function(e,t,r,s){var h,d;if(typeof e!=typeof t)return!1;if(null==e||null==t)return!1;if(E(e)!==E(t))return!1;if(i(e)!==i(t))return!1;var l=c(e),y=c(t);if(l!==y)return!1;var C=e instanceof Error,N=t instanceof Error;if(C!==N)return!1;if((C||N)&&(e.name!==t.name||e.message!==t.message))return!1;var M=o(e),L=o(t);if(M!==L)return!1;if((M||L)&&(e.source!==t.source||a(e)!==a(t)))return!1;var k=u(e),F=u(t);if(k!==F)return!1;if((k||F)&&v(e)!==v(t))return!1;if(r.strict&&b&&b(e)!==b(t))return!1;if(m(e)!==m(t))return!1;var V=x(e),H=x(t);if(V!==H)return!1;if(V||H){if(e.length!==t.length)return!1;for(h=0;h<e.length;h++)if(e[h]!==t[h])return!1;return!0}if(typeof e!=typeof t)return!1;var j=n(e),K=n(t);if(j.length!==K.length)return!1;for(j.sort(),K.sort(),h=j.length-1;h>=0;h--)if(j[h]!=K[h])return!1;for(h=j.length-1;h>=0;h--)if(!B(e[d=j[h]],t[d],r,s))return!1;var q=f(e),G=f(t);if(q!==G)return!1;if("Set"===q||"Set"===G)return function(e,t,r,n){if(D(e)!==D(t))return!1;var i,s,o,a=p(e),c=p(t);for(;(i=a.next())&&!i.done;)if(i.value&&"object"==typeof i.value)o||(o=new S),T(o,i.value);else if(!_(t,i.value)){if(r.strict)return!1;if(!U(e,t,i.value))return!1;o||(o=new S),T(o,i.value)}if(o){for(;(s=c.next())&&!s.done;)if(s.value&&"object"==typeof s.value){if(!R(o,s.value,r.strict,n))return!1}else if(!r.strict&&!_(e,s.value)&&!R(o,s.value,r.strict,n))return!1;return 0===D(o)}return!0}(e,t,r,s);if("Map"===q)return function(e,t,r,n){if(w(e)!==w(t))return!1;var i,s,o,a,c,u,h=p(e),d=p(t);for(;(i=h.next())&&!i.done;)if(a=i.value[0],c=i.value[1],a&&"object"==typeof a)o||(o=new S),T(o,a);else if(void 0===(u=I(t,a))&&!A(t,a)||!B(c,u,r,n)){if(r.strict)return!1;if(!O(e,t,a,c,r,n))return!1;o||(o=new S),T(o,a)}if(o){for(;(s=d.next())&&!s.done;)if(a=s.value[0],u=s.value[1],a&&"object"==typeof a){if(!P(o,e,a,u,r,n))return!1}else if(!(r.strict||e.has(a)&&B(I(e,a),u,r,n)||P(o,e,a,u,g({},r,{strict:!1}),n)))return!1;return 0===D(o)}return!0}(e,t,r,s);return!0}(e,t,l,d)}function x(e){return!(!e||"object"!=typeof e||"number"!=typeof e.length)&&("function"==typeof e.copy&&"function"==typeof e.slice&&(!(e.length>0&&"number"!=typeof e[0])&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))))}e.exports=function(e,t,r){return B(e,t,r,y())}},8393:(e,t,r)=>{"use strict";var n=r(2680),i="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),s=Object.prototype.toString,o=Array.prototype.concat,a=Object.defineProperty,c=r(1491)(),u=a&&c,h=function(e,t,r,n){var i;(!(t in e)||"function"==typeof(i=n)&&"[object Function]"===s.call(i)&&n())&&(u?a(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},d=function(e,t){var r=arguments.length>2?arguments[2]:{},s=n(t);i&&(s=o.call(s,Object.getOwnPropertySymbols(t)));for(var a=0;a<s.length;a+=1)h(e,s[a],t[s[a]],r[s[a]])};d.supportsDescriptors=!!u,e.exports=d},3532:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+e},t.toClass=function(e){switch(e.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}},5813:(e,t,r)=>{"use strict";const n=r(4300).Buffer,i=r(7108),s=r(3219),o=r(1599),a=r(3532),c=r(8395),u=r(2296),h=32768,d=t.name={};d.encode=function(e,t,r){t||(t=n.alloc(d.encodingLength(e))),r||(r=0);const i=r,s=e.replace(/^\.|\.$/gm,"");if(s.length){const e=s.split(".");for(let n=0;n<e.length;n++){const i=t.write(e[n],r+1);t[r]=i,r+=i+1}}return t[r++]=0,d.encode.bytes=r-i,t},d.encode.bytes=0,d.decode=function(e,t){t||(t=0);const r=[];let n=t,i=0,s=0,o=!1;for(;;){if(t>=e.length)throw new Error("Cannot decode name (buffer overflow)");const a=e[t++];if(s+=o?0:1,0===a)break;if(0==(192&a)){if(t+a>e.length)throw new Error("Cannot decode name (buffer overflow)");if(i+=a+1,i>254)throw new Error("Cannot decode name (name too long)");r.push(e.toString("utf-8",t,t+a)),t+=a,s+=o?0:a}else{if(192!=(192&a))throw new Error("Cannot decode name (bad label)");{if(t+1>e.length)throw new Error("Cannot decode name (buffer overflow)");const r=e.readUInt16BE(t-1)-49152;if(r>=n)throw new Error("Cannot decode name (bad pointer)");t=r,n=r,s+=o?0:1,o=!0}}}return d.decode.bytes=s,0===r.length?".":r.join(".")},d.decode.bytes=0,d.encodingLength=function(e){return"."===e||".."===e?1:n.byteLength(e.replace(/^\.|\.$/gm,""))+2};const l={encode:function(e,t,r){t||(t=n.alloc(l.encodingLength(e))),r||(r=0);const i=t.write(e,r+1);return t[r]=i,l.encode.bytes=i+1,t}};l.encode.bytes=0,l.decode=function(e,t){t||(t=0);const r=e[t],n=e.toString("utf-8",t+1,t+1+r);return l.decode.bytes=r+1,n},l.decode.bytes=0,l.encodingLength=function(e){return n.byteLength(e)+1};const f={encode:function(e,t,r){t||(t=f.encodingLength(e)),r||(r=0);const n=32767&(e.flags||0),i="response"===e.type?32768:0;return t.writeUInt16BE(e.id||0,r),t.writeUInt16BE(n|i,r+2),t.writeUInt16BE(e.questions.length,r+4),t.writeUInt16BE(e.answers.length,r+6),t.writeUInt16BE(e.authorities.length,r+8),t.writeUInt16BE(e.additionals.length,r+10),t}};f.encode.bytes=12,f.decode=function(e,t){if(t||(t=0),e.length<12)throw new Error("Header must be 12 bytes");const r=e.readUInt16BE(t+2);return{id:e.readUInt16BE(t),type:32768&r?"response":"query",flags:32767&r,flag_qr:1==(r>>15&1),opcode:o.toString(r>>11&15),flag_aa:1==(r>>10&1),flag_tc:1==(r>>9&1),flag_rd:1==(r>>8&1),flag_ra:1==(r>>7&1),flag_z:1==(r>>6&1),flag_ad:1==(r>>5&1),flag_cd:1==(r>>4&1),rcode:s.toString(15&r),questions:new Array(e.readUInt16BE(t+4)),answers:new Array(e.readUInt16BE(t+6)),authorities:new Array(e.readUInt16BE(t+8)),additionals:new Array(e.readUInt16BE(t+10))}},f.decode.bytes=12,f.encodingLength=function(){return 12};const p=t.unknown={};p.encode=function(e,t,r){return t||(t=n.alloc(p.encodingLength(e))),r||(r=0),t.writeUInt16BE(e.length,r),e.copy(t,r+2),p.encode.bytes=e.length+2,t},p.encode.bytes=0,p.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),n=e.slice(t+2,t+2+r);return p.decode.bytes=r+2,n},p.decode.bytes=0,p.encodingLength=function(e){return e.length+2};const y=t.ns={};y.encode=function(e,t,r){return t||(t=n.alloc(y.encodingLength(e))),r||(r=0),d.encode(e,t,r+2),t.writeUInt16BE(d.encode.bytes,r),y.encode.bytes=d.encode.bytes+2,t},y.encode.bytes=0,y.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),n=d.decode(e,t+2);return y.decode.bytes=r+2,n},y.decode.bytes=0,y.encodingLength=function(e){return d.encodingLength(e)+2};const m=t.soa={};m.encode=function(e,t,r){t||(t=n.alloc(m.encodingLength(e))),r||(r=0);const i=r;return r+=2,d.encode(e.mname,t,r),r+=d.encode.bytes,d.encode(e.rname,t,r),r+=d.encode.bytes,t.writeUInt32BE(e.serial||0,r),r+=4,t.writeUInt32BE(e.refresh||0,r),r+=4,t.writeUInt32BE(e.retry||0,r),r+=4,t.writeUInt32BE(e.expire||0,r),r+=4,t.writeUInt32BE(e.minimum||0,r),r+=4,t.writeUInt16BE(r-i-2,i),m.encode.bytes=r-i,t},m.encode.bytes=0,m.decode=function(e,t){t||(t=0);const r=t,n={};return t+=2,n.mname=d.decode(e,t),t+=d.decode.bytes,n.rname=d.decode(e,t),t+=d.decode.bytes,n.serial=e.readUInt32BE(t),t+=4,n.refresh=e.readUInt32BE(t),t+=4,n.retry=e.readUInt32BE(t),t+=4,n.expire=e.readUInt32BE(t),t+=4,n.minimum=e.readUInt32BE(t),t+=4,m.decode.bytes=t-r,n},m.decode.bytes=0,m.encodingLength=function(e){return 22+d.encodingLength(e.mname)+d.encodingLength(e.rname)};const g=t.txt={};g.encode=function(e,t,r){Array.isArray(e)||(e=[e]);for(let t=0;t<e.length;t++)if("string"==typeof e[t]&&(e[t]=n.from(e[t])),!n.isBuffer(e[t]))throw new Error("Must be a Buffer");t||(t=n.alloc(g.encodingLength(e))),r||(r=0);const i=r;return r+=2,e.forEach((function(e){t[r++]=e.length,e.copy(t,r,0,e.length),r+=e.length})),t.writeUInt16BE(r-i-2,i),g.encode.bytes=r-i,t},g.encode.bytes=0,g.decode=function(e,t){t||(t=0);const r=t;let n=e.readUInt16BE(t);t+=2;let i=[];for(;n>0;){const r=e[t++];if(--n,n<r)throw new Error("Buffer overflow");i.push(e.slice(t,t+r)),t+=r,n-=r}return g.decode.bytes=t-r,i},g.decode.bytes=0,g.encodingLength=function(e){Array.isArray(e)||(e=[e]);let t=2;return e.forEach((function(e){t+="string"==typeof e?n.byteLength(e)+1:e.length+1})),t};const v=t.null={};v.encode=function(e,t,r){t||(t=n.alloc(v.encodingLength(e))),r||(r=0),"string"==typeof e&&(e=n.from(e)),e||(e=n.alloc(0));const i=r;r+=2;const s=e.length;return e.copy(t,r,0,s),r+=s,t.writeUInt16BE(r-i-2,i),v.encode.bytes=r-i,t},v.encode.bytes=0,v.decode=function(e,t){t||(t=0);const r=t,n=e.readUInt16BE(t);t+=2;const i=e.slice(t,t+n);return t+=n,v.decode.bytes=t-r,i},v.decode.bytes=0,v.encodingLength=function(e){return e?(n.isBuffer(e)?e.length:n.byteLength(e))+2:2};const b=t.hinfo={};b.encode=function(e,t,r){t||(t=n.alloc(b.encodingLength(e))),r||(r=0);const i=r;return r+=2,l.encode(e.cpu,t,r),r+=l.encode.bytes,l.encode(e.os,t,r),r+=l.encode.bytes,t.writeUInt16BE(r-i-2,i),b.encode.bytes=r-i,t},b.encode.bytes=0,b.decode=function(e,t){t||(t=0);const r=t,n={};return t+=2,n.cpu=l.decode(e,t),t+=l.decode.bytes,n.os=l.decode(e,t),t+=l.decode.bytes,b.decode.bytes=t-r,n},b.decode.bytes=0,b.encodingLength=function(e){return l.encodingLength(e.cpu)+l.encodingLength(e.os)+2};const E=t.ptr={},S=t.cname=E,A=t.dname=E;E.encode=function(e,t,r){return t||(t=n.alloc(E.encodingLength(e))),r||(r=0),d.encode(e,t,r+2),t.writeUInt16BE(d.encode.bytes,r),E.encode.bytes=d.encode.bytes+2,t},E.encode.bytes=0,E.decode=function(e,t){t||(t=0);const r=d.decode(e,t+2);return E.decode.bytes=d.decode.bytes+2,r},E.decode.bytes=0,E.encodingLength=function(e){return d.encodingLength(e)+2};const I=t.srv={};I.encode=function(e,t,r){t||(t=n.alloc(I.encodingLength(e))),r||(r=0),t.writeUInt16BE(e.priority||0,r+2),t.writeUInt16BE(e.weight||0,r+4),t.writeUInt16BE(e.port||0,r+6),d.encode(e.target,t,r+8);const i=d.encode.bytes+6;return t.writeUInt16BE(i,r),I.encode.bytes=i+2,t},I.encode.bytes=0,I.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),n={};return n.priority=e.readUInt16BE(t+2),n.weight=e.readUInt16BE(t+4),n.port=e.readUInt16BE(t+6),n.target=d.decode(e,t+8),I.decode.bytes=r+2,n},I.decode.bytes=0,I.encodingLength=function(e){return 8+d.encodingLength(e.target)};const w=t.caa={};w.ISSUER_CRITICAL=128,w.encode=function(e,t,r){const i=w.encodingLength(e);return t||(t=n.alloc(w.encodingLength(e))),r||(r=0),e.issuerCritical&&(e.flags=w.ISSUER_CRITICAL),t.writeUInt16BE(i-2,r),r+=2,t.writeUInt8(e.flags||0,r),r+=1,l.encode(e.tag,t,r),r+=l.encode.bytes,t.write(e.value,r),r+=n.byteLength(e.value),w.encode.bytes=i,t},w.encode.bytes=0,w.decode=function(e,t){t||(t=0);const r=e.readUInt16BE(t),n=t+=2,i={};return i.flags=e.readUInt8(t),t+=1,i.tag=l.decode(e,t),t+=l.decode.bytes,i.value=e.toString("utf-8",t,n+r),i.issuerCritical=!!(i.flags&w.ISSUER_CRITICAL),w.decode.bytes=r+2,i},w.decode.bytes=0,w.encodingLength=function(e){return l.encodingLength(e.tag)+l.encodingLength(e.value)+2};const T=t.mx={};T.encode=function(e,t,r){t||(t=n.alloc(T.encodingLength(e))),r||(r=0);const i=r;return r+=2,t.writeUInt16BE(e.preference||0,r),r+=2,d.encode(e.exchange,t,r),r+=d.encode.bytes,t.writeUInt16BE(r-i-2,i),T.encode.bytes=r-i,t},T.encode.bytes=0,T.decode=function(e,t){t||(t=0);const r=t,n={};return t+=2,n.preference=e.readUInt16BE(t),t+=2,n.exchange=d.decode(e,t),t+=d.decode.bytes,T.decode.bytes=t-r,n},T.encodingLength=function(e){return 4+d.encodingLength(e.exchange)};const C=t.a={};C.encode=function(e,t,r){return t||(t=n.alloc(C.encodingLength(e))),r||(r=0),t.writeUInt16BE(4,r),r+=2,u.v4.encode(e,t,r),C.encode.bytes=6,t},C.encode.bytes=0,C.decode=function(e,t){t||(t=0),t+=2;const r=u.v4.decode(e,t);return C.decode.bytes=6,r},C.decode.bytes=0,C.encodingLength=function(){return 6};const _=t.aaaa={};_.encode=function(e,t,r){return t||(t=n.alloc(_.encodingLength(e))),r||(r=0),t.writeUInt16BE(16,r),r+=2,u.v6.encode(e,t,r),_.encode.bytes=18,t},_.encode.bytes=0,_.decode=function(e,t){t||(t=0),t+=2;const r=u.v6.decode(e,t);return _.decode.bytes=18,r},_.decode.bytes=0,_.encodingLength=function(){return 18};const D=t.option={};D.encode=function(e,t,r){t||(t=n.alloc(D.encodingLength(e))),r||(r=0);const i=r,s=c.toCode(e.code);if(t.writeUInt16BE(s,r),r+=2,e.data)t.writeUInt16BE(e.data.length,r),r+=2,e.data.copy(t,r),r+=e.data.length;else switch(s){case 8:const i=e.sourcePrefixLength||0,s=e.family||u.familyOf(e.ip),o=u.encode(e.ip,n.alloc),a=Math.ceil(i/8);t.writeUInt16BE(a+4,r),r+=2,t.writeUInt16BE(s,r),r+=2,t.writeUInt8(i,r++),t.writeUInt8(e.scopePrefixLength||0,r++),o.copy(t,r,0,a),r+=a;break;case 11:e.timeout?(t.writeUInt16BE(2,r),r+=2,t.writeUInt16BE(e.timeout,r),r+=2):(t.writeUInt16BE(0,r),r+=2);break;case 12:const c=e.length||0;t.writeUInt16BE(c,r),r+=2,t.fill(0,r,r+c),r+=c;break;case 14:const h=2*e.tags.length;t.writeUInt16BE(h,r),r+=2;for(const n of e.tags)t.writeUInt16BE(n,r),r+=2;break;default:throw new Error(`Unknown roption code: ${e.code}`)}return D.encode.bytes=r-i,t},D.encode.bytes=0,D.decode=function(e,t){t||(t=0);const r={};r.code=e.readUInt16BE(t),r.type=c.toString(r.code),t+=2;const i=e.readUInt16BE(t);switch(t+=2,r.data=e.slice(t,t+i),r.code){case 8:r.family=e.readUInt16BE(t),t+=2,r.sourcePrefixLength=e.readUInt8(t++),r.scopePrefixLength=e.readUInt8(t++);const s=n.alloc(1===r.family?4:16);e.copy(s,0,t,t+i-4),r.ip=u.decode(s);break;case 11:i>0&&(r.timeout=e.readUInt16BE(t),t+=2);break;case 14:r.tags=[];for(let n=0;n<i;n+=2)r.tags.push(e.readUInt16BE(t)),t+=2}return D.decode.bytes=i+4,r},D.decode.bytes=0,D.encodingLength=function(e){if(e.data)return e.data.length+4;switch(c.toCode(e.code)){case 8:const t=e.sourcePrefixLength||0;return Math.ceil(t/8)+8;case 11:return"number"==typeof e.timeout?6:4;case 12:return e.length+4;case 14:return 4+2*e.tags.length}throw new Error(`Unknown roption code: ${e.code}`)};const R=t.opt={};R.encode=function(e,t,r){t||(t=n.alloc(R.encodingLength(e))),r||(r=0);const i=r,s=H(e,D);return t.writeUInt16BE(s,r),r=j(e,D,t,r+2),R.encode.bytes=r-i,t},R.encode.bytes=0,R.decode=function(e,t){t||(t=0);const r=t,n=[];let i=e.readUInt16BE(t);t+=2;let s=0;for(;i>0;)n[s++]=D.decode(e,t),t+=D.decode.bytes,i-=D.decode.bytes;return R.decode.bytes=t-r,n},R.decode.bytes=0,R.encodingLength=function(e){return 2+H(e||[],D)};const N=t.dnskey={};N.PROTOCOL_DNSSEC=3,N.ZONE_KEY=128,N.SECURE_ENTRYPOINT=32768,N.encode=function(e,t,r){t||(t=n.alloc(N.encodingLength(e))),r||(r=0);const i=r,s=e.key;if(!n.isBuffer(s))throw new Error("Key must be a Buffer");return r+=2,t.writeUInt16BE(e.flags,r),r+=2,t.writeUInt8(N.PROTOCOL_DNSSEC,r),r+=1,t.writeUInt8(e.algorithm,r),r+=1,s.copy(t,r,0,s.length),r+=s.length,N.encode.bytes=r-i,t.writeUInt16BE(N.encode.bytes-2,i),t},N.encode.bytes=0,N.decode=function(e,t){t||(t=0);const r=t;var n={},i=e.readUInt16BE(t);if(t+=2,n.flags=e.readUInt16BE(t),t+=2,e.readUInt8(t)!==N.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return t+=1,n.algorithm=e.readUInt8(t),t+=1,n.key=e.slice(t,r+i+2),t+=n.key.length,N.decode.bytes=t-r,n},N.decode.bytes=0,N.encodingLength=function(e){return 6+n.byteLength(e.key)};const O=t.rrsig={};O.encode=function(e,t,r){t||(t=n.alloc(O.encodingLength(e))),r||(r=0);const s=r,o=e.signature;if(!n.isBuffer(o))throw new Error("Signature must be a Buffer");return r+=2,t.writeUInt16BE(i.toType(e.typeCovered),r),r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.labels,r),r+=1,t.writeUInt32BE(e.originalTTL,r),r+=4,t.writeUInt32BE(e.expiration,r),r+=4,t.writeUInt32BE(e.inception,r),r+=4,t.writeUInt16BE(e.keyTag,r),r+=2,d.encode(e.signersName,t,r),r+=d.encode.bytes,o.copy(t,r,0,o.length),r+=o.length,O.encode.bytes=r-s,t.writeUInt16BE(O.encode.bytes-2,s),t},O.encode.bytes=0,O.decode=function(e,t){t||(t=0);const r=t;var n={},s=e.readUInt16BE(t);return t+=2,n.typeCovered=i.toString(e.readUInt16BE(t)),t+=2,n.algorithm=e.readUInt8(t),t+=1,n.labels=e.readUInt8(t),t+=1,n.originalTTL=e.readUInt32BE(t),t+=4,n.expiration=e.readUInt32BE(t),t+=4,n.inception=e.readUInt32BE(t),t+=4,n.keyTag=e.readUInt16BE(t),t+=2,n.signersName=d.decode(e,t),t+=d.decode.bytes,n.signature=e.slice(t,r+s+2),t+=n.signature.length,O.decode.bytes=t-r,n},O.decode.bytes=0,O.encodingLength=function(e){return 20+d.encodingLength(e.signersName)+n.byteLength(e.signature)};const U=t.rp={};U.encode=function(e,t,r){t||(t=n.alloc(U.encodingLength(e))),r||(r=0);const i=r;return r+=2,d.encode(e.mbox||".",t,r),r+=d.encode.bytes,d.encode(e.txt||".",t,r),r+=d.encode.bytes,U.encode.bytes=r-i,t.writeUInt16BE(U.encode.bytes-2,i),t},U.encode.bytes=0,U.decode=function(e,t){t||(t=0);const r=t,n={};return t+=2,n.mbox=d.decode(e,t)||".",t+=d.decode.bytes,n.txt=d.decode(e,t)||".",t+=d.decode.bytes,U.decode.bytes=t-r,n},U.decode.bytes=0,U.encodingLength=function(e){return 2+d.encodingLength(e.mbox||".")+d.encodingLength(e.txt||".")};const P={encode:function(e,t,r){t||(t=n.alloc(P.encodingLength(e))),r||(r=0);const s=r;for(var o=[],a=0;a<e.length;a++){var c=i.toType(e[a]);void 0===o[c>>8]&&(o[c>>8]=[]),o[c>>8][c>>3&31]|=1<<7-(7&c)}for(a=0;a<o.length;a++)if(void 0!==o[a]){var u=n.from(o[a]);t.writeUInt8(a,r),r+=1,t.writeUInt8(u.length,r),r+=1,u.copy(t,r),r+=u.length}return P.encode.bytes=r-s,t}};P.encode.bytes=0,P.decode=function(e,t,r){t||(t=0);const n=t;for(var s=[];t-n<r;){var o=e.readUInt8(t);t+=1;var a=e.readUInt8(t);t+=1;for(var c=0;c<a;c++)for(var u=e.readUInt8(t+c),h=0;h<8;h++)if(u&1<<7-h){var d=i.toString(o<<8|c<<3|h);s.push(d)}t+=a}return P.decode.bytes=t-n,s},P.decode.bytes=0,P.encodingLength=function(e){for(var t=[],r=0;r<e.length;r++){var n=i.toType(e[r]);t[n>>8]=Math.max(t[n>>8]||0,255&n)}var s=0;for(r=0;r<t.length;r++)void 0!==t[r]&&(s+=2+Math.ceil((t[r]+1)/8));return s};const B=t.nsec={};B.encode=function(e,t,r){t||(t=n.alloc(B.encodingLength(e))),r||(r=0);const i=r;return r+=2,d.encode(e.nextDomain,t,r),r+=d.encode.bytes,P.encode(e.rrtypes,t,r),r+=P.encode.bytes,B.encode.bytes=r-i,t.writeUInt16BE(B.encode.bytes-2,i),t},B.encode.bytes=0,B.decode=function(e,t){t||(t=0);const r=t;var n={},i=e.readUInt16BE(t);return t+=2,n.nextDomain=d.decode(e,t),t+=d.decode.bytes,n.rrtypes=P.decode(e,t,i-(t-r)),t+=P.decode.bytes,B.decode.bytes=t-r,n},B.decode.bytes=0,B.encodingLength=function(e){return 2+d.encodingLength(e.nextDomain)+P.encodingLength(e.rrtypes)};const x=t.nsec3={};x.encode=function(e,t,r){t||(t=n.alloc(x.encodingLength(e))),r||(r=0);const i=r,s=e.salt;if(!n.isBuffer(s))throw new Error("salt must be a Buffer");const o=e.nextDomain;if(!n.isBuffer(o))throw new Error("nextDomain must be a Buffer");return r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.flags,r),r+=1,t.writeUInt16BE(e.iterations,r),r+=2,t.writeUInt8(s.length,r),r+=1,s.copy(t,r,0,s.length),r+=s.length,t.writeUInt8(o.length,r),r+=1,o.copy(t,r,0,o.length),r+=o.length,P.encode(e.rrtypes,t,r),r+=P.encode.bytes,x.encode.bytes=r-i,t.writeUInt16BE(x.encode.bytes-2,i),t},x.encode.bytes=0,x.decode=function(e,t){t||(t=0);const r=t;var n={},i=e.readUInt16BE(t);t+=2,n.algorithm=e.readUInt8(t),t+=1,n.flags=e.readUInt8(t),t+=1,n.iterations=e.readUInt16BE(t),t+=2;const s=e.readUInt8(t);t+=1,n.salt=e.slice(t,t+s),t+=s;const o=e.readUInt8(t);return t+=1,n.nextDomain=e.slice(t,t+o),t+=o,n.rrtypes=P.decode(e,t,i-(t-r)),t+=P.decode.bytes,x.decode.bytes=t-r,n},x.decode.bytes=0,x.encodingLength=function(e){return 8+e.salt.length+e.nextDomain.length+P.encodingLength(e.rrtypes)};const M=t.ds={};M.encode=function(e,t,r){t||(t=n.alloc(M.encodingLength(e))),r||(r=0);const i=r,s=e.digest;if(!n.isBuffer(s))throw new Error("Digest must be a Buffer");return r+=2,t.writeUInt16BE(e.keyTag,r),r+=2,t.writeUInt8(e.algorithm,r),r+=1,t.writeUInt8(e.digestType,r),r+=1,s.copy(t,r,0,s.length),r+=s.length,M.encode.bytes=r-i,t.writeUInt16BE(M.encode.bytes-2,i),t},M.encode.bytes=0,M.decode=function(e,t){t||(t=0);const r=t;var n={},i=e.readUInt16BE(t);return t+=2,n.keyTag=e.readUInt16BE(t),t+=2,n.algorithm=e.readUInt8(t),t+=1,n.digestType=e.readUInt8(t),t+=1,n.digest=e.slice(t,r+i+2),t+=n.digest.length,M.decode.bytes=t-r,n},M.decode.bytes=0,M.encodingLength=function(e){return 6+n.byteLength(e.digest)};const L=t.sshfp={};L.getFingerprintLengthForHashType=function(e){switch(e){case 1:return 20;case 2:return 32}},L.encode=function(e,t,r){t||(t=n.alloc(L.encodingLength(e))),r||(r=0);const i=r;t[r+=2]=e.algorithm,t[r+=1]=e.hash,r+=1;const s=n.from(e.fingerprint.toUpperCase(),"hex");if(s.length!==L.getFingerprintLengthForHashType(e.hash))throw new Error("Invalid fingerprint length");return s.copy(t,r),r+=s.byteLength,L.encode.bytes=r-i,t.writeUInt16BE(L.encode.bytes-2,i),t},L.encode.bytes=0,L.decode=function(e,t){t||(t=0);const r=t,n={};t+=2,n.algorithm=e[t],t+=1,n.hash=e[t],t+=1;const i=L.getFingerprintLengthForHashType(n.hash);return n.fingerprint=e.slice(t,t+i).toString("hex").toUpperCase(),t+=i,L.decode.bytes=t-r,n},L.decode.bytes=0,L.encodingLength=function(e){return 4+n.from(e.fingerprint,"hex").byteLength};const k=t.record=function(e){switch(e.toUpperCase()){case"A":return C;case"PTR":return E;case"CNAME":return S;case"DNAME":return A;case"TXT":return g;case"NULL":return v;case"AAAA":return _;case"SRV":return I;case"HINFO":return b;case"CAA":return w;case"NS":return y;case"SOA":return m;case"MX":return T;case"OPT":return R;case"DNSKEY":return N;case"RRSIG":return O;case"RP":return U;case"NSEC":return B;case"NSEC3":return x;case"SSHFP":return L;case"DS":return M}return p},F=t.answer={};F.encode=function(e,t,r){t||(t=n.alloc(F.encodingLength(e))),r||(r=0);const s=r;if(d.encode(e.name,t,r),r+=d.encode.bytes,t.writeUInt16BE(i.toType(e.type),r),"OPT"===e.type.toUpperCase()){if("."!==e.name)throw new Error("OPT name must be root.");t.writeUInt16BE(e.udpPayloadSize||4096,r+2),t.writeUInt8(e.extendedRcode||0,r+4),t.writeUInt8(e.ednsVersion||0,r+5),t.writeUInt16BE(e.flags||0,r+6),r+=8,R.encode(e.options||[],t,r),r+=R.encode.bytes}else{let n=a.toClass(void 0===e.class?"IN":e.class);e.flush&&(n|=h),t.writeUInt16BE(n,r+2),t.writeUInt32BE(e.ttl||0,r+4),r+=8;const i=k(e.type);i.encode(e.data,t,r),r+=i.encode.bytes}return F.encode.bytes=r-s,t},F.encode.bytes=0,F.decode=function(e,t){t||(t=0);const r={},n=t;if(r.name=d.decode(e,t),t+=d.decode.bytes,r.type=i.toString(e.readUInt16BE(t)),"OPT"===r.type)r.udpPayloadSize=e.readUInt16BE(t+2),r.extendedRcode=e.readUInt8(t+4),r.ednsVersion=e.readUInt8(t+5),r.flags=e.readUInt16BE(t+6),r.flag_do=1==(r.flags>>15&1),r.options=R.decode(e,t+8),t+=8+R.decode.bytes;else{const n=e.readUInt16BE(t+2);r.ttl=e.readUInt32BE(t+4),r.class=a.toString(-32769&n),r.flush=!!(n&h);const i=k(r.type);r.data=i.decode(e,t+8),t+=8+i.decode.bytes}return F.decode.bytes=t-n,r},F.decode.bytes=0,F.encodingLength=function(e){const t=null!==e.data&&void 0!==e.data?e.data:e.options;return d.encodingLength(e.name)+8+k(e.type).encodingLength(t)};const V=t.question={};function H(e,t){let r=0;for(let n=0;n<e.length;n++)r+=t.encodingLength(e[n]);return r}function j(e,t,r,n){for(let i=0;i<e.length;i++)t.encode(e[i],r,n),n+=t.encode.bytes;return n}function K(e,t,r,n){for(let i=0;i<e.length;i++)e[i]=t.decode(r,n),n+=t.decode.bytes;return n}V.encode=function(e,t,r){t||(t=n.alloc(V.encodingLength(e))),r||(r=0);const s=r;return d.encode(e.name,t,r),r+=d.encode.bytes,t.writeUInt16BE(i.toType(e.type),r),r+=2,t.writeUInt16BE(a.toClass(void 0===e.class?"IN":e.class),r),r+=2,V.encode.bytes=r-s,e},V.encode.bytes=0,V.decode=function(e,t){t||(t=0);const r=t,n={};n.name=d.decode(e,t),t+=d.decode.bytes,n.type=i.toString(e.readUInt16BE(t)),t+=2,n.class=a.toString(e.readUInt16BE(t)),t+=2;return!!(32768&n.class)&&(n.class&=-32769),V.decode.bytes=t-r,n},V.decode.bytes=0,V.encodingLength=function(e){return d.encodingLength(e.name)+4},t.AUTHORITATIVE_ANSWER=1024,t.TRUNCATED_RESPONSE=512,t.RECURSION_DESIRED=256,t.RECURSION_AVAILABLE=128,t.AUTHENTIC_DATA=32,t.CHECKING_DISABLED=16,t.DNSSEC_OK=32768,t.encode=function(e,r,i){const s=!r;s&&(r=n.alloc(t.encodingLength(e))),i||(i=0);const o=i;return e.questions||(e.questions=[]),e.answers||(e.answers=[]),e.authorities||(e.authorities=[]),e.additionals||(e.additionals=[]),f.encode(e,r,i),i+=f.encode.bytes,i=j(e.questions,V,r,i),i=j(e.answers,F,r,i),i=j(e.authorities,F,r,i),i=j(e.additionals,F,r,i),t.encode.bytes=i-o,s&&t.encode.bytes!==r.length?r.slice(0,t.encode.bytes):r},t.encode.bytes=0,t.decode=function(e,r){r||(r=0);const n=r,i=f.decode(e,r);return r+=f.decode.bytes,r=K(i.questions,V,e,r),r=K(i.answers,F,e,r),r=K(i.authorities,F,e,r),r=K(i.additionals,F,e,r),t.decode.bytes=r-n,i},t.decode.bytes=0,t.encodingLength=function(e){return f.encodingLength(e)+H(e.questions||[],V)+H(e.answers||[],F)+H(e.authorities||[],F)+H(e.additionals||[],F)},t.streamEncode=function(e){const r=t.encode(e),i=n.alloc(2);i.writeUInt16BE(r.byteLength);const s=n.concat([i,r]);return t.streamEncode.bytes=s.byteLength,s},t.streamEncode.bytes=0,t.streamDecode=function(e){const r=e.readUInt16BE(0);if(e.byteLength<r+2)return null;const n=t.decode(e.slice(2));return t.streamDecode.bytes=t.decode.bytes,n},t.streamDecode.bytes=0},1599:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+e},t.toOpcode=function(e){switch(e.toUpperCase()){case"QUERY":return 0;case"IQUERY":return 1;case"STATUS":return 2;case"OPCODE_3":return 3;case"NOTIFY":return 4;case"UPDATE":return 5;case"OPCODE_6":return 6;case"OPCODE_7":return 7;case"OPCODE_8":return 8;case"OPCODE_9":return 9;case"OPCODE_10":return 10;case"OPCODE_11":return 11;case"OPCODE_12":return 12;case"OPCODE_13":return 13;case"OPCODE_14":return 14;case"OPCODE_15":return 15}return 0}},8395:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return e<0?null:`OPTION_${e}`},t.toCode=function(e){if("number"==typeof e)return e;if(!e)return-1;switch(e.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}const t=e.match(/_(\d+)$/);return t?parseInt(t[1],10):-1}},3219:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+e},t.toRcode=function(e){switch(e.toUpperCase()){case"NOERROR":return 0;case"FORMERR":return 1;case"SERVFAIL":return 2;case"NXDOMAIN":return 3;case"NOTIMP":return 4;case"REFUSED":return 5;case"YXDOMAIN":return 6;case"YXRRSET":return 7;case"NXRRSET":return 8;case"NOTAUTH":return 9;case"NOTZONE":return 10;case"RCODE_11":return 11;case"RCODE_12":return 12;case"RCODE_13":return 13;case"RCODE_14":return 14;case"RCODE_15":return 15}return 0}},7108:(e,t)=>{"use strict";t.toString=function(e){switch(e){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+e},t.toType=function(e){switch(e.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":case"*":return 255}return e.toUpperCase().startsWith("UNKNOWN_")?parseInt(e.slice(8)):0}},7517:(e,t,r)=>{var n=r(2781),i=["write","end","destroy"],s=["resume","pause"],o=["data","close"],a=Array.prototype.slice;function c(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r)}e.exports=function(e,t){var r=new n,u=!1;return c(i,(function(t){function n(){return e[t].apply(e,arguments)}r[t]=n})),c(s,(function(e){function n(){r.emit(e);var n=t[e];if(n)return n.apply(t,arguments);t.emit(e)}r[e]=n})),c(o,(function(e){function n(){var t=a.call(arguments);t.unshift(e),r.emit.apply(r,t)}t.on(e,n)})),t.on("end",(function(){if(u)return;u=!0;var e=a.call(arguments);e.unshift("end"),r.emit.apply(r,e)})),e.on("drain",(function(){r.emit("drain")})),e.on("error",h),t.on("error",h),r.writable=e.writable,r.readable=t.readable,r;function h(e){r.emit("error",e)}}},9776:(e,t,r)=>{var n=r(2781).Stream,i=t,s=r(1290),o=r(2454),a=r(7517),c=r(9873),u=r(8122),h=r(8677),d=r(5965),l=global.setImmediate||process.nextTick;i.Stream=n,i.through=s,i.from=o,i.duplex=a,i.map=c,i.pause=u,i.split=h,i.pipeline=i.connect=i.pipe=d,i.concat=i.merge=function(){var e=[].slice.call(arguments);1===e.length&&e[0]instanceof Array&&(e=e[0]);var t=new n;t.setMaxListeners(0);var r=0;return t.writable=t.readable=!0,e.length?e.forEach((function(n){n.pipe(t,{end:!1});var i=!1;n.on("end",(function(){i||(i=!0,++r==e.length&&t.emit("end"))}))})):process.nextTick((function(){t.emit("end")})),t.write=function(e){this.emit("data",e)},t.destroy=function(){e.forEach((function(e){e.destroy&&e.destroy()}))},t},i.collect=i.writeArray=function(e){if("function"!=typeof e)throw new Error("function writeArray (done): done must be function");var t=new n,r=[],i=!1;return t.write=function(e){r.push(e)},t.end=function(){i=!0,e(null,r)},t.writable=!0,t.readable=!1,t.destroy=function(){t.writable=t.readable=!1,i||e(new Error("destroyed before end"),r)},t},i.readArray=function(e){var t=new n,r=0,i=!1,s=!1;if(t.readable=!0,t.writable=!1,!Array.isArray(e))throw new Error("event-stream.read expects an array");return t.resume=function(){if(!s){i=!1;for(var n=e.length;r<n&&!i&&!s;)t.emit("data",e[r++]);r!=n||s||(s=!0,t.readable=!1,t.emit("end"))}},process.nextTick(t.resume),t.pause=function(){i=!0},t.destroy=function(){s=!0,t.emit("close")},t},i.readable=function(e,t){var r=new n,i=0,s=!1,o=!1,a=!1;if(r.readable=!0,r.writable=!1,"function"!=typeof e)throw new Error("event-stream.readable expects async function");function c(n,u){n?(r.emit("error",n),t||r.emit("end")):arguments.length>1&&r.emit("data",u),l((function(){if(!(o||s||a))try{a=!0,e.call(r,i++,(function(){a=!1,c.apply(null,arguments)}))}catch(e){r.emit("error",e)}}))}return r.on("end",(function(){o=!0})),r.resume=function(){s=!1,c()},process.nextTick(c),r.pause=function(){s=!0},r.destroy=function(){r.emit("end"),r.emit("close"),o=!0},r},i.mapSync=function(e){return i.through((function(t){var r;try{r=e(t)}catch(e){return this.emit("error",e)}void 0!==r&&this.emit("data",r)}))},i.filterSync=function(e){return i.through((function(t){e(t)&&this.queue(t)}))},i.flatmapSync=function(e){return i.through((function(t){var r=this;t.forEach((function(t){r.queue(e(t))}))}))},i.log=function(e){return i.through((function(t){[].slice.call(arguments);e?console.error(e,t):console.error(t),this.emit("data",t)}))},i.child=function(e){return i.duplex(e.stdin,e.stdout)},i.parse=function(e){var t=!(!e||!e.error);return i.through((function(e){var r;try{e&&(r=JSON.parse(e.toString()))}catch(r){return t?this.emit("error",r):console.error(r,"attempting to parse:",e)}void 0!==r&&this.emit("data",r)}))},i.stringify=function(){var e=r(4300).Buffer;return i.mapSync((function(t){return JSON.stringify(e.isBuffer(t)?t.toString():t)+"\n"}))},i.replace=function(e,t){return i.pipeline(i.split(e),i.join(t))},i.join=function(e){if("function"==typeof e)return i.wait(e);var t=!0;return i.through((function(r){return t||this.emit("data",e),t=!1,this.emit("data",r),!0}))},i.wait=function(e){var t=[];return i.through((function(e){t.push(e)}),(function(){var r=Buffer.isBuffer(t[0])?Buffer.concat(t):t.join("");this.emit("data",r),this.emit("end"),e&&e(null,r)}))},i.pipeable=function(){throw new Error("[EVENT-STREAM] es.pipeable is deprecated")}},5011:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,s;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,s[i]))return!1;for(i=n;0!=i--;){var o=s[i];if(!e(t[o],r[o]))return!1}return!0}return t!=t&&r!=r}},9152:(e,t,r)=>{var n=r(6113);function i(e,t){null!=e&&("number"==typeof e?this.fromNumber(e,t):Buffer.isBuffer(e)?this.fromBuffer(e):null==t&&"string"!=typeof e?this.fromByteArray(e):this.fromString(e,t))}function s(){return new i(null)}i.prototype.am=function(e,t,r,n,i,s){for(var o=16383&t,a=t>>14;--s>=0;){var c=16383&this[e],u=this[e++]>>14,h=a*c+u*o;i=((c=o*c+((16383&h)<<14)+r[n]+i)>>28)+(h>>14)+a*u,r[n++]=268435455&c}return i},i.prototype.DB=28,i.prototype.DM=268435455,i.prototype.DV=1<<28;i.prototype.FV=Math.pow(2,52),i.prototype.F1=24,i.prototype.F2=4;var o,a,c=new Array;for(o="0".charCodeAt(0),a=0;a<=9;++a)c[o++]=a;for(o="a".charCodeAt(0),a=10;a<36;++a)c[o++]=a;for(o="A".charCodeAt(0),a=10;a<36;++a)c[o++]=a;function u(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function h(e,t){var r=c[e.charCodeAt(t)];return null==r?-1:r}function d(e){var t=s();return t.fromInt(e),t}function l(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function f(e){this.m=e}function p(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function y(e,t){return e&t}function m(e,t){return e|t}function g(e,t){return e^t}function v(e,t){return e&~t}function b(e){if(0===e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function E(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function S(){}function A(e){return e}function I(e){this.r2=s(),this.q3=s(),i.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}f.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},f.prototype.revert=function(e){return e},f.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},f.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},f.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},p.prototype.convert=function(e){var t=s();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(i.ZERO)>0&&this.m.subTo(t,t),t},p.prototype.revert=function(e){var t=s();return e.copyTo(t),this.reduce(t),t},p.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],n=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,n,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},p.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},p.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},S.prototype.convert=A,S.prototype.revert=A,S.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},S.prototype.sqrTo=function(e,t){e.squareTo(t)},I.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=s();return e.copyTo(t),this.reduce(t),t},I.prototype.revert=function(e){return e},I.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},I.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},I.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var w=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],T=(1<<26)/w[w.length-1];i.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},i.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+DV:this.t=0},i.prototype.fromString=function(e,t,r){var n;switch(t){case 2:n=1;break;case 4:n=2;break;case 8:n=3;break;case 16:n=4;break;case 32:n=5;break;case 256:n=8;break;default:return void this.fromRadix(e,t)}this.t=0,this.s=0;for(var s=e.length,o=!1,a=0;--s>=0;){var c=8==n?255&e[s]:h(e,s);c<0?"-"==e.charAt(s)&&(o=!0):(o=!1,0===a?this[this.t++]=c:a+n>this.DB?(this[this.t-1]|=(c&(1<<this.DB-a)-1)<<a,this[this.t++]=c>>this.DB-a):this[this.t-1]|=c<<a,(a+=n)>=this.DB&&(a-=this.DB))}r||8!=n||0==(128&e[0])||(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),o&&i.ZERO.subTo(this,this)},i.prototype.fromByteArray=function(e,t){this.fromString(e,256,t)},i.prototype.fromBuffer=function(e){this.fromString(e,256,!0)},i.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},i.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},i.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},i.prototype.lShiftTo=function(e,t){var r,n=e%this.DB,i=this.DB-n,s=(1<<i)-1,o=Math.floor(e/this.DB),a=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)t[r+o+1]=this[r]>>i|a,a=(this[r]&s)<<n;for(r=o-1;r>=0;--r)t[r]=0;t[o]=a,t.t=this.t+o+1,t.s=this.s,t.clamp()},i.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t[0]=this[r]>>n;for(var o=r+1;o<this.t;++o)t[o-r-1]|=(this[o]&s)<<i,t[o-r]=this[o]>>n;n>0&&(t[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}},i.prototype.subTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]-e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e[r],t[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t[r++]=this.DV+n:n>0&&(t[r++]=n),t.t=r,t.clamp()},i.prototype.multiplyTo=function(e,t){var r=this.abs(),n=e.abs(),s=r.t;for(t.t=s+n.t;--s>=0;)t[s]=0;for(s=0;s<n.t;++s)t[s+r.t]=r.am(0,n[s],t,s,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&i.ZERO.subTo(t,t)},i.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},i.prototype.divRemTo=function(e,t,r){var n=e.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t)return null!=t&&t.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=s());var a=s(),c=this.s,u=e.s,h=this.DB-l(n[n.t-1]);h>0?(n.lShiftTo(h,a),o.lShiftTo(h,r)):(n.copyTo(a),o.copyTo(r));var d=a.t,f=a[d-1];if(0!==f){var p=f*(1<<this.F1)+(d>1?a[d-2]>>this.F2:0),y=this.FV/p,m=(1<<this.F1)/p,g=1<<this.F2,v=r.t,b=v-d,E=null==t?s():t;for(a.dlShiftTo(b,E),r.compareTo(E)>=0&&(r[r.t++]=1,r.subTo(E,r)),i.ONE.dlShiftTo(d,E),E.subTo(a,a);a.t<d;)a[a.t++]=0;for(;--b>=0;){var S=r[--v]==f?this.DM:Math.floor(r[v]*y+(r[v-1]+g)*m);if((r[v]+=a.am(0,S,r,b,0,d))<S)for(a.dlShiftTo(b,E),r.subTo(E,r);r[v]<--S;)r.subTo(E,r)}null!=t&&(r.drShiftTo(d,t),c!=u&&i.ZERO.subTo(t,t)),r.t=d,r.clamp(),h>0&&r.rShiftTo(h,r),c<0&&i.ZERO.subTo(r,r)}}},i.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},i.prototype.isEven=function(){return 0===(this.t>0?1&this[0]:this.s)},i.prototype.exp=function(e,t){if(e>4294967295||e<1)return i.ONE;var r=s(),n=s(),o=t.convert(this),a=l(e)-1;for(o.copyTo(r);--a>=0;)if(t.sqrTo(r,n),(e&1<<a)>0)t.mulTo(n,o,r);else{var c=r;r=n,n=c}return t.revert(r)},i.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},i.prototype.toRadix=function(e){if(null==e&&(e=10),0===this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=d(r),i=s(),o=s(),a="";for(this.divRemTo(n,i,o);i.signum()>0;)a=(r+o.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,o);return o.intValue().toString(e)+a},i.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),s=!1,o=0,a=0,c=0;c<e.length;++c){var u=h(e,c);u<0?"-"==e.charAt(c)&&0===this.signum()&&(s=!0):(a=t*a+u,++o>=r&&(this.dMultiply(n),this.dAddOffset(a,0),o=0,a=0))}o>0&&(this.dMultiply(Math.pow(t,o)),this.dAddOffset(a,0)),s&&i.ZERO.subTo(this,this)},i.prototype.fromNumber=function(e,t){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e),this.testBit(e-1)||this.bitwiseTo(i.ONE.shiftLeft(e-1),m,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(i.ONE.shiftLeft(e-1),this);else{var r=n.randomBytes(1+(e>>3)),s=7&e;s>0?r[0]&=(1<<s)-1:r[0]=0,this.fromByteArray(r)}},i.prototype.bitwiseTo=function(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r[n]=t(this[n],e[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r[n]=t(this[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r[n]=t(i,e[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},i.prototype.changeBit=function(e,t){var r=i.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r},i.prototype.addTo=function(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this[r]+e[r],t[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this[r],t[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e[r],t[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t[r++]=n:n<-1&&(t[r++]=this.DV+n),t.t=r,t.clamp()},i.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},i.prototype.dAddOffset=function(e,t){if(0!==e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},i.prototype.multiplyLowerTo=function(e,t,r){var n,i=Math.min(this.t+e.t,t);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(n=r.t-this.t;i<n;++i)r[i+this.t]=this.am(0,e[i],r,i,0,this.t);for(n=Math.min(e.t,t);i<n;++i)this.am(0,e[i],r,i,0,t-i);r.clamp()},i.prototype.multiplyUpperTo=function(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r[this.t+n-t]=this.am(t-n,e[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)},i.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0===t)r=this[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this[n])%e;return r},i.prototype.millerRabin=function(e){var t=this.subtract(i.ONE),r=t.getLowestSetBit();if(r<=0)return!1;var n=t.shiftRight(r);(e=e+1>>1)>w.length&&(e=w.length);for(var o=s(),a=0;a<e;++a){o.fromInt(w[Math.floor(Math.random()*w.length)]);var c=o.modPow(n,this);if(0!=c.compareTo(i.ONE)&&0!=c.compareTo(t)){for(var u=1;u++<r&&0!=c.compareTo(t);)if(0===(c=c.modPowInt(2,this)).compareTo(i.ONE))return!1;if(0!=c.compareTo(t))return!1}}return!0},i.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,n=(1<<t)-1,i=!1,s="",o=this.t,a=this.DB-o*this.DB%t;if(o-- >0)for(a<this.DB&&(r=this[o]>>a)>0&&(i=!0,s=u(r));o>=0;)a<t?(r=(this[o]&(1<<a)-1)<<t-a,r|=this[--o]>>(a+=this.DB-t)):(r=this[o]>>(a-=t)&n,a<=0&&(a+=this.DB,--o)),r>0&&(i=!0),i&&(s+=u(r));return 16==e&&s.length%2!=0&&(s="0"+s),i?s:"0"},i.prototype.negate=function(){var e=s();return i.ZERO.subTo(this,e),e},i.prototype.abs=function(){return this.s<0?this.negate():this},i.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},i.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+l(this[this.t-1]^this.s&this.DM)},i.prototype.mod=function(e){var t=s();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(i.ZERO)>0&&e.subTo(t,t),t},i.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new f(t):new p(t),this.exp(e,r)},i.prototype.clone=function(){var e=s();return this.copyTo(e),e},i.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0===this.t)return-1}else{if(1==this.t)return this[0];if(0===this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},i.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},i.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},i.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},i.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,n=this.DB-e*this.DB%8,i=0;if(e-- >0)for(n<this.DB&&(r=this[e]>>n)!=(this.s&this.DM)>>n&&(t[i++]=r|this.s<<this.DB-n);e>=0;)n<8?(r=(this[e]&(1<<n)-1)<<8-n,r|=this[--e]>>(n+=this.DB-8)):(r=this[e]>>(n-=8)&255,n<=0&&(n+=this.DB,--e)),0!=(128&r)&&(r|=-256),0===i&&(128&this.s)!=(128&r)&&++i,(i>0||r!=this.s)&&(t[i++]=r);return t},i.prototype.toBuffer=function(e){var t=Buffer.from(this.toByteArray());if(!0===e&&0===t[0])t=t.slice(1);else if("number"==typeof e){if(t.length>e){for(var r=0;r<t.length-e;r++)if(0!==t[r])return null;return t.slice(t.length-e)}if(t.length<e){var n=Buffer.alloc(e);return n.fill(0,0,e-t.length),t.copy(n,e-t.length),n}}return t},i.prototype.equals=function(e){return 0==this.compareTo(e)},i.prototype.eq=function(e){return console.log(this.compareTo(e)),0==this.compareTo(e)},i.prototype.gt=function(e){return this.compareTo(e)>0},i.prototype.gte=function(e){return this.compareTo(e)>=0},i.prototype.lt=function(e){return this.compareTo(e)<0},i.prototype.lte=function(e){return this.compareTo(e)<=0},i.prototype.min=function(e){return this.compareTo(e)<0?this:e},i.prototype.max=function(e){return this.compareTo(e)>0?this:e},i.prototype.and=function(e){var t=s();return this.bitwiseTo(e,y,t),t},i.prototype.or=function(e){var t=s();return this.bitwiseTo(e,m,t),t},i.prototype.xor=function(e){var t=s();return this.bitwiseTo(e,g,t),t},i.prototype.andNot=function(e){var t=s();return this.bitwiseTo(e,v,t),t},i.prototype.not=function(){for(var e=s(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},i.prototype.shiftLeft=function(e){var t=s();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},i.prototype.shiftRight=function(e){var t=s();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},i.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+b(this[e]);return this.s<0?this.t*this.DB:-1},i.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=E(this[r]^t);return e},i.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},i.prototype.setBit=function(e){return this.changeBit(e,m)},i.prototype.clearBit=function(e){return this.changeBit(e,v)},i.prototype.flipBit=function(e){return this.changeBit(e,g)},i.prototype.add=function(e){var t=s();return this.addTo(e,t),t},i.prototype.subtract=function(e){var t=s();return this.subTo(e,t),t},i.prototype.multiply=function(e){var t=s();return this.multiplyTo(e,t),t},i.prototype.divide=function(e){var t=s();return this.divRemTo(e,t,null),t},i.prototype.remainder=function(e){var t=s();return this.divRemTo(e,null,t),t},i.prototype.divideAndRemainder=function(e){var t=s(),r=s();return this.divRemTo(e,t,r),new Array(t,r)},i.prototype.modPow=function(e,t){var r,n,i=e.bitLength(),o=d(1);if(i<=0)return o;r=i<18?1:i<48?3:i<144?4:i<768?5:6,n=i<8?new f(t):t.isEven()?new I(t):new p(t);var a=new Array,c=3,u=r-1,h=(1<<r)-1;if(a[1]=n.convert(this),r>1){var y=s();for(n.sqrTo(a[1],y);c<=h;)a[c]=s(),n.mulTo(y,a[c-2],a[c]),c+=2}var m,g,v=e.t-1,b=!0,E=s();for(i=l(e[v])-1;v>=0;){for(i>=u?m=e[v]>>i-u&h:(m=(e[v]&(1<<i+1)-1)<<u-i,v>0&&(m|=e[v-1]>>this.DB+i-u)),c=r;0==(1&m);)m>>=1,--c;if((i-=c)<0&&(i+=this.DB,--v),b)a[m].copyTo(o),b=!1;else{for(;c>1;)n.sqrTo(o,E),n.sqrTo(E,o),c-=2;c>0?n.sqrTo(o,E):(g=o,o=E,E=g),n.mulTo(E,a[m],o)}for(;v>=0&&0==(e[v]&1<<i);)n.sqrTo(o,E),g=o,o=E,E=g,--i<0&&(i=this.DB-1,--v)}return n.revert(o)},i.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0===e.signum())return i.ZERO;for(var r=e.clone(),n=this.clone(),s=d(1),o=d(0),a=d(0),c=d(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),t?(s.isEven()&&o.isEven()||(s.addTo(this,s),o.subTo(e,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&c.isEven()||(a.addTo(this,a),c.subTo(e,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(e,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),t&&s.subTo(a,s),o.subTo(c,o)):(n.subTo(r,n),t&&a.subTo(s,a),c.subTo(o,c))}return 0!=n.compareTo(i.ONE)?i.ZERO:c.compareTo(e)>=0?c.subtract(e):c.signum()<0?(c.addTo(e,c),c.signum()<0?c.add(e):c):c},i.prototype.pow=function(e){return this.exp(e,new S)},i.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r},i.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=w[w.length-1]){for(t=0;t<w.length;++t)if(r[0]==w[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<w.length;){for(var n=w[t],i=t+1;i<w.length&&n<T;)n*=w[i++];for(n=r.modInt(n);t<i;)if(n%w[t++]==0)return!1}return r.millerRabin(e)},i.int2char=u,i.ZERO=d(0),i.ONE=d(1),i.prototype.square=function(){var e=s();return this.squareTo(e),e},e.exports=i},7678:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.params=t.hex=void 0;const n=r(9152);function i(e){return new n(e.split(/\s|\n/).join(""),16)}t.hex=i,t.params={1024:{N_length_bits:1024,N:i("\n      EEAF0AB9 ADB38DD6 9C33F80A FA8FC5E8 60726187 75FF3C0B 9EA2314C\n      9C256576 D674DF74 96EA81D3 383B4813 D692C6E0 E0D5D8E2 50B98BE4\n      8E495C1D 6089DAD1 5DC7D7B4 6154D6B6 CE8EF4AD 69B15D49 82559B29\n      7BCF1885 C529F566 660E57EC 68EDBC3C 05726CC0 2FD4CBF4 976EAA9A\n      FD5138FE 8376435B 9FC61D2F C0EB06E3\n    "),g:i("02"),hash:"sha1"},1536:{N_length_bits:1536,N:i("\n      9DEF3CAF B939277A B1F12A86 17A47BBB DBA51DF4 99AC4C80 BEEEA961\n      4B19CC4D 5F4F5F55 6E27CBDE 51C6A94B E4607A29 1558903B A0D0F843\n      80B655BB 9A22E8DC DF028A7C EC67F0D0 8134B1C8 B9798914 9B609E0B\n      E3BAB63D 47548381 DBC5B1FC 764E3F4B 53DD9DA1 158BFD3E 2B9C8CF5\n      6EDF0195 39349627 DB2FD53D 24B7C486 65772E43 7D6C7F8C E442734A\n      F7CCB7AE 837C264A E3A9BEB8 7F8A2FE9 B8B5292E 5A021FFF 5E91479E\n      8CE7A28C 2442C6F3 15180F93 499A234D CF76E3FE D135F9BB\n    "),g:i("02"),hash:"sha1"},2048:{N_length_bits:2048,N:i("\n      AC6BDB41 324A9A9B F166DE5E 1389582F AF72B665 1987EE07 FC319294\n      3DB56050 A37329CB B4A099ED 8193E075 7767A13D D52312AB 4B03310D\n      CD7F48A9 DA04FD50 E8083969 EDB767B0 CF609517 9A163AB3 661A05FB\n      D5FAAAE8 2918A996 2F0B93B8 55F97993 EC975EEA A80D740A DBF4FF74\n      7359D041 D5C33EA7 1D281E44 6B14773B CA97B43A 23FB8016 76BD207A\n      436C6481 F1D2B907 8717461A 5B9D32E6 88F87748 544523B5 24B0D57D\n      5EA77A27 75D2ECFA 032CFBDB F52FB378 61602790 04E57AE6 AF874E73\n      03CE5329 9CCC041C 7BC308D8 2A5698F3 A8D0C382 71AE35F8 E9DBFBB6\n      94B5C803 D89F7AE4 35DE236D 525F5475 9B65E372 FCD68EF2 0FA7111F\n      9E4AFF73\n    "),g:i("02"),hash:"sha256"},3072:{N_length_bits:3072,N:i("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF\n    "),g:i("05"),hash:"sha256"},hap:{N_length_bits:3072,N:i("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A93AD2CA FFFFFFFF FFFFFFFF\n    "),g:i("05"),hash:"sha512"},4096:{N_length_bits:4096,N:i("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34063199\n      FFFFFFFF FFFFFFFF\n    "),g:i("05"),hash:"sha256"},6244:{N_length_bits:6244,N:i("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492\n      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406\n      AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918\n      DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151\n      2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03\n      F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F\n      BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA\n      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B\n      B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632\n      387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E\n      6DCC4024 FFFFFFFF FFFFFFFF\n    "),g:i("05"),hash:"sha256"},8192:{N_length_bits:8192,N:i("\n      FFFFFFFF FFFFFFFF C90FDAA2 2168C234 C4C6628B 80DC1CD1 29024E08\n      8A67CC74 020BBEA6 3B139B22 514A0879 8E3404DD EF9519B3 CD3A431B\n      302B0A6D F25F1437 4FE1356D 6D51C245 E485B576 625E7EC6 F44C42E9\n      A637ED6B 0BFF5CB6 F406B7ED EE386BFB 5A899FA5 AE9F2411 7C4B1FE6\n      49286651 ECE45B3D C2007CB8 A163BF05 98DA4836 1C55D39A 69163FA8\n      FD24CF5F 83655D23 DCA3AD96 1C62F356 208552BB 9ED52907 7096966D\n      670C354E 4ABC9804 F1746C08 CA18217C 32905E46 2E36CE3B E39E772C\n      180E8603 9B2783A2 EC07A28F B5C55DF0 6F4C52C9 DE2BCBF6 95581718\n      3995497C EA956AE5 15D22618 98FA0510 15728E5A 8AAAC42D AD33170D\n      04507A33 A85521AB DF1CBA64 ECFB8504 58DBEF0A 8AEA7157 5D060C7D\n      B3970F85 A6E1E4C7 ABF5AE8C DB0933D7 1E8C94E0 4A25619D CEE3D226\n      1AD2EE6B F12FFA06 D98A0864 D8760273 3EC86A64 521F2B18 177B200C\n      BBE11757 7A615D6C 770988C0 BAD946E2 08E24FA0 74E5AB31 43DB5BFC\n      E0FD108E 4B82D120 A9210801 1A723C12 A787E6D7 88719A10 BDBA5B26\n      99C32718 6AF4E23C 1A946834 B6150BDA 2583E9CA 2AD44CE8 DBBBC2DB\n      04DE8EF9 2E8EFC14 1FBECAA6 287C5947 4E6BC05D 99B2964F A090C3A2\n      233BA186 515BE7ED 1F612970 CEE2D7AF B81BDD76 2170481C D0069127\n      D5B05AA9 93B4EA98 8D8FDDC1 86FFB7DC 90A6C08F 4DF435C9 34028492\n      36C3FAB4 D27C7026 C1D4DCB2 602646DE C9751E76 3DBA37BD F8FF9406\n      AD9E530E E5DB382F 413001AE B06A53ED 9027D831 179727B0 865A8918\n      DA3EDBEB CF9B14ED 44CE6CBA CED4BB1B DB7F1447 E6CC254B 33205151\n      2BD7AF42 6FB8F401 378CD2BF 5983CA01 C64B92EC F032EA15 D1721D03\n      F482D7CE 6E74FEF6 D55E702F 46980C82 B5A84031 900B1C9E 59E7C97F\n      BEC7E8F3 23A97A7E 36CC88BE 0F1D45B7 FF585AC5 4BD407B2 2B4154AA\n      CC8F6D7E BF48E1D8 14CC5ED2 0F8037E0 A79715EE F29BE328 06A1D58B\n      B7C5DA76 F550AA3D 8A1FBFF0 EB19CCB1 A313D55C DA56C9EC 2EF29632\n      387FE8D7 6E3C0468 043E8F66 3F4860EE 12BF2D5B 0B7474D6 E694F91E\n      6DBE1159 74A3926F 12FEE5E4 38777CB6 A932DF8C D8BEC4D0 73B931BA\n      3BC832B6 8D9DD300 741FA7BF 8AFC47ED 2576F693 6BA42466 3AAB639C\n      5AE4F568 3423B474 2BF1C978 238F16CB E39D652D E3FDB8BE FC848AD9\n      22222E04 A4037C07 13EB57A8 1A23F0C7 3473FC64 6CEA306B 4BCBC886\n      2F8385DD FA9D4B7F A2C087E8 79683303 ED5BDD3A 062B3CF5 B3A278A6\n      6D2A13F8 3F44F82D DF310EE0 74AB6A36 4597E899 A0255DC1 64F31CC5\n      0846851D F9AB4819 5DED7EA1 B1D510BD 7EE74D73 FAF36BC3 1ECFA268\n      359046F4 EB879F92 4009438B 481C6CD7 889A002E D5EE382B C9190DA6\n      FC026E47 9558E447 5677E9AA 9E3050E2 765694DF C81F56E8 80B96E71\n      60C980DD 98EDD3DF FFFFFFFF FFFFFFFF\n    "),g:i("13"),hash:"sha256"}},t.default=t.params},6957:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SrpServer=t.SrpClient=t.SRP=void 0;const i=n(r(6113)),s=n(r(9491)),o=r(9152),a=r(7678),c=new o(0,10);function u(e,t){if(!e)throw new Error(t||"assertion")}function h(e,t="arg"){u(Buffer.isBuffer(e),`Type error: ${t} must be a buffer`)}function d(e,t="arg"){u(e instanceof o,`Type error: ${t} must be a BigInteger`)}function l(e,t){h(e,"n");const r=t-e.length;u(r>-1,"Negative padding.  Very uncomfortable.");const n=Buffer.alloc(t);return n.fill(0,0,r),e.copy(n,r),s.default.strictEqual(n.length,t),n}function f(e,t){d(e);const r=e.toString(16).length%2!=0?"0"+e.toString(16):e.toString(16);return l(Buffer.from(r,"hex"),t.N_length_bits/8)}function p(e,t,r,n){h(t,"salt (salt)"),h(r,"identity (I)"),h(n,"password (P)");const s=i.default.createHash(e.hash).update(Buffer.concat([r,Buffer.from(":"),n])).digest(),a=i.default.createHash(e.hash).update(t).update(s).digest();return new o(a)}class y{static computeVerifier(e,t,r,n){h(t,"salt (salt)"),h(r,"identity (I)"),h(n,"password (P)");return e.g.modPow(p(e,t,r,n),e.N).toBuffer(e.N_length_bits/8)}static genKey(e=32,t){if("number"!=typeof e&&(t=e,e=32),!t)return new Promise(((t,r)=>y.genKey(e,((e,n)=>e?r(e):t(n)))));i.default.randomBytes(e,((e,r)=>e?t(e,null):t(null,r)))}}function m(e){const t=i.default.createHash(e.hash).update(f(e.N,e)).update(f(e.g,e)).digest();return new o(t)}function g(e,t,r){h(t,"A"),h(r,"B");const n=i.default.createHash(e.hash).update(l(t,e.N_length_bits/8)).update(l(r,e.N_length_bits/8)).digest();return new o(n)}function v(e,t){return h(t,"S"),"sha1"===e.hash?Buffer.concat([i.default.createHash(e.hash).update(t).update(Buffer.from([0,0,0,0])).digest(),i.default.createHash(e.hash).update(t).update(Buffer.from([0,0,0,1])).digest()]):i.default.createHash(e.hash).update(t).digest()}function b(e,t,r,n,s,o){if(arguments.length>4){h(t,"identity (I)"),h(r,"salt (s)"),h(n,"client public key (A)"),h(s,"server public key (B)"),h(o,"session key (K)");const a=i.default.createHash(e.hash).update(e.N.toBuffer(!0)).digest(),c=i.default.createHash(e.hash).update(e.g.toBuffer(!0)).digest();for(let e=0;e<a.length;e++)a[e]^=c[e];const u=i.default.createHash(e.hash).update(t).digest();return i.default.createHash(e.hash).update(a).update(u).update(r).update(n).update(s).update(o).digest()}return[n,s,r]=[t,r,n],h(n,"A"),h(s,"B"),h(r,"S"),i.default.createHash(e.hash).update(n).update(s).update(r).digest()}function E(e,t,r,n){return h(t,"A"),h(r,"M1"),h(n,"K"),i.default.createHash(e.hash).update(t).update(r).update(n).digest()}function S(e,t){return e.toString("hex")===t.toString("hex")}t.SRP=y,y.params=a.params;t.SrpClient=class{constructor(e,t,r,n,i,s=!0){h(t,"salt (s)"),h(r,"identity (I)"),h(n,"password (P)"),h(i,"secret1"),this._params=e,this._k=m(e),this._x=p(e,t,r,n),this._a=new o(i),s&&(this._I=r,this._s=t),this._A=function(e,t){return d(t),Math.ceil(t.toString(16).length/2)<32&&console.warn("getA: client key length %d is less than the recommended 256 bits",t.bitLength()),e.g.modPow(t,e.N).toBuffer(e.N_length_bits/8)}(e,this._a)}computeA(){return this._A}setB(e){const t=g(this._params,this._A,e),r=function(e,t,r,n,i,s){if(d(t),d(r),d(n),d(i),d(s),c.compareTo(i)>=0||e.N.compareTo(i)<=0)throw new Error('invalid server-supplied "B", must be 1..N-1');return i.subtract(t.multiply(e.g.modPow(r,e.N))).modPow(n.add(s.multiply(r)),e.N).mod(e.N).toBuffer(e.N_length_bits/8)}(this._params,this._k,this._x,this._a,new o(e),t);this._K=v(this._params,r),this._u=t,this._S=r,this._B=e,this._I&&this._s?this._M1=b(this._params,this._I,this._s,this._A,this._B,this._K):this._M1=b(this._params,this._A,this._B,this._S),this._M2=E(this._params,this._A,this._M1,this._K)}computeM1(){if(void 0===this._M1)throw new Error("incomplete protocol");return this._M1}checkM2(e){if(!S(this._M2,e))throw new Error("server is not authentic")}computeK(){if(void 0===this._K)throw new Error("incomplete protocol");return this._K}};t.SrpServer=class{constructor(e,t,r,n,i){if(this._params=e,this._k=m(e),arguments.length>3)h(t,"salt (salt)"),h(r,"identity (I)"),h(n,"password (P)"),h(i,"secret2"),this._b=new o(i),this._v=new o(y.computeVerifier(e,t,r,n)),this._I=r,this._s=t;else if(t instanceof Buffer){const e=t;[i,t,r,n]=[r,void 0,void 0,void 0],h(e,"verifier (v)"),h(i,"secret2"),this._b=new o(i),this._v=new o(e)}else{const a=t;[i,t,r,n]=[r,void 0,void 0,void 0],(0,s.default)(a.username instanceof Buffer||"string"==typeof a.username,"identity.username (I) must be a string or Buffer"),h(a.salt,"identity.salt (s)"),(0,s.default)("password"in a||"verifier"in a,"identity requires a password or verifier"),"verifier"in a?h(a.verifier,"identity.verifier (v)"):(0,s.default)(a.password instanceof Buffer||"string"==typeof a.password,"identity.password (p) must be a string or Buffer"),h(i,"secret2");const c="string"==typeof a.username?Buffer.from(a.username):a.username;this._b=new o(i),this._v=new o("verifier"in a?a.verifier:y.computeVerifier(e,a.salt,c,"string"==typeof a.password?Buffer.from(a.password):a.password)),this._I=c,this._s=a.salt}this._B=function(e,t,r,n){return d(r),d(t),d(n),t.multiply(r).add(e.g.modPow(n,e.N)).mod(e.N).toBuffer(e.N_length_bits/8)}(e,this._k,this._v,this._b)}computeB(){return this._B}setA(e){const t=g(this._params,e,this._B),r=function(e,t,r,n,i){if(d(t),d(r),d(n),d(i),c.compareTo(r)>=0||e.N.compareTo(r)<=0)throw new Error('invalid client-supplied "A", must be 1..N-1');return r.multiply(t.modPow(i,e.N)).modPow(n,e.N).mod(e.N).toBuffer(e.N_length_bits/8)}(this._params,this._v,new o(e),this._b,t);this._K=v(this._params,r),this._u=t,this._S=r,this._I&&this._s?this._M1=b(this._params,this._I,this._s,e,this._B,this._K):this._M1=b(this._params,e,this._B,this._S),this._M2=E(this._params,e,this._M1,this._K)}checkM1(e){if(void 0===this._M1)throw new Error("incomplete protocol");if(!S(this._M1,e))throw new Error("client did not use the same password")}computeK(){if(void 0===this._K)throw new Error("incomplete protocol");return this._K}computeM2(){if(void 0===this._M2)throw new Error("incomplete protocol");return this._M2}}},2040:(e,t,r)=>{"use strict";var n=r(6521),i=Object.prototype.toString,s=Object.prototype.hasOwnProperty,o=function(e,t,r){for(var n=0,i=e.length;n<i;n++)s.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))},a=function(e,t,r){for(var n=0,i=e.length;n<i;n++)null==r?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)},c=function(e,t,r){for(var n in e)s.call(e,n)&&(null==r?t(e[n],n,e):t.call(r,e[n],n,e))};e.exports=function(e,t,r){if(!n(t))throw new TypeError("iterator must be a function");var s;arguments.length>=3&&(s=r),"[object Array]"===i.call(e)?o(e,t,s):"string"==typeof e?a(e,t,s):c(e,t,s)}},2454:(e,t,r)=>{"use strict";var n=r(2781);e.exports=function e(t){if(Array.isArray(t)){var r=0,i=t.length;return e((function(e){return r<i?this.emit("data",t[r++]):this.emit("end"),!0}))}var s=new n,o=0;function a(){if(s.started=!0,!s.ended)for(;!s.ended&&!s.paused&&t.call(s,o++,(function(){s.ended||s.paused||process.nextTick(a)})););}return s.ended=!1,s.started=!1,s.readable=!0,s.writable=!1,s.paused=!1,s.ended=!1,s.pause=function(){s.started=!0,s.paused=!0},s.resume=function(){s.started=!0,s.paused=!1,a()},s.on("end",(function(){s.ended=!0,s.readable=!1,process.nextTick(s.destroy)})),s.destroy=function(){s.ended=!0,s.emit("close")},process.nextTick((function(){s.started||s.resume()})),s}},3623:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,i="[object Function]";e.exports=function(e){var s=this;if("function"!=typeof s||n.call(s)!==i)throw new TypeError(t+s);for(var o,a=r.call(arguments,1),c=function(){if(this instanceof o){var t=s.apply(this,a.concat(r.call(arguments)));return Object(t)===t?t:this}return s.apply(e,a.concat(r.call(arguments)))},u=Math.max(0,s.length-a.length),h=[],d=0;d<u;d++)h.push("$"+d);if(o=Function("binder","return function ("+h.join(",")+"){ return binder.apply(this,arguments); }")(c),s.prototype){var l=function(){};l.prototype=s.prototype,o.prototype=new l,l.prototype=null}return o}},8689:(e,t,r)=>{"use strict";var n=r(3623);e.exports=Function.prototype.bind||n},1075:e=>{"use strict";var t=function(){return"string"==typeof function(){}.name},r=Object.getOwnPropertyDescriptor;if(r)try{r([],"length")}catch(e){r=null}t.functionsHaveConfigurableNames=function(){if(!t()||!r)return!1;var e=r((function(){}),"name");return!!e&&!!e.configurable};var n=Function.prototype.bind;t.boundFunctionsHaveNames=function(){return t()&&"function"==typeof n&&""!==function(){}.bind().name},e.exports=t},5962:(e,t,r)=>{"use strict";const{Buffer:n}=r(4300),{createHash:i,createHmac:s}=r(6113),o={},a=e=>{switch(e){case"sha256":case"sha3-256":case"blake2s256":return 32;case"sha512":case"sha3-512":case"blake2b512":return 64;case"sha224":case"sha3-224":return 28;case"sha384":case"sha3-384":return 48;case"sha1":return 20;case"md5":return 16;default:{let t=o[e];return void 0===t&&(t=i(e).digest().length,o[e]=t),t}}},c=(e,t,r,i)=>{const o=n.isBuffer(r)?r:n.from(r),a=i&&i.length?n.from(i):n.alloc(t,0);return s(e,a).update(o).digest()},u=(e,t,r,i,o)=>{const a=n.isBuffer(o)?o:n.from(o||""),c=a.length,u=Math.ceil(i/t);if(u>255)throw new Error(`OKM length ${i} is too long for ${e} hash`);const h=n.alloc(t*u+c+1);for(let n=1,i=0,o=0;n<=u;++n)a.copy(h,o),h[o+c]=n,s(e,r).update(h.slice(i,o+c+1)).digest().copy(h,o),i=o,o+=t;return h.slice(0,i)};function h(e,t,{salt:r="",info:n="",hash:i="SHA-256"}={}){i=i.toLowerCase().replace("-","");const s=a(i),o=c(i,s,e,r);return u(i,s,o,t,n)}Object.defineProperties(h,{hash_length:{configurable:!1,enumerable:!1,writable:!1,value:a},extract:{configurable:!1,enumerable:!1,writable:!1,value:c},expand:{configurable:!1,enumerable:!1,writable:!1,value:u}}),e.exports=h},49:(e,t,r)=>{"use strict";var n,i=SyntaxError,s=Function,o=TypeError,a=function(e){try{return s('"use strict"; return ('+e+").constructor;")()}catch(e){}},c=Object.getOwnPropertyDescriptor;if(c)try{c({},"")}catch(e){c=null}var u=function(){throw new o},h=c?function(){try{return u}catch(e){try{return c(arguments,"callee").get}catch(e){return u}}}():u,d=r(7651)(),l=Object.getPrototypeOf||function(e){return e.__proto__},f={},p="undefined"==typeof Uint8Array?n:l(Uint8Array),y={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":d?l([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":f,"%AsyncGenerator%":f,"%AsyncGeneratorFunction%":f,"%AsyncIteratorPrototype%":f,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":s,"%GeneratorFunction%":f,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":d?l(l([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&d?l((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&d?l((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":d?l(""[Symbol.iterator]()):n,"%Symbol%":d?Symbol:n,"%SyntaxError%":i,"%ThrowTypeError%":h,"%TypedArray%":p,"%TypeError%":o,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},m=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(r=l(i.prototype))}return y[t]=r,r},g={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},v=r(8689),b=r(203),E=v.call(Function.call,Array.prototype.concat),S=v.call(Function.apply,Array.prototype.splice),A=v.call(Function.call,String.prototype.replace),I=v.call(Function.call,String.prototype.slice),w=v.call(Function.call,RegExp.prototype.exec),T=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,C=/\\(\\)?/g,_=function(e){var t=I(e,0,1),r=I(e,-1);if("%"===t&&"%"!==r)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var n=[];return A(e,T,(function(e,t,r,i){n[n.length]=r?A(i,C,"$1"):t||e})),n},D=function(e,t){var r,n=e;if(b(g,n)&&(n="%"+(r=g[n])[0]+"%"),b(y,n)){var s=y[n];if(s===f&&(s=m(n)),void 0===s&&!t)throw new o("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:s}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new o('"allowMissing" argument must be a boolean');if(null===w(/^%?[^%]*%?$/g,e))throw new i("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=_(e),n=r.length>0?r[0]:"",s=D("%"+n+"%",t),a=s.name,u=s.value,h=!1,d=s.alias;d&&(n=d[0],S(r,E([0,1],d)));for(var l=1,f=!0;l<r.length;l+=1){var p=r[l],m=I(p,0,1),g=I(p,-1);if(('"'===m||"'"===m||"`"===m||'"'===g||"'"===g||"`"===g)&&m!==g)throw new i("property names with quotes must have matching quotes");if("constructor"!==p&&f||(h=!0),b(y,a="%"+(n+="."+p)+"%"))u=y[a];else if(null!=u){if(!(p in u)){if(!t)throw new o("base intrinsic for "+e+" exists, but the property is not available.");return}if(c&&l+1>=r.length){var v=c(u,p);u=(f=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:u[p]}else f=b(u,p),u=u[p];f&&!h&&(y[a]=u)}}return u}},5212:e=>{"use strict";var t="undefined"!=typeof BigInt&&BigInt;e.exports=function(){return"function"==typeof t&&"function"==typeof BigInt&&"bigint"==typeof t(42)&&"bigint"==typeof BigInt(42)}},7831:e=>{"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return-1!==n&&(-1===i||n<i)}},1491:(e,t,r)=>{"use strict";var n=r(49)("%Object.defineProperty%",!0),i=function(){if(n)try{return n({},"a",{value:1}),!0}catch(e){return!1}return!1};i.hasArrayLengthDefineBug=function(){if(!i())return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=i},7651:(e,t,r)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,i=r(5139);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},5139:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},1375:(e,t,r)=>{"use strict";var n=r(5139);e.exports=function(){return n()&&!!Symbol.toStringTag}},203:(e,t,r)=>{"use strict";var n=r(8689);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},7440:(e,t,r)=>{"use strict";var n=r(1375)(),i=r(6610)("Object.prototype.toString"),s=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},o=function(e){return!!s(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},a=function(){return s(arguments)}();s.isLegacyArguments=o,e.exports=a?s:o},5386:(e,t,r)=>{"use strict";if(r(5212)()){var n=BigInt.prototype.valueOf;e.exports=function(e){return null!=e&&"boolean"!=typeof e&&"string"!=typeof e&&"number"!=typeof e&&"symbol"!=typeof e&&"function"!=typeof e&&("bigint"==typeof e||function(e){try{return n.call(e),!0}catch(e){}return!1}(e))}}else e.exports=function(e){return!1}},6181:(e,t,r)=>{"use strict";var n=r(6610),i=n("Boolean.prototype.toString"),s=n("Object.prototype.toString"),o=r(1375)();e.exports=function(e){return"boolean"==typeof e||null!==e&&"object"==typeof e&&(o&&Symbol.toStringTag in e?function(e){try{return i(e),!0}catch(e){return!1}}(e):"[object Boolean]"===s(e))}},6521:e=>{"use strict";var t,r,n=Function.prototype.toString,i="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof i&&"function"==typeof Object.defineProperty)try{t=Object.defineProperty({},"length",{get:function(){throw r}}),r={},i((function(){throw 42}),null,t)}catch(e){e!==r&&(i=null)}else i=null;var s=/^\s*class\b/,o=function(e){try{var t=n.call(e);return s.test(t)}catch(e){return!1}},a=Object.prototype.toString,c="function"==typeof Symbol&&!!Symbol.toStringTag,u="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};e.exports=i?function(e){if(e===u)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{i(e,null,t)}catch(e){if(e!==r)return!1}return!o(e)}:function(e){if(e===u)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(c)return function(e){try{return!o(e)&&(n.call(e),!0)}catch(e){return!1}}(e);if(o(e))return!1;var t=a.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}},6319:(e,t,r)=>{"use strict";var n=Date.prototype.getDay,i=Object.prototype.toString,s=r(1375)();e.exports=function(e){return"object"==typeof e&&null!==e&&(s?function(e){try{return n.call(e),!0}catch(e){return!1}}(e):"[object Date]"===i.call(e))}},6603:e=>{"use strict";var t,r="function"==typeof Map&&Map.prototype?Map:null,n="function"==typeof Set&&Set.prototype?Set:null;r||(t=function(e){return!1});var i=r?Map.prototype.has:null,s=n?Set.prototype.has:null;t||i||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(i.call(e),s)try{s.call(e)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},8627:(e,t,r)=>{"use strict";var n=Number.prototype.toString,i=Object.prototype.toString,s=r(1375)();e.exports=function(e){return"number"==typeof e||"object"==typeof e&&(s?function(e){try{return n.call(e),!0}catch(e){return!1}}(e):"[object Number]"===i.call(e))}},3688:(e,t,r)=>{"use strict";var n,i,s,o,a=r(6610),c=r(1375)();if(c){n=a("Object.prototype.hasOwnProperty"),i=a("RegExp.prototype.exec"),s={};var u=function(){throw s};o={toString:u,valueOf:u},"symbol"==typeof Symbol.toPrimitive&&(o[Symbol.toPrimitive]=u)}var h=a("Object.prototype.toString"),d=Object.getOwnPropertyDescriptor;e.exports=c?function(e){if(!e||"object"!=typeof e)return!1;var t=d(e,"lastIndex");if(!(t&&n(t,"value")))return!1;try{i(e,o)}catch(e){return e===s}}:function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"[object RegExp]"===h(e)}},5638:e=>{"use strict";var t,r="function"==typeof Map&&Map.prototype?Map:null,n="function"==typeof Set&&Set.prototype?Set:null;n||(t=function(e){return!1});var i=r?Map.prototype.has:null,s=n?Set.prototype.has:null;t||s||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(s.call(e),i)try{i.call(e)}catch(e){return!0}return e instanceof n}catch(e){}return!1}},8811:(e,t,r)=>{"use strict";var n=String.prototype.valueOf,i=Object.prototype.toString,s=r(1375)();e.exports=function(e){return"string"==typeof e||"object"==typeof e&&(s?function(e){try{return n.call(e),!0}catch(e){return!1}}(e):"[object String]"===i.call(e))}},4530:(e,t,r)=>{"use strict";var n=Object.prototype.toString;if(r(7651)()){var i=Symbol.prototype.toString,s=/^Symbol\(.*\)$/;e.exports=function(e){if("symbol"==typeof e)return!0;if("[object Symbol]"!==n.call(e))return!1;try{return function(e){return"symbol"==typeof e.valueOf()&&s.test(i.call(e))}(e)}catch(e){return!1}}}else e.exports=function(e){return!1}},6898:(e,t,r)=>{"use strict";var n=r(2040),i=r(8087),s=r(6610),o=s("Object.prototype.toString"),a=r(1375)(),c="undefined"==typeof globalThis?global:globalThis,u=i(),h=s("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},d=s("String.prototype.slice"),l={},f=r(2752),p=Object.getPrototypeOf;a&&f&&p&&n(u,(function(e){var t=new c[e];if(Symbol.toStringTag in t){var r=p(t),n=f(r,Symbol.toStringTag);if(!n){var i=p(r);n=f(i,Symbol.toStringTag)}l[e]=n.get}}));e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!a||!(Symbol.toStringTag in e)){var t=d(o(e),8,-1);return h(u,t)>-1}return!!f&&function(e){var t=!1;return n(l,(function(r,n){if(!t)try{t=r.call(e)===n}catch(e){}})),t}(e)}},1680:e=>{"use strict";var t,r="function"==typeof WeakMap&&WeakMap.prototype?WeakMap:null,n="function"==typeof WeakSet&&WeakSet.prototype?WeakSet:null;r||(t=function(e){return!1});var i=r?r.prototype.has:null,s=n?n.prototype.has:null;t||i||(t=function(e){return!1}),e.exports=t||function(e){if(!e||"object"!=typeof e)return!1;try{if(i.call(e,i),s)try{s.call(e,s)}catch(e){return!0}return e instanceof r}catch(e){}return!1}},854:(e,t,r)=>{"use strict";var n=r(49),i=r(6610),s=n("%WeakSet%",!0),o=i("WeakSet.prototype.has",!0);if(o){var a=i("WeakMap.prototype.has",!0);e.exports=function(e){if(!e||"object"!=typeof e)return!1;try{if(o(e,o),a)try{a(e,a)}catch(e){return!0}return e instanceof s}catch(e){}return!1}}else e.exports=function(e){return!1}},9394:e=>{var t={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==t.call(e)}},9873:(e,t,r)=>{var n=r(2781).Stream;e.exports=function(e,t){var r=new n,i=0,s=0,o=!1,a=!1,c=!1,u=0,h=!1,d=(t=t||{}).failures?"failure":"error",l={};function f(e,t){var n=u+1;if(t===n?(void 0!==e&&r.emit.apply(r,["data",e]),u++,n++):l[t]=e,l.hasOwnProperty(n)){var c=l[n];return delete l[n],f(c,n)}s++,i===s&&(a&&(a=!1,r.emit("drain")),o&&y())}function p(e,n,i){c||(h=!0,e&&!t.failures||f(n,i),e&&r.emit.apply(r,[d,e]),h=!1)}function y(e){if(o=!0,r.writable=!1,void 0!==e)return f(e,i);i==s&&(r.readable=!1,r.emit("end"),r.destroy())}return r.writable=!0,r.readable=!0,r.write=function(t){if(o)throw new Error("map stream is not writable");h=!1,i++;try{var r=(n=t,s=i,c=p,e.call(null,n,(function(e,t){c(e,t,s)})));return!(a=!1===r)}catch(e){if(h)throw e;return p(e),!a}var n,s,c},r.end=function(e){o||y(e)},r.destroy=function(){o=c=!0,r.writable=r.readable=a=!1,process.nextTick((function(){r.emit("close")}))},r.pause=function(){a=!0},r.resume=function(){a=!1},r}},5285:e=>{var t=1e3,r=60*t,n=60*r,i=24*n,s=7*i,o=365.25*i;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var s=Math.abs(e);if(s>=i)return a(e,s,i,"day");if(s>=n)return a(e,s,n,"hour");if(s>=r)return a(e,s,r,"minute");if(s>=t)return a(e,s,t,"second");return e+" ms"}(e):function(e){var s=Math.abs(e);if(s>=i)return Math.round(e/i)+"d";if(s>=n)return Math.round(e/n)+"h";if(s>=r)return Math.round(e/r)+"m";if(s>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},7211:(e,t)=>{var r=function(e){return"_"+e},n=function(e){return e};t.stringify=function(e){return"object"==typeof e&&e&&e.name?t.stringify(e.name,e.protocol,e.subtypes):Array.prototype.concat.apply([],arguments).filter(n).map(r).join(".")},t.parse=function(e){for(var t=e.split("."),r=0;r<t.length;r++)"_"===t[r][0]&&(t[r]=t[r].slice(1));return{name:t.shift(),protocol:t.shift()||null,subtypes:t}},t.tcp=function(e){return t.stringify(e,"tcp",Array.prototype.concat.apply([],Array.prototype.slice.call(arguments,1)))},t.udp=function(e){return t.stringify(e,"udp",Array.prototype.concat.apply([],Array.prototype.slice.call(arguments,1)))}},9695:(e,t,r)=>{var n=r(5813),i=r(1891),s=r(4735),o=r(2361),a=r(2037),c=function(){};function u(e){return 4===e||"IPv4"===e}e.exports=function(e){e||(e={});var t=new o.EventEmitter,r="number"==typeof e.port?e.port:5353,h=e.type||"udp4",d=e.ip||e.host||("udp4"===h?"224.0.0.251":null),l={address:d,port:r},f={},p=!1,y=null;if(!("udp6"!==h||d&&e.interface))throw new Error("For IPv6 multicast you must specify `ip` and `interface`");var m=e.socket||i.createSocket({type:h,reuseAddr:!1!==e.reuseAddr,toString:function(){return h}});m.on("error",(function(e){"EACCES"===e.code||"EADDRINUSE"===e.code?t.emit("error",e):t.emit("warning",e)})),m.on("message",(function(e,r){try{e=n.decode(e)}catch(e){return void t.emit("warning",e)}t.emit("packet",e,r),"query"===e.type&&t.emit("query",e,r),"response"===e.type&&t.emit("response",e,r)})),m.on("listening",(function(){r||(r=l.port=m.address().port),!1!==e.multicast&&(t.update(),y=setInterval(t.update,5e3),m.setMulticastTTL(e.ttl||255),m.setMulticastLoopback(!1!==e.loopback))}));var g=s((function(t){if(!r||!1===e.bind)return t(null);m.once("error",t),m.bind(r,e.bind||e.interface,(function(){m.removeListener("error",t),t(null)}))}));return g((function(e){if(e)return t.emit("error",e);t.emit("ready")})),t.send=function(e,r,i){if("function"==typeof r)return t.send(e,null,r);i||(i=c),r?r.host||r.address||(r.address=l.address):r=l,g((function(t){if(p)return i();if(t)return i(t);var s=n.encode(e);m.send(s,0,s.length,r.port,r.address||r.host,i)}))},t.response=t.respond=function(e,r,i){Array.isArray(e)&&(e={answers:e}),e.type="response",e.flags=(e.flags||0)|n.AUTHORITATIVE_ANSWER,t.send(e,r,i)},t.query=function(e,r,n,i){return"function"==typeof r?t.query(e,null,null,r):"object"==typeof r&&r&&r.port?t.query(e,null,r,n):"function"==typeof n?t.query(e,r,null,n):(i||(i=c),"string"==typeof e&&(e=[{name:e,type:r||"ANY"}]),Array.isArray(e)&&(e={type:"query",questions:e}),e.type="query",void t.send(e,n,i))},t.destroy=function(e){if(e||(e=c),p)return process.nextTick(e);for(var t in p=!0,clearInterval(y),f)try{m.dropMembership(d,t)}catch(e){}f={},m.close(e)},t.update=function(){for(var r=e.interface?[].concat(e.interface):function(){for(var e=a.networkInterfaces(),t=Object.keys(e),r=[],n=0;n<t.length;n++)for(var i=e[t[n]],s=0;s<i.length;s++){var o=i[s];if(u(o.family)){r.push(o.address);break}}return r}(),n=!1,i=0;i<r.length;i++){var s=r[i];if(!f[s])try{m.addMembership(d,s),f[s]=!0,n=!0}catch(e){t.emit("warning",e)}}if(n){if(m.setMulticastInterface)try{m.setMulticastInterface(e.interface||function(){for(var e=a.networkInterfaces(),t=Object.keys(e),r=0;r<t.length;r++)for(var n=e[t[r]],i=0;i<n.length;i++){var s=n[i];if(u(s.family)&&!s.internal)return"darwin"===a.platform()&&"en0"===t[r]?s.address:"0.0.0.0"}return"127.0.0.1"}())}catch(e){t.emit("warning",e)}t.emit("networkInterface")}},t}},1273:(e,t,r)=>{var n="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,s=n&&i&&"function"==typeof i.get?i.get:null,o=n&&Map.prototype.forEach,a="function"==typeof Set&&Set.prototype,c=Object.getOwnPropertyDescriptor&&a?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,u=a&&c&&"function"==typeof c.get?c.get:null,h=a&&Set.prototype.forEach,d="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,l="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,f="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,p=Boolean.prototype.valueOf,y=Object.prototype.toString,m=Function.prototype.toString,g=String.prototype.match,v=String.prototype.slice,b=String.prototype.replace,E=String.prototype.toUpperCase,S=String.prototype.toLowerCase,A=RegExp.prototype.test,I=Array.prototype.concat,w=Array.prototype.join,T=Array.prototype.slice,C=Math.floor,_="function"==typeof BigInt?BigInt.prototype.valueOf:null,D=Object.getOwnPropertySymbols,R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,N="function"==typeof Symbol&&"object"==typeof Symbol.iterator,O="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===N||"symbol")?Symbol.toStringTag:null,U=Object.prototype.propertyIsEnumerable,P=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function B(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||A.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var n=e<0?-C(-e):C(e);if(n!==e){var i=String(n),s=v.call(t,i.length+1);return b.call(i,r,"$&_")+"."+b.call(b.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return b.call(t,r,"$&_")}var x=r(8887),M=x.custom,L=j(M)?M:null;function k(e,t,r){var n="double"===(r.quoteStyle||t)?'"':"'";return n+e+n}function F(e){return b.call(String(e),/"/g,"&quot;")}function V(e){return!("[object Array]"!==G(e)||O&&"object"==typeof e&&O in e)}function H(e){return!("[object RegExp]"!==G(e)||O&&"object"==typeof e&&O in e)}function j(e){if(N)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!R)return!1;try{return R.call(e),!0}catch(e){}return!1}e.exports=function e(t,r,n,i){var a=r||{};if(q(a,"quoteStyle")&&"single"!==a.quoteStyle&&"double"!==a.quoteStyle)throw new TypeError('option "quoteStyle" must be "single" or "double"');if(q(a,"maxStringLength")&&("number"==typeof a.maxStringLength?a.maxStringLength<0&&a.maxStringLength!==1/0:null!==a.maxStringLength))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var c=!q(a,"customInspect")||a.customInspect;if("boolean"!=typeof c&&"symbol"!==c)throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(q(a,"indent")&&null!==a.indent&&"\t"!==a.indent&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(q(a,"numericSeparator")&&"boolean"!=typeof a.numericSeparator)throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var y=a.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return $(t,a);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var E=String(t);return y?B(t,E):E}if("bigint"==typeof t){var A=String(t)+"n";return y?B(t,A):A}var C=void 0===a.depth?5:a.depth;if(void 0===n&&(n=0),n>=C&&C>0&&"object"==typeof t)return V(t)?"[Array]":"[Object]";var D=function(e,t){var r;if("\t"===e.indent)r="\t";else{if(!("number"==typeof e.indent&&e.indent>0))return null;r=w.call(Array(e.indent+1)," ")}return{base:r,prev:w.call(Array(t+1),r)}}(a,n);if(void 0===i)i=[];else if(z(i,t)>=0)return"[Circular]";function M(t,r,s){if(r&&(i=T.call(i)).push(r),s){var o={depth:a.depth};return q(a,"quoteStyle")&&(o.quoteStyle=a.quoteStyle),e(t,o,n+1,i)}return e(t,a,n+1,i)}if("function"==typeof t&&!H(t)){var K=function(e){if(e.name)return e.name;var t=g.call(m.call(e),/^function\s*([\w$]+)/);if(t)return t[1];return null}(t),W=Z(t,M);return"[Function"+(K?": "+K:" (anonymous)")+"]"+(W.length>0?" { "+w.call(W,", ")+" }":"")}if(j(t)){var ee=N?b.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):R.call(t);return"object"!=typeof t||N?ee:Y(ee)}if(function(e){if(!e||"object"!=typeof e)return!1;if("undefined"!=typeof HTMLElement&&e instanceof HTMLElement)return!0;return"string"==typeof e.nodeName&&"function"==typeof e.getAttribute}(t)){for(var te="<"+S.call(String(t.nodeName)),re=t.attributes||[],ne=0;ne<re.length;ne++)te+=" "+re[ne].name+"="+k(F(re[ne].value),"double",a);return te+=">",t.childNodes&&t.childNodes.length&&(te+="..."),te+="</"+S.call(String(t.nodeName))+">"}if(V(t)){if(0===t.length)return"[]";var ie=Z(t,M);return D&&!function(e){for(var t=0;t<e.length;t++)if(z(e[t],"\n")>=0)return!1;return!0}(ie)?"["+X(ie,D)+"]":"[ "+w.call(ie,", ")+" ]"}if(function(e){return!("[object Error]"!==G(e)||O&&"object"==typeof e&&O in e)}(t)){var se=Z(t,M);return"cause"in Error.prototype||!("cause"in t)||U.call(t,"cause")?0===se.length?"["+String(t)+"]":"{ ["+String(t)+"] "+w.call(se,", ")+" }":"{ ["+String(t)+"] "+w.call(I.call("[cause]: "+M(t.cause),se),", ")+" }"}if("object"==typeof t&&c){if(L&&"function"==typeof t[L]&&x)return x(t,{depth:C-n});if("symbol"!==c&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!s||!e||"object"!=typeof e)return!1;try{s.call(e);try{u.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var oe=[];return o.call(t,(function(e,r){oe.push(M(r,t,!0)+" => "+M(e,t))})),J("Map",s.call(t),oe,D)}if(function(e){if(!u||!e||"object"!=typeof e)return!1;try{u.call(e);try{s.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var ae=[];return h.call(t,(function(e){ae.push(M(e,t))})),J("Set",u.call(t),ae,D)}if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{d.call(e,d);try{l.call(e,l)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Q("WeakMap");if(function(e){if(!l||!e||"object"!=typeof e)return!1;try{l.call(e,l);try{d.call(e,d)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Q("WeakSet");if(function(e){if(!f||!e||"object"!=typeof e)return!1;try{return f.call(e),!0}catch(e){}return!1}(t))return Q("WeakRef");if(function(e){return!("[object Number]"!==G(e)||O&&"object"==typeof e&&O in e)}(t))return Y(M(Number(t)));if(function(e){if(!e||"object"!=typeof e||!_)return!1;try{return _.call(e),!0}catch(e){}return!1}(t))return Y(M(_.call(t)));if(function(e){return!("[object Boolean]"!==G(e)||O&&"object"==typeof e&&O in e)}(t))return Y(p.call(t));if(function(e){return!("[object String]"!==G(e)||O&&"object"==typeof e&&O in e)}(t))return Y(M(String(t)));if(!function(e){return!("[object Date]"!==G(e)||O&&"object"==typeof e&&O in e)}(t)&&!H(t)){var ce=Z(t,M),ue=P?P(t)===Object.prototype:t instanceof Object||t.constructor===Object,he=t instanceof Object?"":"null prototype",de=!ue&&O&&Object(t)===t&&O in t?v.call(G(t),8,-1):he?"Object":"",le=(ue||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(de||he?"["+w.call(I.call([],de||[],he||[]),": ")+"] ":"");return 0===ce.length?le+"{}":D?le+"{"+X(ce,D)+"}":le+"{ "+w.call(ce,", ")+" }"}return String(t)};var K=Object.prototype.hasOwnProperty||function(e){return e in this};function q(e,t){return K.call(e,t)}function G(e){return y.call(e)}function z(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function $(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return $(v.call(e,0,t.maxStringLength),t)+n}return k(b.call(b.call(e,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,W),"single",t)}function W(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+E.call(t.toString(16))}function Y(e){return"Object("+e+")"}function Q(e){return e+" { ? }"}function J(e,t,r,n){return e+" ("+t+") {"+(n?X(r,n):w.call(r,", "))+"}"}function X(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+w.call(e,","+r)+"\n"+t.prev}function Z(e,t){var r=V(e),n=[];if(r){n.length=e.length;for(var i=0;i<e.length;i++)n[i]=q(e,i)?t(e[i],e):""}var s,o="function"==typeof D?D(e):[];if(N){s={};for(var a=0;a<o.length;a++)s["$"+o[a]]=o[a]}for(var c in e)q(e,c)&&(r&&String(Number(c))===c&&c<e.length||N&&s["$"+c]instanceof Symbol||(A.call(/[^\w$]/,c)?n.push(t(c,e)+": "+t(e[c],e)):n.push(c+": "+t(e[c],e))));if("function"==typeof D)for(var u=0;u<o.length;u++)U.call(e,o[u])&&n.push("["+t(o[u])+"]: "+t(e[o[u]],e));return n}},8887:(e,t,r)=>{e.exports=r(3837).inspect},5860:e=>{"use strict";var t=function(e){return e!=e};e.exports=function(e,r){return 0===e&&0===r?1/e==1/r:e===r||!(!t(e)||!t(r))}},8211:(e,t,r)=>{"use strict";var n=r(8393),i=r(2269),s=r(5860),o=r(2566),a=r(1862),c=i(o(),Object);n(c,{getPolyfill:o,implementation:s,shim:a}),e.exports=c},2566:(e,t,r)=>{"use strict";var n=r(5860);e.exports=function(){return"function"==typeof Object.is?Object.is:n}},1862:(e,t,r)=>{"use strict";var n=r(2566),i=r(8393);e.exports=function(){var e=n();return i(Object,{is:e},{is:function(){return Object.is!==e}}),e}},1782:(e,t,r)=>{"use strict";var n;if(!Object.keys){var i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=r(327),a=Object.prototype.propertyIsEnumerable,c=!a.call({toString:null},"toString"),u=a.call((function(){}),"prototype"),h=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=function(e){var t=e.constructor;return t&&t.prototype===e},l={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},f=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!l["$"+e]&&i.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{d(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(e){var t=null!==e&&"object"==typeof e,r="[object Function]"===s.call(e),n=o(e),a=t&&"[object String]"===s.call(e),l=[];if(!t&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var p=u&&r;if(a&&e.length>0&&!i.call(e,0))for(var y=0;y<e.length;++y)l.push(String(y));if(n&&e.length>0)for(var m=0;m<e.length;++m)l.push(String(m));else for(var g in e)p&&"prototype"===g||!i.call(e,g)||l.push(String(g));if(c)for(var v=function(e){if("undefined"==typeof window||!f)return d(e);try{return d(e)}catch(e){return!1}}(e),b=0;b<h.length;++b)v&&"constructor"===h[b]||!i.call(e,h[b])||l.push(h[b]);return l}}e.exports=n},2680:(e,t,r)=>{"use strict";var n=Array.prototype.slice,i=r(327),s=Object.keys,o=s?function(e){return s(e)}:r(1782),a=Object.keys;o.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return i(e)?a(n.call(e)):a(e)})}else Object.keys=o;return Object.keys||o},e.exports=o},327:e=>{"use strict";var t=Object.prototype.toString;e.exports=function(e){var r=t.call(e),n="[object Arguments]"===r;return n||(n="[object Array]"!==r&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===t.call(e.callee)),n}},9538:(e,t,r)=>{"use strict";var n=r(2680),i=function(e){return null!=e},s=r(5139)(),o=r(6610),a=Object,c=o("Array.prototype.push"),u=o("Object.prototype.propertyIsEnumerable"),h=s?Object.getOwnPropertySymbols:null;e.exports=function(e,t){if(!i(e))throw new TypeError("target must be an object");var r,o,d,l,f,p,y,m=a(e);for(r=1;r<arguments.length;++r){o=a(arguments[r]),l=n(o);var g=s&&(Object.getOwnPropertySymbols||h);if(g)for(f=g(o),d=0;d<f.length;++d)y=f[d],u(o,y)&&c(l,y);for(d=0;d<l.length;++d)p=o[y=l[d]],u(o,y)&&(m[y]=p)}return m}},381:(e,t,r)=>{"use strict";var n=r(8393),i=r(2269),s=r(9538),o=r(1947),a=r(5504),c=i.apply(o()),u=function(e,t){return c(Object,arguments)};n(u,{getPolyfill:o,implementation:s,shim:a}),e.exports=u},1947:(e,t,r)=>{"use strict";var n=r(9538);e.exports=function(){return Object.assign?function(){if(!Object.assign)return!1;for(var e="abcdefghijklmnopqrst",t=e.split(""),r={},n=0;n<t.length;++n)r[t[n]]=t[n];var i=Object.assign({},r),s="";for(var o in i)s+=o;return e!==s}()||function(){if(!Object.assign||!Object.preventExtensions)return!1;var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}return!1}()?n:Object.assign:n}},5504:(e,t,r)=>{"use strict";var n=r(8393),i=r(1947);e.exports=function(){var e=i();return n(Object,{assign:e},{assign:function(){return Object.assign!==e}}),e}},8122:(e,t,r)=>{e.exports=r(1290)},1605:(e,t,r)=>{"use strict";var n=r(1075).functionsHaveConfigurableNames(),i=Object,s=TypeError;e.exports=function(){if(null!=this&&this!==i(this))throw new s("RegExp.prototype.flags getter called on non-object");var e="";return this.hasIndices&&(e+="d"),this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.dotAll&&(e+="s"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e},n&&Object.defineProperty&&Object.defineProperty(e.exports,"name",{value:"get flags"})},728:(e,t,r)=>{"use strict";var n=r(8393),i=r(2269),s=r(1605),o=r(3394),a=r(8216),c=i(o());n(c,{getPolyfill:o,implementation:s,shim:a}),e.exports=c},3394:(e,t,r)=>{"use strict";var n=r(1605),i=r(8393).supportsDescriptors,s=Object.getOwnPropertyDescriptor;e.exports=function(){if(i&&"gim"===/a/gim.flags){var e=s(RegExp.prototype,"flags");if(e&&"function"==typeof e.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var t="",r={};if(Object.defineProperty(r,"hasIndices",{get:function(){t+="d"}}),Object.defineProperty(r,"sticky",{get:function(){t+="y"}}),"dy"===t)return e.get}}return n}},8216:(e,t,r)=>{"use strict";var n=r(8393).supportsDescriptors,i=r(3394),s=Object.getOwnPropertyDescriptor,o=Object.defineProperty,a=TypeError,c=Object.getPrototypeOf,u=/a/;e.exports=function(){if(!n||!c)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var e=i(),t=c(u),r=s(t,"flags");return r&&r.get===e||o(t,"flags",{configurable:!0,enumerable:!1,get:e}),e}},1444:(e,t,r)=>{var n=r(4300),i=n.Buffer;function s(e,t){for(var r in e)t[r]=e[r]}function o(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=o),o.prototype=Object.create(i.prototype),s(i,o),o.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},o.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},915:(e,t,r)=>{!function(e){e.parser=function(e,t){return new i(e,t)},e.SAXParser=i,e.SAXStream=o,e.createStream=function(e,t){return new o(e,t)},e.MAX_BUFFER_LENGTH=65536;var t,n=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function i(t,r){if(!(this instanceof i))return new i(t,r);var s=this;!function(e){for(var t=0,r=n.length;t<r;t++)e[n[t]]=""}(s),s.q=s.c="",s.bufferCheckPosition=e.MAX_BUFFER_LENGTH,s.opt=r||{},s.opt.lowercase=s.opt.lowercase||s.opt.lowercasetags,s.looseCase=s.opt.lowercase?"toLowerCase":"toUpperCase",s.tags=[],s.closed=s.closedRoot=s.sawRoot=!1,s.tag=s.error=null,s.strict=!!t,s.noscript=!(!t&&!s.opt.noscript),s.state=A.BEGIN,s.strictEntities=s.opt.strictEntities,s.ENTITIES=s.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),s.attribList=[],s.opt.xmlns&&(s.ns=Object.create(u)),s.trackPosition=!1!==s.opt.position,s.trackPosition&&(s.position=s.line=s.column=0),w(s,"onready")}e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(e){function t(){}return t.prototype=e,new t}),Object.keys||(Object.keys=function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}),i.prototype={end:function(){R(this)},write:function(t){var r=this;if(this.error)throw this.error;if(r.closed)return D(r,"Cannot write after close. Assign an onready handler.");if(null===t)return R(r);"object"==typeof t&&(t=t.toString());var i=0,s="";for(;s=k(t,i++),r.c=s,s;)switch(r.trackPosition&&(r.position++,"\n"===s?(r.line++,r.column=0):r.column++),r.state){case A.BEGIN:if(r.state=A.BEGIN_WHITESPACE,"\ufeff"===s)continue;L(r,s);continue;case A.BEGIN_WHITESPACE:L(r,s);continue;case A.TEXT:if(r.sawRoot&&!r.closedRoot){for(var o=i-1;s&&"<"!==s&&"&"!==s;)(s=k(t,i++))&&r.trackPosition&&(r.position++,"\n"===s?(r.line++,r.column=0):r.column++);r.textNode+=t.substring(o,i-1)}"<"!==s||r.sawRoot&&r.closedRoot&&!r.strict?(p(s)||r.sawRoot&&!r.closedRoot||N(r,"Text data outside of root node."),"&"===s?r.state=A.TEXT_ENTITY:r.textNode+=s):(r.state=A.OPEN_WAKA,r.startTagPosition=r.position);continue;case A.SCRIPT:"<"===s?r.state=A.SCRIPT_ENDING:r.script+=s;continue;case A.SCRIPT_ENDING:"/"===s?r.state=A.CLOSE_TAG:(r.script+="<"+s,r.state=A.SCRIPT);continue;case A.OPEN_WAKA:if("!"===s)r.state=A.SGML_DECL,r.sgmlDecl="";else if(p(s));else if(g(h,s))r.state=A.OPEN_TAG,r.tagName=s;else if("/"===s)r.state=A.CLOSE_TAG,r.tagName="";else if("?"===s)r.state=A.PROC_INST,r.procInstName=r.procInstBody="";else{if(N(r,"Unencoded <"),r.startTagPosition+1<r.position){var a=r.position-r.startTagPosition;s=new Array(a).join(" ")+s}r.textNode+="<"+s,r.state=A.TEXT}continue;case A.SGML_DECL:"[CDATA["===(r.sgmlDecl+s).toUpperCase()?(T(r,"onopencdata"),r.state=A.CDATA,r.sgmlDecl="",r.cdata=""):r.sgmlDecl+s==="--"?(r.state=A.COMMENT,r.comment="",r.sgmlDecl=""):"DOCTYPE"===(r.sgmlDecl+s).toUpperCase()?(r.state=A.DOCTYPE,(r.doctype||r.sawRoot)&&N(r,"Inappropriately located doctype declaration"),r.doctype="",r.sgmlDecl=""):">"===s?(T(r,"onsgmldeclaration",r.sgmlDecl),r.sgmlDecl="",r.state=A.TEXT):y(s)?(r.state=A.SGML_DECL_QUOTED,r.sgmlDecl+=s):r.sgmlDecl+=s;continue;case A.SGML_DECL_QUOTED:s===r.q&&(r.state=A.SGML_DECL,r.q=""),r.sgmlDecl+=s;continue;case A.DOCTYPE:">"===s?(r.state=A.TEXT,T(r,"ondoctype",r.doctype),r.doctype=!0):(r.doctype+=s,"["===s?r.state=A.DOCTYPE_DTD:y(s)&&(r.state=A.DOCTYPE_QUOTED,r.q=s));continue;case A.DOCTYPE_QUOTED:r.doctype+=s,s===r.q&&(r.q="",r.state=A.DOCTYPE);continue;case A.DOCTYPE_DTD:r.doctype+=s,"]"===s?r.state=A.DOCTYPE:y(s)&&(r.state=A.DOCTYPE_DTD_QUOTED,r.q=s);continue;case A.DOCTYPE_DTD_QUOTED:r.doctype+=s,s===r.q&&(r.state=A.DOCTYPE_DTD,r.q="");continue;case A.COMMENT:"-"===s?r.state=A.COMMENT_ENDING:r.comment+=s;continue;case A.COMMENT_ENDING:"-"===s?(r.state=A.COMMENT_ENDED,r.comment=_(r.opt,r.comment),r.comment&&T(r,"oncomment",r.comment),r.comment=""):(r.comment+="-"+s,r.state=A.COMMENT);continue;case A.COMMENT_ENDED:">"!==s?(N(r,"Malformed comment"),r.comment+="--"+s,r.state=A.COMMENT):r.state=A.TEXT;continue;case A.CDATA:"]"===s?r.state=A.CDATA_ENDING:r.cdata+=s;continue;case A.CDATA_ENDING:"]"===s?r.state=A.CDATA_ENDING_2:(r.cdata+="]"+s,r.state=A.CDATA);continue;case A.CDATA_ENDING_2:">"===s?(r.cdata&&T(r,"oncdata",r.cdata),T(r,"onclosecdata"),r.cdata="",r.state=A.TEXT):"]"===s?r.cdata+="]":(r.cdata+="]]"+s,r.state=A.CDATA);continue;case A.PROC_INST:"?"===s?r.state=A.PROC_INST_ENDING:p(s)?r.state=A.PROC_INST_BODY:r.procInstName+=s;continue;case A.PROC_INST_BODY:if(!r.procInstBody&&p(s))continue;"?"===s?r.state=A.PROC_INST_ENDING:r.procInstBody+=s;continue;case A.PROC_INST_ENDING:">"===s?(T(r,"onprocessinginstruction",{name:r.procInstName,body:r.procInstBody}),r.procInstName=r.procInstBody="",r.state=A.TEXT):(r.procInstBody+="?"+s,r.state=A.PROC_INST_BODY);continue;case A.OPEN_TAG:g(d,s)?r.tagName+=s:(O(r),">"===s?B(r):"/"===s?r.state=A.OPEN_TAG_SLASH:(p(s)||N(r,"Invalid character in tag name"),r.state=A.ATTRIB));continue;case A.OPEN_TAG_SLASH:">"===s?(B(r,!0),x(r)):(N(r,"Forward-slash in opening tag not followed by >"),r.state=A.ATTRIB);continue;case A.ATTRIB:if(p(s))continue;">"===s?B(r):"/"===s?r.state=A.OPEN_TAG_SLASH:g(h,s)?(r.attribName=s,r.attribValue="",r.state=A.ATTRIB_NAME):N(r,"Invalid attribute name");continue;case A.ATTRIB_NAME:"="===s?r.state=A.ATTRIB_VALUE:">"===s?(N(r,"Attribute without value"),r.attribValue=r.attribName,P(r),B(r)):p(s)?r.state=A.ATTRIB_NAME_SAW_WHITE:g(d,s)?r.attribName+=s:N(r,"Invalid attribute name");continue;case A.ATTRIB_NAME_SAW_WHITE:if("="===s)r.state=A.ATTRIB_VALUE;else{if(p(s))continue;N(r,"Attribute without value"),r.tag.attributes[r.attribName]="",r.attribValue="",T(r,"onattribute",{name:r.attribName,value:""}),r.attribName="",">"===s?B(r):g(h,s)?(r.attribName=s,r.state=A.ATTRIB_NAME):(N(r,"Invalid attribute name"),r.state=A.ATTRIB)}continue;case A.ATTRIB_VALUE:if(p(s))continue;y(s)?(r.q=s,r.state=A.ATTRIB_VALUE_QUOTED):(N(r,"Unquoted attribute value"),r.state=A.ATTRIB_VALUE_UNQUOTED,r.attribValue=s);continue;case A.ATTRIB_VALUE_QUOTED:if(s!==r.q){"&"===s?r.state=A.ATTRIB_VALUE_ENTITY_Q:r.attribValue+=s;continue}P(r),r.q="",r.state=A.ATTRIB_VALUE_CLOSED;continue;case A.ATTRIB_VALUE_CLOSED:p(s)?r.state=A.ATTRIB:">"===s?B(r):"/"===s?r.state=A.OPEN_TAG_SLASH:g(h,s)?(N(r,"No whitespace between attributes"),r.attribName=s,r.attribValue="",r.state=A.ATTRIB_NAME):N(r,"Invalid attribute name");continue;case A.ATTRIB_VALUE_UNQUOTED:if(!m(s)){"&"===s?r.state=A.ATTRIB_VALUE_ENTITY_U:r.attribValue+=s;continue}P(r),">"===s?B(r):r.state=A.ATTRIB;continue;case A.CLOSE_TAG:if(r.tagName)">"===s?x(r):g(d,s)?r.tagName+=s:r.script?(r.script+="</"+r.tagName,r.tagName="",r.state=A.SCRIPT):(p(s)||N(r,"Invalid tagname in closing tag"),r.state=A.CLOSE_TAG_SAW_WHITE);else{if(p(s))continue;v(h,s)?r.script?(r.script+="</"+s,r.state=A.SCRIPT):N(r,"Invalid tagname in closing tag."):r.tagName=s}continue;case A.CLOSE_TAG_SAW_WHITE:if(p(s))continue;">"===s?x(r):N(r,"Invalid characters in closing tag");continue;case A.TEXT_ENTITY:case A.ATTRIB_VALUE_ENTITY_Q:case A.ATTRIB_VALUE_ENTITY_U:var c,u;switch(r.state){case A.TEXT_ENTITY:c=A.TEXT,u="textNode";break;case A.ATTRIB_VALUE_ENTITY_Q:c=A.ATTRIB_VALUE_QUOTED,u="attribValue";break;case A.ATTRIB_VALUE_ENTITY_U:c=A.ATTRIB_VALUE_UNQUOTED,u="attribValue"}";"===s?(r[u]+=M(r),r.entity="",r.state=c):g(r.entity.length?f:l,s)?r.entity+=s:(N(r,"Invalid character in entity name"),r[u]+="&"+r.entity+s,r.entity="",r.state=c);continue;default:throw new Error(r,"Unknown state: "+r.state)}r.position>=r.bufferCheckPosition&&function(t){for(var r=Math.max(e.MAX_BUFFER_LENGTH,10),i=0,s=0,o=n.length;s<o;s++){var a=t[n[s]].length;if(a>r)switch(n[s]){case"textNode":C(t);break;case"cdata":T(t,"oncdata",t.cdata),t.cdata="";break;case"script":T(t,"onscript",t.script),t.script="";break;default:D(t,"Max buffer length exceeded: "+n[s])}i=Math.max(i,a)}var c=e.MAX_BUFFER_LENGTH-i;t.bufferCheckPosition=c+t.position}(r);return r},resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){var e;C(e=this),""!==e.cdata&&(T(e,"oncdata",e.cdata),e.cdata=""),""!==e.script&&(T(e,"onscript",e.script),e.script="")}};try{t=r(2781).Stream}catch(e){t=function(){}}var s=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e}));function o(e,r){if(!(this instanceof o))return new o(e,r);t.apply(this),this._parser=new i(e,r),this.writable=!0,this.readable=!0;var n=this;this._parser.onend=function(){n.emit("end")},this._parser.onerror=function(e){n.emit("error",e),n._parser.error=null},this._decoder=null,s.forEach((function(e){Object.defineProperty(n,"on"+e,{get:function(){return n._parser["on"+e]},set:function(t){if(!t)return n.removeAllListeners(e),n._parser["on"+e]=t,t;n.on(e,t)},enumerable:!0,configurable:!1})}))}o.prototype=Object.create(t.prototype,{constructor:{value:o}}),o.prototype.write=function(e){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(e)){if(!this._decoder){var t=r(1576).StringDecoder;this._decoder=new t("utf8")}e=this._decoder.write(e)}return this._parser.write(e.toString()),this.emit("data",e),!0},o.prototype.end=function(e){return e&&e.length&&this.write(e),this._parser.end(),!0},o.prototype.on=function(e,r){var n=this;return n._parser["on"+e]||-1===s.indexOf(e)||(n._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),n.emit.apply(n,t)}),t.prototype.on.call(n,e,r)};var a="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/2000/xmlns/",u={xml:a,xmlns:c},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,l=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function p(e){return" "===e||"\n"===e||"\r"===e||"\t"===e}function y(e){return'"'===e||"'"===e}function m(e){return">"===e||p(e)}function g(e,t){return e.test(t)}function v(e,t){return!g(e,t)}var b,E,S,A=0;for(var I in e.STATE={BEGIN:A++,BEGIN_WHITESPACE:A++,TEXT:A++,TEXT_ENTITY:A++,OPEN_WAKA:A++,SGML_DECL:A++,SGML_DECL_QUOTED:A++,DOCTYPE:A++,DOCTYPE_QUOTED:A++,DOCTYPE_DTD:A++,DOCTYPE_DTD_QUOTED:A++,COMMENT_STARTING:A++,COMMENT:A++,COMMENT_ENDING:A++,COMMENT_ENDED:A++,CDATA:A++,CDATA_ENDING:A++,CDATA_ENDING_2:A++,PROC_INST:A++,PROC_INST_BODY:A++,PROC_INST_ENDING:A++,OPEN_TAG:A++,OPEN_TAG_SLASH:A++,ATTRIB:A++,ATTRIB_NAME:A++,ATTRIB_NAME_SAW_WHITE:A++,ATTRIB_VALUE:A++,ATTRIB_VALUE_QUOTED:A++,ATTRIB_VALUE_CLOSED:A++,ATTRIB_VALUE_UNQUOTED:A++,ATTRIB_VALUE_ENTITY_Q:A++,ATTRIB_VALUE_ENTITY_U:A++,CLOSE_TAG:A++,CLOSE_TAG_SAW_WHITE:A++,SCRIPT:A++,SCRIPT_ENDING:A++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach((function(t){var r=e.ENTITIES[t],n="number"==typeof r?String.fromCharCode(r):r;e.ENTITIES[t]=n})),e.STATE)e.STATE[e.STATE[I]]=I;function w(e,t,r){e[t]&&e[t](r)}function T(e,t,r){e.textNode&&C(e),w(e,t,r)}function C(e){e.textNode=_(e.opt,e.textNode),e.textNode&&w(e,"ontext",e.textNode),e.textNode=""}function _(e,t){return e.trim&&(t=t.trim()),e.normalize&&(t=t.replace(/\s+/g," ")),t}function D(e,t){return C(e),e.trackPosition&&(t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c),t=new Error(t),e.error=t,w(e,"onerror",t),e}function R(e){return e.sawRoot&&!e.closedRoot&&N(e,"Unclosed root tag"),e.state!==A.BEGIN&&e.state!==A.BEGIN_WHITESPACE&&e.state!==A.TEXT&&D(e,"Unexpected end"),C(e),e.c="",e.closed=!0,w(e,"onend"),i.call(e,e.strict,e.opt),e}function N(e,t){if("object"!=typeof e||!(e instanceof i))throw new Error("bad call to strictFail");e.strict&&D(e,t)}function O(e){e.strict||(e.tagName=e.tagName[e.looseCase]());var t=e.tags[e.tags.length-1]||e,r=e.tag={name:e.tagName,attributes:{}};e.opt.xmlns&&(r.ns=t.ns),e.attribList.length=0,T(e,"onopentagstart",r)}function U(e,t){var r=e.indexOf(":")<0?["",e]:e.split(":"),n=r[0],i=r[1];return t&&"xmlns"===e&&(n="xmlns",i=""),{prefix:n,local:i}}function P(e){if(e.strict||(e.attribName=e.attribName[e.looseCase]()),-1!==e.attribList.indexOf(e.attribName)||e.tag.attributes.hasOwnProperty(e.attribName))e.attribName=e.attribValue="";else{if(e.opt.xmlns){var t=U(e.attribName,!0),r=t.prefix,n=t.local;if("xmlns"===r)if("xml"===n&&e.attribValue!==a)N(e,"xml: prefix must be bound to "+a+"\nActual: "+e.attribValue);else if("xmlns"===n&&e.attribValue!==c)N(e,"xmlns: prefix must be bound to "+c+"\nActual: "+e.attribValue);else{var i=e.tag,s=e.tags[e.tags.length-1]||e;i.ns===s.ns&&(i.ns=Object.create(s.ns)),i.ns[n]=e.attribValue}e.attribList.push([e.attribName,e.attribValue])}else e.tag.attributes[e.attribName]=e.attribValue,T(e,"onattribute",{name:e.attribName,value:e.attribValue});e.attribName=e.attribValue=""}}function B(e,t){if(e.opt.xmlns){var r=e.tag,n=U(e.tagName);r.prefix=n.prefix,r.local=n.local,r.uri=r.ns[n.prefix]||"",r.prefix&&!r.uri&&(N(e,"Unbound namespace prefix: "+JSON.stringify(e.tagName)),r.uri=n.prefix);var i=e.tags[e.tags.length-1]||e;r.ns&&i.ns!==r.ns&&Object.keys(r.ns).forEach((function(t){T(e,"onopennamespace",{prefix:t,uri:r.ns[t]})}));for(var s=0,o=e.attribList.length;s<o;s++){var a=e.attribList[s],c=a[0],u=a[1],h=U(c,!0),d=h.prefix,l=h.local,f=""===d?"":r.ns[d]||"",p={name:c,value:u,prefix:d,local:l,uri:f};d&&"xmlns"!==d&&!f&&(N(e,"Unbound namespace prefix: "+JSON.stringify(d)),p.uri=d),e.tag.attributes[c]=p,T(e,"onattribute",p)}e.attribList.length=0}e.tag.isSelfClosing=!!t,e.sawRoot=!0,e.tags.push(e.tag),T(e,"onopentag",e.tag),t||(e.noscript||"script"!==e.tagName.toLowerCase()?e.state=A.TEXT:e.state=A.SCRIPT,e.tag=null,e.tagName=""),e.attribName=e.attribValue="",e.attribList.length=0}function x(e){if(!e.tagName)return N(e,"Weird empty close tag."),e.textNode+="</>",void(e.state=A.TEXT);if(e.script){if("script"!==e.tagName)return e.script+="</"+e.tagName+">",e.tagName="",void(e.state=A.SCRIPT);T(e,"onscript",e.script),e.script=""}var t=e.tags.length,r=e.tagName;e.strict||(r=r[e.looseCase]());for(var n=r;t--;){if(e.tags[t].name===n)break;N(e,"Unexpected close tag")}if(t<0)return N(e,"Unmatched closing tag: "+e.tagName),e.textNode+="</"+e.tagName+">",void(e.state=A.TEXT);e.tagName=r;for(var i=e.tags.length;i-- >t;){var s=e.tag=e.tags.pop();e.tagName=e.tag.name,T(e,"onclosetag",e.tagName);var o={};for(var a in s.ns)o[a]=s.ns[a];var c=e.tags[e.tags.length-1]||e;e.opt.xmlns&&s.ns!==c.ns&&Object.keys(s.ns).forEach((function(t){var r=s.ns[t];T(e,"onclosenamespace",{prefix:t,uri:r})}))}0===t&&(e.closedRoot=!0),e.tagName=e.attribValue=e.attribName="",e.attribList.length=0,e.state=A.TEXT}function M(e){var t,r=e.entity,n=r.toLowerCase(),i="";return e.ENTITIES[r]?e.ENTITIES[r]:e.ENTITIES[n]?e.ENTITIES[n]:("#"===(r=n).charAt(0)&&("x"===r.charAt(1)?(r=r.slice(2),i=(t=parseInt(r,16)).toString(16)):(r=r.slice(1),i=(t=parseInt(r,10)).toString(10))),r=r.replace(/^0+/,""),isNaN(t)||i.toLowerCase()!==r?(N(e,"Invalid character entity"),"&"+e.entity+";"):String.fromCodePoint(t))}function L(e,t){"<"===t?(e.state=A.OPEN_WAKA,e.startTagPosition=e.position):p(t)||(N(e,"Non-whitespace before first tag."),e.textNode=t,e.state=A.TEXT)}function k(e,t){var r="";return t<e.length&&(r=e.charAt(t)),r}A=e.STATE,String.fromCodePoint||(b=String.fromCharCode,E=Math.floor,S=function(){var e,t,r=16384,n=[],i=-1,s=arguments.length;if(!s)return"";for(var o="";++i<s;){var a=Number(arguments[i]);if(!isFinite(a)||a<0||a>1114111||E(a)!==a)throw RangeError("Invalid code point: "+a);a<=65535?n.push(a):(e=55296+((a-=65536)>>10),t=a%1024+56320,n.push(e,t)),(i+1===s||n.length>r)&&(o+=b.apply(null,n),n.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:S,configurable:!0,writable:!0}):String.fromCodePoint=S)}(t)},8373:(e,t,r)=>{"use strict";var n=r(49),i=r(6610),s=r(1273),o=n("%TypeError%"),a=n("%WeakMap%",!0),c=n("%Map%",!0),u=i("WeakMap.prototype.get",!0),h=i("WeakMap.prototype.set",!0),d=i("WeakMap.prototype.has",!0),l=i("Map.prototype.get",!0),f=i("Map.prototype.set",!0),p=i("Map.prototype.has",!0),y=function(e,t){for(var r,n=e;null!==(r=n.next);n=r)if(r.key===t)return n.next=r.next,r.next=e.next,e.next=r,r};e.exports=function(){var e,t,r,n={assert:function(e){if(!n.has(e))throw new o("Side channel does not contain "+s(e))},get:function(n){if(a&&n&&("object"==typeof n||"function"==typeof n)){if(e)return u(e,n)}else if(c){if(t)return l(t,n)}else if(r)return function(e,t){var r=y(e,t);return r&&r.value}(r,n)},has:function(n){if(a&&n&&("object"==typeof n||"function"==typeof n)){if(e)return d(e,n)}else if(c){if(t)return p(t,n)}else if(r)return function(e,t){return!!y(e,t)}(r,n);return!1},set:function(n,i){a&&n&&("object"==typeof n||"function"==typeof n)?(e||(e=new a),h(e,n,i)):c?(t||(t=new c),f(t,n,i)):(r||(r={key:{},next:null}),function(e,t,r){var n=y(e,t);n?n.value=r:e.next={key:t,next:e.next,value:r}}(r,n,i))}};return n}},8677:(e,t,r)=>{var n=r(1290),i=r(1576).StringDecoder;e.exports=function(e,t,r){var s=new i,o="",a=r&&r.maxLength,c=!r||!1!==r.trailing;"function"==typeof e&&(t=e,e=null);e||(e=/\r?\n/);function u(e,r){if(t){try{r=t(r)}catch(t){return e.emit("error",t)}void 0!==r&&e.queue(r)}else e.queue(r)}function h(t,r){var n=((null!=o?o:"")+r).split(e);if(o=n.pop(),a&&o.length>a)return t.emit("error",new Error("maximum buffer reached"));for(var i=0;i<n.length;i++){u(t,n[i])}}return n((function(e){h(this,s.write(e))}),(function(){s.end&&h(this,s.end()),c&&null!=o&&u(this,o),this.queue(null)}))}},5965:(e,t,r)=>{var n=r(7517),i=r(1290);e.exports=function(){var e;if(0==(e=1==arguments.length&&Array.isArray(arguments[0])?arguments[0]:[].slice.call(arguments)).length)return i();if(1==e.length)return e[0];var t=e[0],r=e[e.length-1],s=n(t,r);function o(e){e.length<2||(e[0].pipe(e[1]),o(e.slice(1)))}function a(){var e=[].slice.call(arguments);e.unshift("error"),s.emit.apply(s,e)}o(e);for(var c=1;c<e.length-1;c++)e[c].on("error",a);return s}},5416:(e,t,r)=>{"use strict";const n=r(2037),i=r(6224),s=r(7831),{env:o}=process;let a;function c(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function u(e,t){if(0===a)return 0;if(s("color=16m")||s("color=full")||s("color=truecolor"))return 3;if(s("color=256"))return 2;if(e&&!t&&void 0===a)return 0;const r=a||0;if("dumb"===o.TERM)return r;if("win32"===process.platform){const e=n.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some((e=>e in o))||"codeship"===o.CI_NAME?1:r;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:r}s("no-color")||s("no-colors")||s("color=false")||s("color=never")?a=0:(s("color")||s("colors")||s("color=true")||s("color=always"))&&(a=1),"FORCE_COLOR"in o&&(a="true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(parseInt(o.FORCE_COLOR,10),3)),e.exports={supportsColor:function(e){return c(u(e,e&&e.isTTY))},stdout:c(u(!0,i.isatty(1))),stderr:c(u(!0,i.isatty(2)))}},1290:(e,t,r)=>{var n=r(2781);function i(e,t,r){e=e||function(e){this.queue(e)},t=t||function(){this.queue(null)};var i=!1,s=!1,o=[],a=!1,c=new n;function u(){for(;o.length&&!c.paused;){var e=o.shift();if(null===e)return c.emit("end");c.emit("data",e)}}function h(){c.writable=!1,t.call(c),!c.readable&&c.autoDestroy&&c.destroy()}return c.readable=c.writable=!0,c.paused=!1,c.autoDestroy=!(r&&!1===r.autoDestroy),c.write=function(t){return e.call(this,t),!c.paused},c.queue=c.push=function(e){return a||(null===e&&(a=!0),o.push(e),u()),c},c.on("end",(function(){c.readable=!1,!c.writable&&c.autoDestroy&&process.nextTick((function(){c.destroy()}))})),c.end=function(e){if(!i)return i=!0,arguments.length&&c.write(e),h(),c},c.destroy=function(){if(!s)return s=!0,i=!0,o.length=0,c.writable=c.readable=!1,c.emit("close"),c},c.pause=function(){if(!c.paused)return c.paused=!0,c},c.resume=function(){return c.paused&&(c.paused=!1,c.emit("resume")),u(),c.paused||c.emit("drain"),c},c}e.exports=i,i.through=i},4735:e=>{"use strict";var t=function(e,t,r){process.nextTick((function(){e(t,r)}))};function r(e){return"[object Error]"===Object.prototype.toString.call(e)}function n(){}function i(e,t){e.apply(null,t)}process.nextTick((function(e){42===e&&(t=process.nextTick)}),42),e.exports=function(e){var s=function n(o){var a=[o];function c(e){a.push(e)}function u(e){var o=arguments;for(s=r(e)?n:c;a.length;)c(a.shift());function c(e){t(i,e,o)}}s=c,e(u)};return function(e){s(e||n)}}},5827:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__assign:()=>s,__asyncDelegator:()=>S,__asyncGenerator:()=>E,__asyncValues:()=>A,__await:()=>b,__awaiter:()=>h,__classPrivateFieldGet:()=>_,__classPrivateFieldIn:()=>R,__classPrivateFieldSet:()=>D,__createBinding:()=>l,__decorate:()=>a,__exportStar:()=>f,__extends:()=>i,__generator:()=>d,__importDefault:()=>C,__importStar:()=>T,__makeTemplateObject:()=>I,__metadata:()=>u,__param:()=>c,__read:()=>y,__rest:()=>o,__spread:()=>m,__spreadArray:()=>v,__spreadArrays:()=>g,__values:()=>p});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))}function d(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var l=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function f(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||l(t,e,r)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function v(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=i[e](t)).value instanceof b?Promise.resolve(r.value.v).then(c,u):h(s[0][2],r)}catch(e){h(s[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function S(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function A(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var w=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&l(t,e,r);return w(t,e),t}function C(e){return e&&e.__esModule?e:{default:e}}function _(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function D(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},1501:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var o=t(),a=t([1]),c=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),f=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function y(e,t,r,n,i){var s,o=0;for(s=0;s<i;s++)o|=e[t+s]^r[n+s];return(1&o-1>>>8)-1}function m(e,t,r,n){return y(e,t,r,n,16)}function g(e,t,r,n){return y(e,t,r,n,32)}function v(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,h=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,d=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,v=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,E=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,S=s,A=o,I=a,w=c,T=u,C=h,_=d,D=l,R=f,N=p,O=y,U=m,P=g,B=v,x=b,M=E,L=0;L<20;L+=2)S^=(i=(P^=(i=(R^=(i=(T^=(i=S+P|0)<<7|i>>>25)+S|0)<<9|i>>>23)+T|0)<<13|i>>>19)+R|0)<<18|i>>>14,C^=(i=(A^=(i=(B^=(i=(N^=(i=C+A|0)<<7|i>>>25)+C|0)<<9|i>>>23)+N|0)<<13|i>>>19)+B|0)<<18|i>>>14,O^=(i=(_^=(i=(I^=(i=(x^=(i=O+_|0)<<7|i>>>25)+O|0)<<9|i>>>23)+x|0)<<13|i>>>19)+I|0)<<18|i>>>14,M^=(i=(U^=(i=(D^=(i=(w^=(i=M+U|0)<<7|i>>>25)+M|0)<<9|i>>>23)+w|0)<<13|i>>>19)+D|0)<<18|i>>>14,S^=(i=(w^=(i=(I^=(i=(A^=(i=S+w|0)<<7|i>>>25)+S|0)<<9|i>>>23)+A|0)<<13|i>>>19)+I|0)<<18|i>>>14,C^=(i=(T^=(i=(D^=(i=(_^=(i=C+T|0)<<7|i>>>25)+C|0)<<9|i>>>23)+_|0)<<13|i>>>19)+D|0)<<18|i>>>14,O^=(i=(N^=(i=(R^=(i=(U^=(i=O+N|0)<<7|i>>>25)+O|0)<<9|i>>>23)+U|0)<<13|i>>>19)+R|0)<<18|i>>>14,M^=(i=(x^=(i=(B^=(i=(P^=(i=M+x|0)<<7|i>>>25)+M|0)<<9|i>>>23)+P|0)<<13|i>>>19)+B|0)<<18|i>>>14;S=S+s|0,A=A+o|0,I=I+a|0,w=w+c|0,T=T+u|0,C=C+h|0,_=_+d|0,D=D+l|0,R=R+f|0,N=N+p|0,O=O+y|0,U=U+m|0,P=P+g|0,B=B+v|0,x=x+b|0,M=M+E|0,e[0]=S>>>0&255,e[1]=S>>>8&255,e[2]=S>>>16&255,e[3]=S>>>24&255,e[4]=A>>>0&255,e[5]=A>>>8&255,e[6]=A>>>16&255,e[7]=A>>>24&255,e[8]=I>>>0&255,e[9]=I>>>8&255,e[10]=I>>>16&255,e[11]=I>>>24&255,e[12]=w>>>0&255,e[13]=w>>>8&255,e[14]=w>>>16&255,e[15]=w>>>24&255,e[16]=T>>>0&255,e[17]=T>>>8&255,e[18]=T>>>16&255,e[19]=T>>>24&255,e[20]=C>>>0&255,e[21]=C>>>8&255,e[22]=C>>>16&255,e[23]=C>>>24&255,e[24]=_>>>0&255,e[25]=_>>>8&255,e[26]=_>>>16&255,e[27]=_>>>24&255,e[28]=D>>>0&255,e[29]=D>>>8&255,e[30]=D>>>16&255,e[31]=D>>>24&255,e[32]=R>>>0&255,e[33]=R>>>8&255,e[34]=R>>>16&255,e[35]=R>>>24&255,e[36]=N>>>0&255,e[37]=N>>>8&255,e[38]=N>>>16&255,e[39]=N>>>24&255,e[40]=O>>>0&255,e[41]=O>>>8&255,e[42]=O>>>16&255,e[43]=O>>>24&255,e[44]=U>>>0&255,e[45]=U>>>8&255,e[46]=U>>>16&255,e[47]=U>>>24&255,e[48]=P>>>0&255,e[49]=P>>>8&255,e[50]=P>>>16&255,e[51]=P>>>24&255,e[52]=B>>>0&255,e[53]=B>>>8&255,e[54]=B>>>16&255,e[55]=B>>>24&255,e[56]=x>>>0&255,e[57]=x>>>8&255,e[58]=x>>>16&255,e[59]=x>>>24&255,e[60]=M>>>0&255,e[61]=M>>>8&255,e[62]=M>>>16&255,e[63]=M>>>24&255}(e,t,r,n)}function b(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,h=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,d=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,v=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,E=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,S=0;S<20;S+=2)s^=(i=(g^=(i=(f^=(i=(u^=(i=s+g|0)<<7|i>>>25)+s|0)<<9|i>>>23)+u|0)<<13|i>>>19)+f|0)<<18|i>>>14,h^=(i=(o^=(i=(v^=(i=(p^=(i=h+o|0)<<7|i>>>25)+h|0)<<9|i>>>23)+p|0)<<13|i>>>19)+v|0)<<18|i>>>14,y^=(i=(d^=(i=(a^=(i=(b^=(i=y+d|0)<<7|i>>>25)+y|0)<<9|i>>>23)+b|0)<<13|i>>>19)+a|0)<<18|i>>>14,E^=(i=(m^=(i=(l^=(i=(c^=(i=E+m|0)<<7|i>>>25)+E|0)<<9|i>>>23)+c|0)<<13|i>>>19)+l|0)<<18|i>>>14,s^=(i=(c^=(i=(a^=(i=(o^=(i=s+c|0)<<7|i>>>25)+s|0)<<9|i>>>23)+o|0)<<13|i>>>19)+a|0)<<18|i>>>14,h^=(i=(u^=(i=(l^=(i=(d^=(i=h+u|0)<<7|i>>>25)+h|0)<<9|i>>>23)+d|0)<<13|i>>>19)+l|0)<<18|i>>>14,y^=(i=(p^=(i=(f^=(i=(m^=(i=y+p|0)<<7|i>>>25)+y|0)<<9|i>>>23)+m|0)<<13|i>>>19)+f|0)<<18|i>>>14,E^=(i=(b^=(i=(v^=(i=(g^=(i=E+b|0)<<7|i>>>25)+E|0)<<9|i>>>23)+g|0)<<13|i>>>19)+v|0)<<18|i>>>14;e[0]=s>>>0&255,e[1]=s>>>8&255,e[2]=s>>>16&255,e[3]=s>>>24&255,e[4]=h>>>0&255,e[5]=h>>>8&255,e[6]=h>>>16&255,e[7]=h>>>24&255,e[8]=y>>>0&255,e[9]=y>>>8&255,e[10]=y>>>16&255,e[11]=y>>>24&255,e[12]=E>>>0&255,e[13]=E>>>8&255,e[14]=E>>>16&255,e[15]=E>>>24&255,e[16]=d>>>0&255,e[17]=d>>>8&255,e[18]=d>>>16&255,e[19]=d>>>24&255,e[20]=l>>>0&255,e[21]=l>>>8&255,e[22]=l>>>16&255,e[23]=l>>>24&255,e[24]=f>>>0&255,e[25]=f>>>8&255,e[26]=f>>>16&255,e[27]=f>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var E=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function S(e,t,r,n,i,s,o){var a,c,u=new Uint8Array(16),h=new Uint8Array(64);for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=s[c];for(;i>=64;){for(v(h,u,o,E),c=0;c<64;c++)e[t+c]=r[n+c]^h[c];for(a=1,c=8;c<16;c++)a=a+(255&u[c])|0,u[c]=255&a,a>>>=8;i-=64,t+=64,n+=64}if(i>0)for(v(h,u,o,E),c=0;c<i;c++)e[t+c]=r[n+c]^h[c];return 0}function A(e,t,r,n,i){var s,o,a=new Uint8Array(16),c=new Uint8Array(64);for(o=0;o<16;o++)a[o]=0;for(o=0;o<8;o++)a[o]=n[o];for(;r>=64;){for(v(c,a,i,E),o=0;o<64;o++)e[t+o]=c[o];for(s=1,o=8;o<16;o++)s=s+(255&a[o])|0,a[o]=255&s,s>>>=8;r-=64,t+=64}if(r>0)for(v(c,a,i,E),o=0;o<r;o++)e[t+o]=c[o];return 0}function I(e,t,r,n,i){var s=new Uint8Array(32);b(s,n,i,E);for(var o=new Uint8Array(8),a=0;a<8;a++)o[a]=n[a+16];return A(e,t,r,o,s)}function w(e,t,r,n,i,s,o){var a=new Uint8Array(32);b(a,s,o,E);for(var c=new Uint8Array(8),u=0;u<8;u++)c[u]=s[u+16];return S(e,t,r,n,i,c,a)}var T=function(e){var t,r,n,i,s,o,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|i<<9),s=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|s<<12),this.r[5]=s>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(s>>>14|o<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|a<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function C(e,t,r,n,i,s){var o=new T(s);return o.update(r,n,i),o.finish(e,t),0}function _(e,t,r,n,i,s){var o=new Uint8Array(16);return C(o,0,r,n,i,s),m(e,t,o,0)}function D(e,t,r,n,i){var s;if(r<32)return-1;for(w(e,0,t,0,r,n,i),C(e,16,e,32,r-32,e),s=0;s<16;s++)e[s]=0;return 0}function R(e,t,r,n,i){var s,o=new Uint8Array(32);if(r<32)return-1;if(I(o,0,32,n,i),0!==_(t,16,t,32,r-32,o))return-1;for(w(e,0,t,0,r,n,i),s=0;s<32;s++)e[s]=0;return 0}function N(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function O(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function U(e,t,r){for(var n,i=~(r-1),s=0;s<16;s++)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function P(e,r){var n,i,s,o=t(),a=t();for(n=0;n<16;n++)a[n]=r[n];for(O(a),O(a),O(a),i=0;i<2;i++){for(o[0]=a[0]-65517,n=1;n<15;n++)o[n]=a[n]-65535-(o[n-1]>>16&1),o[n-1]&=65535;o[15]=a[15]-32767-(o[14]>>16&1),s=o[15]>>16&1,o[14]&=65535,U(a,o,1-s)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function B(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return P(r,e),P(n,t),g(r,0,n,0)}function x(e){var t=new Uint8Array(32);return P(t,e),1&t[0]}function M(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function L(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function k(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function F(e,t,r){var n,i,s=0,o=0,a=0,c=0,u=0,h=0,d=0,l=0,f=0,p=0,y=0,m=0,g=0,v=0,b=0,E=0,S=0,A=0,I=0,w=0,T=0,C=0,_=0,D=0,R=0,N=0,O=0,U=0,P=0,B=0,x=0,M=r[0],L=r[1],k=r[2],F=r[3],V=r[4],H=r[5],j=r[6],K=r[7],q=r[8],G=r[9],z=r[10],$=r[11],W=r[12],Y=r[13],Q=r[14],J=r[15];s+=(n=t[0])*M,o+=n*L,a+=n*k,c+=n*F,u+=n*V,h+=n*H,d+=n*j,l+=n*K,f+=n*q,p+=n*G,y+=n*z,m+=n*$,g+=n*W,v+=n*Y,b+=n*Q,E+=n*J,o+=(n=t[1])*M,a+=n*L,c+=n*k,u+=n*F,h+=n*V,d+=n*H,l+=n*j,f+=n*K,p+=n*q,y+=n*G,m+=n*z,g+=n*$,v+=n*W,b+=n*Y,E+=n*Q,S+=n*J,a+=(n=t[2])*M,c+=n*L,u+=n*k,h+=n*F,d+=n*V,l+=n*H,f+=n*j,p+=n*K,y+=n*q,m+=n*G,g+=n*z,v+=n*$,b+=n*W,E+=n*Y,S+=n*Q,A+=n*J,c+=(n=t[3])*M,u+=n*L,h+=n*k,d+=n*F,l+=n*V,f+=n*H,p+=n*j,y+=n*K,m+=n*q,g+=n*G,v+=n*z,b+=n*$,E+=n*W,S+=n*Y,A+=n*Q,I+=n*J,u+=(n=t[4])*M,h+=n*L,d+=n*k,l+=n*F,f+=n*V,p+=n*H,y+=n*j,m+=n*K,g+=n*q,v+=n*G,b+=n*z,E+=n*$,S+=n*W,A+=n*Y,I+=n*Q,w+=n*J,h+=(n=t[5])*M,d+=n*L,l+=n*k,f+=n*F,p+=n*V,y+=n*H,m+=n*j,g+=n*K,v+=n*q,b+=n*G,E+=n*z,S+=n*$,A+=n*W,I+=n*Y,w+=n*Q,T+=n*J,d+=(n=t[6])*M,l+=n*L,f+=n*k,p+=n*F,y+=n*V,m+=n*H,g+=n*j,v+=n*K,b+=n*q,E+=n*G,S+=n*z,A+=n*$,I+=n*W,w+=n*Y,T+=n*Q,C+=n*J,l+=(n=t[7])*M,f+=n*L,p+=n*k,y+=n*F,m+=n*V,g+=n*H,v+=n*j,b+=n*K,E+=n*q,S+=n*G,A+=n*z,I+=n*$,w+=n*W,T+=n*Y,C+=n*Q,_+=n*J,f+=(n=t[8])*M,p+=n*L,y+=n*k,m+=n*F,g+=n*V,v+=n*H,b+=n*j,E+=n*K,S+=n*q,A+=n*G,I+=n*z,w+=n*$,T+=n*W,C+=n*Y,_+=n*Q,D+=n*J,p+=(n=t[9])*M,y+=n*L,m+=n*k,g+=n*F,v+=n*V,b+=n*H,E+=n*j,S+=n*K,A+=n*q,I+=n*G,w+=n*z,T+=n*$,C+=n*W,_+=n*Y,D+=n*Q,R+=n*J,y+=(n=t[10])*M,m+=n*L,g+=n*k,v+=n*F,b+=n*V,E+=n*H,S+=n*j,A+=n*K,I+=n*q,w+=n*G,T+=n*z,C+=n*$,_+=n*W,D+=n*Y,R+=n*Q,N+=n*J,m+=(n=t[11])*M,g+=n*L,v+=n*k,b+=n*F,E+=n*V,S+=n*H,A+=n*j,I+=n*K,w+=n*q,T+=n*G,C+=n*z,_+=n*$,D+=n*W,R+=n*Y,N+=n*Q,O+=n*J,g+=(n=t[12])*M,v+=n*L,b+=n*k,E+=n*F,S+=n*V,A+=n*H,I+=n*j,w+=n*K,T+=n*q,C+=n*G,_+=n*z,D+=n*$,R+=n*W,N+=n*Y,O+=n*Q,U+=n*J,v+=(n=t[13])*M,b+=n*L,E+=n*k,S+=n*F,A+=n*V,I+=n*H,w+=n*j,T+=n*K,C+=n*q,_+=n*G,D+=n*z,R+=n*$,N+=n*W,O+=n*Y,U+=n*Q,P+=n*J,b+=(n=t[14])*M,E+=n*L,S+=n*k,A+=n*F,I+=n*V,w+=n*H,T+=n*j,C+=n*K,_+=n*q,D+=n*G,R+=n*z,N+=n*$,O+=n*W,U+=n*Y,P+=n*Q,B+=n*J,E+=(n=t[15])*M,o+=38*(A+=n*k),a+=38*(I+=n*F),c+=38*(w+=n*V),u+=38*(T+=n*H),h+=38*(C+=n*j),d+=38*(_+=n*K),l+=38*(D+=n*q),f+=38*(R+=n*G),p+=38*(N+=n*z),y+=38*(O+=n*$),m+=38*(U+=n*W),g+=38*(P+=n*Y),v+=38*(B+=n*Q),b+=38*(x+=n*J),s=(n=(s+=38*(S+=n*L))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),E=(n=E+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),E=(n=E+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=u,e[5]=h,e[6]=d,e[7]=l,e[8]=f,e[9]=p,e[10]=y,e[11]=m,e[12]=g,e[13]=v,e[14]=b,e[15]=E}function V(e,t){F(e,t,t)}function H(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=253;n>=0;n--)V(i,i),2!==n&&4!==n&&F(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function j(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=250;n>=0;n--)V(i,i),1!==n&&F(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function K(e,r,n){var i,s,o=new Uint8Array(32),a=new Float64Array(80),u=t(),h=t(),d=t(),l=t(),f=t(),p=t();for(s=0;s<31;s++)o[s]=r[s];for(o[31]=127&r[31]|64,o[0]&=248,M(a,n),s=0;s<16;s++)h[s]=a[s],l[s]=u[s]=d[s]=0;for(u[0]=l[0]=1,s=254;s>=0;--s)U(u,h,i=o[s>>>3]>>>(7&s)&1),U(d,l,i),L(f,u,d),k(u,u,d),L(d,h,l),k(h,h,l),V(l,f),V(p,u),F(u,d,u),F(d,h,f),L(f,u,d),k(u,u,d),V(h,u),k(d,l,p),F(u,d,c),L(u,u,l),F(d,d,u),F(u,l,p),F(l,h,a),V(h,f),U(u,h,i),U(d,l,i);for(s=0;s<16;s++)a[s+16]=u[s],a[s+32]=d[s],a[s+48]=h[s],a[s+64]=l[s];var y=a.subarray(32),m=a.subarray(16);return H(y,y),F(m,m,y),P(e,m),0}function q(e,t){return K(e,t,s)}function G(e,t){return n(t,32),q(e,t)}function z(e,t,r){var n=new Uint8Array(32);return K(n,r,t),b(e,i,n,E)}T.prototype.blocks=function(e,t,r){for(var n,i,s,o,a,c,u,h,d,l,f,p,y,m,g,v,b,E,S,A=this.fin?0:2048,I=this.h[0],w=this.h[1],T=this.h[2],C=this.h[3],_=this.h[4],D=this.h[5],R=this.h[6],N=this.h[7],O=this.h[8],U=this.h[9],P=this.r[0],B=this.r[1],x=this.r[2],M=this.r[3],L=this.r[4],k=this.r[5],F=this.r[6],V=this.r[7],H=this.r[8],j=this.r[9];r>=16;)l=d=0,l+=(I+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*P,l+=(w+=8191&(n>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*j),l+=(T+=8191&(i>>>10|(s=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*H),l+=(C+=8191&(s>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*V),d=(l+=(_+=8191&(o>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*F))>>>13,l&=8191,l+=(D+=a>>>1&8191)*(5*k),l+=(R+=8191&(a>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*L),l+=(N+=8191&(c>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*M),l+=(O+=8191&(u>>>8|(h=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*x),f=d+=(l+=(U+=h>>>5|A)*(5*B))>>>13,f+=I*B,f+=w*P,f+=T*(5*j),f+=C*(5*H),d=(f+=_*(5*V))>>>13,f&=8191,f+=D*(5*F),f+=R*(5*k),f+=N*(5*L),f+=O*(5*M),d+=(f+=U*(5*x))>>>13,f&=8191,p=d,p+=I*x,p+=w*B,p+=T*P,p+=C*(5*j),d=(p+=_*(5*H))>>>13,p&=8191,p+=D*(5*V),p+=R*(5*F),p+=N*(5*k),p+=O*(5*L),y=d+=(p+=U*(5*M))>>>13,y+=I*M,y+=w*x,y+=T*B,y+=C*P,d=(y+=_*(5*j))>>>13,y&=8191,y+=D*(5*H),y+=R*(5*V),y+=N*(5*F),y+=O*(5*k),m=d+=(y+=U*(5*L))>>>13,m+=I*L,m+=w*M,m+=T*x,m+=C*B,d=(m+=_*P)>>>13,m&=8191,m+=D*(5*j),m+=R*(5*H),m+=N*(5*V),m+=O*(5*F),g=d+=(m+=U*(5*k))>>>13,g+=I*k,g+=w*L,g+=T*M,g+=C*x,d=(g+=_*B)>>>13,g&=8191,g+=D*P,g+=R*(5*j),g+=N*(5*H),g+=O*(5*V),v=d+=(g+=U*(5*F))>>>13,v+=I*F,v+=w*k,v+=T*L,v+=C*M,d=(v+=_*x)>>>13,v&=8191,v+=D*B,v+=R*P,v+=N*(5*j),v+=O*(5*H),b=d+=(v+=U*(5*V))>>>13,b+=I*V,b+=w*F,b+=T*k,b+=C*L,d=(b+=_*M)>>>13,b&=8191,b+=D*x,b+=R*B,b+=N*P,b+=O*(5*j),E=d+=(b+=U*(5*H))>>>13,E+=I*H,E+=w*V,E+=T*F,E+=C*k,d=(E+=_*L)>>>13,E&=8191,E+=D*M,E+=R*x,E+=N*B,E+=O*P,S=d+=(E+=U*(5*j))>>>13,S+=I*j,S+=w*H,S+=T*V,S+=C*F,d=(S+=_*k)>>>13,S&=8191,S+=D*L,S+=R*M,S+=N*x,S+=O*B,I=l=8191&(d=(d=((d+=(S+=U*P)>>>13)<<2)+d|0)+(l&=8191)|0),w=f+=d>>>=13,T=p&=8191,C=y&=8191,_=m&=8191,D=g&=8191,R=v&=8191,N=b&=8191,O=E&=8191,U=S&=8191,t+=16,r-=16;this.h[0]=I,this.h[1]=w,this.h[2]=T,this.h[3]=C,this.h[4]=_,this.h[5]=D,this.h[6]=R,this.h[7]=N,this.h[8]=O,this.h[9]=U},T.prototype.finish=function(e,t){var r,n,i,s,o=new Uint16Array(10);if(this.leftover){for(s=this.leftover,this.buffer[s++]=1;s<16;s++)this.buffer[s]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,s=2;s<10;s++)this.h[s]+=r,r=this.h[s]>>>13,this.h[s]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this.h[s]+r,r=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,n=(1^r)-1,s=0;s<10;s++)o[s]&=n;for(n=~n,s=0;s<10;s++)this.h[s]=this.h[s]&n|o[s];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,s=1;s<8;s++)i=(this.h[s]+this.pad[s]|0)+(i>>>16)|0,this.h[s]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},T.prototype.update=function(e,t,r){var n,i;if(this.leftover){for((i=16-this.leftover)>r&&(i=r),n=0;n<i;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(i=r-r%16,this.blocks(e,t,i),t+=i,r-=i),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var $=D,W=R;var Y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Q(e,t,r,n){for(var i,s,o,a,c,u,h,d,l,f,p,y,m,g,v,b,E,S,A,I,w,T,C,_,D,R,N=new Int32Array(16),O=new Int32Array(16),U=e[0],P=e[1],B=e[2],x=e[3],M=e[4],L=e[5],k=e[6],F=e[7],V=t[0],H=t[1],j=t[2],K=t[3],q=t[4],G=t[5],z=t[6],$=t[7],W=0;n>=128;){for(A=0;A<16;A++)I=8*A+W,N[A]=r[I+0]<<24|r[I+1]<<16|r[I+2]<<8|r[I+3],O[A]=r[I+4]<<24|r[I+5]<<16|r[I+6]<<8|r[I+7];for(A=0;A<80;A++)if(i=U,s=P,o=B,a=x,c=M,u=L,h=k,F,l=V,f=H,p=j,y=K,m=q,g=G,v=z,$,C=65535&(T=$),_=T>>>16,D=65535&(w=F),R=w>>>16,C+=65535&(T=(q>>>14|M<<18)^(q>>>18|M<<14)^(M>>>9|q<<23)),_+=T>>>16,D+=65535&(w=(M>>>14|q<<18)^(M>>>18|q<<14)^(q>>>9|M<<23)),R+=w>>>16,C+=65535&(T=q&G^~q&z),_+=T>>>16,D+=65535&(w=M&L^~M&k),R+=w>>>16,C+=65535&(T=Y[2*A+1]),_+=T>>>16,D+=65535&(w=Y[2*A]),R+=w>>>16,w=N[A%16],_+=(T=O[A%16])>>>16,D+=65535&w,R+=w>>>16,D+=(_+=(C+=65535&T)>>>16)>>>16,C=65535&(T=S=65535&C|_<<16),_=T>>>16,D=65535&(w=E=65535&D|(R+=D>>>16)<<16),R=w>>>16,C+=65535&(T=(V>>>28|U<<4)^(U>>>2|V<<30)^(U>>>7|V<<25)),_+=T>>>16,D+=65535&(w=(U>>>28|V<<4)^(V>>>2|U<<30)^(V>>>7|U<<25)),R+=w>>>16,_+=(T=V&H^V&j^H&j)>>>16,D+=65535&(w=U&P^U&B^P&B),R+=w>>>16,d=65535&(D+=(_+=(C+=65535&T)>>>16)>>>16)|(R+=D>>>16)<<16,b=65535&C|_<<16,C=65535&(T=y),_=T>>>16,D=65535&(w=a),R=w>>>16,_+=(T=S)>>>16,D+=65535&(w=E),R+=w>>>16,P=i,B=s,x=o,M=a=65535&(D+=(_+=(C+=65535&T)>>>16)>>>16)|(R+=D>>>16)<<16,L=c,k=u,F=h,U=d,H=l,j=f,K=p,q=y=65535&C|_<<16,G=m,z=g,$=v,V=b,A%16==15)for(I=0;I<16;I++)w=N[I],C=65535&(T=O[I]),_=T>>>16,D=65535&w,R=w>>>16,w=N[(I+9)%16],C+=65535&(T=O[(I+9)%16]),_+=T>>>16,D+=65535&w,R+=w>>>16,E=N[(I+1)%16],C+=65535&(T=((S=O[(I+1)%16])>>>1|E<<31)^(S>>>8|E<<24)^(S>>>7|E<<25)),_+=T>>>16,D+=65535&(w=(E>>>1|S<<31)^(E>>>8|S<<24)^E>>>7),R+=w>>>16,E=N[(I+14)%16],_+=(T=((S=O[(I+14)%16])>>>19|E<<13)^(E>>>29|S<<3)^(S>>>6|E<<26))>>>16,D+=65535&(w=(E>>>19|S<<13)^(S>>>29|E<<3)^E>>>6),R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,N[I]=65535&D|R<<16,O[I]=65535&C|_<<16;C=65535&(T=V),_=T>>>16,D=65535&(w=U),R=w>>>16,w=e[0],_+=(T=t[0])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[0]=U=65535&D|R<<16,t[0]=V=65535&C|_<<16,C=65535&(T=H),_=T>>>16,D=65535&(w=P),R=w>>>16,w=e[1],_+=(T=t[1])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[1]=P=65535&D|R<<16,t[1]=H=65535&C|_<<16,C=65535&(T=j),_=T>>>16,D=65535&(w=B),R=w>>>16,w=e[2],_+=(T=t[2])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[2]=B=65535&D|R<<16,t[2]=j=65535&C|_<<16,C=65535&(T=K),_=T>>>16,D=65535&(w=x),R=w>>>16,w=e[3],_+=(T=t[3])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[3]=x=65535&D|R<<16,t[3]=K=65535&C|_<<16,C=65535&(T=q),_=T>>>16,D=65535&(w=M),R=w>>>16,w=e[4],_+=(T=t[4])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[4]=M=65535&D|R<<16,t[4]=q=65535&C|_<<16,C=65535&(T=G),_=T>>>16,D=65535&(w=L),R=w>>>16,w=e[5],_+=(T=t[5])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[5]=L=65535&D|R<<16,t[5]=G=65535&C|_<<16,C=65535&(T=z),_=T>>>16,D=65535&(w=k),R=w>>>16,w=e[6],_+=(T=t[6])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[6]=k=65535&D|R<<16,t[6]=z=65535&C|_<<16,C=65535&(T=$),_=T>>>16,D=65535&(w=F),R=w>>>16,w=e[7],_+=(T=t[7])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[7]=F=65535&D|R<<16,t[7]=$=65535&C|_<<16,W+=128,n-=128}return n}function J(e,t,r){var n,i=new Int32Array(8),s=new Int32Array(8),o=new Uint8Array(256),a=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,Q(i,s,t,r),r%=128,n=0;n<r;n++)o[n]=t[a-r+n];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,p(o,r-8,a/536870912|0,a<<3),Q(i,s,o,r),n=0;n<8;n++)p(e,8*n,i[n],s[n]);return 0}function X(e,r){var n=t(),i=t(),s=t(),o=t(),a=t(),c=t(),u=t(),d=t(),l=t();k(n,e[1],e[0]),k(l,r[1],r[0]),F(n,n,l),L(i,e[0],e[1]),L(l,r[0],r[1]),F(i,i,l),F(s,e[3],r[3]),F(s,s,h),F(o,e[2],r[2]),L(o,o,o),k(a,i,n),k(c,o,s),L(u,o,s),L(d,i,n),F(e[0],a,c),F(e[1],d,u),F(e[2],u,c),F(e[3],a,d)}function Z(e,t,r){var n;for(n=0;n<4;n++)U(e[n],t[n],r)}function ee(e,r){var n=t(),i=t(),s=t();H(s,r[2]),F(n,r[0],s),F(i,r[1],s),P(e,i),e[31]^=x(n)<<7}function te(e,t,r){var n,i;for(N(e[0],o),N(e[1],a),N(e[2],a),N(e[3],o),i=255;i>=0;--i)Z(e,t,n=r[i/8|0]>>(7&i)&1),X(t,e),X(e,e),Z(e,t,n)}function re(e,r){var n=[t(),t(),t(),t()];N(n[0],d),N(n[1],l),N(n[2],a),F(n[3],d,l),te(e,n,r)}function ne(e,r,i){var s,o=new Uint8Array(64),a=[t(),t(),t(),t()];for(i||n(r,32),J(o,r,32),o[0]&=248,o[31]&=127,o[31]|=64,re(a,o),ee(e,a),s=0;s<32;s++)r[s+32]=e[s];return 0}var ie=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function se(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*ie[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*ie[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*ie[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;se(e,r)}function ae(e,r,n,i){var s,o,a=new Uint8Array(64),c=new Uint8Array(64),u=new Uint8Array(64),h=new Float64Array(64),d=[t(),t(),t(),t()];J(a,i,32),a[0]&=248,a[31]&=127,a[31]|=64;var l=n+64;for(s=0;s<n;s++)e[64+s]=r[s];for(s=0;s<32;s++)e[32+s]=a[32+s];for(J(u,e.subarray(32),n+32),oe(u),re(d,u),ee(e,d),s=32;s<64;s++)e[s]=i[s];for(J(c,e,n+64),oe(c),s=0;s<64;s++)h[s]=0;for(s=0;s<32;s++)h[s]=u[s];for(s=0;s<32;s++)for(o=0;o<32;o++)h[s+o]+=c[s]*a[o];return se(e.subarray(32),h),l}function ce(e,r,n,i){var s,c=new Uint8Array(32),h=new Uint8Array(64),d=[t(),t(),t(),t()],l=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),i=t(),s=t(),c=t(),h=t(),d=t(),l=t();return N(e[2],a),M(e[1],r),V(s,e[1]),F(c,s,u),k(s,s,e[2]),L(c,e[2],c),V(h,c),V(d,h),F(l,d,h),F(n,l,s),F(n,n,c),j(n,n),F(n,n,s),F(n,n,c),F(n,n,c),F(e[0],n,c),V(i,e[0]),F(i,i,c),B(i,s)&&F(e[0],e[0],f),V(i,e[0]),F(i,i,c),B(i,s)?-1:(x(e[0])===r[31]>>7&&k(e[0],o,e[0]),F(e[3],e[0],e[1]),0)}(l,i))return-1;for(s=0;s<n;s++)e[s]=r[s];for(s=0;s<32;s++)e[s+32]=i[s];if(J(h,e,n),oe(h),te(d,l,h),re(l,r.subarray(32)),X(d,l),ee(c,d),n-=64,g(r,0,c,0)){for(s=0;s<n;s++)e[s]=0;return-1}for(s=0;s<n;s++)e[s]=r[s+64];return n}var ue=16,he=64,de=32,le=64;function fe(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function pe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ye(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:b,crypto_stream_xor:w,crypto_stream:I,crypto_stream_salsa20_xor:S,crypto_stream_salsa20:A,crypto_onetimeauth:C,crypto_onetimeauth_verify:_,crypto_verify_16:m,crypto_verify_32:g,crypto_secretbox:D,crypto_secretbox_open:R,crypto_scalarmult:K,crypto_scalarmult_base:q,crypto_box_beforenm:z,crypto_box_afternm:$,crypto_box:function(e,t,r,n,i,s){var o=new Uint8Array(32);return z(o,i,s),$(e,t,r,n,o)},crypto_box_open:function(e,t,r,n,i,s){var o=new Uint8Array(32);return z(o,i,s),W(e,t,r,n,o)},crypto_box_keypair:G,crypto_hash:J,crypto_sign:ae,crypto_sign_keypair:ne,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:ue,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:he,crypto_sign_PUBLICKEYBYTES:de,crypto_sign_SECRETKEYBYTES:le,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:u,L:ie,pack25519:P,unpack25519:M,M:F,A:L,S:V,Z:k,pow2523:j,add:X,set25519:N,modL:se,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,r){pe(e,t,r),fe(r,t);for(var n=new Uint8Array(32+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+32]=e[s];return D(i,n,n.length,t,r),i.subarray(ue)},e.secretbox.open=function(e,t,r){pe(e,t,r),fe(r,t);for(var n=new Uint8Array(ue+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+ue]=e[s];return n.length<32||0!==R(i,n,n.length,t,r)?null:i.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=ue,e.scalarMult=function(e,t){if(pe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return K(r,e,t),r},e.scalarMult.base=function(e){if(pe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return q(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox(t,r,s)},e.box.before=function(e,t){pe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return z(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox.open(t,r,s)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return G(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(pe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return q(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(pe(e,t),t.length!==le)throw new Error("bad secret key size");var r=new Uint8Array(he+e.length);return ae(r,e,e.length,t),r},e.sign.open=function(e,t){if(pe(e,t),t.length!==de)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ce(r,e,e.length,t);if(n<0)return null;for(var i=new Uint8Array(n),s=0;s<i.length;s++)i[s]=r[s];return i},e.sign.detached=function(t,r){for(var n=e.sign(t,r),i=new Uint8Array(he),s=0;s<i.length;s++)i[s]=n[s];return i},e.sign.detached.verify=function(e,t,r){if(pe(e,t,r),t.length!==he)throw new Error("bad signature size");if(r.length!==de)throw new Error("bad public key size");var n,i=new Uint8Array(he+e.length),s=new Uint8Array(he+e.length);for(n=0;n<he;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+he]=e[n];return ce(s,i,i.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(de),t=new Uint8Array(le);return ne(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(pe(e),e.length!==le)throw new Error("bad secret key size");for(var t=new Uint8Array(de),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(pe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(de),r=new Uint8Array(le),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=de,e.sign.secretKeyLength=le,e.sign.seedLength=32,e.sign.signatureLength=he,e.hash=function(e){pe(e);var t=new Uint8Array(64);return J(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return pe(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===y(e,0,t,0,e.length))},e.setPRNG=function(e){n=e},function(){var t="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){e.setPRNG((function(e,r){var n,i=new Uint8Array(r);for(n=0;n<r;n+=65536)t.getRandomValues(i.subarray(n,n+Math.min(r-n,65536)));for(n=0;n<r;n++)e[n]=i[n];ye(i)}))}else(t=r(6113))&&t.randomBytes&&e.setPRNG((function(e,r){var n,i=t.randomBytes(r);for(n=0;n<r;n++)e[n]=i[n];ye(i)}))}()}(e.exports?e.exports:self.nacl=self.nacl||{})},639:(e,t,r)=>{"use strict";var n=r(8811),i=r(8627),s=r(6181),o=r(4530),a=r(5386);e.exports=function(e){return null==e||"object"!=typeof e&&"function"!=typeof e?null:n(e)?"String":i(e)?"Number":s(e)?"Boolean":o(e)?"Symbol":a(e)?"BigInt":void 0}},7945:(e,t,r)=>{"use strict";var n=r(2040),i=r(8087),s=r(6610),o=s("Object.prototype.toString"),a=r(1375)(),c="undefined"==typeof globalThis?global:globalThis,u=i(),h=s("String.prototype.slice"),d={},l=r(2752),f=Object.getPrototypeOf;a&&l&&f&&n(u,(function(e){if("function"==typeof c[e]){var t=new c[e];if(Symbol.toStringTag in t){var r=f(t),n=l(r,Symbol.toStringTag);if(!n){var i=f(r);n=l(i,Symbol.toStringTag)}d[e]=n.get}}}));var p=r(6898);e.exports=function(e){return!!p(e)&&(a&&Symbol.toStringTag in e?function(e){var t=!1;return n(d,(function(r,n){if(!t)try{var i=r.call(e);i===n&&(t=i)}catch(e){}})),t}(e):h(o(e),8,-1))}},6079:function(e,t){(function(){"use strict";t.stripBOM=function(e){return"\ufeff"===e[0]?e.substring(1):e}}).call(this)},3170:function(e,t,r){(function(){"use strict";var e,n,i,s,o,a={}.hasOwnProperty;e=r(9015),n=r(5290).defaults,s=function(e){return"string"==typeof e&&(e.indexOf("&")>=0||e.indexOf(">")>=0||e.indexOf("<")>=0)},o=function(e){return"<![CDATA["+i(e)+"]]>"},i=function(e){return e.replace("]]>","]]]]><![CDATA[>")},t.Builder=function(){function t(e){var t,r,i;for(t in this.options={},r=n[.2])a.call(r,t)&&(i=r[t],this.options[t]=i);for(t in e)a.call(e,t)&&(i=e[t],this.options[t]=i)}return t.prototype.buildObject=function(t){var r,i,c,u,h,d;return r=this.options.attrkey,i=this.options.charkey,1===Object.keys(t).length&&this.options.rootName===n[.2].rootName?t=t[h=Object.keys(t)[0]]:h=this.options.rootName,d=this,c=function(e,t){var n,u,h,l,f,p;if("object"!=typeof t)d.options.cdata&&s(t)?e.raw(o(t)):e.txt(t);else if(Array.isArray(t)){for(l in t)if(a.call(t,l))for(f in u=t[l])h=u[f],e=c(e.ele(f),h).up()}else for(f in t)if(a.call(t,f))if(u=t[f],f===r){if("object"==typeof u)for(n in u)p=u[n],e=e.att(n,p)}else if(f===i)e=d.options.cdata&&s(u)?e.raw(o(u)):e.txt(u);else if(Array.isArray(u))for(l in u)a.call(u,l)&&(e="string"==typeof(h=u[l])?d.options.cdata&&s(h)?e.ele(f).raw(o(h)).up():e.ele(f,h).up():c(e.ele(f),h).up());else"object"==typeof u?e=c(e.ele(f),u).up():"string"==typeof u&&d.options.cdata&&s(u)?e=e.ele(f).raw(o(u)).up():(null==u&&(u=""),e=e.ele(f,u.toString()).up());return e},u=e.create(h,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),c(u,t).end(this.options.renderOpts)},t}()}).call(this)},5290:function(e,t){(function(){t.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(this)},2841:function(e,t,r){(function(){"use strict";var e,n,i,s,o,a,c,u,h=function(e,t){return function(){return e.apply(t,arguments)}},d={}.hasOwnProperty;c=r(915),i=r(2361),e=r(6079),a=r(9906),u=r(9512).setImmediate,n=r(5290).defaults,s=function(e){return"object"==typeof e&&null!=e&&0===Object.keys(e).length},o=function(e,t,r){var n,i;for(n=0,i=e.length;n<i;n++)t=(0,e[n])(t,r);return t},t.Parser=function(r){function i(e){var r,i,s;if(this.parseStringPromise=h(this.parseStringPromise,this),this.parseString=h(this.parseString,this),this.reset=h(this.reset,this),this.assignOrPush=h(this.assignOrPush,this),this.processAsync=h(this.processAsync,this),!(this instanceof t.Parser))return new t.Parser(e);for(r in this.options={},i=n[.2])d.call(i,r)&&(s=i[r],this.options[r]=s);for(r in e)d.call(e,r)&&(s=e[r],this.options[r]=s);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(a.normalize)),this.reset()}return function(e,t){for(var r in t)d.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(i,r),i.prototype.processAsync=function(){var e,t;try{return this.remaining.length<=this.options.chunkSize?(e=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(e),this.saxParser.close()):(e=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(e),u(this.processAsync))}catch(e){if(t=e,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(t)}},i.prototype.assignOrPush=function(e,t,r){return t in e?(e[t]instanceof Array||(e[t]=[e[t]]),e[t].push(r)):this.options.explicitArray?e[t]=[r]:e[t]=r},i.prototype.reset=function(){var e,t,r,n,i;return this.removeAllListeners(),this.saxParser=c.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(i=this,function(e){if(i.saxParser.resume(),!i.saxParser.errThrown)return i.saxParser.errThrown=!0,i.emit("error",e)}),this.saxParser.onend=function(e){return function(){if(!e.saxParser.ended)return e.saxParser.ended=!0,e.emit("end",e.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,n=[],e=this.options.attrkey,t=this.options.charkey,this.saxParser.onopentag=function(r){return function(i){var s,a,c,u,h;if((c={})[t]="",!r.options.ignoreAttrs)for(s in h=i.attributes)d.call(h,s)&&(e in c||r.options.mergeAttrs||(c[e]={}),a=r.options.attrValueProcessors?o(r.options.attrValueProcessors,i.attributes[s],s):i.attributes[s],u=r.options.attrNameProcessors?o(r.options.attrNameProcessors,s):s,r.options.mergeAttrs?r.assignOrPush(c,u,a):c[e][u]=a);return c["#name"]=r.options.tagNameProcessors?o(r.options.tagNameProcessors,i.name):i.name,r.options.xmlns&&(c[r.options.xmlnskey]={uri:i.uri,local:i.local}),n.push(c)}}(this),this.saxParser.onclosetag=function(e){return function(){var r,i,a,c,u,h,l,f,p,y;if(h=n.pop(),u=h["#name"],e.options.explicitChildren&&e.options.preserveChildrenOrder||delete h["#name"],!0===h.cdata&&(r=h.cdata,delete h.cdata),p=n[n.length-1],h[t].match(/^\s*$/)&&!r?(i=h[t],delete h[t]):(e.options.trim&&(h[t]=h[t].trim()),e.options.normalize&&(h[t]=h[t].replace(/\s{2,}/g," ").trim()),h[t]=e.options.valueProcessors?o(e.options.valueProcessors,h[t],u):h[t],1===Object.keys(h).length&&t in h&&!e.EXPLICIT_CHARKEY&&(h=h[t])),s(h)&&(h=""!==e.options.emptyTag?e.options.emptyTag:i),null!=e.options.validator&&(y="/"+function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)c=n[e],r.push(c["#name"]);return r}().concat(u).join("/"),function(){var t;try{h=e.options.validator(y,p&&p[u],h)}catch(r){return t=r,e.emit("error",t)}}()),e.options.explicitChildren&&!e.options.mergeAttrs&&"object"==typeof h)if(e.options.preserveChildrenOrder){if(p){for(a in p[e.options.childkey]=p[e.options.childkey]||[],l={},h)d.call(h,a)&&(l[a]=h[a]);p[e.options.childkey].push(l),delete h["#name"],1===Object.keys(h).length&&t in h&&!e.EXPLICIT_CHARKEY&&(h=h[t])}}else c={},e.options.attrkey in h&&(c[e.options.attrkey]=h[e.options.attrkey],delete h[e.options.attrkey]),!e.options.charsAsChildren&&e.options.charkey in h&&(c[e.options.charkey]=h[e.options.charkey],delete h[e.options.charkey]),Object.getOwnPropertyNames(h).length>0&&(c[e.options.childkey]=h),h=c;return n.length>0?e.assignOrPush(p,u,h):(e.options.explicitRoot&&(f=h,(h={})[u]=f),e.resultObject=h,e.saxParser.ended=!0,e.emit("end",e.resultObject))}}(this),r=function(e){return function(r){var i,s;if(s=n[n.length-1])return s[t]+=r,e.options.explicitChildren&&e.options.preserveChildrenOrder&&e.options.charsAsChildren&&(e.options.includeWhiteChars||""!==r.replace(/\\n/g,"").trim())&&(s[e.options.childkey]=s[e.options.childkey]||[],(i={"#name":"__text__"})[t]=r,e.options.normalize&&(i[t]=i[t].replace(/\s{2,}/g," ").trim()),s[e.options.childkey].push(i)),s}}(this),this.saxParser.ontext=r,this.saxParser.oncdata=function(e){var t;if(t=r(e))return t.cdata=!0}},i.prototype.parseString=function(t,r){var n;null!=r&&"function"==typeof r&&(this.on("end",(function(e){return this.reset(),r(null,e)})),this.on("error",(function(e){return this.reset(),r(e)})));try{return""===(t=t.toString()).trim()?(this.emit("end",null),!0):(t=e.stripBOM(t),this.options.async?(this.remaining=t,u(this.processAsync),this.saxParser):this.saxParser.write(t).close())}catch(e){if(n=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",n),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw n}},i.prototype.parseStringPromise=function(e){return new Promise((t=this,function(r,n){return t.parseString(e,(function(e,t){return e?n(e):r(t)}))}));var t},i}(i),t.parseString=function(e,r,n){var i,s;return null!=n?("function"==typeof n&&(i=n),"object"==typeof r&&(s=r)):("function"==typeof r&&(i=r),s={}),new t.Parser(s).parseString(e,i)},t.parseStringPromise=function(e,r){var n;return"object"==typeof r&&(n=r),new t.Parser(n).parseStringPromise(e)}}).call(this)},9906:function(e,t){(function(){"use strict";var e;e=new RegExp(/(?!xmlns)^.*:/),t.normalize=function(e){return e.toLowerCase()},t.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},t.stripPrefix=function(t){return t.replace(e,"")},t.parseNumbers=function(e){return isNaN(e)||(e=e%1==0?parseInt(e,10):parseFloat(e)),e},t.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e="true"===e.toLowerCase()),e}}).call(this)},6227:function(e,t,r){(function(){"use strict";var e,n,i,s,o={}.hasOwnProperty;n=r(5290),e=r(3170),i=r(2841),s=r(9906),t.defaults=n.defaults,t.processors=s,t.ValidationError=function(e){function t(e){this.message=e}return function(e,t){for(var r in t)o.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(t,Error),t}(),t.Builder=e.Builder,t.Parser=i.Parser,t.parseString=i.parseString,t.parseStringPromise=i.parseStringPromise}).call(this)},2074:function(e){(function(){e.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(this)},6895:function(e){(function(){e.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(this)},7628:function(e){(function(){var t,r,n,i,s,o,a,c=[].slice,u={}.hasOwnProperty;t=function(){var e,t,r,n,i,o;if(o=arguments[0],i=2<=arguments.length?c.call(arguments,1):[],s(Object.assign))Object.assign.apply(null,arguments);else for(e=0,r=i.length;e<r;e++)if(null!=(n=i[e]))for(t in n)u.call(n,t)&&(o[t]=n[t]);return o},s=function(e){return!!e&&"[object Function]"===Object.prototype.toString.call(e)},o=function(e){var t;return!!e&&("function"==(t=typeof e)||"object"===t)},n=function(e){return s(Array.isArray)?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)},i=function(e){var t;if(n(e))return!e.length;for(t in e)if(u.call(e,t))return!1;return!0},a=function(e){var t,r;return o(e)&&(r=Object.getPrototypeOf(e))&&(t=r.constructor)&&"function"==typeof t&&t instanceof t&&Function.prototype.toString.call(t)===Function.prototype.toString.call(Object)},r=function(e){return s(e.valueOf)?e.valueOf():e},e.exports.assign=t,e.exports.isFunction=s,e.exports.isObject=o,e.exports.isArray=n,e.exports.isEmpty=i,e.exports.isPlainObject=a,e.exports.getValue=r}).call(this)},9497:function(e){(function(){e.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(this)},8453:function(e,t,r){(function(){var t;t=r(6895),r(5338),e.exports=function(){function e(e,r,n){if(this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==r)throw new Error("Missing attribute name. "+this.debugInfo(r));this.name=this.stringify.name(r),this.value=this.stringify.attValue(n),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(e){return this.options.writer.attribute(this,this.options.writer.filterOptions(e))},e.prototype.debugInfo=function(e){return null==(e=e||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+e+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(e){return e.namespaceURI===this.namespaceURI&&(e.prefix===this.prefix&&(e.localName===this.localName&&e.value===this.value))},e}()}).call(this)},8397:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(6895),n=r(5039),e.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(n)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.cdata(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},5039:function(e,t,r){(function(){var t,n={}.hasOwnProperty;t=r(5338),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e),this.value=""}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(e){return this.value=e||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(e){return this.value=e||""}}),t.prototype.clone=function(){return Object.create(this)},t.prototype.substringData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.appendData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.insertData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.deleteData=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.replaceData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},t.prototype.isEqualNode=function(e){return!!t.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.data===this.data},t}(t)}).call(this)},2784:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(6895),n=r(5039),e.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(n)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.comment(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},3002:function(e,t,r){(function(){var t,n;t=r(5862),n=r(4064),e.exports=function(){function e(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(e.prototype,"parameterNames",{get:function(){return new n(Object.keys(this.defaultParams))}}),e.prototype.getParameter=function(e){return this.params.hasOwnProperty(e)?this.params[e]:null},e.prototype.canSetParameter=function(e,t){return!0},e.prototype.setParameter=function(e,t){return null!=t?this.params[e]=t:delete this.params[e]},e}()}).call(this)},5862:function(e){(function(){e.exports=function(){function e(){}return e.prototype.handleError=function(e){throw new Error(e)},e}()}).call(this)},3707:function(e){(function(){e.exports=function(){function e(){}return e.prototype.hasFeature=function(e,t){return!0},e.prototype.createDocumentType=function(e,t,r){throw new Error("This DOM method is not implemented.")},e.prototype.createDocument=function(e,t,r){throw new Error("This DOM method is not implemented.")},e.prototype.createHTMLDocument=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},4064:function(e){(function(){e.exports=function(){function e(e){this.arr=e||[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length}}),e.prototype.item=function(e){return this.arr[e]||null},e.prototype.contains=function(e){return-1!==this.arr.indexOf(e)},e}()}).call(this)},5147:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;n=r(5338),t=r(6895),e.exports=function(e){function r(e,n,i,s,o,a){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==i)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!s)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!o)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==o.indexOf("#")&&(o="#"+o),!o.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(a&&!o.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(i),this.attributeType=this.stringify.dtdAttType(s),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=o}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},3856:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;n=r(5338),t=r(6895),e.exports=function(e){function r(e,n,i){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());i||(i="(#PCDATA)"),Array.isArray(i)&&(i="("+i.join(",")+")"),this.name=this.stringify.name(n),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(i)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},3478:function(e,t,r){(function(){var t,n,i,s={}.hasOwnProperty;i=r(7628).isObject,n=r(5338),t=r(6895),e.exports=function(e){function r(e,n,s,o){if(r.__super__.constructor.call(this,e),null==s)throw new Error("Missing DTD entity name. "+this.debugInfo(s));if(null==o)throw new Error("Missing DTD entity value. "+this.debugInfo(s));if(this.pe=!!n,this.name=this.stringify.name(s),this.type=t.EntityDeclaration,i(o)){if(!o.pubID&&!o.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(s));if(o.pubID&&!o.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(s));if(this.internal=!1,null!=o.pubID&&(this.pubID=this.stringify.dtdPubID(o.pubID)),null!=o.sysID&&(this.sysID=this.stringify.dtdSysID(o.sysID)),null!=o.nData&&(this.nData=this.stringify.dtdNData(o.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(s))}else this.value=this.stringify.dtdEntityValue(o),this.internal=!0}return function(e,t){for(var r in t)s.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return null}}),r.prototype.toString=function(e){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},4416:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;n=r(5338),t=r(6895),e.exports=function(e){function r(e,n,i){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!i.pubID&&!i.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=t.NotationDeclaration,null!=i.pubID&&(this.pubID=this.stringify.dtdPubID(i.pubID)),null!=i.sysID&&(this.sysID=this.stringify.dtdSysID(i.sysID))}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),r.prototype.toString=function(e){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},7281:function(e,t,r){(function(){var t,n,i,s={}.hasOwnProperty;i=r(7628).isObject,n=r(5338),t=r(6895),e.exports=function(e){function r(e,n,s,o){var a;r.__super__.constructor.call(this,e),i(n)&&(n=(a=n).version,s=a.encoding,o=a.standalone),n||(n="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(n),null!=s&&(this.encoding=this.stringify.xmlEncoding(s)),null!=o&&(this.standalone=this.stringify.xmlStandalone(o))}return function(e,t){for(var r in t)s.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.toString=function(e){return this.options.writer.declaration(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},9233:function(e,t,r){(function(){var t,n,i,s,o,a,c,u,h={}.hasOwnProperty;u=r(7628).isObject,c=r(5338),t=r(6895),n=r(5147),s=r(3478),i=r(3856),o=r(4416),a=r(8283),e.exports=function(e){function r(e,n,i){var s,o,a,c,h,d;if(r.__super__.constructor.call(this,e),this.type=t.DocType,e.children)for(o=0,a=(c=e.children).length;o<a;o++)if((s=c[o]).type===t.Element){this.name=s.name;break}this.documentObject=e,u(n)&&(n=(h=n).pubID,i=h.sysID),null==i&&(i=(d=[n,i])[0],n=d[1]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=i&&(this.sysID=this.stringify.dtdSysID(i))}return function(e,t){for(var r in t)h.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"entities",{get:function(){var e,r,n,i,s;for(i={},r=0,n=(s=this.children).length;r<n;r++)(e=s[r]).type!==t.EntityDeclaration||e.pe||(i[e.name]=e);return new a(i)}}),Object.defineProperty(r.prototype,"notations",{get:function(){var e,r,n,i,s;for(i={},r=0,n=(s=this.children).length;r<n;r++)(e=s[r]).type===t.NotationDeclaration&&(i[e.name]=e);return new a(i)}}),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(r.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),r.prototype.element=function(e,t){var r;return r=new i(this,e,t),this.children.push(r),this},r.prototype.attList=function(e,t,r,i,s){var o;return o=new n(this,e,t,r,i,s),this.children.push(o),this},r.prototype.entity=function(e,t){var r;return r=new s(this,!1,e,t),this.children.push(r),this},r.prototype.pEntity=function(e,t){var r;return r=new s(this,!0,e,t),this.children.push(r),this},r.prototype.notation=function(e,t){var r;return r=new o(this,e,t),this.children.push(r),this},r.prototype.toString=function(e){return this.options.writer.docType(this,this.options.writer.filterOptions(e))},r.prototype.ele=function(e,t){return this.element(e,t)},r.prototype.att=function(e,t,r,n,i){return this.attList(e,t,r,n,i)},r.prototype.ent=function(e,t){return this.entity(e,t)},r.prototype.pent=function(e,t){return this.pEntity(e,t)},r.prototype.not=function(e,t){return this.notation(e,t)},r.prototype.up=function(){return this.root()||this.documentObject},r.prototype.isEqualNode=function(e){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&(e.name===this.name&&(e.publicId===this.publicId&&e.systemId===this.systemId))},r}(c)}).call(this)},2423:function(e,t,r){(function(){var t,n,i,s,o,a,c,u={}.hasOwnProperty;c=r(7628).isPlainObject,i=r(3707),n=r(3002),s=r(5338),t=r(6895),a=r(1113),o=r(2086),e.exports=function(e){function r(e){r.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new n,e||(e={}),e.writer||(e.writer=new o),this.options=e,this.stringify=new a(e)}return function(e,t){for(var r in t)u.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"implementation",{value:new i}),Object.defineProperty(r.prototype,"doctype",{get:function(){var e,r,n,i;for(r=0,n=(i=this.children).length;r<n;r++)if((e=i[r]).type===t.DocType)return e;return null}}),Object.defineProperty(r.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(r.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(r.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(r.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(r.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(r.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(r.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(r.prototype,"origin",{get:function(){return null}}),Object.defineProperty(r.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(r.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(r.prototype,"contentType",{get:function(){return null}}),r.prototype.end=function(e){var t;return t={},e?c(e)&&(t=e,e=this.options.writer):e=this.options.writer,e.document(this,e.filterOptions(t))},r.prototype.toString=function(e){return this.options.writer.document(this,this.options.writer.filterOptions(e))},r.prototype.createElement=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTextNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createComment=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createCDATASection=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createProcessingInstruction=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttribute=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEntityReference=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.importNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createElementNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementById=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.adoptNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.renameNode=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createEvent=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createNodeIterator=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.createTreeWalker=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(s)}).call(this)},2881:function(e,t,r){(function(){var t,n,i,s,o,a,c,u,h,d,l,f,p,y,m,g,v,b,E,S,A,I,w,T={}.hasOwnProperty;w=r(7628),A=w.isObject,S=w.isFunction,I=w.isPlainObject,E=w.getValue,t=r(6895),f=r(2423),p=r(1031),s=r(8397),o=r(2784),m=r(596),b=r(693),y=r(979),d=r(7281),l=r(9233),a=r(5147),u=r(3478),c=r(3856),h=r(4416),i=r(8453),v=r(1113),g=r(2086),n=r(9497),e.exports=function(){function e(e,r,n){var i;this.name="?xml",this.type=t.Document,e||(e={}),i={},e.writer?I(e.writer)&&(i=e.writer,e.writer=new g):e.writer=new g,this.options=e,this.writer=e.writer,this.writerOptions=this.writer.filterOptions(i),this.stringify=new v(e),this.onDataCallback=r||function(){},this.onEndCallback=n||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return e.prototype.createChildNode=function(e){var r,n,i,s,o,a,c,u;switch(e.type){case t.CData:this.cdata(e.value);break;case t.Comment:this.comment(e.value);break;case t.Element:for(n in i={},c=e.attribs)T.call(c,n)&&(r=c[n],i[n]=r.value);this.node(e.name,i);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(e.value);break;case t.Text:this.text(e.value);break;case t.ProcessingInstruction:this.instruction(e.target,e.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+e.constructor.name)}for(o=0,a=(u=e.children).length;o<a;o++)s=u[o],this.createChildNode(s),s.type===t.Element&&this.up();return this},e.prototype.dummy=function(){return this},e.prototype.node=function(e,t,r){var n;if(null==e)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(e));return this.openCurrent(),e=E(e),null==t&&(t={}),t=E(t),A(t)||(r=(n=[t,r])[0],t=n[1]),this.currentNode=new p(this,e,t),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=r&&this.text(r),this},e.prototype.element=function(e,r,n){var i,s,o,a,c,u;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(e)||A(e)||S(e))for(a=this.options.noValidation,this.options.noValidation=!0,(u=new f(this.options).element("TEMP_ROOT")).element(e),this.options.noValidation=a,s=0,o=(c=u.children).length;s<o;s++)i=c[s],this.createChildNode(i),i.type===t.Element&&this.up();else this.node(e,r,n);return this},e.prototype.attribute=function(e,t){var r,n;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(e));if(null!=e&&(e=E(e)),A(e))for(r in e)T.call(e,r)&&(n=e[r],this.attribute(r,n));else S(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.currentNode.attribs[e]=new i(this,e,""):null!=t&&(this.currentNode.attribs[e]=new i(this,e,t));return this},e.prototype.text=function(e){var t;return this.openCurrent(),t=new b(this,e),this.onData(this.writer.text(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.cdata=function(e){var t;return this.openCurrent(),t=new s(this,e),this.onData(this.writer.cdata(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.comment=function(e){var t;return this.openCurrent(),t=new o(this,e),this.onData(this.writer.comment(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.raw=function(e){var t;return this.openCurrent(),t=new m(this,e),this.onData(this.writer.raw(t,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.instruction=function(e,t){var r,n,i,s,o;if(this.openCurrent(),null!=e&&(e=E(e)),null!=t&&(t=E(t)),Array.isArray(e))for(r=0,s=e.length;r<s;r++)n=e[r],this.instruction(n);else if(A(e))for(n in e)T.call(e,n)&&(i=e[n],this.instruction(n,i));else S(t)&&(t=t.apply()),o=new y(this,e,t),this.onData(this.writer.processingInstruction(o,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},e.prototype.declaration=function(e,t,r){var n;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return n=new d(this,e,t,r),this.onData(this.writer.declaration(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.doctype=function(e,t,r){if(this.openCurrent(),null==e)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,t,r),this.currentNode.rootNodeName=e,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},e.prototype.dtdElement=function(e,t){var r;return this.openCurrent(),r=new c(this,e,t),this.onData(this.writer.dtdElement(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.attList=function(e,t,r,n,i){var s;return this.openCurrent(),s=new a(this,e,t,r,n,i),this.onData(this.writer.dtdAttList(s,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.entity=function(e,t){var r;return this.openCurrent(),r=new u(this,!1,e,t),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.pEntity=function(e,t){var r;return this.openCurrent(),r=new u(this,!0,e,t),this.onData(this.writer.dtdEntity(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.notation=function(e,t){var r;return this.openCurrent(),r=new h(this,e,t),this.onData(this.writer.dtdNotation(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},e.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},e.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},e.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},e.prototype.openNode=function(e){var r,i,s,o;if(!e.isOpen){if(this.root||0!==this.currentLevel||e.type!==t.Element||(this.root=e),i="",e.type===t.Element){for(s in this.writerOptions.state=n.OpenTag,i=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<"+e.name,o=e.attribs)T.call(o,s)&&(r=o[s],i+=this.writer.attribute(r,this.writerOptions,this.currentLevel));i+=(e.children?">":"/>")+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=n.InsideTag}else this.writerOptions.state=n.OpenTag,i=this.writer.indent(e,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+e.rootNodeName,e.pubID&&e.sysID?i+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(i+=' SYSTEM "'+e.sysID+'"'),e.children?(i+=" [",this.writerOptions.state=n.InsideTag):(this.writerOptions.state=n.CloseTag,i+=">"),i+=this.writer.endline(e,this.writerOptions,this.currentLevel);return this.onData(i,this.currentLevel),e.isOpen=!0}},e.prototype.closeNode=function(e){var r;if(!e.isClosed)return r="",this.writerOptions.state=n.CloseTag,r=e.type===t.Element?this.writer.indent(e,this.writerOptions,this.currentLevel)+"</"+e.name+">"+this.writer.endline(e,this.writerOptions,this.currentLevel):this.writer.indent(e,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(e,this.writerOptions,this.currentLevel),this.writerOptions.state=n.None,this.onData(r,this.currentLevel),e.isClosed=!0},e.prototype.onData=function(e,t){return this.documentStarted=!0,this.onDataCallback(e,t+1)},e.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},e.prototype.debugInfo=function(e){return null==e?"":"node: <"+e+">"},e.prototype.ele=function(){return this.element.apply(this,arguments)},e.prototype.nod=function(e,t,r){return this.node(e,t,r)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.dec=function(e,t,r){return this.declaration(e,t,r)},e.prototype.dtd=function(e,t,r){return this.doctype(e,t,r)},e.prototype.e=function(e,t,r){return this.element(e,t,r)},e.prototype.n=function(e,t,r){return this.node(e,t,r)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},e.prototype.ent=function(e,t){return this.entity(e,t)},e.prototype.pent=function(e,t){return this.pEntity(e,t)},e.prototype.not=function(e,t){return this.notation(e,t)},e}()}).call(this)},5584:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;n=r(5338),t=r(6895),e.exports=function(e){function r(e){r.__super__.constructor.call(this,e),this.type=t.Dummy}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return""},r}(n)}).call(this)},1031:function(e,t,r){(function(){var t,n,i,s,o,a,c,u,h={}.hasOwnProperty;u=r(7628),c=u.isObject,a=u.isFunction,o=u.getValue,s=r(5338),t=r(6895),n=r(8453),i=r(8283),e.exports=function(e){function r(e,n,i){var s,o,a,c;if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,null!=i&&this.attribute(i),e.type===t.Document&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this,e.children))for(o=0,a=(c=e.children).length;o<a;o++)if((s=c[o]).type===t.DocType){s.name=this.name;break}}return function(e,t){for(var r in t)h.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(r.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(r.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(r.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new i(this.attribs)),this.attributeMap}}),r.prototype.clone=function(){var e,t,r,n;for(t in(r=Object.create(this)).isRoot&&(r.documentObject=null),r.attribs={},n=this.attribs)h.call(n,t)&&(e=n[t],r.attribs[t]=e.clone());return r.children=[],this.children.forEach((function(e){var t;return(t=e.clone()).parent=r,r.children.push(t)})),r},r.prototype.attribute=function(e,t){var r,i;if(null!=e&&(e=o(e)),c(e))for(r in e)h.call(e,r)&&(i=e[r],this.attribute(r,i));else a(t)&&(t=t.apply()),this.options.keepNullAttributes&&null==t?this.attribs[e]=new n(this,e,""):null!=t&&(this.attribs[e]=new n(this,e,t));return this},r.prototype.removeAttribute=function(e){var t,r,n;if(null==e)throw new Error("Missing attribute name. "+this.debugInfo());if(e=o(e),Array.isArray(e))for(r=0,n=e.length;r<n;r++)t=e[r],delete this.attribs[t];else delete this.attribs[e];return this},r.prototype.toString=function(e){return this.options.writer.element(this,this.options.writer.filterOptions(e))},r.prototype.att=function(e,t){return this.attribute(e,t)},r.prototype.a=function(e,t){return this.attribute(e,t)},r.prototype.getAttribute=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e].value:null},r.prototype.setAttribute=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNode=function(e){return this.attribs.hasOwnProperty(e)?this.attribs[e]:null},r.prototype.setAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.removeAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getAttributeNodeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setAttributeNodeNS=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.hasAttribute=function(e){return this.attribs.hasOwnProperty(e)},r.prototype.hasAttributeNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttribute=function(e,t){return this.attribs.hasOwnProperty(e)?this.attribs[e].isId:t},r.prototype.setIdAttributeNS=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.setIdAttributeNode=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByTagNameNS=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.getElementsByClassName=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.isEqualNode=function(e){var t,n,i;if(!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e))return!1;if(e.namespaceURI!==this.namespaceURI)return!1;if(e.prefix!==this.prefix)return!1;if(e.localName!==this.localName)return!1;if(e.attribs.length!==this.attribs.length)return!1;for(t=n=0,i=this.attribs.length-1;0<=i?n<=i:n>=i;t=0<=i?++n:--n)if(!this.attribs[t].isEqualNode(e.attribs[t]))return!1;return!0},r}(s)}).call(this)},8283:function(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.getNamedItem=function(e){return this.nodes[e]},e.prototype.setNamedItem=function(e){var t;return t=this.nodes[e.nodeName],this.nodes[e.nodeName]=e,t||null},e.prototype.removeNamedItem=function(e){var t;return t=this.nodes[e],delete this.nodes[e],t||null},e.prototype.item=function(e){return this.nodes[Object.keys(this.nodes)[e]]||null},e.prototype.getNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e.prototype.setNamedItemNS=function(e){throw new Error("This DOM method is not implemented.")},e.prototype.removeNamedItemNS=function(e,t){throw new Error("This DOM method is not implemented.")},e}()}).call(this)},5338:function(e,t,r){(function(){var t,n,i,s,o,a,c,u,h,d,l,f,p,y,m,g,v,b={}.hasOwnProperty;v=r(7628),g=v.isObject,m=v.isFunction,y=v.isEmpty,p=v.getValue,u=null,i=null,s=null,o=null,a=null,l=null,f=null,d=null,c=null,n=null,h=null,t=null,e.exports=function(){function e(e){this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,u||(u=r(1031),i=r(8397),s=r(2784),o=r(7281),a=r(9233),l=r(596),f=r(693),d=r(979),c=r(5584),n=r(6895),h=r(5691),r(8283),t=r(2074))}return Object.defineProperty(e.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(e.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new h(this.children)),this.childNodeList}}),Object.defineProperty(e.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(e.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(e.prototype,"previousSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e-1]||null}}),Object.defineProperty(e.prototype,"nextSibling",{get:function(){var e;return e=this.parent.children.indexOf(this),this.parent.children[e+1]||null}}),Object.defineProperty(e.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(e.prototype,"textContent",{get:function(){var e,t,r,i,s;if(this.nodeType===n.Element||this.nodeType===n.DocumentFragment){for(s="",t=0,r=(i=this.children).length;t<r;t++)(e=i[t]).textContent&&(s+=e.textContent);return s}return null},set:function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),e.prototype.setParent=function(e){var t,r,n,i,s;for(this.parent=e,e&&(this.options=e.options,this.stringify=e.stringify),s=[],r=0,n=(i=this.children).length;r<n;r++)t=i[r],s.push(t.setParent(this));return s},e.prototype.element=function(e,t,r){var n,i,s,o,a,c,u,h,d,l,f;if(c=null,null===t&&null==r&&(t=(d=[{},null])[0],r=d[1]),null==t&&(t={}),t=p(t),g(t)||(r=(l=[t,r])[0],t=l[1]),null!=e&&(e=p(e)),Array.isArray(e))for(s=0,u=e.length;s<u;s++)i=e[s],c=this.element(i);else if(m(e))c=this.element(e.apply());else if(g(e)){for(a in e)if(b.call(e,a))if(f=e[a],m(f)&&(f=f.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))c=this.attribute(a.substr(this.stringify.convertAttKey.length),f);else if(!this.options.separateArrayItems&&Array.isArray(f)&&y(f))c=this.dummy();else if(g(f)&&y(f))c=this.element(a);else if(this.options.keepNullNodes||null!=f)if(!this.options.separateArrayItems&&Array.isArray(f))for(o=0,h=f.length;o<h;o++)i=f[o],(n={})[a]=i,c=this.element(n);else g(f)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?c=this.element(f):(c=this.element(a)).element(f):c=this.element(a,f);else c=this.dummy()}else c=this.options.keepNullNodes||null!==r?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===e.indexOf(this.stringify.convertTextKey)?this.text(r):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===e.indexOf(this.stringify.convertCDataKey)?this.cdata(r):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===e.indexOf(this.stringify.convertCommentKey)?this.comment(r):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===e.indexOf(this.stringify.convertRawKey)?this.raw(r):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===e.indexOf(this.stringify.convertPIKey)?this.instruction(e.substr(this.stringify.convertPIKey.length),r):this.node(e,t,r):this.dummy();if(null==c)throw new Error("Could not create any elements with: "+e+". "+this.debugInfo());return c},e.prototype.insertBefore=function(e,t,r){var n,i,s,o,a;if(null!=e?e.type:void 0)return o=t,(s=e).setParent(this),o?(i=children.indexOf(o),a=children.splice(i),children.push(s),Array.prototype.push.apply(children,a)):children.push(s),s;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return i=this.parent.children.indexOf(this),a=this.parent.children.splice(i),n=this.parent.element(e,t,r),Array.prototype.push.apply(this.parent.children,a),n},e.prototype.insertAfter=function(e,t,r){var n,i,s;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(e));return i=this.parent.children.indexOf(this),s=this.parent.children.splice(i+1),n=this.parent.element(e,t,r),Array.prototype.push.apply(this.parent.children,s),n},e.prototype.remove=function(){var e;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return e=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[e,e-e+1].concat([])),this.parent},e.prototype.node=function(e,t,r){var n,i;return null!=e&&(e=p(e)),t||(t={}),t=p(t),g(t)||(r=(i=[t,r])[0],t=i[1]),n=new u(this,e,t),null!=r&&n.text(r),this.children.push(n),n},e.prototype.text=function(e){var t;return g(e)&&this.element(e),t=new f(this,e),this.children.push(t),this},e.prototype.cdata=function(e){var t;return t=new i(this,e),this.children.push(t),this},e.prototype.comment=function(e){var t;return t=new s(this,e),this.children.push(t),this},e.prototype.commentBefore=function(e){var t,r;return t=this.parent.children.indexOf(this),r=this.parent.children.splice(t),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,r),this},e.prototype.commentAfter=function(e){var t,r;return t=this.parent.children.indexOf(this),r=this.parent.children.splice(t+1),this.parent.comment(e),Array.prototype.push.apply(this.parent.children,r),this},e.prototype.raw=function(e){var t;return t=new l(this,e),this.children.push(t),this},e.prototype.dummy=function(){return new c(this)},e.prototype.instruction=function(e,t){var r,n,i,s,o;if(null!=e&&(e=p(e)),null!=t&&(t=p(t)),Array.isArray(e))for(s=0,o=e.length;s<o;s++)r=e[s],this.instruction(r);else if(g(e))for(r in e)b.call(e,r)&&(n=e[r],this.instruction(r,n));else m(t)&&(t=t.apply()),i=new d(this,e,t),this.children.push(i);return this},e.prototype.instructionBefore=function(e,t){var r,n;return r=this.parent.children.indexOf(this),n=this.parent.children.splice(r),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,n),this},e.prototype.instructionAfter=function(e,t){var r,n;return r=this.parent.children.indexOf(this),n=this.parent.children.splice(r+1),this.parent.instruction(e,t),Array.prototype.push.apply(this.parent.children,n),this},e.prototype.declaration=function(e,t,r){var i,s;return i=this.document(),s=new o(i,e,t,r),0===i.children.length?i.children.unshift(s):i.children[0].type===n.Declaration?i.children[0]=s:i.children.unshift(s),i.root()||i},e.prototype.dtd=function(e,t){var r,i,s,o,c,u,h,d,l;for(r=this.document(),i=new a(r,e,t),s=o=0,u=(d=r.children).length;o<u;s=++o)if(d[s].type===n.DocType)return r.children[s]=i,i;for(s=c=0,h=(l=r.children).length;c<h;s=++c)if(l[s].isRoot)return r.children.splice(s,0,i),i;return r.children.push(i),i},e.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},e.prototype.root=function(){var e;for(e=this;e;){if(e.type===n.Document)return e.rootObject;if(e.isRoot)return e;e=e.parent}},e.prototype.document=function(){var e;for(e=this;e;){if(e.type===n.Document)return e;e=e.parent}},e.prototype.end=function(e){return this.document().end(e)},e.prototype.prev=function(){var e;if((e=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[e-1]},e.prototype.next=function(){var e;if(-1===(e=this.parent.children.indexOf(this))||e===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[e+1]},e.prototype.importDocument=function(e){var t;return(t=e.root().clone()).parent=this,t.isRoot=!1,this.children.push(t),this},e.prototype.debugInfo=function(e){var t,r;return null!=(e=e||this.name)||(null!=(t=this.parent)?t.name:void 0)?null==e?"parent: <"+this.parent.name+">":(null!=(r=this.parent)?r.name:void 0)?"node: <"+e+">, parent: <"+this.parent.name+">":"node: <"+e+">":""},e.prototype.ele=function(e,t,r){return this.element(e,t,r)},e.prototype.nod=function(e,t,r){return this.node(e,t,r)},e.prototype.txt=function(e){return this.text(e)},e.prototype.dat=function(e){return this.cdata(e)},e.prototype.com=function(e){return this.comment(e)},e.prototype.ins=function(e,t){return this.instruction(e,t)},e.prototype.doc=function(){return this.document()},e.prototype.dec=function(e,t,r){return this.declaration(e,t,r)},e.prototype.e=function(e,t,r){return this.element(e,t,r)},e.prototype.n=function(e,t,r){return this.node(e,t,r)},e.prototype.t=function(e){return this.text(e)},e.prototype.d=function(e){return this.cdata(e)},e.prototype.c=function(e){return this.comment(e)},e.prototype.r=function(e){return this.raw(e)},e.prototype.i=function(e,t){return this.instruction(e,t)},e.prototype.u=function(){return this.up()},e.prototype.importXMLBuilder=function(e){return this.importDocument(e)},e.prototype.replaceChild=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.removeChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.appendChild=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.hasChildNodes=function(){return 0!==this.children.length},e.prototype.cloneNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isSupported=function(e,t){return!0},e.prototype.hasAttributes=function(){return 0!==this.attribs.length},e.prototype.compareDocumentPosition=function(e){var r,n;return(r=this)===e?0:this.document()!==e.document()?(n=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?n|=t.Preceding:n|=t.Following,n):r.isAncestor(e)?t.Contains|t.Preceding:r.isDescendant(e)?t.Contains|t.Following:r.isPreceding(e)?t.Preceding:t.Following},e.prototype.isSameNode=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupPrefix=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isDefaultNamespace=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.lookupNamespaceURI=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.isEqualNode=function(e){var t,r,n;if(e.nodeType!==this.nodeType)return!1;if(e.children.length!==this.children.length)return!1;for(t=r=0,n=this.children.length-1;0<=n?r<=n:r>=n;t=0<=n?++r:--r)if(!this.children[t].isEqualNode(e.children[t]))return!1;return!0},e.prototype.getFeature=function(e,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.setUserData=function(e,t,r){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.getUserData=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},e.prototype.contains=function(e){return!!e&&(e===this||this.isDescendant(e))},e.prototype.isDescendant=function(e){var t,r,n,i;for(r=0,n=(i=this.children).length;r<n;r++){if(e===(t=i[r]))return!0;if(t.isDescendant(e))return!0}return!1},e.prototype.isAncestor=function(e){return e.isDescendant(this)},e.prototype.isPreceding=function(e){var t,r;return t=this.treePosition(e),r=this.treePosition(this),-1!==t&&-1!==r&&t<r},e.prototype.isFollowing=function(e){var t,r;return t=this.treePosition(e),r=this.treePosition(this),-1!==t&&-1!==r&&t>r},e.prototype.treePosition=function(e){var t,r;return r=0,t=!1,this.foreachTreeNode(this.document(),(function(n){if(r++,!t&&n===e)return t=!0})),t?r:-1},e.prototype.foreachTreeNode=function(e,t){var r,n,i,s,o;for(e||(e=this.document()),n=0,i=(s=e.children).length;n<i;n++){if(o=t(r=s[n]))return o;if(o=this.foreachTreeNode(r,t))return o}},e}()}).call(this)},5691:function(e){(function(){e.exports=function(){function e(e){this.nodes=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this.nodes.length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.item=function(e){return this.nodes[e]||null},e}()}).call(this)},979:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(6895),n=r(5039),e.exports=function(e){function r(e,n,i){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,i&&(this.value=this.stringify.insValue(i))}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(e))},r.prototype.isEqualNode=function(e){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(e)&&e.target===this.target},r}(n)}).call(this)},596:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(6895),n=r(5338),e.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(n)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.raw(this,this.options.writer.filterOptions(e))},r}(n)}).call(this)},764:function(e,t,r){(function(){var t,n,i,s={}.hasOwnProperty;t=r(6895),i=r(5398),n=r(9497),e.exports=function(e){function r(e,t){this.stream=e,r.__super__.constructor.call(this,t)}return function(e,t){for(var r in t)s.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),r.prototype.endline=function(e,t,i){return e.isLastRootNode&&t.state===n.CloseTag?"":r.__super__.endline.call(this,e,t,i)},r.prototype.document=function(e,t){var r,n,i,s,o,a,c,u,h;for(n=i=0,o=(c=e.children).length;i<o;n=++i)(r=c[n]).isLastRootNode=n===e.children.length-1;for(t=this.filterOptions(t),h=[],s=0,a=(u=e.children).length;s<a;s++)r=u[s],h.push(this.writeChildNode(r,t,0));return h},r.prototype.attribute=function(e,t,n){return this.stream.write(r.__super__.attribute.call(this,e,t,n))},r.prototype.cdata=function(e,t,n){return this.stream.write(r.__super__.cdata.call(this,e,t,n))},r.prototype.comment=function(e,t,n){return this.stream.write(r.__super__.comment.call(this,e,t,n))},r.prototype.declaration=function(e,t,n){return this.stream.write(r.__super__.declaration.call(this,e,t,n))},r.prototype.docType=function(e,t,r){var i,s,o,a;if(r||(r=0),this.openNode(e,t,r),t.state=n.OpenTag,this.stream.write(this.indent(e,t,r)),this.stream.write("<!DOCTYPE "+e.root().name),e.pubID&&e.sysID?this.stream.write(' PUBLIC "'+e.pubID+'" "'+e.sysID+'"'):e.sysID&&this.stream.write(' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(e,t,r)),t.state=n.InsideTag,s=0,o=(a=e.children).length;s<o;s++)i=a[s],this.writeChildNode(i,t,r+1);t.state=n.CloseTag,this.stream.write("]")}return t.state=n.CloseTag,this.stream.write(t.spaceBeforeSlash+">"),this.stream.write(this.endline(e,t,r)),t.state=n.None,this.closeNode(e,t,r)},r.prototype.element=function(e,r,i){var o,a,c,u,h,d,l,f,p;for(l in i||(i=0),this.openNode(e,r,i),r.state=n.OpenTag,this.stream.write(this.indent(e,r,i)+"<"+e.name),f=e.attribs)s.call(f,l)&&(o=f[l],this.attribute(o,r,i));if(u=0===(c=e.children.length)?null:e.children[0],0===c||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))r.allowEmpty?(this.stream.write(">"),r.state=n.CloseTag,this.stream.write("</"+e.name+">")):(r.state=n.CloseTag,this.stream.write(r.spaceBeforeSlash+"/>"));else if(!r.pretty||1!==c||u.type!==t.Text&&u.type!==t.Raw||null==u.value){for(this.stream.write(">"+this.endline(e,r,i)),r.state=n.InsideTag,h=0,d=(p=e.children).length;h<d;h++)a=p[h],this.writeChildNode(a,r,i+1);r.state=n.CloseTag,this.stream.write(this.indent(e,r,i)+"</"+e.name+">")}else this.stream.write(">"),r.state=n.InsideTag,r.suppressPrettyCount++,!0,this.writeChildNode(u,r,i+1),r.suppressPrettyCount--,!1,r.state=n.CloseTag,this.stream.write("</"+e.name+">");return this.stream.write(this.endline(e,r,i)),r.state=n.None,this.closeNode(e,r,i)},r.prototype.processingInstruction=function(e,t,n){return this.stream.write(r.__super__.processingInstruction.call(this,e,t,n))},r.prototype.raw=function(e,t,n){return this.stream.write(r.__super__.raw.call(this,e,t,n))},r.prototype.text=function(e,t,n){return this.stream.write(r.__super__.text.call(this,e,t,n))},r.prototype.dtdAttList=function(e,t,n){return this.stream.write(r.__super__.dtdAttList.call(this,e,t,n))},r.prototype.dtdElement=function(e,t,n){return this.stream.write(r.__super__.dtdElement.call(this,e,t,n))},r.prototype.dtdEntity=function(e,t,n){return this.stream.write(r.__super__.dtdEntity.call(this,e,t,n))},r.prototype.dtdNotation=function(e,t,n){return this.stream.write(r.__super__.dtdNotation.call(this,e,t,n))},r}(i)}).call(this)},2086:function(e,t,r){(function(){var t,n={}.hasOwnProperty;t=r(5398),e.exports=function(e){function t(e){t.__super__.constructor.call(this,e)}return function(e,t){for(var r in t)n.call(t,r)&&(e[r]=t[r]);function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype}(t,e),t.prototype.document=function(e,t){var r,n,i,s,o;for(t=this.filterOptions(t),s="",n=0,i=(o=e.children).length;n<i;n++)r=o[n],s+=this.writeChildNode(r,t,0);return t.pretty&&s.slice(-t.newline.length)===t.newline&&(s=s.slice(0,-t.newline.length)),s},t}(t)}).call(this)},1113:function(e){(function(){var t=function(e,t){return function(){return e.apply(t,arguments)}},r={}.hasOwnProperty;e.exports=function(){function e(e){var n,i,s;for(n in this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this),e||(e={}),this.options=e,this.options.version||(this.options.version="1.0"),i=e.stringify||{})r.call(i,n)&&(s=i[n],this[n]=s)}return e.prototype.name=function(e){return this.options.noValidation?e:this.assertLegalName(""+e||"")},e.prototype.text=function(e){return this.options.noValidation?e:this.assertLegalChar(this.textEscape(""+e||""))},e.prototype.cdata=function(e){return this.options.noValidation?e:(e=(e=""+e||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(e))},e.prototype.comment=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+e);return this.assertLegalChar(e)},e.prototype.raw=function(e){return this.options.noValidation?e:""+e||""},e.prototype.attValue=function(e){return this.options.noValidation?e:this.assertLegalChar(this.attEscape(e=""+e||""))},e.prototype.insTarget=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.insValue=function(e){if(this.options.noValidation)return e;if((e=""+e||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return this.assertLegalChar(e)},e.prototype.xmlVersion=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e},e.prototype.xmlEncoding=function(e){if(this.options.noValidation)return e;if(!(e=""+e||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+e);return this.assertLegalChar(e)},e.prototype.xmlStandalone=function(e){return this.options.noValidation?e:e?"yes":"no"},e.prototype.dtdPubID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdSysID=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdElementValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttType=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdAttDefault=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdEntityValue=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.dtdNData=function(e){return this.options.noValidation?e:this.assertLegalChar(""+e||"")},e.prototype.convertAttKey="@",e.prototype.convertPIKey="?",e.prototype.convertTextKey="#text",e.prototype.convertCDataKey="#cdata",e.prototype.convertCommentKey="#comment",e.prototype.convertRawKey="#raw",e.prototype.assertLegalChar=function(e){var t,r;if(this.options.noValidation)return e;if(t="","1.0"===this.options.version){if(t=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=e.match(t))throw new Error("Invalid character in string: "+e+" at index "+r.index)}else if("1.1"===this.options.version&&(t=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,r=e.match(t)))throw new Error("Invalid character in string: "+e+" at index "+r.index);return e},e.prototype.assertLegalName=function(e){var t;if(this.options.noValidation)return e;if(this.assertLegalChar(e),t=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!e.match(t))throw new Error("Invalid character in name");return e},e.prototype.textEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},e.prototype.attEscape=function(e){var t;return this.options.noValidation?e:(t=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,e.replace(t,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},e}()}).call(this)},693:function(e,t,r){(function(){var t,n,i={}.hasOwnProperty;t=r(6895),n=r(5039),e.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(n)}return function(e,t){for(var r in t)i.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype}(r,e),Object.defineProperty(r.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"wholeText",{get:function(){var e,t,r;for(r="",t=this.previousSibling;t;)r=t.data+r,t=t.previousSibling;for(r+=this.data,e=this.nextSibling;e;)r+=e.data,e=e.nextSibling;return r}}),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(e){return this.options.writer.text(this,this.options.writer.filterOptions(e))},r.prototype.splitText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.replaceWholeText=function(e){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(n)}).call(this)},5398:function(e,t,r){(function(){var t,n,i,s={}.hasOwnProperty;i=r(7628).assign,t=r(6895),r(7281),r(9233),r(8397),r(2784),r(1031),r(596),r(693),r(979),r(5584),r(5147),r(3856),r(3478),r(4416),n=r(9497),e.exports=function(){function e(e){var t,r,n;for(t in e||(e={}),this.options=e,r=e.writer||{})s.call(r,t)&&(n=r[t],this["_"+t]=this[t],this[t]=n)}return e.prototype.filterOptions=function(e){var t,r,s,o,a,c,u,h;return e||(e={}),e=i({},this.options,e),(t={writer:this}).pretty=e.pretty||!1,t.allowEmpty=e.allowEmpty||!1,t.indent=null!=(r=e.indent)?r:"  ",t.newline=null!=(s=e.newline)?s:"\n",t.offset=null!=(o=e.offset)?o:0,t.dontPrettyTextNodes=null!=(a=null!=(c=e.dontPrettyTextNodes)?c:e.dontprettytextnodes)?a:0,t.spaceBeforeSlash=null!=(u=null!=(h=e.spaceBeforeSlash)?h:e.spacebeforeslash)?u:"",!0===t.spaceBeforeSlash&&(t.spaceBeforeSlash=" "),t.suppressPrettyCount=0,t.user={},t.state=n.None,t},e.prototype.indent=function(e,t,r){var n;return!t.pretty||t.suppressPrettyCount?"":t.pretty&&(n=(r||0)+t.offset+1)>0?new Array(n).join(t.indent):""},e.prototype.endline=function(e,t,r){return!t.pretty||t.suppressPrettyCount?"":t.newline},e.prototype.attribute=function(e,t,r){var n;return this.openAttribute(e,t,r),n=" "+e.name+'="'+e.value+'"',this.closeAttribute(e,t,r),n},e.prototype.cdata=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<![CDATA[",t.state=n.InsideTag,i+=e.value,t.state=n.CloseTag,i+="]]>"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.comment=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"\x3c!-- ",t.state=n.InsideTag,i+=e.value,t.state=n.CloseTag,i+=" --\x3e"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.declaration=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<?xml",t.state=n.InsideTag,i+=' version="'+e.version+'"',null!=e.encoding&&(i+=' encoding="'+e.encoding+'"'),null!=e.standalone&&(i+=' standalone="'+e.standalone+'"'),t.state=n.CloseTag,i+=t.spaceBeforeSlash+"?>",i+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.docType=function(e,t,r){var i,s,o,a,c;if(r||(r=0),this.openNode(e,t,r),t.state=n.OpenTag,a=this.indent(e,t,r),a+="<!DOCTYPE "+e.root().name,e.pubID&&e.sysID?a+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(a+=' SYSTEM "'+e.sysID+'"'),e.children.length>0){for(a+=" [",a+=this.endline(e,t,r),t.state=n.InsideTag,s=0,o=(c=e.children).length;s<o;s++)i=c[s],a+=this.writeChildNode(i,t,r+1);t.state=n.CloseTag,a+="]"}return t.state=n.CloseTag,a+=t.spaceBeforeSlash+">",a+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),a},e.prototype.element=function(e,r,i){var o,a,c,u,h,d,l,f,p,y,m,g,v,b;for(p in i||(i=0),y=!1,m="",this.openNode(e,r,i),r.state=n.OpenTag,m+=this.indent(e,r,i)+"<"+e.name,g=e.attribs)s.call(g,p)&&(o=g[p],m+=this.attribute(o,r,i));if(u=0===(c=e.children.length)?null:e.children[0],0===c||e.children.every((function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value})))r.allowEmpty?(m+=">",r.state=n.CloseTag,m+="</"+e.name+">"+this.endline(e,r,i)):(r.state=n.CloseTag,m+=r.spaceBeforeSlash+"/>"+this.endline(e,r,i));else if(!r.pretty||1!==c||u.type!==t.Text&&u.type!==t.Raw||null==u.value){if(r.dontPrettyTextNodes)for(h=0,l=(v=e.children).length;h<l;h++)if(((a=v[h]).type===t.Text||a.type===t.Raw)&&null!=a.value){r.suppressPrettyCount++,y=!0;break}for(m+=">"+this.endline(e,r,i),r.state=n.InsideTag,d=0,f=(b=e.children).length;d<f;d++)a=b[d],m+=this.writeChildNode(a,r,i+1);r.state=n.CloseTag,m+=this.indent(e,r,i)+"</"+e.name+">",y&&r.suppressPrettyCount--,m+=this.endline(e,r,i),r.state=n.None}else m+=">",r.state=n.InsideTag,r.suppressPrettyCount++,y=!0,m+=this.writeChildNode(u,r,i+1),r.suppressPrettyCount--,y=!1,r.state=n.CloseTag,m+="</"+e.name+">"+this.endline(e,r,i);return this.closeNode(e,r,i),m},e.prototype.writeChildNode=function(e,r,n){switch(e.type){case t.CData:return this.cdata(e,r,n);case t.Comment:return this.comment(e,r,n);case t.Element:return this.element(e,r,n);case t.Raw:return this.raw(e,r,n);case t.Text:return this.text(e,r,n);case t.ProcessingInstruction:return this.processingInstruction(e,r,n);case t.Dummy:return"";case t.Declaration:return this.declaration(e,r,n);case t.DocType:return this.docType(e,r,n);case t.AttributeDeclaration:return this.dtdAttList(e,r,n);case t.ElementDeclaration:return this.dtdElement(e,r,n);case t.EntityDeclaration:return this.dtdEntity(e,r,n);case t.NotationDeclaration:return this.dtdNotation(e,r,n);default:throw new Error("Unknown XML node type: "+e.constructor.name)}},e.prototype.processingInstruction=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<?",t.state=n.InsideTag,i+=e.target,e.value&&(i+=" "+e.value),t.state=n.CloseTag,i+=t.spaceBeforeSlash+"?>",i+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.raw=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r),t.state=n.InsideTag,i+=e.value,t.state=n.CloseTag,i+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.text=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r),t.state=n.InsideTag,i+=e.value,t.state=n.CloseTag,i+=this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.dtdAttList=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<!ATTLIST",t.state=n.InsideTag,i+=" "+e.elementName+" "+e.attributeName+" "+e.attributeType,"#DEFAULT"!==e.defaultValueType&&(i+=" "+e.defaultValueType),e.defaultValue&&(i+=' "'+e.defaultValue+'"'),t.state=n.CloseTag,i+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.dtdElement=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<!ELEMENT",t.state=n.InsideTag,i+=" "+e.name+" "+e.value,t.state=n.CloseTag,i+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.dtdEntity=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<!ENTITY",t.state=n.InsideTag,e.pe&&(i+=" %"),i+=" "+e.name,e.value?i+=' "'+e.value+'"':(e.pubID&&e.sysID?i+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.sysID&&(i+=' SYSTEM "'+e.sysID+'"'),e.nData&&(i+=" NDATA "+e.nData)),t.state=n.CloseTag,i+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.dtdNotation=function(e,t,r){var i;return this.openNode(e,t,r),t.state=n.OpenTag,i=this.indent(e,t,r)+"<!NOTATION",t.state=n.InsideTag,i+=" "+e.name,e.pubID&&e.sysID?i+=' PUBLIC "'+e.pubID+'" "'+e.sysID+'"':e.pubID?i+=' PUBLIC "'+e.pubID+'"':e.sysID&&(i+=' SYSTEM "'+e.sysID+'"'),t.state=n.CloseTag,i+=t.spaceBeforeSlash+">"+this.endline(e,t,r),t.state=n.None,this.closeNode(e,t,r),i},e.prototype.openNode=function(e,t,r){},e.prototype.closeNode=function(e,t,r){},e.prototype.openAttribute=function(e,t,r){},e.prototype.closeAttribute=function(e,t,r){},e}()}).call(this)},9015:function(e,t,r){(function(){var t,n,i,s,o,a,c,u,h,d;d=r(7628),u=d.assign,h=d.isFunction,i=r(3707),s=r(2423),o=r(2881),c=r(2086),a=r(764),t=r(6895),n=r(9497),e.exports.create=function(e,t,r,n){var i,o;if(null==e)throw new Error("Root element needs a name.");return n=u({},t,r,n),o=(i=new s(n)).element(e),n.headless||(i.declaration(n),null==n.pubID&&null==n.sysID||i.dtd(n)),o},e.exports.begin=function(e,t,r){var n;return h(e)&&(t=(n=[e,t])[0],r=n[1],e={}),t?new o(e,t,r):new s(e)},e.exports.stringWriter=function(e){return new c(e)},e.exports.streamWriter=function(e,t){return new a(e,t)},e.exports.implementation=new i,e.exports.nodeType=t,e.exports.writerState=n}).call(this)},6522:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3837),i=r(4250);var s,o;!function(e){e[e.UNIVERSAL=0]="UNIVERSAL",e[e.APPLICATION=64]="APPLICATION",e[e.CONTEXT_SPECIFIC=128]="CONTEXT_SPECIFIC",e[e.PRIVATE=192]="PRIVATE"}(s=t.Class||(t.Class={})),function(e){e[e.NONE=0]="NONE",e[e.BOOLEAN=1]="BOOLEAN",e[e.INTEGER=2]="INTEGER",e[e.BITSTRING=3]="BITSTRING",e[e.OCTETSTRING=4]="OCTETSTRING",e[e.NULL=5]="NULL",e[e.OID=6]="OID",e[e.ENUMERATED=10]="ENUMERATED",e[e.UTF8=12]="UTF8",e[e.SEQUENCE=16]="SEQUENCE",e[e.SET=17]="SET",e[e.NUMERICSTRING=18]="NUMERICSTRING",e[e.PRINTABLESTRING=19]="PRINTABLESTRING",e[e.T61STRING=20]="T61STRING",e[e.IA5STRING=22]="IA5STRING",e[e.UTCTIME=23]="UTCTIME",e[e.GENERALIZEDTIME=24]="GENERALIZEDTIME",e[e.GENERALSTRING=27]="GENERALSTRING"}(o=t.Tag||(t.Tag={}));class a{constructor(e,t){this.buf=e,this.bitLen=t}at(e){if(e<0||e>=this.bitLen||!Number.isInteger(e))return 0;const t=Math.floor(e/8),r=7-e%8;return this.buf[t]>>r&1}rightAlign(){const e=8-this.bitLen%8;if(8===e||0===this.buf.length)return this.buf;const t=Buffer.alloc(this.buf.length);t[0]=this.buf[0]>>e;for(let r=1;r<this.buf.length;r++)t[r]=this.buf[r-1]<<8-e,t[r]|=this.buf[r]>>e;return t}}t.BitString=a;class c{static Bool(e){const t=new c(s.UNIVERSAL,o.BOOLEAN,Buffer.from([e?255:0]));return t._value=e,t}static parseBool(e){if(!(e instanceof Buffer)||1!==e.length)throw new Error("ASN1 syntax error: invalid boolean");switch(e[0]){case 0:return!1;case 255:return!0;default:throw new Error("ASN1 syntax error: invalid boolean")}}static Integer(e){if(e instanceof Buffer){const t=new c(s.UNIVERSAL,o.INTEGER,e);return t._value=e.toString("hex"),t}if(!Number.isSafeInteger(e))throw new Error("ASN1 syntax error: invalid integer");let t;if(e>=-128&&e<128)t=Buffer.alloc(1),t.writeInt8(e,0);else if(e>=-32768&&e<32768)t=Buffer.alloc(2),t.writeIntBE(e,0,2);else if(e>=-8388608&&e<8388608)t=Buffer.alloc(3),t.writeIntBE(e,0,3);else if(e>=-2147483648&&e<2147483648)t=Buffer.alloc(4),t.writeIntBE(e,0,4);else if(e>=-549755813888&&e<549755813888)t=Buffer.alloc(5),t.writeIntBE(e,0,5);else{if(!(e>=-0x800000000000&&e<0x800000000000))throw new Error("ASN1 syntax error: invalid Integer");t=Buffer.alloc(6),t.writeIntBE(e,0,6)}const r=new c(s.UNIVERSAL,o.INTEGER,t);return r._value=e,r}static parseInteger(e){if(!(e instanceof Buffer)||0===e.length)throw new Error("ASN1 syntax error: invalid Integer");return e.length>6?e.toString("hex"):e.readIntBE(0,e.length)}static parseIntegerNum(e){const t=c.parseInteger(e);if("number"!=typeof t)throw new Error("ASN1 syntax error: invalid Integer number");return t}static parseIntegerStr(e){const t=c.parseInteger(e);return"number"==typeof t?t.toString(16):t}static BitString(e){e instanceof Buffer&&(e=new a(e,8*e.length));const t=8*e.buf.length-e.bitLen,r=Buffer.alloc(e.buf.length+1);return r.writeInt8(t,0),e.buf.copy(r,1),new c(s.UNIVERSAL,o.BITSTRING,r)}static parseBitString(e){if(!(e instanceof Buffer)||0===e.length)throw new Error("ASN1 syntax error: invalid BitString");const t=e[0];if(t>7||1===e.length&&t>0||0!=(e[e.length-1]&(1<<e[0])-1))throw new Error("ASN1 syntax error: invalid padding bits in BIT STRING");return new a(e.slice(1),8*(e.length-1)-t)}static Null(){const e=new c(s.UNIVERSAL,o.NULL,Buffer.alloc(0));return e._value=null,e}static parseNull(e){if(!(e instanceof Buffer)||0!==e.length)throw new Error("ASN1 syntax error: invalid null");return null}static OID(e){const t=e.split(".");if(0===t.length)throw new Error("ASN1 syntax error: invalid Object Identifier");const r=[];r.push(40*d(t[0])+d(t[1]));const n=[];for(let e=2;e<t.length;++e){let i=d(t[e]);for(n.length=0,n.push(127&i);i>127;)i>>>=7,n.unshift(127&i|128);r.push(...n)}const i=new c(s.UNIVERSAL,o.OID,Buffer.from(r));return i._value=e,i}static parseOID(e){if(!(e instanceof Buffer)||0===e.length)throw new Error("ASN1 syntax error: invalid OID");let t=Math.floor(e[0]/40)+"."+e[0]%40,r=0;for(let n=1;n<e.length;n++)e[n]>=128?(r+=127&e[n],r<<=7):(t+="."+(r+e[n]),r=0);return t}static UTF8(e){const t=new c(s.UNIVERSAL,o.UTF8,Buffer.from(e,"utf8"));return t._value=e,t}static parseUTF8(e){if(!(e instanceof Buffer))throw new Error("parse ASN1 error: invalid Buffer");return e.toString("utf8")}static NumericString(e){if(!u(e))throw new Error("ASN1 syntax error: invalid NumericString");const t=new c(s.UNIVERSAL,o.NUMERICSTRING,Buffer.from(e,"utf8"));return t._value=e,t}static parseNumericString(e){if(!(e instanceof Buffer))throw new Error("parse ASN1 error: invalid Buffer");const t=e.toString("utf8");if(!u(t))throw new Error("ASN1 syntax error: invalid NumericString");return t}static PrintableString(e){const t=new c(s.UNIVERSAL,o.PRINTABLESTRING,Buffer.from(e,"utf8"));return t._value=e,t}static parsePrintableString(e){if(!(e instanceof Buffer))throw new Error("parse ASN1 error: invalid Buffer");return e.toString("utf8")}static IA5String(e){if(!h(e))throw new Error("ASN1 syntax error: invalid IA5String");const t=new c(s.UNIVERSAL,o.IA5STRING,Buffer.from(e,"utf8"));return t._value=e,t}static parseIA5String(e){if(!(e instanceof Buffer))throw new Error("parse ASN1 error: invalid Buffer");const t=e.toString("utf8");if(!h(t))throw new Error("ASN1 syntax error: invalid IA5String");return t}static T61String(e){const t=new c(s.UNIVERSAL,o.T61STRING,Buffer.from(e,"utf8"));return t._value=e,t}static parseT61String(e){if(!(e instanceof Buffer))throw new Error("parse ASN1 error: invalid Buffer");return e.toString("utf8")}static GeneralString(e){const t=new c(s.UNIVERSAL,o.GENERALSTRING,Buffer.from(e,"utf8"));return t._value=e,t}static parseGeneralString(e){if(!(e instanceof Buffer))throw new Error("parse ASN1 error: invalid Buffer");return e.toString("utf8")}static UTCTime(e){let t="";const r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(const e of r)e.length<2&&(t+="0"),t+=e;t+="Z";const n=new c(s.UNIVERSAL,o.UTCTIME,Buffer.from(t,"utf8"));return n._value=e,n}static parseUTCTime(e){if(!(e instanceof Buffer)||0===e.length)throw new Error("ASN1 syntax error: invalid UTC Time");const t=e.toString("utf8"),r=new Date;let n=d(t.substr(0,2));n=n>=50?1900+n:2e3+n;const i=d(t.substr(2,2))-1,s=d(t.substr(4,2)),o=d(t.substr(6,2)),a=d(t.substr(8,2));let c=0,u=0,h="";if(t.length>11&&(u=10,h=t.charAt(u),"+"!==h&&"-"!==h&&(c=d(t.substr(10,2)),u+=2)),r.setUTCFullYear(n,i,s),r.setUTCHours(o,a,c,0),u>0&&(h=t.charAt(u),"+"===h||"-"===h)){let e=60*d(t.substr(u+1,2))+d(t.substr(u+4,2));e*=6e4,"+"===h?r.setTime(+r-e):r.setTime(+r+e)}return r}static GeneralizedTime(e){let t="";const r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(const e of r)e.length<2&&(t+="0"),t+=e;t+="Z";const n=new c(s.UNIVERSAL,o.GENERALIZEDTIME,Buffer.from(t,"utf8"));return n._value=e,n}static parseGeneralizedTime(e){if(!(e instanceof Buffer)||0===e.length)throw new Error("ASN1 syntax error: invalid Generalized Time");const t=e.toString("utf8"),r=new Date,n=d(t.substr(0,4)),i=d(t.substr(4,2))-1,s=d(t.substr(6,2)),o=d(t.substr(8,2)),a=d(t.substr(10,2)),c=d(t.substr(12,2));let u=0,h=0,l=!1;"Z"===t.charAt(t.length-1)&&(l=!0);const f=t.length-5,p=t.charAt(f);if("+"===p||"-"===p){h=60*d(t.substr(f+1,2))+d(t.substr(f+4,2)),h*=6e4,"+"===p&&(h*=-1),l=!0}return"."===t.charAt(14)&&(u=1e3*parseFloat(t.substr(14))),l?(r.setUTCFullYear(n,i,s),r.setUTCHours(o,a,c,u),r.setTime(+r+h)):(r.setFullYear(n,i,s),r.setHours(o,a,c,u)),r}static parseTime(e,t){switch(e){case o.UTCTIME:return c.parseUTCTime(t);case o.GENERALIZEDTIME:return c.parseGeneralizedTime(t);default:throw new Error("Invalid ASN1 time tag")}}static Set(e){const t=new c(s.UNIVERSAL,o.SET,Buffer.concat(e.map((e=>e.toDER()))));return t._value=e,t}static Seq(e){const t=new c(s.UNIVERSAL,o.SEQUENCE,Buffer.concat(e.map((e=>e.toDER()))));return t._value=e,t}static Spec(e,t,r=!0){const n=Array.isArray(t)?Buffer.concat(t.map((e=>e.toDER()))):t.toDER();Array.isArray(t)&&(r=!0);const i=new c(s.CONTEXT_SPECIFIC,e,n,r);return i._value=t,i}static fromDER(e,t=!1){return c._fromDER(new i.BufferVisitor(e),t)}static parseDER(e,t,r){const n=c._fromDER(new i.BufferVisitor(e),!1);if(n.class!==t&&n.tag!==r)throw new Error(`invalid ASN.1 DER for class ${t} and tag ${r}`);return n}static parseDERWithTemplate(e,t){const r=c._fromDER(new i.BufferVisitor(e),!0),n={},s=r.validate(t,n);if(null!=s)throw s.data=r,s;return n}static _parseCompound(e,t){const r=[],n=e.length,s=new i.BufferVisitor(e);let o=0;for(;o<n;){const e=s.end;r.push(c._fromDER(s,t)),o+=s.end-e}return r}static _fromDER(e,t){if(!(e.buf instanceof Buffer)||0===e.length)throw new Error("ASN1 syntax error: invalid Generalized Time");e.mustWalk(1,"Too few bytes to read ASN.1 tag.");const r=e.start,n=e.buf[r],i=192&n,s=31&n,a=function(e){e.mustWalk(1,"Too few bytes to read ASN.1 value length.");const t=e.buf[e.start];if(0==(128&t))return t;const r=127&t;return e.mustWalk(r,"Too few bytes to read ASN.1 value length."),e.buf.readUIntBE(e.start,r)}(e);if(e.mustHas(a),0!==a&&s===o.NULL)throw new Error("invalid value length or NULL tag.");e.mustWalk(a);const u=32==(32&n),h=new c(i,s,e.buf.slice(e.start,e.end),u);return u&&t&&(h._value=c._parseCompound(h.bytes,t)),h._der=e.buf.slice(r,e.end),h}constructor(e,t,r,n=!1){this.class=e,this.tag=t,this.bytes=r,this.isCompound=n||t===o.SEQUENCE||t===o.SET,this._value=void 0,this._der=null}get value(){return void 0===this._value&&(this._value=this.valueOf()),this._value}get DER(){return null==this._der&&(this._der=this.toDER()),this._der}mustCompound(e="asn1 object value is not compound"){if(!this.isCompound||!Array.isArray(this.value)){const t=new Error(e);throw t.data=this.toJSON(),t}return this.value}equals(e){return e instanceof c&&(this.class===e.class&&this.tag===e.tag&&this.isCompound===e.isCompound&&!!this.bytes.equals(e.bytes))}toDER(){let e=this.class|this.tag;this.isCompound&&(e|=32);const t=function(e){if(e<=127)return 0;if(e<=255)return 1;if(e<=65535)return 2;if(e<=16777215)return 3;if(e<=4294967295)return 4;if(e<=0xffffffffff)return 5;if(e<=0xffffffffffff)return 6;throw new Error("invalid value length")}(this.bytes.length),r=Buffer.allocUnsafe(2+t+this.bytes.length);return r.writeInt8(e,0),0===t?(r.writeUInt8(this.bytes.length,1),this.bytes.copy(r,2)):(r.writeUInt8(128|t,1),r.writeUIntBE(this.bytes.length,2,t),this.bytes.copy(r,2+t)),r}valueOf(){if(this.isCompound)return c._parseCompound(this.bytes,!1);if(this.class!==s.UNIVERSAL)return this.bytes;switch(this.tag){case o.BOOLEAN:return c.parseBool(this.bytes);case o.INTEGER:return c.parseInteger(this.bytes);case o.BITSTRING:return c.parseBitString(this.bytes);case o.NULL:return c.parseNull(this.bytes);case o.OID:return c.parseOID(this.bytes);case o.UTF8:return c.parseUTF8(this.bytes);case o.NUMERICSTRING:return c.parseNumericString(this.bytes);case o.PRINTABLESTRING:return c.parsePrintableString(this.bytes);case o.T61STRING:return c.parseT61String(this.bytes);case o.IA5STRING:return c.parseIA5String(this.bytes);case o.GENERALSTRING:return c.parseGeneralString(this.bytes);case o.UTCTIME:return c.parseUTCTime(this.bytes);case o.GENERALIZEDTIME:return c.parseGeneralizedTime(this.bytes);default:return this.bytes}}validate(e,t={}){if(this.class!==e.class)return new Error(`ASN.1 object validate failure for ${e.name} : error class ${s[this.class]}`);if(!(Array.isArray(e.tag)?e.tag:[e.tag]).includes(this.tag))return new Error(`ASN.1 object validate failure for ${e.name}: error tag ${o[this.tag]}`);if(null!=e.capture&&(t[e.capture]=this),Array.isArray(e.value)){const r=this.mustCompound(`${e.name} need compound ASN1 value`);for(let n=0,i=0;n<e.value.length;n++)if(null!=r[i]){const s=r[i].validate(e.value[n],t);if(null==s)i++;else if(!0!==e.value[n].optional)return s}else if(!0!==e.value[n].optional)return new Error(`ASN.1 object validate failure for ${e.value[n].name}: not exists`)}else if(null!=e.value){const r=this.tag===o.BITSTRING?this.bytes.slice(1):this.bytes;return c.fromDER(r).validate(e.value,t)}return null}toJSON(){let e=this.value;return Array.isArray(e)&&(e=e.map((e=>e.toJSON()))),{class:s[this.class],tag:this.class===s.UNIVERSAL?o[this.tag]:this.tag,value:e}}[n.inspect.custom](e,t){return t.depth<=2&&(t.depth=10),`<${this.constructor.name} ${n.inspect(this.toJSON(),t)}>`}}function u(e){for(const t of e){const e=t.charCodeAt(0);if(32!==e&&(e<48||e>57))return!1}return!0}function h(e){for(const t of e)if(t.charCodeAt(0)>=128)return!1;return!0}function d(e,t=10){const r=parseInt(e,t);if(Number.isNaN(r))throw new Error(`Invalid numeric string "${e}" in radix ${t}.`);return r}t.ASN1=c},4250:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BufferVisitor=class{constructor(e,t=0,r=0){this.start=t,this.end=r>t?r:t,this.buf=e}get length(){return this.buf.length}reset(e=0,t=0){return this.start=e,t>=this.start?this.end=t:this.end<this.start&&(this.end=this.start),this}walk(e){return this.start=this.end,this.end+=e,this}mustHas(e,t="Too few bytes to parse."){const r=this.end+e;if(r>this.buf.length){const e=new Error(t);throw e.available=this.buf.length,e.requested=r,e}return this.walk(0),this}mustWalk(e,t){return this.mustHas(e,t),this.walk(e),this}}},1066:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4250);t.BufferVisitor=n.BufferVisitor;var i=r(6599);t.PEM=i.PEM;var s=r(6522);t.ASN1=s.ASN1,t.Class=s.Class,t.Tag=s.Tag,t.BitString=s.BitString},6599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3837),i="-----BEGIN ",s="-----END ",o="-----",a="Proc-Type";class c{static parse(e){const t=[],r=e.toString("utf8").split("\n").map((e=>e.trim())).filter((e=>""!==e&&!e.startsWith("#")));for(;r.length>0;)t.push(u(r));if(0===t.length)throw new Error("PEM: no block");return t}constructor(e,t){this.type=e,this.body=t,this.headers=Object.create(null)}get procType(){return this.getHeader(a)}getHeader(e){const t=this.headers[e];return null==t?"":t}setHeader(e,t){if(e.includes(":"))throw new Error("pem: cannot encode a header key that contains a colon");if(""===e||""===t)throw new Error("pem: invalid header key or value");this.headers[e]=t}toString(){let e=i+this.type+o+"\n";const t=Object.keys(this.headers);if(t.length>0){const r=this.procType;""!==r&&(e+=`Proc-Type: ${r}\n`),t.sort();for(const r of t)r!==a&&(e+=`${r}: ${this.headers[r]}\n`);e+="\n"}const r=this.body.toString("base64");let n=0;for(;n<r.length;)e+=r.slice(n,n+64)+"\n",n+=64;return e+=s+this.type+o+"\n",e}toBuffer(){return Buffer.from(this.toString(),"utf8")}valueOf(){return this.body}toJSON(){return{type:this.type,body:this.body,headers:this.headers}}[n.inspect.custom](e,t){return`<${this.constructor.name} ${n.inspect(this.toJSON(),t)}>`}}function u(e){let t=e.shift();if(null==t||!t.startsWith(i)||!t.endsWith(o))throw new Error("pem: invalid BEGIN line");const r=t.slice(i.length,t.length-o.length);if(""===r)throw new Error("pem: invalid type");const n=[];for(t=e.shift();null!=t&&t.includes(": ");){const r=t.split(": ");if(2!==r.length||""===r[0]||""===r[1])throw new Error("pem: invalid Header line");n.push(r),t=e.shift()}let a="";for(;null!=t&&!t.startsWith(s);)a+=t,t=e.shift();if(null==t||t!==`-----END ${r}-----`)throw new Error("pem: invalid END line");const u=new c(r,Buffer.from(a,"base64"));if(""===a||u.body.toString("base64")!==a)throw new Error("pem: invalid base64 body");for(const e of n)u.setHeader(e[0],e[1]);return u}t.PEM=c},9952:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1808);t.bytesFromIP=function(e){switch(n.isIP(e)){case 4:return Buffer.from(e.split(".").map((e=>parseInt(e,10))));case 6:const t=e.split(":"),r=Buffer.alloc(16);let n=0;""===t[t.length-1]&&(t[t.length-1]="0");for(let e=0;e<t.length;e++)""!==t[e]?(r.writeUInt16BE(parseInt(t[e],16),n),n+=2):e+1<t.length&&""!==t[e+1]&&(n=16-2*(t.length-e-1));return r;default:return null}},t.bytesToIP=function(e){switch(e.length){case 4:return[e[0],e[1],e[2],e[3]].join(".");case 16:const t=[];let r=-1,n=0,i=-1,s=0;for(let o=0;o<e.length;o+=2){const a=e[o]<<8|e[o+1];0===a?(n++,-1===r&&(r=t.length),n>s&&(s=n,i=r)):(r=-1,n=0),t.push(a.toString(16))}if(s>0){let e="";const r=t.slice(i+s);t.length=i,0===t.length&&(e+=":"),0===r.length&&(e+=":"),t.push(e,...r)}return t.join(":");default:return""}};const i=Object.create(null),s=/^[0-9.]+$/;function o(e,t){i[e]=t,i[t]=e}t.getOID=function(e){return s.test(e)&&""!==i[e]?e:null==i[e]?"":i[e]},t.getOIDName=function(e){return s.test(e)||""===i[e]?null==i[e]?e:i[e]:e},o("1.2.840.113549.1.1.1","rsaEncryption"),o("1.2.840.113549.1.1.4","md5WithRsaEncryption"),o("1.2.840.113549.1.1.5","sha1WithRsaEncryption"),o("1.2.840.113549.1.1.8","mgf1"),o("1.2.840.113549.1.1.10","RSASSA-PSS"),o("1.2.840.113549.1.1.11","sha256WithRsaEncryption"),o("1.2.840.113549.1.1.12","sha384WithRsaEncryption"),o("1.2.840.113549.1.1.13","sha512WithRsaEncryption"),o("1.2.840.10045.2.1","ecEncryption"),o("1.2.840.10045.4.1","ecdsaWithSha1"),o("1.2.840.10045.4.3.2","ecdsaWithSha256"),o("1.2.840.10045.4.3.3","ecdsaWithSha384"),o("1.2.840.10045.4.3.4","ecdsaWithSha512"),o("1.2.840.10040.4.3","dsaWithSha1"),o("2.16.840.1.101.3.4.3.2","dsaWithSha256"),o("1.3.14.3.2.7","desCBC"),o("1.3.14.3.2.26","sha1"),o("2.16.840.1.101.3.4.2.1","sha256"),o("2.16.840.1.101.3.4.2.2","sha384"),o("2.16.840.1.101.3.4.2.3","sha512"),o("1.2.840.113549.2.5","md5"),o("1.3.101.110","X25519"),o("1.3.101.111","X448"),o("1.3.101.112","Ed25519"),o("1.3.101.113","Ed448"),o("1.2.840.113549.1.7.1","data"),o("1.2.840.113549.1.7.2","signedData"),o("1.2.840.113549.1.7.3","envelopedData"),o("1.2.840.113549.1.7.4","signedAndEnvelopedData"),o("1.2.840.113549.1.7.5","digestedData"),o("1.2.840.113549.1.7.6","encryptedData"),o("1.2.840.113549.1.9.1","emailAddress"),o("1.2.840.113549.1.9.2","unstructuredName"),o("1.2.840.113549.1.9.3","contentType"),o("1.2.840.113549.1.9.4","messageDigest"),o("1.2.840.113549.1.9.5","signingTime"),o("1.2.840.113549.1.9.6","counterSignature"),o("1.2.840.113549.1.9.7","challengePassword"),o("1.2.840.113549.1.9.8","unstructuredAddress"),o("1.2.840.113549.1.9.14","extensionRequest"),o("1.2.840.113549.1.9.20","friendlyName"),o("1.2.840.113549.1.9.21","localKeyId"),o("1.2.840.113549.1.9.22.1","x509Certificate"),o("1.2.840.113549.1.12.10.1.1","keyBag"),o("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),o("1.2.840.113549.1.12.10.1.3","certBag"),o("1.2.840.113549.1.12.10.1.4","crlBag"),o("1.2.840.113549.1.12.10.1.5","secretBag"),o("1.2.840.113549.1.12.10.1.6","safeContentsBag"),o("1.2.840.113549.1.5.13","pkcs5PBES2"),o("1.2.840.113549.1.5.12","pkcs5PBKDF2"),o("1.2.840.113549.2.7","hmacWithSha1"),o("1.2.840.113549.2.9","hmacWithSha256"),o("1.2.840.113549.2.10","hmacWithSha384"),o("1.2.840.113549.2.11","hmacWithSha512"),o("1.2.840.113549.3.7","3desCBC"),o("2.16.840.1.101.3.4.1.2","aesCBC128"),o("2.16.840.1.101.3.4.1.42","aesCBC256"),o("2.5.4.3","commonName"),o("2.5.4.5","serialName"),o("2.5.4.6","countryName"),o("2.5.4.7","localityName"),o("2.5.4.8","stateOrProvinceName"),o("2.5.4.10","organizationName"),o("2.5.4.11","organizationalUnitName"),o("2.5.4.15","businessCategory"),o("2.16.840.1.113730.1.1","nsCertType"),o("2.5.29.2","keyAttributes"),o("2.5.29.4","keyUsageRestriction"),o("2.5.29.6","subtreesConstraint"),o("2.5.29.9","subjectDirectoryAttributes"),o("2.5.29.14","subjectKeyIdentifier"),o("2.5.29.15","keyUsage"),o("2.5.29.16","privateKeyUsagePeriod"),o("2.5.29.17","subjectAltName"),o("2.5.29.18","issuerAltName"),o("2.5.29.19","basicConstraints"),o("2.5.29.20","cRLNumber"),o("2.5.29.21","cRLReason"),o("2.5.29.22","expirationDate"),o("2.5.29.23","instructionCode"),o("2.5.29.24","invalidityDate"),o("2.5.29.27","deltaCRLIndicator"),o("2.5.29.28","issuingDistributionPoint"),o("2.5.29.29","certificateIssuer"),o("2.5.29.30","nameConstraints"),o("2.5.29.31","cRLDistributionPoints"),o("2.5.29.32","certificatePolicies"),o("2.5.29.33","policyMappings"),o("2.5.29.35","authorityKeyIdentifier"),o("2.5.29.36","policyConstraints"),o("2.5.29.37","extKeyUsage"),o("2.5.29.46","freshestCRL"),o("2.5.29.54","inhibitAnyPolicy"),o("1.3.6.1.4.1.311.60.2.1.2","jurisdictionST"),o("1.3.6.1.4.1.311.60.2.1.3","jurisdictionC"),o("1.3.6.1.4.1.11129.2.4.2","timestampList"),o("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),o("1.3.6.1.5.5.7.3.1","serverAuth"),o("1.3.6.1.5.5.7.3.2","clientAuth"),o("1.3.6.1.5.5.7.3.3","codeSigning"),o("1.3.6.1.5.5.7.3.4","emailProtection"),o("1.3.6.1.5.5.7.3.8","timeStamping"),o("1.3.6.1.5.5.7.48.1","authorityInfoAccessOcsp"),o("1.3.6.1.5.5.7.48.2","authorityInfoAccessIssuers")},7219:(e,t,r)=>{"use strict";var n=r(9952);n.bytesFromIP,n.bytesToIP,n.getOID,n.getOIDName;var i=r(411);i.PublicKey,t._q=i.PrivateKey,i.RSAPublicKey,i.RSAPrivateKey;var s=r(9620);t.KB=s.Certificate,s.DistinguishedName},411:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3837),i=r(6113),s=r(9100),o=r(1066),a=r(9952);t.publicKeyValidator={name:"PublicKeyInfo",class:o.Class.UNIVERSAL,tag:o.Tag.SEQUENCE,capture:"publicKeyInfo",value:[{name:"PublicKeyInfo.AlgorithmIdentifier",class:o.Class.UNIVERSAL,tag:o.Tag.SEQUENCE,value:[{name:"PublicKeyAlgorithmIdentifier.algorithm",class:o.Class.UNIVERSAL,tag:o.Tag.OID,capture:"publicKeyOID"}]},{name:"PublicKeyInfo.PublicKey",class:o.Class.UNIVERSAL,tag:o.Tag.BITSTRING,capture:"publicKey"}]},t.privateKeyValidator={name:"PrivateKeyInfo",class:o.Class.UNIVERSAL,tag:o.Tag.SEQUENCE,capture:"privateKeyInfo",value:[{name:"PrivateKeyInfo.Version",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.AlgorithmIdentifier",class:o.Class.UNIVERSAL,tag:o.Tag.SEQUENCE,value:[{name:"PrivateKeyAlgorithmIdentifier.algorithm",class:o.Class.UNIVERSAL,tag:o.Tag.OID,capture:"privateKeyOID"}]},{name:"PrivateKeyInfo.PrivateKey",class:o.Class.UNIVERSAL,tag:o.Tag.OCTETSTRING,capture:"privateKey"}]};const c={name:"RSAPublicKey",class:o.Class.UNIVERSAL,tag:o.Tag.SEQUENCE,value:[{name:"RSAPublicKey.modulus",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"publicKeyExponent"}]},u={name:"RSAPrivateKey",class:o.Class.UNIVERSAL,tag:o.Tag.SEQUENCE,value:[{name:"RSAPrivateKey.version",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",class:o.Class.UNIVERSAL,tag:o.Tag.INTEGER,capture:"privateKeyCoefficient"}]},h=[a.getOID("X25519"),a.getOID("X448"),a.getOID("Ed25519"),a.getOID("Ed448")];class d{constructor(e){const r={},n=e.validate(t.publicKeyValidator,r);if(null!=n)throw new Error("Cannot read X.509 public key: "+n.message);this.oid=o.ASN1.parseOID(r.publicKeyOID.bytes),this.algo=a.getOIDName(this.oid),this._pkcs8=e,this._keyRaw=o.ASN1.parseBitString(r.publicKey.bytes).buf,this._finalKey=this._keyRaw,this._finalPEM=""}static fromPEM(e){const t=o.PEM.parse(e)[0];if(t.procType.includes("ENCRYPTED"))throw new Error("Could not convert public key from PEM, PEM is encrypted.");const r=o.ASN1.fromDER(t.body,!0);switch(t.type){case"PUBLIC KEY":return new d(r);case"RSA PUBLIC KEY":const e=o.ASN1.Seq([o.ASN1.Seq([o.ASN1.OID(a.getOID("rsaEncryption")),o.ASN1.Null()]),o.ASN1.BitString(r.DER)]);return new d(e);default:throw new Error("Could not convert public key from PEM, recommend PKCS#8 PEM")}}static addVerifier(e,t){if(""===(e=a.getOID(e)))throw new Error(`Invalid object identifier: ${e}`);if(null!=d._verifiers[e])throw new Error(`Verifier ${e} exists`);d._verifiers[e]=t}get keyRaw(){return this._finalKey}verify(e,t,r){const n=d._verifiers[this.oid];if(null!=n){const s=i.createHash(r).update(e).digest();return n.call(this,s,t)}const s=i.createVerify(r);return s.update(e),s.verify(this.toPEM(),t)}getFingerprint(e,t="PublicKey"){let r;switch(t){case"PublicKeyInfo":r=this._pkcs8.DER;break;case"PublicKey":r=this._keyRaw;break;default:throw new Error(`Unknown fingerprint type "${t}".`)}const n=i.createHash(e);return n.update(r),n.digest()}toASN1(){return this._pkcs8}toDER(){return this._pkcs8.DER}toPEM(){return""===this._finalPEM&&(this._finalPEM=new o.PEM("PUBLIC KEY",this._pkcs8.DER).toString()),this._finalPEM}toJSON(){return{oid:this.oid,algo:this.algo,publicKey:this._keyRaw}}[n.inspect.custom](e,t){return`<${this.constructor.name} ${n.inspect(this.toJSON(),t)}>`}}d._verifiers=Object.create(null),t.PublicKey=d;class l{constructor(e){const r=Object.create(null),n=e.validate(t.privateKeyValidator,r);if(null!=n)throw new Error("Cannot read X.509 private key: "+n.message);if(this.version=o.ASN1.parseIntegerNum(r.privateKeyVersion.bytes)+1,this.oid=o.ASN1.parseOID(r.privateKeyOID.bytes),this.algo=a.getOIDName(this.oid),this._pkcs8=e,this._keyRaw=r.privateKey.bytes,this._publicKeyRaw=null,this._finalKey=this._keyRaw,this._finalPEM="",h.includes(this.oid))if(this._finalKey=this._keyRaw=o.ASN1.parseDER(this._keyRaw,o.Class.UNIVERSAL,o.Tag.OCTETSTRING).bytes,"1.3.101.112"===this.oid){const e=s.sign.keyPair.fromSeed(this._keyRaw);this._publicKeyRaw=Buffer.from(e.publicKey),this._finalKey=Buffer.from(e.secretKey)}else if(2===this.version)for(const t of e.mustCompound())t.class===o.Class.CONTEXT_SPECIFIC&&1===t.tag&&(this._publicKeyRaw=o.ASN1.parseBitString(t.bytes).buf,this._finalKey=Buffer.concat([this._keyRaw,this._publicKeyRaw]))}static fromPEM(e){const t=o.PEM.parse(e)[0];if(t.procType.includes("ENCRYPTED"))throw new Error("Could not convert private key from PEM, PEM is encrypted.");let r=o.ASN1.fromDER(t.body,!0);switch(t.type){case"PRIVATE KEY":return new l(r);case"RSA PRIVATE KEY":return r=o.ASN1.Seq([r.value[0],o.ASN1.Seq([o.ASN1.OID(a.getOID("rsaEncryption")),o.ASN1.Null()]),new o.ASN1(o.Class.UNIVERSAL,o.Tag.OCTETSTRING,r.DER)]),new l(r);default:throw new Error("Could not convert private key from PEM, recommend PKCS#8 PEM")}}static addSigner(e,t){if(""===(e=a.getOID(e)))throw new Error(`Invalid object identifier: ${e}`);if(null!=l._signers[e])throw new Error(`Signer ${e} exists`);l._signers[e]=t}get keyRaw(){return this._finalKey}get publicKeyRaw(){return this._publicKeyRaw}sign(e,t){const r=l._signers[this.oid];if(null!=r){const n=i.createHash(t).update(e).digest();return r.call(this,n)}const n=i.createSign(t);return n.update(e),n.sign(this.toPEM())}toASN1(){return this._pkcs8}toDER(){return this._pkcs8.DER}toPEM(){return""===this._finalPEM&&(this._finalPEM=new o.PEM("PRIVATE KEY",this._pkcs8.DER).toString()),this._finalPEM}toJSON(){return{version:this.version,oid:this.oid,algo:this.algo,privateKey:this._keyRaw,publicKey:this._publicKeyRaw}}[n.inspect.custom](e,t){return`<${this.constructor.name} ${n.inspect(this.toJSON(),t)}>`}}l._signers=Object.create(null),t.PrivateKey=l;class f extends d{static fromPublicKey(e){return new f(e.toASN1())}constructor(e){if(super(e),a.getOID(this.oid)!==a.getOID("rsaEncryption"))throw new Error(`Invalid RSA public key, unknown OID: ${this.oid}`);const t=Object.create(null);this._pkcs1=o.ASN1.fromDER(this._keyRaw,!0);const r=this._pkcs1.validate(c,t);if(null!=r)throw new Error("Cannot read RSA public key: "+r.message);this.modulus=o.ASN1.parseIntegerStr(t.publicKeyModulus.bytes),this.exponent=o.ASN1.parseIntegerNum(t.publicKeyExponent.bytes)}toASN1(){return this._pkcs1}toDER(){return this._keyRaw}toPEM(){return""===this._finalPEM&&(this._finalPEM=new o.PEM("RSA PUBLIC KEY",this._keyRaw).toString()),this._finalPEM}toPublicKeyPEM(){return new o.PEM("PUBLIC KEY",this._pkcs8.DER).toString()}toJSON(){return{oid:this.oid,algo:this.algo,modulus:y(this.modulus),exponent:this.exponent}}[n.inspect.custom](e,t){return`<${this.constructor.name} ${n.inspect(this.toJSON(),t)}>`}}t.RSAPublicKey=f;class p extends l{static fromPrivateKey(e){return new p(e.toASN1())}constructor(e){if(super(e),a.getOID(this.oid)!==a.getOID("rsaEncryption"))throw new Error(`Invalid RSA private key, unknown OID: ${this.oid}`);const t=Object.create(null);this._pkcs1=o.ASN1.fromDER(this._keyRaw,!0);const r=this._pkcs1.validate(u,t);if(null!=r)throw new Error("Cannot read RSA private key: "+r.message);this.publicExponent=o.ASN1.parseIntegerNum(t.privateKeyPublicExponent.bytes),this.privateExponent=o.ASN1.parseIntegerStr(t.privateKeyPrivateExponent.bytes),this.modulus=o.ASN1.parseIntegerStr(t.privateKeyModulus.bytes),this.prime1=o.ASN1.parseIntegerStr(t.privateKeyPrime1.bytes),this.prime2=o.ASN1.parseIntegerStr(t.privateKeyPrime2.bytes),this.exponent1=o.ASN1.parseIntegerStr(t.privateKeyExponent1.bytes),this.exponent2=o.ASN1.parseIntegerStr(t.privateKeyExponent2.bytes),this.coefficient=o.ASN1.parseIntegerStr(t.privateKeyCoefficient.bytes)}toASN1(){return this._pkcs1}toDER(){return this._keyRaw}toPEM(){return""===this._finalPEM&&(this._finalPEM=new o.PEM("RSA PRIVATE KEY",this._keyRaw).toString()),this._finalPEM}toPrivateKeyPEM(){return new o.PEM("PRIVATE KEY",this._pkcs8.DER).toString()}toJSON(){return{version:this.version,oid:this.oid,algo:this.algo,publicExponent:this.publicExponent,privateExponent:y(this.privateExponent),modulus:y(this.modulus),prime1:y(this.prime1),prime2:y(this.prime2),exponent1:y(this.exponent1),exponent2:y(this.exponent2),coefficient:y(this.coefficient)}}[n.inspect.custom](e,t){return`<${this.constructor.name} ${n.inspect(this.toJSON(),t)}>`}}function y(e){return e.length%8!=0&&e.startsWith("00")?e.slice(2):e}t.RSAPrivateKey=p,d.addVerifier(a.getOID("Ed25519"),(function(e,t){return s.sign.detached.verify(e,t,this.keyRaw)})),l.addSigner(a.getOID("Ed25519"),(function(e){const t=this.keyRaw;if(64!==t.length)throw new Error("Invalid signing key.");return Buffer.from(s.sign.detached(e,t))}))},9620:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3837),i=r(6113),s=r(1066),o=r(9952),a=r(411),c=Object.create(null);c.CN=o.getOID("commonName"),c.commonName="CN",c.C=o.getOID("countryName"),c.countryName="C",c.L=o.getOID("localityName"),c.localityName="L",c.ST=o.getOID("stateOrProvinceName"),c.stateOrProvinceName="ST",c.O=o.getOID("organizationName"),c.organizationName="O",c.OU=o.getOID("organizationalUnitName"),c.organizationalUnitName="OU",c.E=o.getOID("emailAddress"),c.emailAddress="E";const u={name:"Certificate",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,value:[{name:"Certificate.TBSCertificate",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,capture:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",class:s.Class.CONTEXT_SPECIFIC,tag:s.Tag.NONE,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",class:s.Class.UNIVERSAL,tag:s.Tag.INTEGER,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",class:s.Class.UNIVERSAL,tag:s.Tag.INTEGER,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,value:[{name:"Certificate.TBSCertificate.signature.algorithm",class:s.Class.UNIVERSAL,tag:s.Tag.OID,capture:"certinfoSignatureOID"},{name:"Certificate.TBSCertificate.signature.parameters",class:s.Class.UNIVERSAL,tag:s.Tag.OCTETSTRING,optional:!0,capture:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,capture:"certIssuer"},{name:"Certificate.TBSCertificate.validity",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,value:[{name:"Certificate.TBSCertificate.validity.notBefore",class:s.Class.UNIVERSAL,tag:[s.Tag.UTCTIME,s.Tag.GENERALIZEDTIME],capture:"certValidityNotBefore"},{name:"Certificate.TBSCertificate.validity.notAfter",class:s.Class.UNIVERSAL,tag:[s.Tag.UTCTIME,s.Tag.GENERALIZEDTIME],capture:"certValidityNotAfter"}]},{name:"Certificate.TBSCertificate.subject",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,capture:"certSubject"},a.publicKeyValidator,{name:"Certificate.TBSCertificate.issuerUniqueID",class:s.Class.CONTEXT_SPECIFIC,tag:s.Tag.BOOLEAN,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",class:s.Class.UNIVERSAL,tag:s.Tag.BITSTRING,capture:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",class:s.Class.CONTEXT_SPECIFIC,tag:s.Tag.INTEGER,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",class:s.Class.UNIVERSAL,tag:s.Tag.BITSTRING,capture:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",class:s.Class.CONTEXT_SPECIFIC,tag:s.Tag.BITSTRING,capture:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,value:[{name:"Certificate.signatureAlgorithm.algorithm",class:s.Class.UNIVERSAL,tag:s.Tag.OID,capture:"certSignatureOID"},{name:"Certificate.TBSCertificate.signature.parameters",class:s.Class.UNIVERSAL,tag:s.Tag.OCTETSTRING,optional:!0,capture:"certSignatureParams"}]},{name:"Certificate.signatureValue",class:s.Class.UNIVERSAL,tag:s.Tag.BITSTRING,capture:"certSignature"}]};class h{constructor(){this.attributes=[],this.uniqueId=null}get commonName(){return this.getFieldValue("commonName")}get organizationName(){return this.getFieldValue("organizationName")}get organizationalUnitName(){return this.getFieldValue("organizationalUnitName")}get countryName(){return this.getFieldValue("countryName")}get localityName(){return this.getFieldValue("localityName")}get serialName(){return this.getFieldValue("serialName")}getHash(){const e=i.createHash("sha1");for(const t of this.attributes)e.update(t.oid),e.update(t.value);return e.digest()}getField(e){for(const t of this.attributes)if(e===t.oid||e===t.name||e===t.shortName)return t;return null}addField(e){g([e]),this.attributes.push(e)}setAttrs(e){g(e),this.attributes=e}toJSON(){const e={};for(const t of this.attributes){const r=t.shortName;"string"==typeof r&&""!==r&&(e[r]=t.value)}return e.uniqueId=this.uniqueId,e.attributes=this.attributes,e}getFieldValue(e){const t=this.getField(e);return null!=t?t.value:""}}t.DistinguishedName=h;class d{static fromPEMs(e){const t=[],r=s.PEM.parse(e);for(const e of r){if("CERTIFICATE"!==e.type&&"X509 CERTIFICATE"!==e.type&&"TRUSTED CERTIFICATE"!==e.type)throw new Error("Could not convert certificate from PEM: invalid type");if(e.procType.includes("ENCRYPTED"))throw new Error("Could not convert certificate from PEM: PEM is encrypted.");const r=s.ASN1.fromDER(e.body);t.push(new d(r))}if(0===t.length)throw new Error("No Certificate");return t}static fromPEM(e){return d.fromPEMs(e)[0]}constructor(e){const t=Object.create(null),r=e.validate(u,t);if(null!=r)throw new Error("Cannot read X.509 certificate: "+r.message);if(this.raw=e.DER,this.version=null==t.certVersion?0:s.ASN1.parseIntegerNum(t.certVersion.bytes)+1,this.serialNumber=s.ASN1.parseIntegerStr(t.certSerialNumber.bytes),this.signatureOID=s.ASN1.parseOID(t.certSignatureOID.bytes),this.signatureAlgorithm=o.getOIDName(this.signatureOID),this.infoSignatureOID=s.ASN1.parseOID(t.certinfoSignatureOID.bytes),this.signature=s.ASN1.parseBitString(t.certSignature.bytes).buf,this.validFrom=s.ASN1.parseTime(t.certValidityNotBefore.tag,t.certValidityNotBefore.bytes),this.validTo=s.ASN1.parseTime(t.certValidityNotAfter.tag,t.certValidityNotAfter.bytes),this.issuer=new h,this.issuer.setAttrs(v(t.certIssuer)),null!=t.certIssuerUniqueId&&(this.issuer.uniqueId=s.ASN1.parseBitString(t.certIssuerUniqueId.bytes)),this.subject=new h,this.subject.setAttrs(v(t.certSubject)),null!=t.certSubjectUniqueId&&(this.subject.uniqueId=s.ASN1.parseBitString(t.certSubjectUniqueId.bytes)),this.extensions=[],this.subjectKeyIdentifier="",this.authorityKeyIdentifier="",this.ocspServer="",this.issuingCertificateURL="",this.isCA=!1,this.maxPathLen=-1,this.basicConstraintsValid=!1,this.keyUsage=0,this.dnsNames=[],this.emailAddresses=[],this.ipAddresses=[],this.uris=[],null!=t.certExtensions){this.extensions=function(e){const t=[];for(const r of e.mustCompound())for(const e of r.mustCompound())t.push(l(e));return t}(t.certExtensions);for(const e of this.extensions)if("string"==typeof e.subjectKeyIdentifier&&(this.subjectKeyIdentifier=e.subjectKeyIdentifier),"string"==typeof e.authorityKeyIdentifier&&(this.authorityKeyIdentifier=e.authorityKeyIdentifier),"string"==typeof e.authorityInfoAccessOcsp&&(this.ocspServer=e.authorityInfoAccessOcsp),"string"==typeof e.authorityInfoAccessIssuers&&(this.issuingCertificateURL=e.authorityInfoAccessIssuers),"boolean"==typeof e.basicConstraintsValid&&(this.isCA=e.isCA,this.maxPathLen=e.maxPathLen,this.basicConstraintsValid=e.basicConstraintsValid),"number"==typeof e.keyUsage&&(this.keyUsage=e.keyUsage),Array.isArray(e.altNames))for(const t of e.altNames)null!=t.dnsName&&this.dnsNames.push(t.dnsName),null!=t.email&&this.emailAddresses.push(t.email),null!=t.ip&&this.ipAddresses.push(t.ip),null!=t.uri&&this.uris.push(t.uri)}this.publicKey=new a.PublicKey(t.publicKeyInfo),this.publicKeyRaw=this.publicKey.toDER(),this.tbsCertificate=t.tbsCertificate}getExtension(e,t=""){for(const r of this.extensions)if(e===r.oid||e===r.name)return""===t?r:r[t];return null}checkSignature(e){if(3===this.version&&!this.basicConstraintsValid||this.basicConstraintsValid&&!this.isCA)return new Error("The parent constraint violation error");if(!0!==this.getExtension("keyUsage","keyCertSign"))return new Error("The parent constraint violation error");if(!e.isIssuer(this))return new Error("The parent certificate did not issue the given child certificate");const t=function(e){switch(o.getOIDName(e)){case"sha1WithRsaEncryption":case"ecdsaWithSha1":case"dsaWithSha1":return"sha1";case"md5WithRsaEncryption":return"md5";case"sha256WithRsaEncryption":case"RSASSA-PSS":case"ecdsaWithSha256":case"dsaWithSha256":return"sha256";case"sha384WithRsaEncryption":case"ecdsaWithSha384":return"sha384";case"sha512WithRsaEncryption":case"ecdsaWithSha512":return"sha512";default:return""}}(e.signatureOID);if(""===t)return new Error("Unknown child signature OID.");return!1===this.publicKey.verify(e.tbsCertificate.DER,e.signature,t)?new Error("Child signature not matched"):null}isIssuer(e){return this.issuer.getHash().equals(e.subject.getHash())}verifySubjectKeyIdentifier(){return this.publicKey.getFingerprint("sha1","PublicKey").toString("hex")===this.subjectKeyIdentifier}toJSON(){const e={};for(const t of Object.keys(this))e[t]=b(this[t]);return delete e.tbsCertificate,e}[n.inspect.custom](e,t){return t.depth<=2&&(t.depth=10),`<${this.constructor.name} ${n.inspect(this.toJSON(),t)}>`}}function l(e){const t={};switch(t.oid=s.ASN1.parseOID(e.value[0].bytes),t.critical=!1,e.value[1].tag===s.Tag.BOOLEAN?(t.critical=s.ASN1.parseBool(e.value[1].bytes),t.value=e.value[2].bytes):t.value=e.value[1].bytes,t.name=o.getOIDName(t.oid),t.name){case"keyUsage":!function(e){const t=s.ASN1.parseBitString(s.ASN1.fromDER(e.value).bytes);let r=0,n=0;e.keyUsage=0;for(let r=0;r<9;r++)0!==t.at(r)&&(e.keyUsage|=1<<r);t.buf.length>0&&(r=t.buf[0],n=t.buf.length>1?t.buf[1]:0);e.digitalSignature=128==(128&r),e.nonRepudiation=64==(64&r),e.keyEncipherment=32==(32&r),e.dataEncipherment=16==(16&r),e.keyAgreement=8==(8&r),e.keyCertSign=4==(4&r),e.cRLSign=2==(2&r),e.encipherOnly=1==(1&r),e.decipherOnly=128==(128&n)}(t);break;case"basicConstraints":!function(e){const t=s.ASN1.fromDER(e.value).mustCompound();t.length>0&&t[0].tag===s.Tag.BOOLEAN?e.isCA=s.ASN1.parseBool(t[0].bytes):e.isCA=!1;let r=null;t.length>0&&t[0].tag===s.Tag.INTEGER?r=t[0].bytes:t.length>1&&(r=t[1].bytes);e.maxPathLen=null!==r?s.ASN1.parseInteger(r):-1;e.basicConstraintsValid=!0}(t);break;case"extKeyUsage":!function(e){const t=s.ASN1.fromDER(e.value).mustCompound();for(const r of t)e[o.getOIDName(s.ASN1.parseOID(r.bytes))]=!0}(t);break;case"nsCertType":!function(e){const t=s.ASN1.parseBitString(s.ASN1.fromDER(e.value).bytes);let r=0;t.buf.length>0&&(r=t.buf[0]);e.client=128==(128&r),e.server=64==(64&r),e.email=32==(32&r),e.objsign=16==(16&r),e.reserved=8==(8&r),e.sslCA=4==(4&r),e.emailCA=2==(2&r),e.objCA=1==(1&r)}(t);break;case"subjectAltName":case"issuerAltName":f(t);break;case"subjectKeyIdentifier":!function(e){const t=s.ASN1.parseDERWithTemplate(e.value,p);e.subjectKeyIdentifier=t.subjectKeyIdentifier.bytes.toString("hex")}(t);break;case"authorityKeyIdentifier":!function(e){const t=s.ASN1.parseDERWithTemplate(e.value,y);e.authorityKeyIdentifier=t.authorityKeyIdentifier.bytes.toString("hex")}(t);break;case"authorityInfoAccess":!function(e){const t=s.ASN1.parseDERWithTemplate(e.value,m);null!=t.authorityInfoAccessOcsp&&(e.authorityInfoAccessOcsp=t.authorityInfoAccessOcsp.bytes.toString());null!=t.authorityInfoAccessIssuers&&(e.authorityInfoAccessIssuers=t.authorityInfoAccessIssuers.bytes.toString())}(t)}return t}function f(e){e.altNames=[];const t=s.ASN1.fromDER(e.value).mustCompound();for(const r of t){const t={tag:r.tag,value:r.bytes};switch(e.altNames.push(t),r.tag){case 1:t.email=r.bytes.toString();break;case 2:t.dnsName=r.bytes.toString();break;case 6:t.uri=r.bytes.toString();break;case 7:t.ip=o.bytesToIP(r.bytes);break;case 8:t.oid=s.ASN1.parseOID(r.bytes)}}}t.Certificate=d;const p={name:"subjectKeyIdentifier",class:s.Class.UNIVERSAL,tag:s.Tag.OCTETSTRING,capture:"subjectKeyIdentifier"};const y={name:"authorityKeyIdentifier",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,value:[{name:"authorityKeyIdentifier.value",class:s.Class.CONTEXT_SPECIFIC,tag:s.Tag.NONE,capture:"authorityKeyIdentifier"}]};const m={name:"authorityInfoAccess",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,value:[{name:"authorityInfoAccess.authorityInfoAccessOcsp",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,optional:!0,value:[{name:"authorityInfoAccess.authorityInfoAccessOcsp.oid",class:s.Class.UNIVERSAL,tag:s.Tag.OID},{name:"authorityInfoAccess.authorityInfoAccessOcsp.value",class:s.Class.CONTEXT_SPECIFIC,tag:s.Tag.OID,capture:"authorityInfoAccessOcsp"}]},{name:"authorityInfoAccess.authorityInfoAccessIssuers",class:s.Class.UNIVERSAL,tag:s.Tag.SEQUENCE,optional:!0,value:[{name:"authorityInfoAccess.authorityInfoAccessIssuers.oid",class:s.Class.UNIVERSAL,tag:s.Tag.OID},{name:"authorityInfoAccess.authorityInfoAccessIssuers.value",class:s.Class.CONTEXT_SPECIFIC,tag:s.Tag.OID,capture:"authorityInfoAccessIssuers"}]}]};function g(e){for(const t of e){if(null!=t.name&&""!==t.name||(null!=t.oid&&(t.name=o.getOIDName(t.oid)),""===t.name&&null!=t.shortName&&(t.name=o.getOIDName(c[t.shortName]))),null==t.oid||""===t.oid){if(""===t.name)throw new Error("Attribute oid not specified.");t.oid=o.getOID(t.name)}if(null!=t.shortName&&""!==t.shortName||(t.shortName=null==c[t.name]?"":c[t.name]),null==t.value)throw new Error("Attribute value not specified.")}}function v(e){const t=[];for(const n of e.mustCompound())for(const e of n.mustCompound()){const n=e.mustCompound(),i={};i.oid=s.ASN1.parseOID(n[0].bytes),i.value=n[1].value,i.valueTag=n[1].tag,i.name=o.getOIDName(i.oid),i.shortName=(r=i.name,null==c[r]?"":c[r]),t.push(i)}var r;return t}function b(e){return null==e||e instanceof Buffer||"function"!=typeof e.toJSON?e:e.toJSON()}},5069:(e,t)=>{"use strict";var r;(function(e){e[e.LOWER_7=127]="LOWER_7",e[e.UPPER_1=128]="UPPER_1"})(r||(r={}));const n=e=>Number.isSafeInteger(e);class i{static decode(e,t=0){const n=this.$scanForNullBytes(e,t);let i=0,s=0;for(let o=0;o<=n-t;o++){i|=(e[t+o]&r.LOWER_7)<<s,s+=7}return i}static encode(e){if(this.check(e),e<0)throw new Error(`An unsigned number must NOT be negative, ${e} is!`);let t=[],n=e;do{let e=n&r.LOWER_7;n>>=7,n&&(e|=r.UPPER_1),t.push(e)}while(n);return Uint8Array.from(t)}static check(e){if(!n(e))throw new Error(`${e} is not a safe integer!`)}static $scanForNullBytes(e,t=0){let n=t,i=0;do{if(n>=e.byteLength)throw new Error("This is not a LEB128-encoded Uint8Array, no ending found!");i=e.slice(n,n+1)[0],n++}while(i&r.UPPER_1);return n-1}static getLength(e,t=0){return this.$scanForNullBytes(e,t)-t}}class s{static $ceil7mul(e){let t=e;for(;t%7;)t++;return t}static check(e){if(!n(e))throw new Error(`${e} is not a safe integer!`)}static encode(e){if(this.check(e),e>=0)throw new Error(`A signed number must be negative, ${e} isn't!`);const t=Math.ceil(Math.log2(-e));return i.encode((1<<this.$ceil7mul(t))+e)}static decode(e,t=0){const r=i.decode(e,t);return-((1<<Math.ceil(Math.log2(r)))-r)}}class o{}o.encode=e=>(e>=0?i:s).encode(e),o.decode=(e,t=0,r=!1)=>(r?s:i).decode(e,t)},243:function(e){!function(t){"use strict";function r(e){return parseInt(e)===e}function n(e){if(!r(e.length))return!1;for(var t=0;t<e.length;t++)if(!r(e[t])||e[t]<0||e[t]>255)return!1;return!0}function i(e,t){if(e.buffer&&"Uint8Array"===e.name)return t&&(e=e.slice?e.slice():Array.prototype.slice.call(e)),e;if(Array.isArray(e)){if(!n(e))throw new Error("Array contains invalid value: "+e);return new Uint8Array(e)}if(r(e.length)&&n(e))return new Uint8Array(e);throw new Error("unsupported array-like object")}function s(e){return new Uint8Array(e)}function o(e,t,r,n,i){null==n&&null==i||(e=e.slice?e.slice(n,i):Array.prototype.slice.call(e,n,i)),t.set(e,r)}var a,c={toBytes:function(e){var t=[],r=0;for(e=encodeURI(e);r<e.length;){var n=e.charCodeAt(r++);37===n?(t.push(parseInt(e.substr(r,2),16)),r+=2):t.push(n)}return i(t)},fromBytes:function(e){for(var t=[],r=0;r<e.length;){var n=e[r];n<128?(t.push(String.fromCharCode(n)),r++):n>191&&n<224?(t.push(String.fromCharCode((31&n)<<6|63&e[r+1])),r+=2):(t.push(String.fromCharCode((15&n)<<12|(63&e[r+1])<<6|63&e[r+2])),r+=3)}return t.join("")}},u=(a="0123456789abcdef",{toBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},fromBytes:function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(a[(240&n)>>4]+a[15&n])}return t.join("")}}),h={16:10,24:12,32:14},d=[1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145],l=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22],f=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125],p=[3328402341,4168907908,4000806809,4135287693,4294111757,3597364157,3731845041,2445657428,1613770832,33620227,3462883241,1445669757,3892248089,3050821474,1303096294,3967186586,2412431941,528646813,2311702848,4202528135,4026202645,2992200171,2387036105,4226871307,1101901292,3017069671,1604494077,1169141738,597466303,1403299063,3832705686,2613100635,1974974402,3791519004,1033081774,1277568618,1815492186,2118074177,4126668546,2211236943,1748251740,1369810420,3521504564,4193382664,3799085459,2883115123,1647391059,706024767,134480908,2512897874,1176707941,2646852446,806885416,932615841,168101135,798661301,235341577,605164086,461406363,3756188221,3454790438,1311188841,2142417613,3933566367,302582043,495158174,1479289972,874125870,907746093,3698224818,3025820398,1537253627,2756858614,1983593293,3084310113,2108928974,1378429307,3722699582,1580150641,327451799,2790478837,3117535592,0,3253595436,1075847264,3825007647,2041688520,3059440621,3563743934,2378943302,1740553945,1916352843,2487896798,2555137236,2958579944,2244988746,3151024235,3320835882,1336584933,3992714006,2252555205,2588757463,1714631509,293963156,2319795663,3925473552,67240454,4269768577,2689618160,2017213508,631218106,1269344483,2723238387,1571005438,2151694528,93294474,1066570413,563977660,1882732616,4059428100,1673313503,2008463041,2950355573,1109467491,537923632,3858759450,4260623118,3218264685,2177748300,403442708,638784309,3287084079,3193921505,899127202,2286175436,773265209,2479146071,1437050866,4236148354,2050833735,3362022572,3126681063,840505643,3866325909,3227541664,427917720,2655997905,2749160575,1143087718,1412049534,999329963,193497219,2353415882,3354324521,1807268051,672404540,2816401017,3160301282,369822493,2916866934,3688947771,1681011286,1949973070,336202270,2454276571,201721354,1210328172,3093060836,2680341085,3184776046,1135389935,3294782118,965841320,831886756,3554993207,4068047243,3588745010,2345191491,1849112409,3664604599,26054028,2983581028,2622377682,1235855840,3630984372,2891339514,4092916743,3488279077,3395642799,4101667470,1202630377,268961816,1874508501,4034427016,1243948399,1546530418,941366308,1470539505,1941222599,2546386513,3421038627,2715671932,3899946140,1042226977,2521517021,1639824860,227249030,260737669,3765465232,2084453954,1907733956,3429263018,2420656344,100860677,4160157185,470683154,3261161891,1781871967,2924959737,1773779408,394692241,2579611992,974986535,664706745,3655459128,3958962195,731420851,571543859,3530123707,2849626480,126783113,865375399,765172662,1008606754,361203602,3387549984,2278477385,2857719295,1344809080,2782912378,59542671,1503764984,160008576,437062935,1707065306,3622233649,2218934982,3496503480,2185314755,697932208,1512910199,504303377,2075177163,2824099068,1841019862,739644986],y=[2781242211,2230877308,2582542199,2381740923,234877682,3184946027,2984144751,1418839493,1348481072,50462977,2848876391,2102799147,434634494,1656084439,3863849899,2599188086,1167051466,2636087938,1082771913,2281340285,368048890,3954334041,3381544775,201060592,3963727277,1739838676,4250903202,3930435503,3206782108,4149453988,2531553906,1536934080,3262494647,484572669,2923271059,1783375398,1517041206,1098792767,49674231,1334037708,1550332980,4098991525,886171109,150598129,2481090929,1940642008,1398944049,1059722517,201851908,1385547719,1699095331,1587397571,674240536,2704774806,252314885,3039795866,151914247,908333586,2602270848,1038082786,651029483,1766729511,3447698098,2682942837,454166793,2652734339,1951935532,775166490,758520603,3000790638,4004797018,4217086112,4137964114,1299594043,1639438038,3464344499,2068982057,1054729187,1901997871,2534638724,4121318227,1757008337,0,750906861,1614815264,535035132,3363418545,3988151131,3201591914,1183697867,3647454910,1265776953,3734260298,3566750796,3903871064,1250283471,1807470800,717615087,3847203498,384695291,3313910595,3617213773,1432761139,2484176261,3481945413,283769337,100925954,2180939647,4037038160,1148730428,3123027871,3813386408,4087501137,4267549603,3229630528,2315620239,2906624658,3156319645,1215313976,82966005,3747855548,3245848246,1974459098,1665278241,807407632,451280895,251524083,1841287890,1283575245,337120268,891687699,801369324,3787349855,2721421207,3431482436,959321879,1469301956,4065699751,2197585534,1199193405,2898814052,3887750493,724703513,2514908019,2696962144,2551808385,3516813135,2141445340,1715741218,2119445034,2872807568,2198571144,3398190662,700968686,3547052216,1009259540,2041044702,3803995742,487983883,1991105499,1004265696,1449407026,1316239930,504629770,3683797321,168560134,1816667172,3837287516,1570751170,1857934291,4014189740,2797888098,2822345105,2754712981,936633572,2347923833,852879335,1133234376,1500395319,3084545389,2348912013,1689376213,3533459022,3762923945,3034082412,4205598294,133428468,634383082,2949277029,2398386810,3913789102,403703816,3580869306,2297460856,1867130149,1918643758,607656988,4049053350,3346248884,1368901318,600565992,2090982877,2632479860,557719327,3717614411,3697393085,2249034635,2232388234,2430627952,1115438654,3295786421,2865522278,3633334344,84280067,33027830,303828494,2747425121,1600795957,4188952407,3496589753,2434238086,1486471617,658119965,3106381470,953803233,334231800,3005978776,857870609,3151128937,1890179545,2298973838,2805175444,3056442267,574365214,2450884487,550103529,1233637070,4289353045,2018519080,2057691103,2399374476,4166623649,2148108681,387583245,3664101311,836232934,3330556482,3100665960,3280093505,2955516313,2002398509,287182607,3413881008,4238890068,3597515707,975967766],m=[1671808611,2089089148,2006576759,2072901243,4061003762,1807603307,1873927791,3310653893,810573872,16974337,1739181671,729634347,4263110654,3613570519,2883997099,1989864566,3393556426,2191335298,3376449993,2106063485,4195741690,1508618841,1204391495,4027317232,2917941677,3563566036,2734514082,2951366063,2629772188,2767672228,1922491506,3227229120,3082974647,4246528509,2477669779,644500518,911895606,1061256767,4144166391,3427763148,878471220,2784252325,3845444069,4043897329,1905517169,3631459288,827548209,356461077,67897348,3344078279,593839651,3277757891,405286936,2527147926,84871685,2595565466,118033927,305538066,2157648768,3795705826,3945188843,661212711,2999812018,1973414517,152769033,2208177539,745822252,439235610,455947803,1857215598,1525593178,2700827552,1391895634,994932283,3596728278,3016654259,695947817,3812548067,795958831,2224493444,1408607827,3513301457,0,3979133421,543178784,4229948412,2982705585,1542305371,1790891114,3410398667,3201918910,961245753,1256100938,1289001036,1491644504,3477767631,3496721360,4012557807,2867154858,4212583931,1137018435,1305975373,861234739,2241073541,1171229253,4178635257,33948674,2139225727,1357946960,1011120188,2679776671,2833468328,1374921297,2751356323,1086357568,2408187279,2460827538,2646352285,944271416,4110742005,3168756668,3066132406,3665145818,560153121,271589392,4279952895,4077846003,3530407890,3444343245,202643468,322250259,3962553324,1608629855,2543990167,1154254916,389623319,3294073796,2817676711,2122513534,1028094525,1689045092,1575467613,422261273,1939203699,1621147744,2174228865,1339137615,3699352540,577127458,712922154,2427141008,2290289544,1187679302,3995715566,3100863416,339486740,3732514782,1591917662,186455563,3681988059,3762019296,844522546,978220090,169743370,1239126601,101321734,611076132,1558493276,3260915650,3547250131,2901361580,1655096418,2443721105,2510565781,3828863972,2039214713,3878868455,3359869896,928607799,1840765549,2374762893,3580146133,1322425422,2850048425,1823791212,1459268694,4094161908,3928346602,1706019429,2056189050,2934523822,135794696,3134549946,2022240376,628050469,779246638,472135708,2800834470,3032970164,3327236038,3894660072,3715932637,1956440180,522272287,1272813131,3185336765,2340818315,2323976074,1888542832,1044544574,3049550261,1722469478,1222152264,50660867,4127324150,236067854,1638122081,895445557,1475980887,3117443513,2257655686,3243809217,489110045,2662934430,3778599393,4162055160,2561878936,288563729,1773916777,3648039385,2391345038,2493985684,2612407707,505560094,2274497927,3911240169,3460925390,1442818645,678973480,3749357023,2358182796,2717407649,2306869641,219617805,3218761151,3862026214,1120306242,1756942440,1103331905,2578459033,762796589,252780047,2966125488,1425844308,3151392187,372911126],g=[1667474886,2088535288,2004326894,2071694838,4075949567,1802223062,1869591006,3318043793,808472672,16843522,1734846926,724270422,4278065639,3621216949,2880169549,1987484396,3402253711,2189597983,3385409673,2105378810,4210693615,1499065266,1195886990,4042263547,2913856577,3570689971,2728590687,2947541573,2627518243,2762274643,1920112356,3233831835,3082273397,4261223649,2475929149,640051788,909531756,1061110142,4160160501,3435941763,875846760,2779116625,3857003729,4059105529,1903268834,3638064043,825316194,353713962,67374088,3351728789,589522246,3284360861,404236336,2526454071,84217610,2593830191,117901582,303183396,2155911963,3806477791,3958056653,656894286,2998062463,1970642922,151591698,2206440989,741110872,437923380,454765878,1852748508,1515908788,2694904667,1381168804,993742198,3604373943,3014905469,690584402,3823320797,791638366,2223281939,1398011302,3520161977,0,3991743681,538992704,4244381667,2981218425,1532751286,1785380564,3419096717,3200178535,960056178,1246420628,1280103576,1482221744,3486468741,3503319995,4025428677,2863326543,4227536621,1128514950,1296947098,859002214,2240123921,1162203018,4193849577,33687044,2139062782,1347481760,1010582648,2678045221,2829640523,1364325282,2745433693,1077985408,2408548869,2459086143,2644360225,943212656,4126475505,3166494563,3065430391,3671750063,555836226,269496352,4294908645,4092792573,3537006015,3452783745,202118168,320025894,3974901699,1600119230,2543297077,1145359496,387397934,3301201811,2812801621,2122220284,1027426170,1684319432,1566435258,421079858,1936954854,1616945344,2172753945,1330631070,3705438115,572679748,707427924,2425400123,2290647819,1179044492,4008585671,3099120491,336870440,3739122087,1583276732,185277718,3688593069,3772791771,842159716,976899700,168435220,1229577106,101059084,606366792,1549591736,3267517855,3553849021,2897014595,1650632388,2442242105,2509612081,3840161747,2038008818,3890688725,3368567691,926374254,1835907034,2374863873,3587531953,1313788572,2846482505,1819063512,1448540844,4109633523,3941213647,1701162954,2054852340,2930698567,134748176,3132806511,2021165296,623210314,774795868,471606328,2795958615,3031746419,3334885783,3907527627,3722280097,1953799400,522133822,1263263126,3183336545,2341176845,2324333839,1886425312,1044267644,3048588401,1718004428,1212733584,50529542,4143317495,235803164,1633788866,892690282,1465383342,3115962473,2256965911,3250673817,488449850,2661202215,3789633753,4177007595,2560144171,286339874,1768537042,3654906025,2391705863,2492770099,2610673197,505291324,2273808917,3924369609,3469625735,1431699370,673740880,3755965093,2358021891,2711746649,2307489801,218961690,3217021541,3873845719,1111672452,1751693520,1094828930,2576986153,757954394,252645662,2964376443,1414855848,3149649517,370555436],v=[1374988112,2118214995,437757123,975658646,1001089995,530400753,2902087851,1273168787,540080725,2910219766,2295101073,4110568485,1340463100,3307916247,641025152,3043140495,3736164937,632953703,1172967064,1576976609,3274667266,2169303058,2370213795,1809054150,59727847,361929877,3211623147,2505202138,3569255213,1484005843,1239443753,2395588676,1975683434,4102977912,2572697195,666464733,3202437046,4035489047,3374361702,2110667444,1675577880,3843699074,2538681184,1649639237,2976151520,3144396420,4269907996,4178062228,1883793496,2403728665,2497604743,1383856311,2876494627,1917518562,3810496343,1716890410,3001755655,800440835,2261089178,3543599269,807962610,599762354,33778362,3977675356,2328828971,2809771154,4077384432,1315562145,1708848333,101039829,3509871135,3299278474,875451293,2733856160,92987698,2767645557,193195065,1080094634,1584504582,3178106961,1042385657,2531067453,3711829422,1306967366,2438237621,1908694277,67556463,1615861247,429456164,3602770327,2302690252,1742315127,2968011453,126454664,3877198648,2043211483,2709260871,2084704233,4169408201,0,159417987,841739592,504459436,1817866830,4245618683,260388950,1034867998,908933415,168810852,1750902305,2606453969,607530554,202008497,2472011535,3035535058,463180190,2160117071,1641816226,1517767529,470948374,3801332234,3231722213,1008918595,303765277,235474187,4069246893,766945465,337553864,1475418501,2943682380,4003061179,2743034109,4144047775,1551037884,1147550661,1543208500,2336434550,3408119516,3069049960,3102011747,3610369226,1113818384,328671808,2227573024,2236228733,3535486456,2935566865,3341394285,496906059,3702665459,226906860,2009195472,733156972,2842737049,294930682,1206477858,2835123396,2700099354,1451044056,573804783,2269728455,3644379585,2362090238,2564033334,2801107407,2776292904,3669462566,1068351396,742039012,1350078989,1784663195,1417561698,4136440770,2430122216,775550814,2193862645,2673705150,1775276924,1876241833,3475313331,3366754619,270040487,3902563182,3678124923,3441850377,1851332852,3969562369,2203032232,3868552805,2868897406,566021896,4011190502,3135740889,1248802510,3936291284,699432150,832877231,708780849,3332740144,899835584,1951317047,4236429990,3767586992,866637845,4043610186,1106041591,2144161806,395441711,1984812685,1139781709,3433712980,3835036895,2664543715,1282050075,3240894392,1181045119,2640243204,25965917,4203181171,4211818798,3009879386,2463879762,3910161971,1842759443,2597806476,933301370,1509430414,3943906441,3467192302,3076639029,3776767469,2051518780,2631065433,1441952575,404016761,1942435775,1408749034,1610459739,3745345300,2017778566,3400528769,3110650942,941896748,3265478751,371049330,3168937228,675039627,4279080257,967311729,135050206,3635733660,1683407248,2076935265,3576870512,1215061108,3501741890],b=[1347548327,1400783205,3273267108,2520393566,3409685355,4045380933,2880240216,2471224067,1428173050,4138563181,2441661558,636813900,4233094615,3620022987,2149987652,2411029155,1239331162,1730525723,2554718734,3781033664,46346101,310463728,2743944855,3328955385,3875770207,2501218972,3955191162,3667219033,768917123,3545789473,692707433,1150208456,1786102409,2029293177,1805211710,3710368113,3065962831,401639597,1724457132,3028143674,409198410,2196052529,1620529459,1164071807,3769721975,2226875310,486441376,2499348523,1483753576,428819965,2274680428,3075636216,598438867,3799141122,1474502543,711349675,129166120,53458370,2592523643,2782082824,4063242375,2988687269,3120694122,1559041666,730517276,2460449204,4042459122,2706270690,3446004468,3573941694,533804130,2328143614,2637442643,2695033685,839224033,1973745387,957055980,2856345839,106852767,1371368976,4181598602,1033297158,2933734917,1179510461,3046200461,91341917,1862534868,4284502037,605657339,2547432937,3431546947,2003294622,3182487618,2282195339,954669403,3682191598,1201765386,3917234703,3388507166,0,2198438022,1211247597,2887651696,1315723890,4227665663,1443857720,507358933,657861945,1678381017,560487590,3516619604,975451694,2970356327,261314535,3535072918,2652609425,1333838021,2724322336,1767536459,370938394,182621114,3854606378,1128014560,487725847,185469197,2918353863,3106780840,3356761769,2237133081,1286567175,3152976349,4255350624,2683765030,3160175349,3309594171,878443390,1988838185,3704300486,1756818940,1673061617,3403100636,272786309,1075025698,545572369,2105887268,4174560061,296679730,1841768865,1260232239,4091327024,3960309330,3497509347,1814803222,2578018489,4195456072,575138148,3299409036,446754879,3629546796,4011996048,3347532110,3252238545,4270639778,915985419,3483825537,681933534,651868046,2755636671,3828103837,223377554,2607439820,1649704518,3270937875,3901806776,1580087799,4118987695,3198115200,2087309459,2842678573,3016697106,1003007129,2802849917,1860738147,2077965243,164439672,4100872472,32283319,2827177882,1709610350,2125135846,136428751,3874428392,3652904859,3460984630,3572145929,3593056380,2939266226,824852259,818324884,3224740454,930369212,2801566410,2967507152,355706840,1257309336,4148292826,243256656,790073846,2373340630,1296297904,1422699085,3756299780,3818836405,457992840,3099667487,2135319889,77422314,1560382517,1945798516,788204353,1521706781,1385356242,870912086,325965383,2358957921,2050466060,2388260884,2313884476,4006521127,901210569,3990953189,1014646705,1503449823,1062597235,2031621326,3212035895,3931371469,1533017514,350174575,2256028891,2177544179,1052338372,741876788,1606591296,1914052035,213705253,2334669897,1107234197,1899603969,3725069491,2631447780,2422494913,1635502980,1893020342,1950903388,1120974935],E=[2807058932,1699970625,2764249623,1586903591,1808481195,1173430173,1487645946,59984867,4199882800,1844882806,1989249228,1277555970,3623636965,3419915562,1149249077,2744104290,1514790577,459744698,244860394,3235995134,1963115311,4027744588,2544078150,4190530515,1608975247,2627016082,2062270317,1507497298,2200818878,567498868,1764313568,3359936201,2305455554,2037970062,1047239e3,1910319033,1337376481,2904027272,2892417312,984907214,1243112415,830661914,861968209,2135253587,2011214180,2927934315,2686254721,731183368,1750626376,4246310725,1820824798,4172763771,3542330227,48394827,2404901663,2871682645,671593195,3254988725,2073724613,145085239,2280796200,2779915199,1790575107,2187128086,472615631,3029510009,4075877127,3802222185,4107101658,3201631749,1646252340,4270507174,1402811438,1436590835,3778151818,3950355702,3963161475,4020912224,2667994737,273792366,2331590177,104699613,95345982,3175501286,2377486676,1560637892,3564045318,369057872,4213447064,3919042237,1137477952,2658625497,1119727848,2340947849,1530455833,4007360968,172466556,266959938,516552836,0,2256734592,3980931627,1890328081,1917742170,4294704398,945164165,3575528878,958871085,3647212047,2787207260,1423022939,775562294,1739656202,3876557655,2530391278,2443058075,3310321856,547512796,1265195639,437656594,3121275539,719700128,3762502690,387781147,218828297,3350065803,2830708150,2848461854,428169201,122466165,3720081049,1627235199,648017665,4122762354,1002783846,2117360635,695634755,3336358691,4234721005,4049844452,3704280881,2232435299,574624663,287343814,612205898,1039717051,840019705,2708326185,793451934,821288114,1391201670,3822090177,376187827,3113855344,1224348052,1679968233,2361698556,1058709744,752375421,2431590963,1321699145,3519142200,2734591178,188127444,2177869557,3727205754,2384911031,3215212461,2648976442,2450346104,3432737375,1180849278,331544205,3102249176,4150144569,2952102595,2159976285,2474404304,766078933,313773861,2570832044,2108100632,1668212892,3145456443,2013908262,418672217,3070356634,2594734927,1852171925,3867060991,3473416636,3907448597,2614737639,919489135,164948639,2094410160,2997825956,590424639,2486224549,1723872674,3157750862,3399941250,3501252752,3625268135,2555048196,3673637356,1343127501,4130281361,3599595085,2957853679,1297403050,81781910,3051593425,2283490410,532201772,1367295589,3926170974,895287692,1953757831,1093597963,492483431,3528626907,1446242576,1192455638,1636604631,209336225,344873464,1015671571,669961897,3375740769,3857572124,2973530695,3747192018,1933530610,3464042516,935293895,3454686199,2858115069,1863638845,3683022916,4085369519,3292445032,875313188,1080017571,3279033885,621591778,1233856572,2504130317,24197544,3017672716,3835484340,3247465558,2220981195,3060847922,1551124588,1463996600],S=[4104605777,1097159550,396673818,660510266,2875968315,2638606623,4200115116,3808662347,821712160,1986918061,3430322568,38544885,3856137295,718002117,893681702,1654886325,2975484382,3122358053,3926825029,4274053469,796197571,1290801793,1184342925,3556361835,2405426947,2459735317,1836772287,1381620373,3196267988,1948373848,3764988233,3385345166,3263785589,2390325492,1480485785,3111247143,3780097726,2293045232,548169417,3459953789,3746175075,439452389,1362321559,1400849762,1685577905,1806599355,2174754046,137073913,1214797936,1174215055,3731654548,2079897426,1943217067,1258480242,529487843,1437280870,3945269170,3049390895,3313212038,923313619,679998e3,3215307299,57326082,377642221,3474729866,2041877159,133361907,1776460110,3673476453,96392454,878845905,2801699524,777231668,4082475170,2330014213,4142626212,2213296395,1626319424,1906247262,1846563261,562755902,3708173718,1040559837,3871163981,1418573201,3294430577,114585348,1343618912,2566595609,3186202582,1078185097,3651041127,3896688048,2307622919,425408743,3371096953,2081048481,1108339068,2216610296,0,2156299017,736970802,292596766,1517440620,251657213,2235061775,2933202493,758720310,265905162,1554391400,1532285339,908999204,174567692,1474760595,4002861748,2610011675,3234156416,3693126241,2001430874,303699484,2478443234,2687165888,585122620,454499602,151849742,2345119218,3064510765,514443284,4044981591,1963412655,2581445614,2137062819,19308535,1928707164,1715193156,4219352155,1126790795,600235211,3992742070,3841024952,836553431,1669664834,2535604243,3323011204,1243905413,3141400786,4180808110,698445255,2653899549,2989552604,2253581325,3252932727,3004591147,1891211689,2487810577,3915653703,4237083816,4030667424,2100090966,865136418,1229899655,953270745,3399679628,3557504664,4118925222,2061379749,3079546586,2915017791,983426092,2022837584,1607244650,2118541908,2366882550,3635996816,972512814,3283088770,1568718495,3499326569,3576539503,621982671,2895723464,410887952,2623762152,1002142683,645401037,1494807662,2595684844,1335535747,2507040230,4293295786,3167684641,367585007,3885750714,1865862730,2668221674,2960971305,2763173681,1059270954,2777952454,2724642869,1320957812,2194319100,2429595872,2815956275,77089521,3973773121,3444575871,2448830231,1305906550,4021308739,2857194700,2516901860,3518358430,1787304780,740276417,1699839814,1592394909,2352307457,2272556026,188821243,1729977011,3687994002,274084841,3594982253,3613494426,2701949495,4162096729,322734571,2837966542,1640576439,484830689,1202797690,3537852828,4067639125,349075736,3342319475,4157467219,4255800159,1030690015,1155237496,2951971274,1757691577,607398968,2738905026,499347990,3794078908,1011452712,227885567,2818666809,213114376,3034881240,1455525988,3414450555,850817237,1817998408,3092726480],A=[0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795],I=[0,185469197,370938394,487725847,741876788,657861945,975451694,824852259,1483753576,1400783205,1315723890,1164071807,1950903388,2135319889,1649704518,1767536459,2967507152,3152976349,2801566410,2918353863,2631447780,2547432937,2328143614,2177544179,3901806776,3818836405,4270639778,4118987695,3299409036,3483825537,3535072918,3652904859,2077965243,1893020342,1841768865,1724457132,1474502543,1559041666,1107234197,1257309336,598438867,681933534,901210569,1052338372,261314535,77422314,428819965,310463728,3409685355,3224740454,3710368113,3593056380,3875770207,3960309330,4045380933,4195456072,2471224067,2554718734,2237133081,2388260884,3212035895,3028143674,2842678573,2724322336,4138563181,4255350624,3769721975,3955191162,3667219033,3516619604,3431546947,3347532110,2933734917,2782082824,3099667487,3016697106,2196052529,2313884476,2499348523,2683765030,1179510461,1296297904,1347548327,1533017514,1786102409,1635502980,2087309459,2003294622,507358933,355706840,136428751,53458370,839224033,957055980,605657339,790073846,2373340630,2256028891,2607439820,2422494913,2706270690,2856345839,3075636216,3160175349,3573941694,3725069491,3273267108,3356761769,4181598602,4063242375,4011996048,3828103837,1033297158,915985419,730517276,545572369,296679730,446754879,129166120,213705253,1709610350,1860738147,1945798516,2029293177,1239331162,1120974935,1606591296,1422699085,4148292826,4233094615,3781033664,3931371469,3682191598,3497509347,3446004468,3328955385,2939266226,2755636671,3106780840,2988687269,2198438022,2282195339,2501218972,2652609425,1201765386,1286567175,1371368976,1521706781,1805211710,1620529459,2105887268,1988838185,533804130,350174575,164439672,46346101,870912086,954669403,636813900,788204353,2358957921,2274680428,2592523643,2441661558,2695033685,2880240216,3065962831,3182487618,3572145929,3756299780,3270937875,3388507166,4174560061,4091327024,4006521127,3854606378,1014646705,930369212,711349675,560487590,272786309,457992840,106852767,223377554,1678381017,1862534868,1914052035,2031621326,1211247597,1128014560,1580087799,1428173050,32283319,182621114,401639597,486441376,768917123,651868046,1003007129,818324884,1503449823,1385356242,1333838021,1150208456,1973745387,2125135846,1673061617,1756818940,2970356327,3120694122,2802849917,2887651696,2637442643,2520393566,2334669897,2149987652,3917234703,3799141122,4284502037,4100872472,3309594171,3460984630,3545789473,3629546796,2050466060,1899603969,1814803222,1730525723,1443857720,1560382517,1075025698,1260232239,575138148,692707433,878443390,1062597235,243256656,91341917,409198410,325965383,3403100636,3252238545,3704300486,3620022987,3874428392,3990953189,4042459122,4227665663,2460449204,2578018489,2226875310,2411029155,3198115200,3046200461,2827177882,2743944855],w=[0,218828297,437656594,387781147,875313188,958871085,775562294,590424639,1750626376,1699970625,1917742170,2135253587,1551124588,1367295589,1180849278,1265195639,3501252752,3720081049,3399941250,3350065803,3835484340,3919042237,4270507174,4085369519,3102249176,3051593425,2734591178,2952102595,2361698556,2177869557,2530391278,2614737639,3145456443,3060847922,2708326185,2892417312,2404901663,2187128086,2504130317,2555048196,3542330227,3727205754,3375740769,3292445032,3876557655,3926170974,4246310725,4027744588,1808481195,1723872674,1910319033,2094410160,1608975247,1391201670,1173430173,1224348052,59984867,244860394,428169201,344873464,935293895,984907214,766078933,547512796,1844882806,1627235199,2011214180,2062270317,1507497298,1423022939,1137477952,1321699145,95345982,145085239,532201772,313773861,830661914,1015671571,731183368,648017665,3175501286,2957853679,2807058932,2858115069,2305455554,2220981195,2474404304,2658625497,3575528878,3625268135,3473416636,3254988725,3778151818,3963161475,4213447064,4130281361,3599595085,3683022916,3432737375,3247465558,3802222185,4020912224,4172763771,4122762354,3201631749,3017672716,2764249623,2848461854,2331590177,2280796200,2431590963,2648976442,104699613,188127444,472615631,287343814,840019705,1058709744,671593195,621591778,1852171925,1668212892,1953757831,2037970062,1514790577,1463996600,1080017571,1297403050,3673637356,3623636965,3235995134,3454686199,4007360968,3822090177,4107101658,4190530515,2997825956,3215212461,2830708150,2779915199,2256734592,2340947849,2627016082,2443058075,172466556,122466165,273792366,492483431,1047239e3,861968209,612205898,695634755,1646252340,1863638845,2013908262,1963115311,1446242576,1530455833,1277555970,1093597963,1636604631,1820824798,2073724613,1989249228,1436590835,1487645946,1337376481,1119727848,164948639,81781910,331544205,516552836,1039717051,821288114,669961897,719700128,2973530695,3157750862,2871682645,2787207260,2232435299,2283490410,2667994737,2450346104,3647212047,3564045318,3279033885,3464042516,3980931627,3762502690,4150144569,4199882800,3070356634,3121275539,2904027272,2686254721,2200818878,2384911031,2570832044,2486224549,3747192018,3528626907,3310321856,3359936201,3950355702,3867060991,4049844452,4234721005,1739656202,1790575107,2108100632,1890328081,1402811438,1586903591,1233856572,1149249077,266959938,48394827,369057872,418672217,1002783846,919489135,567498868,752375421,209336225,24197544,376187827,459744698,945164165,895287692,574624663,793451934,1679968233,1764313568,2117360635,1933530610,1343127501,1560637892,1243112415,1192455638,3704280881,3519142200,3336358691,3419915562,3907448597,3857572124,4075877127,4294704398,3029510009,3113855344,2927934315,2744104290,2159976285,2377486676,2594734927,2544078150],T=[0,151849742,303699484,454499602,607398968,758720310,908999204,1059270954,1214797936,1097159550,1517440620,1400849762,1817998408,1699839814,2118541908,2001430874,2429595872,2581445614,2194319100,2345119218,3034881240,3186202582,2801699524,2951971274,3635996816,3518358430,3399679628,3283088770,4237083816,4118925222,4002861748,3885750714,1002142683,850817237,698445255,548169417,529487843,377642221,227885567,77089521,1943217067,2061379749,1640576439,1757691577,1474760595,1592394909,1174215055,1290801793,2875968315,2724642869,3111247143,2960971305,2405426947,2253581325,2638606623,2487810577,3808662347,3926825029,4044981591,4162096729,3342319475,3459953789,3576539503,3693126241,1986918061,2137062819,1685577905,1836772287,1381620373,1532285339,1078185097,1229899655,1040559837,923313619,740276417,621982671,439452389,322734571,137073913,19308535,3871163981,4021308739,4104605777,4255800159,3263785589,3414450555,3499326569,3651041127,2933202493,2815956275,3167684641,3049390895,2330014213,2213296395,2566595609,2448830231,1305906550,1155237496,1607244650,1455525988,1776460110,1626319424,2079897426,1928707164,96392454,213114376,396673818,514443284,562755902,679998e3,865136418,983426092,3708173718,3557504664,3474729866,3323011204,4180808110,4030667424,3945269170,3794078908,2507040230,2623762152,2272556026,2390325492,2975484382,3092726480,2738905026,2857194700,3973773121,3856137295,4274053469,4157467219,3371096953,3252932727,3673476453,3556361835,2763173681,2915017791,3064510765,3215307299,2156299017,2307622919,2459735317,2610011675,2081048481,1963412655,1846563261,1729977011,1480485785,1362321559,1243905413,1126790795,878845905,1030690015,645401037,796197571,274084841,425408743,38544885,188821243,3613494426,3731654548,3313212038,3430322568,4082475170,4200115116,3780097726,3896688048,2668221674,2516901860,2366882550,2216610296,3141400786,2989552604,2837966542,2687165888,1202797690,1320957812,1437280870,1554391400,1669664834,1787304780,1906247262,2022837584,265905162,114585348,499347990,349075736,736970802,585122620,972512814,821712160,2595684844,2478443234,2293045232,2174754046,3196267988,3079546586,2895723464,2777952454,3537852828,3687994002,3234156416,3385345166,4142626212,4293295786,3841024952,3992742070,174567692,57326082,410887952,292596766,777231668,660510266,1011452712,893681702,1108339068,1258480242,1343618912,1494807662,1715193156,1865862730,1948373848,2100090966,2701949495,2818666809,3004591147,3122358053,2235061775,2352307457,2535604243,2653899549,3915653703,3764988233,4219352155,4067639125,3444575871,3294430577,3746175075,3594982253,836553431,953270745,600235211,718002117,367585007,484830689,133361907,251657213,2041877159,1891211689,1806599355,1654886325,1568718495,1418573201,1335535747,1184342925];function C(e){for(var t=[],r=0;r<e.length;r+=4)t.push(e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]);return t}var _=function(e){if(!(this instanceof _))throw Error("AES must be instanitated with `new`");Object.defineProperty(this,"key",{value:i(e,!0)}),this._prepare()};_.prototype._prepare=function(){var e=h[this.key.length];if(null==e)throw new Error("invalid key size (must be 16, 24 or 32 bytes)");this._Ke=[],this._Kd=[];for(var t=0;t<=e;t++)this._Ke.push([0,0,0,0]),this._Kd.push([0,0,0,0]);var r,n=4*(e+1),i=this.key.length/4,s=C(this.key);for(t=0;t<i;t++)r=t>>2,this._Ke[r][t%4]=s[t],this._Kd[e-r][t%4]=s[t];for(var o,a=0,c=i;c<n;){if(o=s[i-1],s[0]^=l[o>>16&255]<<24^l[o>>8&255]<<16^l[255&o]<<8^l[o>>24&255]^d[a]<<24,a+=1,8!=i)for(t=1;t<i;t++)s[t]^=s[t-1];else{for(t=1;t<i/2;t++)s[t]^=s[t-1];o=s[i/2-1],s[i/2]^=l[255&o]^l[o>>8&255]<<8^l[o>>16&255]<<16^l[o>>24&255]<<24;for(t=i/2+1;t<i;t++)s[t]^=s[t-1]}for(t=0;t<i&&c<n;)u=c>>2,f=c%4,this._Ke[u][f]=s[t],this._Kd[e-u][f]=s[t++],c++}for(var u=1;u<e;u++)for(var f=0;f<4;f++)o=this._Kd[u][f],this._Kd[u][f]=A[o>>24&255]^I[o>>16&255]^w[o>>8&255]^T[255&o]},_.prototype.encrypt=function(e){if(16!=e.length)throw new Error("invalid plaintext size (must be 16 bytes)");for(var t=this._Ke.length-1,r=[0,0,0,0],n=C(e),i=0;i<4;i++)n[i]^=this._Ke[0][i];for(var o=1;o<t;o++){for(i=0;i<4;i++)r[i]=p[n[i]>>24&255]^y[n[(i+1)%4]>>16&255]^m[n[(i+2)%4]>>8&255]^g[255&n[(i+3)%4]]^this._Ke[o][i];n=r.slice()}var a,c=s(16);for(i=0;i<4;i++)a=this._Ke[t][i],c[4*i]=255&(l[n[i]>>24&255]^a>>24),c[4*i+1]=255&(l[n[(i+1)%4]>>16&255]^a>>16),c[4*i+2]=255&(l[n[(i+2)%4]>>8&255]^a>>8),c[4*i+3]=255&(l[255&n[(i+3)%4]]^a);return c},_.prototype.decrypt=function(e){if(16!=e.length)throw new Error("invalid ciphertext size (must be 16 bytes)");for(var t=this._Kd.length-1,r=[0,0,0,0],n=C(e),i=0;i<4;i++)n[i]^=this._Kd[0][i];for(var o=1;o<t;o++){for(i=0;i<4;i++)r[i]=v[n[i]>>24&255]^b[n[(i+3)%4]>>16&255]^E[n[(i+2)%4]>>8&255]^S[255&n[(i+1)%4]]^this._Kd[o][i];n=r.slice()}var a,c=s(16);for(i=0;i<4;i++)a=this._Kd[t][i],c[4*i]=255&(f[n[i]>>24&255]^a>>24),c[4*i+1]=255&(f[n[(i+3)%4]>>16&255]^a>>16),c[4*i+2]=255&(f[n[(i+2)%4]>>8&255]^a>>8),c[4*i+3]=255&(f[255&n[(i+1)%4]]^a);return c};var D=function(e){if(!(this instanceof D))throw Error("AES must be instanitated with `new`");this.description="Electronic Code Block",this.name="ecb",this._aes=new _(e)};D.prototype.encrypt=function(e){if((e=i(e)).length%16!=0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var t=s(e.length),r=s(16),n=0;n<e.length;n+=16)o(e,r,0,n,n+16),o(r=this._aes.encrypt(r),t,n);return t},D.prototype.decrypt=function(e){if((e=i(e)).length%16!=0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var t=s(e.length),r=s(16),n=0;n<e.length;n+=16)o(e,r,0,n,n+16),o(r=this._aes.decrypt(r),t,n);return t};var R=function(e,t){if(!(this instanceof R))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Block Chaining",this.name="cbc",t){if(16!=t.length)throw new Error("invalid initialation vector size (must be 16 bytes)")}else t=s(16);this._lastCipherblock=i(t,!0),this._aes=new _(e)};R.prototype.encrypt=function(e){if((e=i(e)).length%16!=0)throw new Error("invalid plaintext size (must be multiple of 16 bytes)");for(var t=s(e.length),r=s(16),n=0;n<e.length;n+=16){o(e,r,0,n,n+16);for(var a=0;a<16;a++)r[a]^=this._lastCipherblock[a];this._lastCipherblock=this._aes.encrypt(r),o(this._lastCipherblock,t,n)}return t},R.prototype.decrypt=function(e){if((e=i(e)).length%16!=0)throw new Error("invalid ciphertext size (must be multiple of 16 bytes)");for(var t=s(e.length),r=s(16),n=0;n<e.length;n+=16){o(e,r,0,n,n+16),r=this._aes.decrypt(r);for(var a=0;a<16;a++)t[n+a]=r[a]^this._lastCipherblock[a];o(e,this._lastCipherblock,0,n,n+16)}return t};var N=function(e,t,r){if(!(this instanceof N))throw Error("AES must be instanitated with `new`");if(this.description="Cipher Feedback",this.name="cfb",t){if(16!=t.length)throw new Error("invalid initialation vector size (must be 16 size)")}else t=s(16);r||(r=1),this.segmentSize=r,this._shiftRegister=i(t,!0),this._aes=new _(e)};N.prototype.encrypt=function(e){if(e.length%this.segmentSize!=0)throw new Error("invalid plaintext size (must be segmentSize bytes)");for(var t,r=i(e,!0),n=0;n<r.length;n+=this.segmentSize){t=this._aes.encrypt(this._shiftRegister);for(var s=0;s<this.segmentSize;s++)r[n+s]^=t[s];o(this._shiftRegister,this._shiftRegister,0,this.segmentSize),o(r,this._shiftRegister,16-this.segmentSize,n,n+this.segmentSize)}return r},N.prototype.decrypt=function(e){if(e.length%this.segmentSize!=0)throw new Error("invalid ciphertext size (must be segmentSize bytes)");for(var t,r=i(e,!0),n=0;n<r.length;n+=this.segmentSize){t=this._aes.encrypt(this._shiftRegister);for(var s=0;s<this.segmentSize;s++)r[n+s]^=t[s];o(this._shiftRegister,this._shiftRegister,0,this.segmentSize),o(e,this._shiftRegister,16-this.segmentSize,n,n+this.segmentSize)}return r};var O=function(e,t){if(!(this instanceof O))throw Error("AES must be instanitated with `new`");if(this.description="Output Feedback",this.name="ofb",t){if(16!=t.length)throw new Error("invalid initialation vector size (must be 16 bytes)")}else t=s(16);this._lastPrecipher=i(t,!0),this._lastPrecipherIndex=16,this._aes=new _(e)};O.prototype.encrypt=function(e){for(var t=i(e,!0),r=0;r<t.length;r++)16===this._lastPrecipherIndex&&(this._lastPrecipher=this._aes.encrypt(this._lastPrecipher),this._lastPrecipherIndex=0),t[r]^=this._lastPrecipher[this._lastPrecipherIndex++];return t},O.prototype.decrypt=O.prototype.encrypt;var U=function(e){if(!(this instanceof U))throw Error("Counter must be instanitated with `new`");0===e||e||(e=1),"number"==typeof e?(this._counter=s(16),this.setValue(e)):this.setBytes(e)};U.prototype.setValue=function(e){if("number"!=typeof e||parseInt(e)!=e)throw new Error("invalid counter value (must be an integer)");if(e>Number.MAX_SAFE_INTEGER)throw new Error("integer value out of safe range");for(var t=15;t>=0;--t)this._counter[t]=e%256,e=parseInt(e/256)},U.prototype.setBytes=function(e){if(16!=(e=i(e,!0)).length)throw new Error("invalid counter bytes size (must be 16 bytes)");this._counter=e},U.prototype.increment=function(){for(var e=15;e>=0;e--){if(255!==this._counter[e]){this._counter[e]++;break}this._counter[e]=0}};var P=function(e,t){if(!(this instanceof P))throw Error("AES must be instanitated with `new`");this.description="Counter",this.name="ctr",t instanceof U||(t=new U(t)),this._counter=t,this._remainingCounter=null,this._remainingCounterIndex=16,this._aes=new _(e)};P.prototype.encrypt=function(e){for(var t=i(e,!0),r=0;r<t.length;r++)16===this._remainingCounterIndex&&(this._remainingCounter=this._aes.encrypt(this._counter._counter),this._remainingCounterIndex=0,this._counter.increment()),t[r]^=this._remainingCounter[this._remainingCounterIndex++];return t},P.prototype.decrypt=P.prototype.encrypt;var B={AES:_,Counter:U,ModeOfOperation:{ecb:D,cbc:R,cfb:N,ofb:O,ctr:P},utils:{hex:u,utf8:c},padding:{pkcs7:{pad:function(e){var t=16-(e=i(e,!0)).length%16,r=s(e.length+t);o(e,r);for(var n=e.length;n<r.length;n++)r[n]=t;return r},strip:function(e){if((e=i(e,!0)).length<16)throw new Error("PKCS#7 invalid length");var t=e[e.length-1];if(t>16)throw new Error("PKCS#7 padding byte out of range");for(var r=e.length-t,n=0;n<t;n++)if(e[r+n]!==t)throw new Error("PKCS#7 invalid padding byte");var a=s(r);return o(e,a,0,0,r),a}}},_arrayTest:{coerceArray:i,createArray:s,copyArray:o}};e.exports=B}()},7616:(e,t,r)=>{var n;e=r.nmd(e);var i=function(e){"use strict";var t=1e7,r=9007199254740992,n=l(r),s="0123456789abcdefghijklmnopqrstuvwxyz",o="function"==typeof BigInt;function a(e,t,r,n){return void 0===e?a[0]:void 0!==t&&(10!=+t||r)?q(e,t,r,n):Y(e)}function c(e,t){this.value=e,this.sign=t,this.isSmall=!1}function u(e){this.value=e,this.sign=e<0,this.isSmall=!0}function h(e){this.value=e}function d(e){return-r<e&&e<r}function l(e){return e<1e7?[e]:e<1e14?[e%1e7,Math.floor(e/1e7)]:[e%1e7,Math.floor(e/1e7)%1e7,Math.floor(e/1e14)]}function f(e){p(e);var r=e.length;if(r<4&&N(e,n)<0)switch(r){case 0:return 0;case 1:return e[0];case 2:return e[0]+e[1]*t;default:return e[0]+(e[1]+e[2]*t)*t}return e}function p(e){for(var t=e.length;0===e[--t];);e.length=t+1}function y(e){for(var t=new Array(e),r=-1;++r<e;)t[r]=0;return t}function m(e){return e>0?Math.floor(e):Math.ceil(e)}function g(e,r){var n,i,s=e.length,o=r.length,a=new Array(s),c=0,u=t;for(i=0;i<o;i++)c=(n=e[i]+r[i]+c)>=u?1:0,a[i]=n-c*u;for(;i<s;)c=(n=e[i]+c)===u?1:0,a[i++]=n-c*u;return c>0&&a.push(c),a}function v(e,t){return e.length>=t.length?g(e,t):g(t,e)}function b(e,r){var n,i,s=e.length,o=new Array(s),a=t;for(i=0;i<s;i++)n=e[i]-a+r,r=Math.floor(n/a),o[i]=n-r*a,r+=1;for(;r>0;)o[i++]=r%a,r=Math.floor(r/a);return o}function E(e,r){var n,i,s=e.length,o=r.length,a=new Array(s),c=0,u=t;for(n=0;n<o;n++)(i=e[n]-c-r[n])<0?(i+=u,c=1):c=0,a[n]=i;for(n=o;n<s;n++){if(!((i=e[n]-c)<0)){a[n++]=i;break}i+=u,a[n]=i}for(;n<s;n++)a[n]=e[n];return p(a),a}function S(e,r,n){var i,s,o=e.length,a=new Array(o),h=-r,d=t;for(i=0;i<o;i++)s=e[i]+h,h=Math.floor(s/d),s%=d,a[i]=s<0?s+d:s;return"number"==typeof(a=f(a))?(n&&(a=-a),new u(a)):new c(a,n)}function A(e,r){var n,i,s,o,a=e.length,c=r.length,u=y(a+c),h=t;for(s=0;s<a;++s){o=e[s];for(var d=0;d<c;++d)n=o*r[d]+u[s+d],i=Math.floor(n/h),u[s+d]=n-i*h,u[s+d+1]+=i}return p(u),u}function I(e,r){var n,i,s=e.length,o=new Array(s),a=t,c=0;for(i=0;i<s;i++)n=e[i]*r+c,c=Math.floor(n/a),o[i]=n-c*a;for(;c>0;)o[i++]=c%a,c=Math.floor(c/a);return o}function w(e,t){for(var r=[];t-- >0;)r.push(0);return r.concat(e)}function T(e,t){var r=Math.max(e.length,t.length);if(r<=30)return A(e,t);r=Math.ceil(r/2);var n=e.slice(r),i=e.slice(0,r),s=t.slice(r),o=t.slice(0,r),a=T(i,o),c=T(n,s),u=T(v(i,n),v(o,s)),h=v(v(a,w(E(E(u,a),c),r)),w(c,2*r));return p(h),h}function C(e,r,n){return new c(e<t?I(r,e):A(r,l(e)),n)}function _(e){var r,n,i,s,o=e.length,a=y(o+o),c=t;for(i=0;i<o;i++){n=0-(s=e[i])*s;for(var u=i;u<o;u++)r=s*e[u]*2+a[i+u]+n,n=Math.floor(r/c),a[i+u]=r-n*c;a[i+o]=n}return p(a),a}function D(e,t){var r,n,i,s,o=e.length,a=y(o);for(i=0,r=o-1;r>=0;--r)i=(s=1e7*i+e[r])-(n=m(s/t))*t,a[r]=0|n;return[a,0|i]}function R(e,r){var n,i=Y(r);if(o)return[new h(e.value/i.value),new h(e.value%i.value)];var s,d=e.value,g=i.value;if(0===g)throw new Error("Cannot divide by zero");if(e.isSmall)return i.isSmall?[new u(m(d/g)),new u(d%g)]:[a[0],e];if(i.isSmall){if(1===g)return[e,a[0]];if(-1==g)return[e.negate(),a[0]];var v=Math.abs(g);if(v<t){s=f((n=D(d,v))[0]);var b=n[1];return e.sign&&(b=-b),"number"==typeof s?(e.sign!==i.sign&&(s=-s),[new u(s),new u(b)]):[new c(s,e.sign!==i.sign),new u(b)]}g=l(v)}var S=N(d,g);if(-1===S)return[a[0],e];if(0===S)return[a[e.sign===i.sign?1:-1],a[0]];n=d.length+g.length<=200?function(e,r){var n,i,s,o,a,c,u,h=e.length,d=r.length,l=t,p=y(r.length),m=r[d-1],g=Math.ceil(l/(2*m)),v=I(e,g),b=I(r,g);for(v.length<=h&&v.push(0),b.push(0),m=b[d-1],i=h-d;i>=0;i--){for(n=l-1,v[i+d]!==m&&(n=Math.floor((v[i+d]*l+v[i+d-1])/m)),s=0,o=0,c=b.length,a=0;a<c;a++)s+=n*b[a],u=Math.floor(s/l),o+=v[i+a]-(s-u*l),s=u,o<0?(v[i+a]=o+l,o=-1):(v[i+a]=o,o=0);for(;0!==o;){for(n-=1,s=0,a=0;a<c;a++)(s+=v[i+a]-l+b[a])<0?(v[i+a]=s+l,s=0):(v[i+a]=s,s=1);o+=s}p[i]=n}return v=D(v,g)[0],[f(p),f(v)]}(d,g):function(e,r){for(var n,i,s,o,a,c=e.length,u=r.length,h=[],d=[],l=t;c;)if(d.unshift(e[--c]),p(d),N(d,r)<0)h.push(0);else{s=d[(i=d.length)-1]*l+d[i-2],o=r[u-1]*l+r[u-2],i>u&&(s=(s+1)*l),n=Math.ceil(s/o);do{if(N(a=I(r,n),d)<=0)break;n--}while(n);h.push(n),d=E(d,a)}return h.reverse(),[f(h),f(d)]}(d,g),s=n[0];var A=e.sign!==i.sign,w=n[1],T=e.sign;return"number"==typeof s?(A&&(s=-s),s=new u(s)):s=new c(s,A),"number"==typeof w?(T&&(w=-w),w=new u(w)):w=new c(w,T),[s,w]}function N(e,t){if(e.length!==t.length)return e.length>t.length?1:-1;for(var r=e.length-1;r>=0;r--)if(e[r]!==t[r])return e[r]>t[r]?1:-1;return 0}function O(e){var t=e.abs();return!t.isUnit()&&(!!(t.equals(2)||t.equals(3)||t.equals(5))||!(t.isEven()||t.isDivisibleBy(3)||t.isDivisibleBy(5))&&(!!t.lesser(49)||void 0))}function U(e,t){for(var r,n,s,o=e.prev(),a=o,c=0;a.isEven();)a=a.divide(2),c++;e:for(n=0;n<t.length;n++)if(!e.lesser(t[n])&&!(s=i(t[n]).modPow(a,e)).isUnit()&&!s.equals(o)){for(r=c-1;0!=r;r--){if((s=s.square().mod(e)).isUnit())return!1;if(s.equals(o))continue e}return!1}return!0}c.prototype=Object.create(a.prototype),u.prototype=Object.create(a.prototype),h.prototype=Object.create(a.prototype),c.prototype.add=function(e){var t=Y(e);if(this.sign!==t.sign)return this.subtract(t.negate());var r=this.value,n=t.value;return t.isSmall?new c(b(r,Math.abs(n)),this.sign):new c(v(r,n),this.sign)},c.prototype.plus=c.prototype.add,u.prototype.add=function(e){var t=Y(e),r=this.value;if(r<0!==t.sign)return this.subtract(t.negate());var n=t.value;if(t.isSmall){if(d(r+n))return new u(r+n);n=l(Math.abs(n))}return new c(b(n,Math.abs(r)),r<0)},u.prototype.plus=u.prototype.add,h.prototype.add=function(e){return new h(this.value+Y(e).value)},h.prototype.plus=h.prototype.add,c.prototype.subtract=function(e){var t=Y(e);if(this.sign!==t.sign)return this.add(t.negate());var r=this.value,n=t.value;return t.isSmall?S(r,Math.abs(n),this.sign):function(e,t,r){var n;return N(e,t)>=0?n=E(e,t):(n=E(t,e),r=!r),"number"==typeof(n=f(n))?(r&&(n=-n),new u(n)):new c(n,r)}(r,n,this.sign)},c.prototype.minus=c.prototype.subtract,u.prototype.subtract=function(e){var t=Y(e),r=this.value;if(r<0!==t.sign)return this.add(t.negate());var n=t.value;return t.isSmall?new u(r-n):S(n,Math.abs(r),r>=0)},u.prototype.minus=u.prototype.subtract,h.prototype.subtract=function(e){return new h(this.value-Y(e).value)},h.prototype.minus=h.prototype.subtract,c.prototype.negate=function(){return new c(this.value,!this.sign)},u.prototype.negate=function(){var e=this.sign,t=new u(-this.value);return t.sign=!e,t},h.prototype.negate=function(){return new h(-this.value)},c.prototype.abs=function(){return new c(this.value,!1)},u.prototype.abs=function(){return new u(Math.abs(this.value))},h.prototype.abs=function(){return new h(this.value>=0?this.value:-this.value)},c.prototype.multiply=function(e){var r,n,i,s=Y(e),o=this.value,u=s.value,h=this.sign!==s.sign;if(s.isSmall){if(0===u)return a[0];if(1===u)return this;if(-1===u)return this.negate();if((r=Math.abs(u))<t)return new c(I(o,r),h);u=l(r)}return n=o.length,i=u.length,new c(-.012*n-.012*i+15e-6*n*i>0?T(o,u):A(o,u),h)},c.prototype.times=c.prototype.multiply,u.prototype._multiplyBySmall=function(e){return d(e.value*this.value)?new u(e.value*this.value):C(Math.abs(e.value),l(Math.abs(this.value)),this.sign!==e.sign)},c.prototype._multiplyBySmall=function(e){return 0===e.value?a[0]:1===e.value?this:-1===e.value?this.negate():C(Math.abs(e.value),this.value,this.sign!==e.sign)},u.prototype.multiply=function(e){return Y(e)._multiplyBySmall(this)},u.prototype.times=u.prototype.multiply,h.prototype.multiply=function(e){return new h(this.value*Y(e).value)},h.prototype.times=h.prototype.multiply,c.prototype.square=function(){return new c(_(this.value),!1)},u.prototype.square=function(){var e=this.value*this.value;return d(e)?new u(e):new c(_(l(Math.abs(this.value))),!1)},h.prototype.square=function(e){return new h(this.value*this.value)},c.prototype.divmod=function(e){var t=R(this,e);return{quotient:t[0],remainder:t[1]}},h.prototype.divmod=u.prototype.divmod=c.prototype.divmod,c.prototype.divide=function(e){return R(this,e)[0]},h.prototype.over=h.prototype.divide=function(e){return new h(this.value/Y(e).value)},u.prototype.over=u.prototype.divide=c.prototype.over=c.prototype.divide,c.prototype.mod=function(e){return R(this,e)[1]},h.prototype.mod=h.prototype.remainder=function(e){return new h(this.value%Y(e).value)},u.prototype.remainder=u.prototype.mod=c.prototype.remainder=c.prototype.mod,c.prototype.pow=function(e){var t,r,n,i=Y(e),s=this.value,o=i.value;if(0===o)return a[1];if(0===s)return a[0];if(1===s)return a[1];if(-1===s)return i.isEven()?a[1]:a[-1];if(i.sign)return a[0];if(!i.isSmall)throw new Error("The exponent "+i.toString()+" is too large.");if(this.isSmall&&d(t=Math.pow(s,o)))return new u(m(t));for(r=this,n=a[1];!0&o&&(n=n.times(r),--o),0!==o;)o/=2,r=r.square();return n},u.prototype.pow=c.prototype.pow,h.prototype.pow=function(e){var t=Y(e),r=this.value,n=t.value,i=BigInt(0),s=BigInt(1),o=BigInt(2);if(n===i)return a[1];if(r===i)return a[0];if(r===s)return a[1];if(r===BigInt(-1))return t.isEven()?a[1]:a[-1];if(t.isNegative())return new h(i);for(var c=this,u=a[1];(n&s)===s&&(u=u.times(c),--n),n!==i;)n/=o,c=c.square();return u},c.prototype.modPow=function(e,t){if(e=Y(e),(t=Y(t)).isZero())throw new Error("Cannot take modPow with modulus 0");var r=a[1],n=this.mod(t);for(e.isNegative()&&(e=e.multiply(a[-1]),n=n.modInv(t));e.isPositive();){if(n.isZero())return a[0];e.isOdd()&&(r=r.multiply(n).mod(t)),e=e.divide(2),n=n.square().mod(t)}return r},h.prototype.modPow=u.prototype.modPow=c.prototype.modPow,c.prototype.compareAbs=function(e){var t=Y(e),r=this.value,n=t.value;return t.isSmall?1:N(r,n)},u.prototype.compareAbs=function(e){var t=Y(e),r=Math.abs(this.value),n=t.value;return t.isSmall?r===(n=Math.abs(n))?0:r>n?1:-1:-1},h.prototype.compareAbs=function(e){var t=this.value,r=Y(e).value;return(t=t>=0?t:-t)===(r=r>=0?r:-r)?0:t>r?1:-1},c.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=Y(e),r=this.value,n=t.value;return this.sign!==t.sign?t.sign?1:-1:t.isSmall?this.sign?-1:1:N(r,n)*(this.sign?-1:1)},c.prototype.compareTo=c.prototype.compare,u.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=Y(e),r=this.value,n=t.value;return t.isSmall?r==n?0:r>n?1:-1:r<0!==t.sign?r<0?-1:1:r<0?1:-1},u.prototype.compareTo=u.prototype.compare,h.prototype.compare=function(e){if(e===1/0)return-1;if(e===-1/0)return 1;var t=this.value,r=Y(e).value;return t===r?0:t>r?1:-1},h.prototype.compareTo=h.prototype.compare,c.prototype.equals=function(e){return 0===this.compare(e)},h.prototype.eq=h.prototype.equals=u.prototype.eq=u.prototype.equals=c.prototype.eq=c.prototype.equals,c.prototype.notEquals=function(e){return 0!==this.compare(e)},h.prototype.neq=h.prototype.notEquals=u.prototype.neq=u.prototype.notEquals=c.prototype.neq=c.prototype.notEquals,c.prototype.greater=function(e){return this.compare(e)>0},h.prototype.gt=h.prototype.greater=u.prototype.gt=u.prototype.greater=c.prototype.gt=c.prototype.greater,c.prototype.lesser=function(e){return this.compare(e)<0},h.prototype.lt=h.prototype.lesser=u.prototype.lt=u.prototype.lesser=c.prototype.lt=c.prototype.lesser,c.prototype.greaterOrEquals=function(e){return this.compare(e)>=0},h.prototype.geq=h.prototype.greaterOrEquals=u.prototype.geq=u.prototype.greaterOrEquals=c.prototype.geq=c.prototype.greaterOrEquals,c.prototype.lesserOrEquals=function(e){return this.compare(e)<=0},h.prototype.leq=h.prototype.lesserOrEquals=u.prototype.leq=u.prototype.lesserOrEquals=c.prototype.leq=c.prototype.lesserOrEquals,c.prototype.isEven=function(){return 0==(1&this.value[0])},u.prototype.isEven=function(){return 0==(1&this.value)},h.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},c.prototype.isOdd=function(){return 1==(1&this.value[0])},u.prototype.isOdd=function(){return 1==(1&this.value)},h.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},c.prototype.isPositive=function(){return!this.sign},u.prototype.isPositive=function(){return this.value>0},h.prototype.isPositive=u.prototype.isPositive,c.prototype.isNegative=function(){return this.sign},u.prototype.isNegative=function(){return this.value<0},h.prototype.isNegative=u.prototype.isNegative,c.prototype.isUnit=function(){return!1},u.prototype.isUnit=function(){return 1===Math.abs(this.value)},h.prototype.isUnit=function(){return this.abs().value===BigInt(1)},c.prototype.isZero=function(){return!1},u.prototype.isZero=function(){return 0===this.value},h.prototype.isZero=function(){return this.value===BigInt(0)},c.prototype.isDivisibleBy=function(e){var t=Y(e);return!t.isZero()&&(!!t.isUnit()||(0===t.compareAbs(2)?this.isEven():this.mod(t).isZero()))},h.prototype.isDivisibleBy=u.prototype.isDivisibleBy=c.prototype.isDivisibleBy,c.prototype.isPrime=function(t){var r=O(this);if(r!==e)return r;var n=this.abs(),s=n.bitLength();if(s<=64)return U(n,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var o=Math.log(2)*s.toJSNumber(),a=Math.ceil(!0===t?2*Math.pow(o,2):o),c=[],u=0;u<a;u++)c.push(i(u+2));return U(n,c)},h.prototype.isPrime=u.prototype.isPrime=c.prototype.isPrime,c.prototype.isProbablePrime=function(t,r){var n=O(this);if(n!==e)return n;for(var s=this.abs(),o=t===e?5:t,a=[],c=0;c<o;c++)a.push(i.randBetween(2,s.minus(2),r));return U(s,a)},h.prototype.isProbablePrime=u.prototype.isProbablePrime=c.prototype.isProbablePrime,c.prototype.modInv=function(e){for(var t,r,n,s=i.zero,o=i.one,a=Y(e),c=this.abs();!c.isZero();)t=a.divide(c),r=s,n=a,s=o,a=c,o=r.subtract(t.multiply(o)),c=n.subtract(t.multiply(c));if(!a.isUnit())throw new Error(this.toString()+" and "+e.toString()+" are not co-prime");return-1===s.compare(0)&&(s=s.add(e)),this.isNegative()?s.negate():s},h.prototype.modInv=u.prototype.modInv=c.prototype.modInv,c.prototype.next=function(){var e=this.value;return this.sign?S(e,1,this.sign):new c(b(e,1),this.sign)},u.prototype.next=function(){var e=this.value;return e+1<r?new u(e+1):new c(n,!1)},h.prototype.next=function(){return new h(this.value+BigInt(1))},c.prototype.prev=function(){var e=this.value;return this.sign?new c(b(e,1),!0):S(e,1,this.sign)},u.prototype.prev=function(){var e=this.value;return e-1>-r?new u(e-1):new c(n,!0)},h.prototype.prev=function(){return new h(this.value-BigInt(1))};for(var P=[1];2*P[P.length-1]<=t;)P.push(2*P[P.length-1]);var B=P.length,x=P[B-1];function M(e){return Math.abs(e)<=t}function L(e,t,r){t=Y(t);for(var n=e.isNegative(),s=t.isNegative(),o=n?e.not():e,a=s?t.not():t,c=0,u=0,h=null,d=null,l=[];!o.isZero()||!a.isZero();)c=(h=R(o,x))[1].toJSNumber(),n&&(c=x-1-c),u=(d=R(a,x))[1].toJSNumber(),s&&(u=x-1-u),o=h[0],a=d[0],l.push(r(c,u));for(var f=0!==r(n?1:0,s?1:0)?i(-1):i(0),p=l.length-1;p>=0;p-=1)f=f.multiply(x).add(i(l[p]));return f}c.prototype.shiftLeft=function(e){var t=Y(e).toJSNumber();if(!M(t))throw new Error(String(t)+" is too large for shifting.");if(t<0)return this.shiftRight(-t);var r=this;if(r.isZero())return r;for(;t>=B;)r=r.multiply(x),t-=B-1;return r.multiply(P[t])},h.prototype.shiftLeft=u.prototype.shiftLeft=c.prototype.shiftLeft,c.prototype.shiftRight=function(e){var t,r=Y(e).toJSNumber();if(!M(r))throw new Error(String(r)+" is too large for shifting.");if(r<0)return this.shiftLeft(-r);for(var n=this;r>=B;){if(n.isZero()||n.isNegative()&&n.isUnit())return n;n=(t=R(n,x))[1].isNegative()?t[0].prev():t[0],r-=B-1}return(t=R(n,P[r]))[1].isNegative()?t[0].prev():t[0]},h.prototype.shiftRight=u.prototype.shiftRight=c.prototype.shiftRight,c.prototype.not=function(){return this.negate().prev()},h.prototype.not=u.prototype.not=c.prototype.not,c.prototype.and=function(e){return L(this,e,(function(e,t){return e&t}))},h.prototype.and=u.prototype.and=c.prototype.and,c.prototype.or=function(e){return L(this,e,(function(e,t){return e|t}))},h.prototype.or=u.prototype.or=c.prototype.or,c.prototype.xor=function(e){return L(this,e,(function(e,t){return e^t}))},h.prototype.xor=u.prototype.xor=c.prototype.xor;var k=1<<30;function F(e){var r=e.value,n="number"==typeof r?r|k:"bigint"==typeof r?r|BigInt(k):r[0]+r[1]*t|1073758208;return n&-n}function V(e,t){if(t.compareTo(e)<=0){var r=V(e,t.square(t)),n=r.p,s=r.e,o=n.multiply(t);return o.compareTo(e)<=0?{p:o,e:2*s+1}:{p:n,e:2*s}}return{p:i(1),e:0}}function H(e,t){return e=Y(e),t=Y(t),e.greater(t)?e:t}function j(e,t){return e=Y(e),t=Y(t),e.lesser(t)?e:t}function K(e,t){if(e=Y(e).abs(),t=Y(t).abs(),e.equals(t))return e;if(e.isZero())return t;if(t.isZero())return e;for(var r,n,i=a[1];e.isEven()&&t.isEven();)r=j(F(e),F(t)),e=e.divide(r),t=t.divide(r),i=i.multiply(r);for(;e.isEven();)e=e.divide(F(e));do{for(;t.isEven();)t=t.divide(F(t));e.greater(t)&&(n=t,t=e,e=n),t=t.subtract(e)}while(!t.isZero());return i.isUnit()?e:e.multiply(i)}c.prototype.bitLength=function(){var e=this;return e.compareTo(i(0))<0&&(e=e.negate().subtract(i(1))),0===e.compareTo(i(0))?i(0):i(V(e,i(2)).e).add(i(1))},h.prototype.bitLength=u.prototype.bitLength=c.prototype.bitLength;var q=function(e,t,r,n){r=r||s,e=String(e),n||(e=e.toLowerCase(),r=r.toLowerCase());var i,o=e.length,a=Math.abs(t),c={};for(i=0;i<r.length;i++)c[r[i]]=i;for(i=0;i<o;i++){if("-"!==(d=e[i])&&(d in c&&c[d]>=a)){if("1"===d&&1===a)continue;throw new Error(d+" is not a valid digit in base "+t+".")}}t=Y(t);var u=[],h="-"===e[0];for(i=h?1:0;i<e.length;i++){var d;if((d=e[i])in c)u.push(Y(c[d]));else{if("<"!==d)throw new Error(d+" is not a valid character");var l=i;do{i++}while(">"!==e[i]&&i<e.length);u.push(Y(e.slice(l+1,i)))}}return G(u,t,h)};function G(e,t,r){var n,i=a[0],s=a[1];for(n=e.length-1;n>=0;n--)i=i.add(e[n].times(s)),s=s.times(t);return r?i.negate():i}function z(e,t){if((t=i(t)).isZero()){if(e.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(t.equals(-1)){if(e.isZero())return{value:[0],isNegative:!1};if(e.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-e.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var r=Array.apply(null,Array(e.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return r.unshift([1]),{value:[].concat.apply([],r),isNegative:!1}}var n=!1;if(e.isNegative()&&t.isPositive()&&(n=!0,e=e.abs()),t.isUnit())return e.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(e.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:n};for(var s,o=[],a=e;a.isNegative()||a.compareAbs(t)>=0;){s=a.divmod(t),a=s.quotient;var c=s.remainder;c.isNegative()&&(c=t.minus(c).abs(),a=a.next()),o.push(c.toJSNumber())}return o.push(a.toJSNumber()),{value:o.reverse(),isNegative:n}}function $(e,t,r){var n=z(e,t);return(n.isNegative?"-":"")+n.value.map((function(e){return function(e,t){return e<(t=t||s).length?t[e]:"<"+e+">"}(e,r)})).join("")}function W(e){if(d(+e)){var t=+e;if(t===m(t))return o?new h(BigInt(t)):new u(t);throw new Error("Invalid integer: "+e)}var r="-"===e[0];r&&(e=e.slice(1));var n=e.split(/e/i);if(n.length>2)throw new Error("Invalid integer: "+n.join("e"));if(2===n.length){var i=n[1];if("+"===i[0]&&(i=i.slice(1)),(i=+i)!==m(i)||!d(i))throw new Error("Invalid integer: "+i+" is not a valid exponent.");var s=n[0],a=s.indexOf(".");if(a>=0&&(i-=s.length-a-1,s=s.slice(0,a)+s.slice(a+1)),i<0)throw new Error("Cannot include negative exponent part for integers");e=s+=new Array(i+1).join("0")}if(!/^([0-9][0-9]*)$/.test(e))throw new Error("Invalid integer: "+e);if(o)return new h(BigInt(r?"-"+e:e));for(var l=[],f=e.length,y=f-7;f>0;)l.push(+e.slice(y,f)),(y-=7)<0&&(y=0),f-=7;return p(l),new c(l,r)}function Y(e){return"number"==typeof e?function(e){if(o)return new h(BigInt(e));if(d(e)){if(e!==m(e))throw new Error(e+" is not an integer.");return new u(e)}return W(e.toString())}(e):"string"==typeof e?W(e):"bigint"==typeof e?new h(e):e}c.prototype.toArray=function(e){return z(this,e)},u.prototype.toArray=function(e){return z(this,e)},h.prototype.toArray=function(e){return z(this,e)},c.prototype.toString=function(t,r){if(t===e&&(t=10),10!==t)return $(this,t,r);for(var n,i=this.value,s=i.length,o=String(i[--s]);--s>=0;)n=String(i[s]),o+="0000000".slice(n.length)+n;return(this.sign?"-":"")+o},u.prototype.toString=function(t,r){return t===e&&(t=10),10!=t?$(this,t,r):String(this.value)},h.prototype.toString=u.prototype.toString,h.prototype.toJSON=c.prototype.toJSON=u.prototype.toJSON=function(){return this.toString()},c.prototype.valueOf=function(){return parseInt(this.toString(),10)},c.prototype.toJSNumber=c.prototype.valueOf,u.prototype.valueOf=function(){return this.value},u.prototype.toJSNumber=u.prototype.valueOf,h.prototype.valueOf=h.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};for(var Q=0;Q<1e3;Q++)a[Q]=Y(Q),Q>0&&(a[-Q]=Y(-Q));return a.one=a[1],a.zero=a[0],a.minusOne=a[-1],a.max=H,a.min=j,a.gcd=K,a.lcm=function(e,t){return e=Y(e).abs(),t=Y(t).abs(),e.divide(K(e,t)).multiply(t)},a.isInstance=function(e){return e instanceof c||e instanceof u||e instanceof h},a.randBetween=function(e,r,n){e=Y(e),r=Y(r);var i=n||Math.random,s=j(e,r),o=H(e,r).subtract(s).add(1);if(o.isSmall)return s.add(Math.floor(i()*o));for(var c=z(o,t).value,u=[],h=!0,d=0;d<c.length;d++){var l=h?c[d]+(d+1<c.length?c[d+1]/t:0):t,f=m(i()*l);u.push(f),f<c[d]&&(h=!1)}return s.add(a.fromArray(u,t,!1))},a.fromArray=function(e,t,r){return G(e.map(Y),Y(t||10),r)},a}();e.hasOwnProperty("exports")&&(e.exports=i),void 0===(n=function(){return i}.call(t,r,t,e))||(e.exports=n)},4798:(e,t,r)=>{"use strict";const n=r(9643),i=r(4673),s=r(1896),o=r(4202),a=r(5844),c=r(5078),u=r(3882),h=r(1402),d=r(7773),{encode:l}=r(5141),{decode:f}=r(6861),{encodingLength:p}=r(7225),y=r(1564),m=r(2723),g={array:i,bool:o,buffer:s,reserved:a,string:c,when:h,select:d};for(const e of Object.keys(u))g[e]=u[e];const v=Symbol("schema");function b(e){const t=new n({readableObjectMode:!1,writableObjectMode:!0,transform:S});return t[v]=e,t}function E(e){let t=null;const r=Buffer.isBuffer(e);r||(t=e);const i=new n({transform:A,readableObjectMode:!0,writableObjectMode:!1});return i[v]=t,r&&i.append(e),i}function S(e,t,r){try{l(e,this[v],this);const t=this.slice();this.consume(t.length),r(null,t)}catch(e){r(e)}}function A(e,t,r){this.append(e);try{for(;this.length>0;){const e=new y(this),t=f(e,this[v]);e.commit(),this.push(t)}r()}catch(e){e instanceof m?r():r(e)}}e.exports={createEncodeStream:b,createDecodeStream:E,encode:l,decode:f,encodingLength:p,createEncode:b,createDecode:E,types:g,BinaryStream:n,NotEnoughDataError:m}},7832:(e,t,r)=>{"use strict";const n=r(5975),i=r(3966);class s{constructor(){this.queue=new i,this.offset=0}get length(){return this.queue.length-this.offset}append(e){if(Buffer.isBuffer(e)){if(this.offset>0){const e=this.queue.shift();this.queue.unshift(e.slice(this.offset)),this.offset=0}this.queue.push(e)}else if(Array.isArray(e))for(let t=0;t<e.length;t+=1)this.append(e[t]);else if(e instanceof s){if(this.offset>0){const e=this.queue.shift();this.queue.unshift(e.slice(this.offset)),this.offset=0}if(e.offset>0){const t=e.queue.shift();e.queue.unshift(t.slice(e.offset)),e.offset=0}let t=e.queue.head;for(;t;)this.queue.push(t.buffer),t=t.next}}get(e){let t=e;for(;t>=this.length;)t-=this.length;for(;t<0;)t+=this.length;let r=this.queue.head,{offset:n}=this;for(;r;){if(r.buffer.length-n>t)return r.buffer[t+n];t-=r.buffer.length-n,n=0,r=r.next}}slice(e,t){for("number"!=typeof e&&(e=0),"number"!=typeof t&&(t=this.length);e<0;)e+=this.length;for(;t<0;)t+=this.length;if(t=Math.min(t,this.length),e>=this.length||0===t)return Buffer.alloc(0);const r=e;e=Math.min(r,t),t=Math.max(r,t);const n=this.queue.slice(e+this.offset,t+this.offset);if(1===n.count)return n.first;let i=n.head;const s=Buffer.allocUnsafe(n.length);let o=0;for(let e=0;e<n.count;e+=1)s.set(i.buffer,o),o+=i.buffer.length,i=i.next;return s}toString(e,t,r){return this.slice(t,r).toString(e)}consume(e){let t=e;for(;this.length>0;){const e=this.queue.first.length-this.offset;if(!(t>=e)){this.offset+=t;break}this.queue.shift(),t-=e,this.offset=0}}indexOf(e,t=0){if(!Number.isInteger(e))throw new TypeError("Invalid argument 1");if(e<0||e>255)throw new Error("Invalid argument 1");for(Number.isInteger(t)||(t=0);t>=this.length;)t-=this.length;for(;t<0;)t+=this.length;let r=this.queue.head,n=0;const i=()=>{n+=r.buffer.length,r=r.next};for(;r;){let s=0;if(r===this.queue.head&&(s+=this.offset),t>=r.buffer.length-s){t-=r.buffer.length-s,i();continue}t<r.buffer.length&&(s+=t);const o=r.buffer.indexOf(e,s);if(o>-1)return o+n-this.offset;i(),s>this.offset&&(t=0)}return-1}}const o={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};Object.keys(o).forEach((e=>{const t=n();t(`\n    function bufferlist_${e}(offset = 0) {\n      const start = offset + this.offset;\n      const head = this.queue.first;\n      const size = ${t.formats.d(o[e])};\n      const isFirtsChunkEnough = head.length - start >= size;\n\n      return isFirtsChunkEnough\n        ? head.${e}(start)\n        : this.slice(offset, offset + size).${e}(0)\n    }\n  `),s.prototype[e]=t.toFunction()}));["readIntBE","readIntLE","readUIntBE","readUIntLE"].forEach((e=>{const t=n();t(`\n    function bufferlist_${e}(size, offset = 0) {\n      const start = offset + this.offset;\n      const head = this.queue.first;\n      const isFirtsChunkEnough = head.length - start >= size;\n\n      return isFirtsChunkEnough\n        ? head.${e}(start, size)\n        : this.slice(offset, offset + size).${e}(0, size)\n    }\n  `),s.prototype[e]=t.toFunction()}));const a={writeDoubleBE:8,writeDoubleLE:8,writeFloatBE:4,writeFloatLE:4,writeInt32BE:4,writeInt32LE:4,writeUInt32BE:4,writeUInt32LE:4,writeInt16BE:2,writeInt16LE:2,writeUInt16BE:2,writeUInt16LE:2,writeInt8:1,writeUInt8:1};Object.keys(a).forEach((e=>{const t=n();t(`\n    function bufferlist_${e}(value) {\n      const size = ${t.formats.d(a[e])};\n      const buf = Buffer.allocUnsafe(size);\n      buf.${e}(value, 0);\n      this.append(buf);\n    }\n  `),s.prototype[e]=t.toFunction()}));["writeIntBE","writeIntLE","writeUIntBE","writeUIntLE"].forEach((e=>{const t=n();t(`\n    function bufferlist_${e}(value, size) {\n      const buf = Buffer.allocUnsafe(size);\n      buf.${e}(value, 0, size);\n      this.append(buf);\n    }\n  `),s.prototype[e]=t.toFunction()})),e.exports=s},3966:e=>{"use strict";class t{constructor(){this.next=null,this.buffer=null}}e.exports=class e{constructor(){this.head=null,this.tail=null,this.length=0,this.count=0}push(e){const r=new t;r.buffer=e,this.length>0?this.tail.next=r:this.head=r,this.tail=r,this.length+=e.length,this.count+=1}unshift(e){const r=new t;r.buffer=e,r.next=this.head,this.isEmpty()&&(this.tail=r),this.head=r,this.length+=e.length,this.count+=1}shift(){if(this.isEmpty())return null;const e=this.head.buffer;return this.head===this.tail?(this.head=null,this.tail=null):this.head=this.head.next,this.length-=e.length,this.length=Math.max(this.length,0),this.count-=1,e}get first(){return this.isEmpty()?null:this.head.buffer}get last(){return this.isEmpty()?null:this.tail.buffer}isEmpty(){return 0===this.length}clear(){this.head=null,this.tail=null,this.length=0,this.count=0}slice(t,r){if(t<0||t>=this.length)return new e;if(r<0||r>this.length||r<t)return new e;const n=new e;let i=this.head,s=t,o=r;for(;i;){if(i.buffer.length>s){0===s&&i.buffer.length<=o?n.push(i.buffer):i.buffer.length>=o?n.push(i.buffer.slice(s,o)):n.push(i.buffer.slice(s));break}s-=i.buffer.length,o-=i.buffer.length,i=i.next}if(i.buffer.length<o)for(;i;){if(i.buffer.length===o){n.push(i.buffer);break}if(i.buffer.length>o){n.push(i.buffer.slice(0,o));break}s<0&&i.buffer.length<o&&n.push(i.buffer),s-=i.buffer.length,o-=i.buffer.length,i=i.next}return n}}},3898:(e,t,r)=>{"use strict";const n=r(4359);e.exports=class e{constructor(){this[n.bytes]=0,this.node=void 0,this.current=void 0}get bytes(){return this[n.bytes]}static clone(t){const r=new e;return t instanceof e&&(r.node=t.node,r.current=t.current),r}static clean(t){t instanceof e&&(t.node=void 0,t.current=void 0)}}},4359:e=>{"use strict";const t=Symbol("skip"),r=Symbol("bytes");e.exports={skip:t,bytes:r}},9643:(e,t,r)=>{"use strict";const{Transform:n}=r(2781),i=r(5975),s=r(7832),o=r(2723),a=Symbol("buffer");class c extends n{constructor(e={}){super(e),this[a]=new s}get buffer(){return this[a]}get length(){return this.buffer.length}append(e){this.buffer.append(e)}get(e){return this.buffer.get(e)}slice(e,t){return this.buffer.slice(e,t)}consume(e){this.buffer.consume(e)}toString(e,t,r){return this.buffer.toString(e,t,r)}indexOf(e,t=0){return this.buffer.indexOf(e,t)}readBuffer(e){h(e,this.length);const t=this.slice(0,e);return this.consume(e),t}writeBuffer(e){this.append(e)}}const u={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};Object.keys(u).forEach((e=>{const t=i();t(`\n    function binary_${e}() {\n      const bytes = ${t.formats.d(u[e])};\n      assertSize(bytes, this.length);\n\n      const res = this.buffer.${e}(0);\n      this.consume(bytes);\n\n      return res;\n    }\n  `),c.prototype[e]=t.toFunction({assertSize:h})})),["readIntBE","readIntLE","readUIntBE","readUIntLE"].forEach((e=>{const t=i();t(`\n    function binary_${e}(size) {\n      assertSize(size, this.length);\n\n      const res = this.buffer.${e}(size, 0);\n      this.consume(size);\n      return res;\n    }\n  `),c.prototype[e]=t.toFunction({assertSize:h})}));["writeDoubleBE","writeDoubleLE","writeFloatBE","writeFloatLE","writeInt32BE","writeInt32LE","writeUInt32BE","writeUInt32LE","writeInt16BE","writeInt16LE","writeUInt16BE","writeUInt16LE","writeInt8","writeUInt8"].forEach((e=>{const t=i();t(`\n    function binary_${e}(value) {\n      this.buffer.${e}(value);\n    }\n  `),c.prototype[e]=t.toFunction()}));function h(e,t){if(e>t)throw new o(e,t)}["writeIntBE","writeIntLE","writeUIntBE","writeUIntLE"].forEach((e=>{const t=i();t(`\n    function binary_${e}(value, size) {\n      this.buffer.${e}(value, size);\n    }\n  `),c.prototype[e]=t.toFunction()})),e.exports=c},6861:(e,t,r)=>{"use strict";const{isType:n,isUserType:i,isDecodeType:s}=r(699),o=r(9643),a=r(4359),c=r(3898);function u(e,t,r){if(n(t)){const n=t.decode.call(r,e);return r[a.bytes]+=t.decode.bytes,n}return h(e,t,r)}function h(e,t,r){!function(e){if(!i(e))throw new TypeError("Argument #2 should be a plain object.")}(t);const n=Object.create(null);void 0===r.node?(r.node=n,r.current=n):r.current=n;const o=Object.keys(t);for(let i=0;i<o.length;i+=1){const c=o[i],u=t[c];if(!s(u)){n[c]=h(e,u,r),r.current=n;continue}const d=u.decode.call(r,e);r[a.bytes]+=u.decode.bytes,!0!==u[a.skip]&&(n[c]=d)}return n}e.exports={decode:function e(t,r){let n=t;Buffer.isBuffer(t)&&(n=new o,n.append(t));const i=new c,s=u(n,r,i);return e.bytes=i.bytes,c.clean(i),s},decodeCommon:u}},5141:(e,t,r)=>{"use strict";const{isUserType:n,isEncodeType:i,isType:s}=r(699),o=r(4359),a=r(3898),c=r(9643);function u(e,t,r,n){s(r)?(r.encode.call(n,e,t),n[o.bytes]+=r.encode.bytes):h(e,t,r,n)}function h(e,t,r,s){!function(e){if(!n(e))throw new TypeError("Argument `schema` should be a plain object.")}(r),void 0===s.node?(s.node=e,s.current=e):s.current=e;const a=Object.keys(r);for(let n=0;n<a.length;n+=1){const c=a[n],u=r[c],d=e[c];i(u)?(u.encode.call(s,d,t),s[o.bytes]+=u.encode.bytes):(h(d,t,u,s),s.current=e)}}e.exports={encode:function e(t,r,n){const i=new a;if(r instanceof c){const e=n;n=r,r=e}n instanceof c||(n=new c);return u(t,n,r,i),e.bytes=i.bytes,a.clean(i),n},encodeCommon:u}},7225:(e,t,r)=>{"use strict";const{isUserType:n,isType:i}=r(699),s=r(3898),o=r(4359);function a(e,t,r){i(t)?r[o.bytes]+=t.encodingLength.call(r,e):c(e,t,r)}function c(e,t,r){if(!n(t))throw new TypeError("Argument `schema` should be a plain object.");void 0===r.node?(r.node=e,r.current=e):r.current=e;const s=Object.keys(t);for(let n=0;n<s.length;n+=1){const a=s[n],u=t[a],h=e[a];i(u)?r[o.bytes]+=u.encodingLength.call(r,h):(c(h,u,r),r.current=e)}}e.exports={encodingLength:function(e,t){const r=new s;return a(e,t,r),s.clean(r),r.bytes},encodingLengthCommon:a}},2723:e=>{"use strict";e.exports=class extends Error{constructor(e,t){super(`requested ${e} bytes but only ${t} available`),this.name="NotEnoughDataError"}}},1564:(e,t,r)=>{"use strict";const n=r(5975),i=r(2723);class s{constructor(e){this.stream=e,this.index=0}append(e){this.stream.append(e)}commit(){this.stream.consume(this.index)}get(e=0){return this.stream.get(this.index+e)}get length(){return this.stream.length}slice(e,t){return this.stream.slice(e,t)}toString(e,t,r){return this.stream.toString(e,t,r)}readBuffer(e){a(this.index+e,this.length);const t=this.stream.slice(this.index,this.index+e);return this.index+=e,t}indexOf(e,t=0){return this.stream.indexOf(e,this.index+t)-this.index}}const o={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1};function a(e,t){if(e>t)throw new i(e,t)}Object.keys(o).forEach((e=>{const t=n(),r=o[e];t(`\n    function transaction_${e}() {\n      assertSize(this.index + ${t.formats.d(r)}, this.length);\n      const value = this.stream.buffer.${e}(this.index);\n      this.index += ${t.formats.d(r)};\n      return value;\n    }\n  `),s.prototype[e]=t.toFunction({assertSize:a})})),["readIntBE","readIntLE","readUIntBE","readUIntLE"].forEach((e=>{const t=n();t(`\n    function transaction_${e}(bytes) {\n      assertSize(this.index + bytes, this.length);\n      const value = this.stream.buffer.${e}(bytes, this.index);\n      this.index += bytes;\n      return value;\n    }\n  `),s.prototype[e]=t.toFunction({assertSize:a})})),e.exports=s},699:(e,t,r)=>{"use strict";const n=r(5817);function i(e){return"function"==typeof e}function s(e){return"object"==typeof e&&null!==e}e.exports={isType:function(e){return s(e)&&i(e.encode)&&i(e.decode)},isUserType:n,isFunction:i,isDecodeType:function(e){return s(e)&&i(e.decode)},isEncodeType:function(e){return s(e)&&i(e.encode)}}},4673:(e,t,r)=>{"use strict";const{decodeCommon:n}=r(6861),{encodeCommon:i}=r(5141),{encodingLengthCommon:s}=r(7225),{isType:o,isUserType:a,isFunction:c}=r(699),u=r(3898);function h(e){if(!Array.isArray(e))throw new TypeError("Argument #1 should be an Array.")}function d(e){if("number"!=typeof e)throw new TypeError("Length of an array should be a number.")}function l(e,t){if(e!==t)throw new Error(`Argument #1 required length ${e} instead of ${t}`)}e.exports=function(e,t,r="count"){if(!o(e)&&!a(e))throw new TypeError("Argument #1 should be a valid type.");const f="bytes"===r,p="number"==typeof t,y=o(t),m=c(t);if(!p&&!y&&!m)throw new TypeError("Unknown type of argument #1.");return{encode:function r(n,o){h(n);const a=u.clone(this);r.bytes=0;let c=0;y?c=n.length:p?c=t:m&&(c=t(a),d(c));f||l(c,n.length);if(f){const t=u.clone(a);for(const r of n)s(r,e,t);y&&(c=t.bytes),l(t.bytes,c),u.clean(t)}y&&(t.encode.call(a,c,o),r.bytes+=t.encode.bytes);n.forEach((t=>{i(t,o,e,a)})),r.bytes+=a.bytes,u.clean(a)},decode:function r(i){let s=0;r.bytes=0;const o=u.clone(this);p?s=t:y?(s=t.decode.call(o,i),r.bytes+=t.decode.bytes):m&&(s=t(o));let a;d(s),a=f?function(e,t,r,i){const s=[],o=i.bytes;let a=0;for(;a<t;)s.push(n(r,e,i)),a=i.bytes-o;if(a>t)throw new Error("Incorrect length of an array.");return s}(e,s,i,o):function(e,t,r,i){const s=new Array(t);for(let o=0;o<t;o+=1)s[o]=n(r,e,i);return s}(e,s,i,o);return r.bytes+=o.bytes,u.clean(o),a},encodingLength:function(r){h(r);const n=u.clone(this);let i=0;if(p&&f)return t;y&&!f&&(i=t.encodingLength(r.length));for(const t of r)s(t,e,n);u.clean(n),i+=n.bytes,y&&f&&(i+=t.encodingLength(i));return i}}}},4202:(e,t,r)=>{"use strict";const{isType:n}=r(699);e.exports=function(e){if(!n(e))throw new TypeError("Argument #1 should be valid type.");return{encode:function t(r,n){e.encode.call(this,r?1:0,n),t.bytes=e.encode.bytes},decode:function t(r){const n=e.decode.call(this,r);return t.bytes=e.decode.bytes,Boolean(n)},encodingLength:e.encodingLength}}},1896:(e,t,r)=>{"use strict";const{isType:n,isFunction:i}=r(699),s=r(2723),o=r(9643);function a(e){if(!(Buffer.isBuffer(e)||e instanceof o))throw new TypeError("Argument 1 should be a Buffer or a BinaryStream.")}function c(e,t){if(e!==t)throw new Error(`Buffer required length ${e} instead of ${t}`)}function u(e){if("number"!=typeof e)throw new TypeError("Length of a buffer should be a number.")}e.exports=function(e){const t="number"==typeof e,r=n(e),o=i(e),h=null===e;if(!(t||r||o||h))throw new TypeError("Unknown type of argument #1.");return{encode:function n(i,s){a(i),n.bytes=0;const d=this;t&&c(e,i.length);r&&(e.encode.call(d,i.length,s),n.bytes+=e.encode.bytes);if(o){const t=e(d);u(t),c(t,i.length)}s.writeBuffer(Buffer.isBuffer(i)?i:i.buffer),n.bytes+=i.length,h&&(s.writeUInt8(0),n.bytes+=1)},decode:function n(i){let a=0;n.bytes=0;const c=this;if(t)a=e;else if(r)a=e.decode.call(c,i),n.bytes+=e.decode.bytes,u(a);else if(o)a=e(c),u(a);else if(h&&(a=i.indexOf(0),-1===a))throw new s(i.length+1,i.length);const d=i.readBuffer(a);n.bytes+=a,h&&(n.bytes+=1,i.consume(1));return d},encodingLength:function(n){a(n);let i=0;if(t)return e;h?i=1:r&&(i=e.encodingLength(n.length));return i+n.length}}}},3882:(e,t,r)=>{"use strict";const n=r(5975);function i(e,t,r){const i=n(),s=n();return i(`\n    function decode_${r}(rstream) {\n      decode_${r}.bytes = ${i.formats.d(e)};\n      return rstream.${r}()\n    }\n  `),s(`\n    function encode_${t}(value, wstream) {\n      wstream.${t}(value);\n      encode_${t}.bytes = ${i.formats.d(e)};\n    }\n  `),{encodingLength:()=>e,encode:s.toFunction(),decode:i.toFunction()}}function s(e,t,r){const i=n(),s=n();return i(`\n    function decode_${r}(rstream) {\n      decode_${r}.bytes = ${i.formats.d(e)};\n      return rstream.${r}(${i.formats.d(e)})\n    }\n  `),s(`\n    function encode_${t}(value, wstream) {\n      wstream.${t}(value, ${i.formats.d(e)});\n      encode_${t}.bytes = ${i.formats.d(e)};\n    }\n  `),{encodingLength:()=>e,encode:s.toFunction(),decode:i.toFunction()}}e.exports={doublebe:i(8,"writeDoubleBE","readDoubleBE"),doublele:i(8,"writeDoubleLE","readDoubleLE"),floatbe:i(4,"writeFloatBE","readFloatBE"),floatle:i(4,"writeFloatLE","readFloatLE"),int8:i(1,"writeInt8","readInt8"),uint8:i(1,"writeUInt8","readUInt8"),int16be:i(2,"writeInt16BE","readInt16BE"),uint16be:i(2,"writeUInt16BE","readUInt16BE"),int16le:i(2,"writeInt16LE","readInt16LE"),uint16le:i(2,"writeUInt16LE","readUInt16LE"),int32be:i(4,"writeInt32BE","readInt32BE"),uint32be:i(4,"writeUInt32BE","readUInt32BE"),int32le:i(4,"writeInt32LE","readInt32LE"),uint32le:i(4,"writeUInt32LE","readUInt32LE"),int24be:s(3,"writeIntBE","readIntBE"),uint24be:s(3,"writeUIntBE","readUIntBE"),int24le:s(3,"writeIntLE","readIntLE"),uint24le:s(3,"writeUIntLE","readUIntLE"),int40be:s(5,"writeIntBE","readIntBE"),uint40be:s(5,"writeUIntBE","readUIntBE"),int40le:s(5,"writeIntLE","readIntLE"),uint40le:s(5,"writeUIntLE","readUIntLE"),int48be:s(6,"writeIntBE","readIntBE"),uint48be:s(6,"writeUIntBE","readUIntBE"),int48le:s(6,"writeIntLE","readIntLE"),uint48le:s(6,"writeUIntLE","readUIntLE")}},5844:(e,t,r)=>{"use strict";const{decodeCommon:n}=r(6861),{encodeCommon:i}=r(5141),{encodingLengthCommon:s}=r(7225),{isType:o,isFunction:a}=r(699),c=r(4359),u=r(3898);e.exports=function(e,t=1){if(!o(e))throw new TypeError("Invalid data type.");if(!Number.isInteger(t)&&!a(t))throw new TypeError("Argument #2 should be a valid integer or function.");return{[c.skip]:!0,encodingLength:function(r){const n=u.clone(this),i=a(t)?t(n):t;return s(r,e,n),u.clean(n),n.bytes*i},decode:function r(i){const s=u.clone(this);r.bytes=0;const o=a(t)?t(s):t;if(0===o)return void u.clean(s);for(let t=o;t>0;t-=1)n(i,e,s);r.bytes=s.bytes,u.clean(s)},encode:function r(n,s){r.bytes=0;const o=u.clone(this),c=a(t)?t(o):t;if(0===c)return void u.clean(o);for(let t=c;t>0;t-=1)i(0,s,e,o);r.bytes=o.bytes,u.clean(o)}}}},7773:(e,t,r)=>{"use strict";const n=r(4359),{decodeCommon:i}=r(6861),s=r(3898);e.exports=function(...e){if(0===e.length)throw new TypeError("You should set at least one condition type.");const t={decode:function r(o){r.bytes=0;const a=s.clone(this);for(const c of e){const e=i(o,c,a);if(!0!==c[n.skip])return r.bytes=a.bytes,s.clean(a),t[n.skip]=!1,e}t[n.skip]=!0},encode:()=>{},[n.skip]:!0};return t}},5078:(e,t,r)=>{"use strict";const{isType:n}=r(699),i=r(2723);function s(e){return function t(r,n){const i=Buffer.from(r.toString(),e);n.writeBuffer(i),n.writeInt8(0),t.bytes=i.length+1}}function o(e){return function t(r){const n=r.indexOf(0);if(-1===n)throw new i(r.length+1,r.length);const s=n+1,o=r.readBuffer(s);return t.bytes=s,o.toString(e,0,n)}}function a(e,t){return function r(n,i){if(n=n.toString(),Buffer.byteLength(n,t)!==e)throw new Error(`Size of string should be ${e} in bytes.`);const s=Buffer.from(n,t);i.writeBuffer(s),r.bytes=s.length}}function c(e,t){return function r(n){const i=n.readBuffer(e);return r.bytes=e,i.toString(t)}}function u(e,t){return function r(n,i){n=n.toString();e.encode.call(this,Buffer.byteLength(n,t),i),r.bytes=e.encode.bytes;const s=Buffer.from(n,t);i.writeBuffer(s),r.bytes+=s.length}}function h(e,t){return function r(n){const i=e.decode.call(this,n);if("number"!=typeof i)throw new TypeError("Size of a string should be a number.");const s=n.readBuffer(i);return r.bytes=e.decode.bytes+s.length,s.toString(t)}}function d(e,t){return function(r){const n=Buffer.byteLength(r,t);return e.encodingLength(n)+n}}function l(e,t){return function r(n,i){r.bytes=0;const s=e(this),o=Buffer.from(n.toString(),t);p(s),function(e,t){if(e!==t)throw new Error(`Buffer required length ${e} instead of ${t}`)}(s,o.length),i.writeBuffer(o),r.bytes+=o.length}}function f(e,t){return function r(n){const i=e(this);p(i);const s=n.readBuffer(i);return r.bytes=i,s.toString(t)}}function p(e){if("number"!=typeof e)throw new TypeError("Length of a buffer should be a number.")}e.exports=function(e,t="ascii"){if(!Buffer.isEncoding(t))throw new Error("Argument #2 should be an encoding name.");if("number"==typeof e)return{encode:a(e,t),decode:c(e,t),encodingLength:()=>e};if(n(e))return{encode:u(e,t),decode:h(e,t),encodingLength:d(e,t)};if(null===e)return{encode:s(t),decode:o(t),encodingLength:e=>Buffer.byteLength(e,t)+1};if("function"==typeof e)return{encode:l(e,t),decode:f(e,t),encodingLength:e=>Buffer.byteLength(e,t)};throw new TypeError("Unknown type of argument #1.")}},1402:(e,t,r)=>{"use strict";const{isType:n,isFunction:i,isUserType:s}=r(699),o=r(4359),{decodeCommon:a}=r(6861),{encodeCommon:c}=r(5141),{encodingLengthCommon:u}=r(7225),h=r(3898);e.exports=function(e,t){if(!n(t)&&!s(t))throw new TypeError("Argument #2 should be a valid type.");const r={encode:function n(s,a){const u=h.clone(this);n.bytes=0;const d=i(e)?Boolean(e(u)):Boolean(e);if(r[o.skip]=!d,!d)return void h.clean(u);c(s,a,t,u),n.bytes=u.bytes,h.clean(u)},decode:function n(s){const c=h.clone(this);n.bytes=0;const u=i(e)?Boolean(e(c)):Boolean(e);if(r[o.skip]=!u,!u)return void h.clean(c);const d=a(s,t,c);return n.bytes=c.bytes,h.clean(c),d},encodingLength:function(r){const n=h.clone(this);(i(e)?Boolean(e(n)):Boolean(e))&&u(r,t,n);return h.clean(n),n.bytes},[o.skip]:!1};return r}},6819:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var o;"object"==typeof e?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;try{o="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(4300).Buffer}catch(e){}function a(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function c(e,t,r){var n=a(e,r);return r-1>=t&&(n|=a(e,r-1)<<4),n}function u(e,t,r,n){for(var i=0,s=Math.min(e.length,r),o=t;o<s;o++){var a=e.charCodeAt(o)-48;i*=n,i+=a>=49?a-49+10:a>=17?a-17+10:a}return i}s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return e.cmp(t)<0?e:t},s.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},s.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},s.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var s,o,a=0;if("be"===r)for(i=e.length-1,s=0;i>=0;i-=3)o=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(i=0,s=0;i<e.length;i+=3)o=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this.strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,s=0,o=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=c(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;else for(n=(e.length-t)%2==0?t+1:t;n<e.length;n+=2)i=c(e,t,n)<<s,this.words[o]|=67108863&i,s>=18?(s-=18,o+=1,this.words[o]|=i>>>26):s+=8;this.strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var s=e.length-r,o=s%n,a=Math.min(s,s-o)+r,c=0,h=r;h<a;h+=n)c=u(e,h,h+n,t),this.imuln(i),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==o){var d=1;for(c=u(e,h,e.length,t),h=0;h<o;h++)d*=t;this.imuln(d),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}this.strip()},s.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],l=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function f(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],s=0|t.words[0],o=i*s,a=67108863&o,c=o/67108864|0;r.words[0]=a;for(var u=1;u<n;u++){for(var h=c>>>26,d=67108863&c,l=Math.min(u,t.length-1),f=Math.max(0,u-e.length+1);f<=l;f++){var p=u-f|0;h+=(o=(i=0|e.words[p])*(s=0|t.words[f])+d)/67108864|0,d=67108863&o}r.words[u]=0|d,c=0|h}return 0!==c?r.words[u]=0|c:r.length--,r.strip()}s.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,s=0,o=0;o<this.length;o++){var a=this.words[o],c=(16777215&(a<<i|s)).toString(16);r=0!==(s=a>>>24-i&16777215)||o!==this.length-1?h[6-c.length]+c+r:c+r,(i+=2)>=26&&(i-=26,o--)}for(0!==s&&(r=s.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var u=d[e],f=l[e];r="";var p=this.clone();for(p.negative=0;!p.isZero();){var y=p.modn(f).toString(e);r=(p=p.idivn(f)).isZero()?y+r:h[u-y.length]+y+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(e,t){return n(void 0!==o),this.toArrayLike(o,e,t)},s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,r){var i=this.byteLength(),s=r||Math.max(1,i);n(i<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0"),this.strip();var o,a,c="le"===t,u=new e(s),h=this.clone();if(c){for(a=0;!h.isZero();a++)o=h.andln(255),h.iushrn(8),u[a]=o;for(;a<s;a++)u[a]=0}else{for(a=0;a<s-i;a++)u[a]=0;for(a=0;!h.isZero();a++)o=h.andln(255),h.iushrn(8),u[s-a-1]=o}return u},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0==(8191&t)&&(r+=13,t>>>=13),0==(127&t)&&(r+=7,t>>>=7),0==(15&t)&&(r+=4,t>>>=4),0==(3&t)&&(r+=2,t>>>=2),0==(1&t)&&r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},s.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},s.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this.strip()},s.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this.strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this.strip()},s.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,s=0;s<n.length;s++)t=(0|r.words[s])+(0|n.words[s])+i,this.words[s]=67108863&t,i=t>>>26;for(;0!==i&&s<r.length;s++)t=(0|r.words[s])+i,this.words[s]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;s<r.length;s++)this.words[s]=r.words[s];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var s=0,o=0;o<n.length;o++)s=(t=(0|r.words[o])-(0|n.words[o])+s)>>26,this.words[o]=67108863&t;for(;0!==s&&o<r.length;o++)s=(t=(0|r.words[o])+s)>>26,this.words[o]=67108863&t;if(0===s&&o<r.length&&r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this.length=Math.max(this.length,o),r!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,r){var n,i,s,o=e.words,a=t.words,c=r.words,u=0,h=0|o[0],d=8191&h,l=h>>>13,f=0|o[1],p=8191&f,y=f>>>13,m=0|o[2],g=8191&m,v=m>>>13,b=0|o[3],E=8191&b,S=b>>>13,A=0|o[4],I=8191&A,w=A>>>13,T=0|o[5],C=8191&T,_=T>>>13,D=0|o[6],R=8191&D,N=D>>>13,O=0|o[7],U=8191&O,P=O>>>13,B=0|o[8],x=8191&B,M=B>>>13,L=0|o[9],k=8191&L,F=L>>>13,V=0|a[0],H=8191&V,j=V>>>13,K=0|a[1],q=8191&K,G=K>>>13,z=0|a[2],$=8191&z,W=z>>>13,Y=0|a[3],Q=8191&Y,J=Y>>>13,X=0|a[4],Z=8191&X,ee=X>>>13,te=0|a[5],re=8191&te,ne=te>>>13,ie=0|a[6],se=8191&ie,oe=ie>>>13,ae=0|a[7],ce=8191&ae,ue=ae>>>13,he=0|a[8],de=8191&he,le=he>>>13,fe=0|a[9],pe=8191&fe,ye=fe>>>13;r.negative=e.negative^t.negative,r.length=19;var me=(u+(n=Math.imul(d,H))|0)+((8191&(i=(i=Math.imul(d,j))+Math.imul(l,H)|0))<<13)|0;u=((s=Math.imul(l,j))+(i>>>13)|0)+(me>>>26)|0,me&=67108863,n=Math.imul(p,H),i=(i=Math.imul(p,j))+Math.imul(y,H)|0,s=Math.imul(y,j);var ge=(u+(n=n+Math.imul(d,q)|0)|0)+((8191&(i=(i=i+Math.imul(d,G)|0)+Math.imul(l,q)|0))<<13)|0;u=((s=s+Math.imul(l,G)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(g,H),i=(i=Math.imul(g,j))+Math.imul(v,H)|0,s=Math.imul(v,j),n=n+Math.imul(p,q)|0,i=(i=i+Math.imul(p,G)|0)+Math.imul(y,q)|0,s=s+Math.imul(y,G)|0;var ve=(u+(n=n+Math.imul(d,$)|0)|0)+((8191&(i=(i=i+Math.imul(d,W)|0)+Math.imul(l,$)|0))<<13)|0;u=((s=s+Math.imul(l,W)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(E,H),i=(i=Math.imul(E,j))+Math.imul(S,H)|0,s=Math.imul(S,j),n=n+Math.imul(g,q)|0,i=(i=i+Math.imul(g,G)|0)+Math.imul(v,q)|0,s=s+Math.imul(v,G)|0,n=n+Math.imul(p,$)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(y,$)|0,s=s+Math.imul(y,W)|0;var be=(u+(n=n+Math.imul(d,Q)|0)|0)+((8191&(i=(i=i+Math.imul(d,J)|0)+Math.imul(l,Q)|0))<<13)|0;u=((s=s+Math.imul(l,J)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(I,H),i=(i=Math.imul(I,j))+Math.imul(w,H)|0,s=Math.imul(w,j),n=n+Math.imul(E,q)|0,i=(i=i+Math.imul(E,G)|0)+Math.imul(S,q)|0,s=s+Math.imul(S,G)|0,n=n+Math.imul(g,$)|0,i=(i=i+Math.imul(g,W)|0)+Math.imul(v,$)|0,s=s+Math.imul(v,W)|0,n=n+Math.imul(p,Q)|0,i=(i=i+Math.imul(p,J)|0)+Math.imul(y,Q)|0,s=s+Math.imul(y,J)|0;var Ee=(u+(n=n+Math.imul(d,Z)|0)|0)+((8191&(i=(i=i+Math.imul(d,ee)|0)+Math.imul(l,Z)|0))<<13)|0;u=((s=s+Math.imul(l,ee)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(C,H),i=(i=Math.imul(C,j))+Math.imul(_,H)|0,s=Math.imul(_,j),n=n+Math.imul(I,q)|0,i=(i=i+Math.imul(I,G)|0)+Math.imul(w,q)|0,s=s+Math.imul(w,G)|0,n=n+Math.imul(E,$)|0,i=(i=i+Math.imul(E,W)|0)+Math.imul(S,$)|0,s=s+Math.imul(S,W)|0,n=n+Math.imul(g,Q)|0,i=(i=i+Math.imul(g,J)|0)+Math.imul(v,Q)|0,s=s+Math.imul(v,J)|0,n=n+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(y,Z)|0,s=s+Math.imul(y,ee)|0;var Se=(u+(n=n+Math.imul(d,re)|0)|0)+((8191&(i=(i=i+Math.imul(d,ne)|0)+Math.imul(l,re)|0))<<13)|0;u=((s=s+Math.imul(l,ne)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(R,H),i=(i=Math.imul(R,j))+Math.imul(N,H)|0,s=Math.imul(N,j),n=n+Math.imul(C,q)|0,i=(i=i+Math.imul(C,G)|0)+Math.imul(_,q)|0,s=s+Math.imul(_,G)|0,n=n+Math.imul(I,$)|0,i=(i=i+Math.imul(I,W)|0)+Math.imul(w,$)|0,s=s+Math.imul(w,W)|0,n=n+Math.imul(E,Q)|0,i=(i=i+Math.imul(E,J)|0)+Math.imul(S,Q)|0,s=s+Math.imul(S,J)|0,n=n+Math.imul(g,Z)|0,i=(i=i+Math.imul(g,ee)|0)+Math.imul(v,Z)|0,s=s+Math.imul(v,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(y,re)|0,s=s+Math.imul(y,ne)|0;var Ae=(u+(n=n+Math.imul(d,se)|0)|0)+((8191&(i=(i=i+Math.imul(d,oe)|0)+Math.imul(l,se)|0))<<13)|0;u=((s=s+Math.imul(l,oe)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(U,H),i=(i=Math.imul(U,j))+Math.imul(P,H)|0,s=Math.imul(P,j),n=n+Math.imul(R,q)|0,i=(i=i+Math.imul(R,G)|0)+Math.imul(N,q)|0,s=s+Math.imul(N,G)|0,n=n+Math.imul(C,$)|0,i=(i=i+Math.imul(C,W)|0)+Math.imul(_,$)|0,s=s+Math.imul(_,W)|0,n=n+Math.imul(I,Q)|0,i=(i=i+Math.imul(I,J)|0)+Math.imul(w,Q)|0,s=s+Math.imul(w,J)|0,n=n+Math.imul(E,Z)|0,i=(i=i+Math.imul(E,ee)|0)+Math.imul(S,Z)|0,s=s+Math.imul(S,ee)|0,n=n+Math.imul(g,re)|0,i=(i=i+Math.imul(g,ne)|0)+Math.imul(v,re)|0,s=s+Math.imul(v,ne)|0,n=n+Math.imul(p,se)|0,i=(i=i+Math.imul(p,oe)|0)+Math.imul(y,se)|0,s=s+Math.imul(y,oe)|0;var Ie=(u+(n=n+Math.imul(d,ce)|0)|0)+((8191&(i=(i=i+Math.imul(d,ue)|0)+Math.imul(l,ce)|0))<<13)|0;u=((s=s+Math.imul(l,ue)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(x,H),i=(i=Math.imul(x,j))+Math.imul(M,H)|0,s=Math.imul(M,j),n=n+Math.imul(U,q)|0,i=(i=i+Math.imul(U,G)|0)+Math.imul(P,q)|0,s=s+Math.imul(P,G)|0,n=n+Math.imul(R,$)|0,i=(i=i+Math.imul(R,W)|0)+Math.imul(N,$)|0,s=s+Math.imul(N,W)|0,n=n+Math.imul(C,Q)|0,i=(i=i+Math.imul(C,J)|0)+Math.imul(_,Q)|0,s=s+Math.imul(_,J)|0,n=n+Math.imul(I,Z)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(w,Z)|0,s=s+Math.imul(w,ee)|0,n=n+Math.imul(E,re)|0,i=(i=i+Math.imul(E,ne)|0)+Math.imul(S,re)|0,s=s+Math.imul(S,ne)|0,n=n+Math.imul(g,se)|0,i=(i=i+Math.imul(g,oe)|0)+Math.imul(v,se)|0,s=s+Math.imul(v,oe)|0,n=n+Math.imul(p,ce)|0,i=(i=i+Math.imul(p,ue)|0)+Math.imul(y,ce)|0,s=s+Math.imul(y,ue)|0;var we=(u+(n=n+Math.imul(d,de)|0)|0)+((8191&(i=(i=i+Math.imul(d,le)|0)+Math.imul(l,de)|0))<<13)|0;u=((s=s+Math.imul(l,le)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(k,H),i=(i=Math.imul(k,j))+Math.imul(F,H)|0,s=Math.imul(F,j),n=n+Math.imul(x,q)|0,i=(i=i+Math.imul(x,G)|0)+Math.imul(M,q)|0,s=s+Math.imul(M,G)|0,n=n+Math.imul(U,$)|0,i=(i=i+Math.imul(U,W)|0)+Math.imul(P,$)|0,s=s+Math.imul(P,W)|0,n=n+Math.imul(R,Q)|0,i=(i=i+Math.imul(R,J)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,J)|0,n=n+Math.imul(C,Z)|0,i=(i=i+Math.imul(C,ee)|0)+Math.imul(_,Z)|0,s=s+Math.imul(_,ee)|0,n=n+Math.imul(I,re)|0,i=(i=i+Math.imul(I,ne)|0)+Math.imul(w,re)|0,s=s+Math.imul(w,ne)|0,n=n+Math.imul(E,se)|0,i=(i=i+Math.imul(E,oe)|0)+Math.imul(S,se)|0,s=s+Math.imul(S,oe)|0,n=n+Math.imul(g,ce)|0,i=(i=i+Math.imul(g,ue)|0)+Math.imul(v,ce)|0,s=s+Math.imul(v,ue)|0,n=n+Math.imul(p,de)|0,i=(i=i+Math.imul(p,le)|0)+Math.imul(y,de)|0,s=s+Math.imul(y,le)|0;var Te=(u+(n=n+Math.imul(d,pe)|0)|0)+((8191&(i=(i=i+Math.imul(d,ye)|0)+Math.imul(l,pe)|0))<<13)|0;u=((s=s+Math.imul(l,ye)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(k,q),i=(i=Math.imul(k,G))+Math.imul(F,q)|0,s=Math.imul(F,G),n=n+Math.imul(x,$)|0,i=(i=i+Math.imul(x,W)|0)+Math.imul(M,$)|0,s=s+Math.imul(M,W)|0,n=n+Math.imul(U,Q)|0,i=(i=i+Math.imul(U,J)|0)+Math.imul(P,Q)|0,s=s+Math.imul(P,J)|0,n=n+Math.imul(R,Z)|0,i=(i=i+Math.imul(R,ee)|0)+Math.imul(N,Z)|0,s=s+Math.imul(N,ee)|0,n=n+Math.imul(C,re)|0,i=(i=i+Math.imul(C,ne)|0)+Math.imul(_,re)|0,s=s+Math.imul(_,ne)|0,n=n+Math.imul(I,se)|0,i=(i=i+Math.imul(I,oe)|0)+Math.imul(w,se)|0,s=s+Math.imul(w,oe)|0,n=n+Math.imul(E,ce)|0,i=(i=i+Math.imul(E,ue)|0)+Math.imul(S,ce)|0,s=s+Math.imul(S,ue)|0,n=n+Math.imul(g,de)|0,i=(i=i+Math.imul(g,le)|0)+Math.imul(v,de)|0,s=s+Math.imul(v,le)|0;var Ce=(u+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,ye)|0)+Math.imul(y,pe)|0))<<13)|0;u=((s=s+Math.imul(y,ye)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(k,$),i=(i=Math.imul(k,W))+Math.imul(F,$)|0,s=Math.imul(F,W),n=n+Math.imul(x,Q)|0,i=(i=i+Math.imul(x,J)|0)+Math.imul(M,Q)|0,s=s+Math.imul(M,J)|0,n=n+Math.imul(U,Z)|0,i=(i=i+Math.imul(U,ee)|0)+Math.imul(P,Z)|0,s=s+Math.imul(P,ee)|0,n=n+Math.imul(R,re)|0,i=(i=i+Math.imul(R,ne)|0)+Math.imul(N,re)|0,s=s+Math.imul(N,ne)|0,n=n+Math.imul(C,se)|0,i=(i=i+Math.imul(C,oe)|0)+Math.imul(_,se)|0,s=s+Math.imul(_,oe)|0,n=n+Math.imul(I,ce)|0,i=(i=i+Math.imul(I,ue)|0)+Math.imul(w,ce)|0,s=s+Math.imul(w,ue)|0,n=n+Math.imul(E,de)|0,i=(i=i+Math.imul(E,le)|0)+Math.imul(S,de)|0,s=s+Math.imul(S,le)|0;var _e=(u+(n=n+Math.imul(g,pe)|0)|0)+((8191&(i=(i=i+Math.imul(g,ye)|0)+Math.imul(v,pe)|0))<<13)|0;u=((s=s+Math.imul(v,ye)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(k,Q),i=(i=Math.imul(k,J))+Math.imul(F,Q)|0,s=Math.imul(F,J),n=n+Math.imul(x,Z)|0,i=(i=i+Math.imul(x,ee)|0)+Math.imul(M,Z)|0,s=s+Math.imul(M,ee)|0,n=n+Math.imul(U,re)|0,i=(i=i+Math.imul(U,ne)|0)+Math.imul(P,re)|0,s=s+Math.imul(P,ne)|0,n=n+Math.imul(R,se)|0,i=(i=i+Math.imul(R,oe)|0)+Math.imul(N,se)|0,s=s+Math.imul(N,oe)|0,n=n+Math.imul(C,ce)|0,i=(i=i+Math.imul(C,ue)|0)+Math.imul(_,ce)|0,s=s+Math.imul(_,ue)|0,n=n+Math.imul(I,de)|0,i=(i=i+Math.imul(I,le)|0)+Math.imul(w,de)|0,s=s+Math.imul(w,le)|0;var De=(u+(n=n+Math.imul(E,pe)|0)|0)+((8191&(i=(i=i+Math.imul(E,ye)|0)+Math.imul(S,pe)|0))<<13)|0;u=((s=s+Math.imul(S,ye)|0)+(i>>>13)|0)+(De>>>26)|0,De&=67108863,n=Math.imul(k,Z),i=(i=Math.imul(k,ee))+Math.imul(F,Z)|0,s=Math.imul(F,ee),n=n+Math.imul(x,re)|0,i=(i=i+Math.imul(x,ne)|0)+Math.imul(M,re)|0,s=s+Math.imul(M,ne)|0,n=n+Math.imul(U,se)|0,i=(i=i+Math.imul(U,oe)|0)+Math.imul(P,se)|0,s=s+Math.imul(P,oe)|0,n=n+Math.imul(R,ce)|0,i=(i=i+Math.imul(R,ue)|0)+Math.imul(N,ce)|0,s=s+Math.imul(N,ue)|0,n=n+Math.imul(C,de)|0,i=(i=i+Math.imul(C,le)|0)+Math.imul(_,de)|0,s=s+Math.imul(_,le)|0;var Re=(u+(n=n+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,ye)|0)+Math.imul(w,pe)|0))<<13)|0;u=((s=s+Math.imul(w,ye)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,n=Math.imul(k,re),i=(i=Math.imul(k,ne))+Math.imul(F,re)|0,s=Math.imul(F,ne),n=n+Math.imul(x,se)|0,i=(i=i+Math.imul(x,oe)|0)+Math.imul(M,se)|0,s=s+Math.imul(M,oe)|0,n=n+Math.imul(U,ce)|0,i=(i=i+Math.imul(U,ue)|0)+Math.imul(P,ce)|0,s=s+Math.imul(P,ue)|0,n=n+Math.imul(R,de)|0,i=(i=i+Math.imul(R,le)|0)+Math.imul(N,de)|0,s=s+Math.imul(N,le)|0;var Ne=(u+(n=n+Math.imul(C,pe)|0)|0)+((8191&(i=(i=i+Math.imul(C,ye)|0)+Math.imul(_,pe)|0))<<13)|0;u=((s=s+Math.imul(_,ye)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,n=Math.imul(k,se),i=(i=Math.imul(k,oe))+Math.imul(F,se)|0,s=Math.imul(F,oe),n=n+Math.imul(x,ce)|0,i=(i=i+Math.imul(x,ue)|0)+Math.imul(M,ce)|0,s=s+Math.imul(M,ue)|0,n=n+Math.imul(U,de)|0,i=(i=i+Math.imul(U,le)|0)+Math.imul(P,de)|0,s=s+Math.imul(P,le)|0;var Oe=(u+(n=n+Math.imul(R,pe)|0)|0)+((8191&(i=(i=i+Math.imul(R,ye)|0)+Math.imul(N,pe)|0))<<13)|0;u=((s=s+Math.imul(N,ye)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,n=Math.imul(k,ce),i=(i=Math.imul(k,ue))+Math.imul(F,ce)|0,s=Math.imul(F,ue),n=n+Math.imul(x,de)|0,i=(i=i+Math.imul(x,le)|0)+Math.imul(M,de)|0,s=s+Math.imul(M,le)|0;var Ue=(u+(n=n+Math.imul(U,pe)|0)|0)+((8191&(i=(i=i+Math.imul(U,ye)|0)+Math.imul(P,pe)|0))<<13)|0;u=((s=s+Math.imul(P,ye)|0)+(i>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,n=Math.imul(k,de),i=(i=Math.imul(k,le))+Math.imul(F,de)|0,s=Math.imul(F,le);var Pe=(u+(n=n+Math.imul(x,pe)|0)|0)+((8191&(i=(i=i+Math.imul(x,ye)|0)+Math.imul(M,pe)|0))<<13)|0;u=((s=s+Math.imul(M,ye)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863;var Be=(u+(n=Math.imul(k,pe))|0)+((8191&(i=(i=Math.imul(k,ye))+Math.imul(F,pe)|0))<<13)|0;return u=((s=Math.imul(F,ye))+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,c[0]=me,c[1]=ge,c[2]=ve,c[3]=be,c[4]=Ee,c[5]=Se,c[6]=Ae,c[7]=Ie,c[8]=we,c[9]=Te,c[10]=Ce,c[11]=_e,c[12]=De,c[13]=Re,c[14]=Ne,c[15]=Oe,c[16]=Ue,c[17]=Pe,c[18]=Be,0!==u&&(c[19]=u,r.length++),r};function y(e,t,r){return(new m).mulp(e,t,r)}function m(e,t){this.x=e,this.y=t}Math.imul||(p=f),s.prototype.mulTo=function(e,t){var r,n=this.length+e.length;return r=10===this.length&&10===e.length?p(this,e,t):n<63?f(this,e,t):n<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,s=0;s<r.length-1;s++){var o=i;i=0;for(var a=67108863&n,c=Math.min(s,t.length-1),u=Math.max(0,s-e.length+1);u<=c;u++){var h=s-u,d=(0|e.words[h])*(0|t.words[u]),l=67108863&d;a=67108863&(l=l+a|0),i+=(o=(o=o+(d/67108864|0)|0)+(l>>>26)|0)>>>26,o&=67108863}r.words[s]=a,n=o,o=i}return 0!==n?r.words[s]=n:r.length--,r.strip()}(this,e,t):y(this,e,t),r},m.prototype.makeRBT=function(e){for(var t=new Array(e),r=s.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},m.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},m.prototype.permute=function(e,t,r,n,i,s){for(var o=0;o<s;o++)n[o]=t[e[o]],i[o]=r[e[o]]},m.prototype.transform=function(e,t,r,n,i,s){this.permute(s,e,t,r,n,i);for(var o=1;o<i;o<<=1)for(var a=o<<1,c=Math.cos(2*Math.PI/a),u=Math.sin(2*Math.PI/a),h=0;h<i;h+=a)for(var d=c,l=u,f=0;f<o;f++){var p=r[h+f],y=n[h+f],m=r[h+f+o],g=n[h+f+o],v=d*m-l*g;g=d*g+l*m,m=v,r[h+f]=p+m,n[h+f]=y+g,r[h+f+o]=p-m,n[h+f+o]=y-g,f!==a&&(v=c*d-u*l,l=c*l+u*d,d=v)}},m.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},m.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},m.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},m.prototype.convert13b=function(e,t,r,i){for(var s=0,o=0;o<t;o++)s+=0|e[o],r[2*o]=8191&s,s>>>=13,r[2*o+1]=8191&s,s>>>=13;for(o=2*t;o<i;++o)r[o]=0;n(0===s),n(0==(-8192&s))},m.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},m.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),c=new Array(n),u=new Array(n),h=new Array(n),d=new Array(n),l=r.words;l.length=n,this.convert13b(e.words,e.length,o,n),this.convert13b(t.words,t.length,u,n),this.transform(o,s,a,c,n,i),this.transform(u,s,h,d,n,i);for(var f=0;f<n;f++){var p=a[f]*h[f]-c[f]*d[f];c[f]=a[f]*d[f]+c[f]*h[f],a[f]=p}return this.conjugate(a,c,n),this.transform(a,c,l,s,n,i),this.conjugate(l,s,n),this.normalize13b(l,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=new Array(this.length+e.length),y(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){n("number"==typeof e),n(e<67108864);for(var t=0,r=0;r<this.length;r++){var i=(0|this.words[r])*e,s=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=s>>>26,this.words[r]=67108863&s}return 0!==t&&(this.words[r]=t,this.length++),this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=(e.words[n]&1<<i)>>>i}return t}(e);if(0===t.length)return new s(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},s.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,s=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&s,c=(0|this.words[t])-a<<r;this.words[t]=c|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},s.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var s=e%26,o=Math.min((e-s)/26,this.length),a=67108863^67108863>>>s<<s,c=r;if(i-=o,i=Math.max(0,i),c){for(var u=0;u<o;u++)c.words[u]=this.words[u];c.length=o}if(0===o);else if(this.length>o)for(this.length-=o,u=0;u<this.length;u++)this.words[u]=this.words[u+o];else this.words[0]=0,this.length=1;var h=0;for(u=this.length-1;u>=0&&(0!==h||u>=i);u--){var d=0|this.words[u];this.words[u]=h<<26-s|d>>>s,h=d&a}return c&&0!==h&&(c.words[c.length++]=h),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},s.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,r){var i,s,o=e.length+r;this._expand(o);var a=0;for(i=0;i<e.length;i++){s=(0|this.words[i+r])+a;var c=(0|e.words[i])*t;a=((s-=67108863&c)>>26)-(c/67108864|0),this.words[i+r]=67108863&s}for(;i<this.length-r;i++)a=(s=(0|this.words[i+r])+a)>>26,this.words[i+r]=67108863&s;if(0===a)return this.strip();for(n(-1===a),a=0,i=0;i<this.length;i++)a=(s=-(0|this.words[i])+a)>>26,this.words[i]=67108863&s;return this.negative=1,this.strip()},s.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,o=0|i.words[i.length-1];0!==(r=26-this._countBits(o))&&(i=i.ushln(r),n.iushln(r),o=0|i.words[i.length-1]);var a,c=n.length-i.length;if("mod"!==t){(a=new s(null)).length=c+1,a.words=new Array(a.length);for(var u=0;u<a.length;u++)a.words[u]=0}var h=n.clone()._ishlnsubmul(i,1,c);0===h.negative&&(n=h,a&&(a.words[c]=1));for(var d=c-1;d>=0;d--){var l=67108864*(0|n.words[i.length+d])+(0|n.words[i.length+d-1]);for(l=Math.min(l/o|0,67108863),n._ishlnsubmul(i,l,d);0!==n.negative;)l--,n.negative=0,n._ishlnsubmul(i,1,d),n.isZero()||(n.negative^=1);a&&(a.words[d]=l)}return a&&a.strip(),n.strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:a||null,mod:n}},s.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(i=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:i,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(i=a.div.neg()),{div:i,mod:a.mod}):0!=(this.negative&e.negative)?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||this.cmp(e)<0?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modn(e.words[0]))}:this._wordDiv(e,t);var i,o,a},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),s=r.cmp(n);return s<0||1===i&&0===s?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modn=function(e){n(e<=67108863);for(var t=(1<<26)%e,r=0,i=this.length-1;i>=0;i--)r=(t*r+(0|this.words[i]))%e;return r},s.prototype.idivn=function(e){n(e<=67108863);for(var t=0,r=this.length-1;r>=0;r--){var i=(0|this.words[r])+67108864*t;this.words[r]=i/e|0,t=i%e}return this.strip()},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new s(1),o=new s(0),a=new s(0),c=new s(1),u=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++u;for(var h=r.clone(),d=t.clone();!t.isZero();){for(var l=0,f=1;0==(t.words[0]&f)&&l<26;++l,f<<=1);if(l>0)for(t.iushrn(l);l-- >0;)(i.isOdd()||o.isOdd())&&(i.iadd(h),o.isub(d)),i.iushrn(1),o.iushrn(1);for(var p=0,y=1;0==(r.words[0]&y)&&p<26;++p,y<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(h),c.isub(d)),a.iushrn(1),c.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(a),o.isub(c)):(r.isub(t),a.isub(i),c.isub(o))}return{a,b:c,gcd:r.iushln(u)}},s.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,o=new s(1),a=new s(0),c=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var u=0,h=1;0==(t.words[0]&h)&&u<26;++u,h<<=1);if(u>0)for(t.iushrn(u);u-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);for(var d=0,l=1;0==(r.words[0]&l)&&d<26;++d,l<<=1);if(d>0)for(r.iushrn(d);d-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(a)):(r.isub(t),a.isub(o))}return(i=0===t.cmpn(1)?o:a).cmpn(0)<0&&i.iadd(e),i},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var s=t;t=r,r=s}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var s=i,o=r;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return-1===this.cmpn(e)},s.prototype.lt=function(e){return-1===this.cmp(e)},s.prototype.lten=function(e){return this.cmpn(e)<=0},s.prototype.lte=function(e){return this.cmp(e)<=0},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new I(e)},s.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function v(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function b(){v.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function E(){v.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function S(){v.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){v.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function w(e){I.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}v.prototype._tmp=function(){var e=new s(null);return e.words=new Array(Math.ceil(this.n/13)),e},v.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},v.prototype.split=function(e,t){e.iushrn(this.n,0,t)},v.prototype.imulK=function(e){return e.imul(this.k)},i(b,v),b.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var s=e.words[9];for(t.words[t.length++]=s&r,i=10;i<e.length;i++){var o=0|e.words[i];e.words[i-10]=(o&r)<<4|s>>>22,s=o}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},b.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(E,v),i(S,v),i(A,v),A.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new b;else if("p224"===e)t=new E;else if("p192"===e)t=new S;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new A}return g[e]=t,t},I.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},I.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},I.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},I.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},I.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},I.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},I.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},I.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},I.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},I.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},I.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},I.prototype.isqr=function(e){return this.imul(e,e.clone())},I.prototype.sqr=function(e){return this.mul(e,e)},I.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new s(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),o=0;!i.isZero()&&0===i.andln(1);)o++,i.iushrn(1);n(!i.isZero());var a=new s(1).toRed(this),c=a.redNeg(),u=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new s(2*h*h).toRed(this);0!==this.pow(h,u).cmp(c);)h.redIAdd(c);for(var d=this.pow(h,i),l=this.pow(e,i.addn(1).iushrn(1)),f=this.pow(e,i),p=o;0!==f.cmp(a);){for(var y=f,m=0;0!==y.cmp(a);m++)y=y.redSqr();n(m<p);var g=this.pow(d,new s(1).iushln(p-m-1));l=l.redMul(g),d=g.redSqr(),f=f.redMul(d),p=m}return l},I.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},I.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],o=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),n=t.length-1;n>=0;n--){for(var u=t.words[n],h=c-1;h>=0;h--){var d=u>>h&1;i!==r[0]&&(i=this.sqr(i)),0!==d||0!==o?(o<<=1,o|=d,(4===++a||0===n&&0===h)&&(i=this.mul(i,r[o]),a=0,o=0)):a=0}c=26}return i},I.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},I.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new w(e)},i(w,I),w.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},w.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},w.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),s=i;return i.cmp(this.m)>=0?s=i.isub(this.m):i.cmpn(0)<0&&(s=i.iadd(this.m)),s._forceRed(this)},w.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},w.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},6723:(e,t,r)=>{var n;function i(e){this.rand=e}if(e.exports=function(e){return n||(n=new i(null)),n.generate(e)},e.exports.Rand=i,i.prototype.generate=function(e){return this._rand(e)},i.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(i.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var s=r(6113);if("function"!=typeof s.randomBytes)throw new Error("Not supported");i.prototype._rand=function(e){return s.randomBytes(e)}}catch(e){}},5177:(e,t,r)=>{var n=r(4300).Buffer,i=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];function s(e){if(n.isBuffer(e))return e;var t="function"==typeof n.alloc&&"function"==typeof n.from;if("number"==typeof e)return t?n.alloc(e):new n(e);if("string"==typeof e)return t?n.from(e):new n(e);throw new Error("input must be buffer, number, or string, received "+typeof e)}function o(e){var t=s(4);return t.writeInt32BE(e,0),t}function a(e,t){e=s(e),n.isBuffer(t)&&(t=t.readUInt32BE(0));for(var r=-1^~~t,o=0;o<e.length;o++)r=i[255&(r^e[o])]^r>>>8;return-1^r}function c(){return o(a.apply(null,arguments))}"undefined"!=typeof Int32Array&&(i=new Int32Array(i)),c.signed=function(){return a.apply(null,arguments)},c.unsigned=function(){return a.apply(null,arguments)>>>0},e.exports=c},587:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(2715)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},2715:(e,t,r)=>{e.exports=function(e){function t(e){let r,i,s,o=null;function a(...e){if(!a.enabled)return;const n=a,i=Number(new Date),s=i-(r||i);n.diff=s,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";o++;const s=t.formatters[i];if("function"==typeof s){const t=e[o];r=s.call(n,t),e.splice(o,1),o--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,s=t.enabled(e)),s),set:e=>{o=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(4476),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},1905:(e,t,r)=>{"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?e.exports=r(587):e.exports=r(7522)},7522:(e,t,r)=>{const n=r(6224),i=r(3837);t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(i.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),s=`  ${i};1m${n} [0m`;r[0]=s+r[0].split("\n").join("\n"+s),r.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):n.isatty(process.stderr.fd)},t.destroy=i.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=r(5455);e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=r(2715)(t);const{formatters:s}=e.exports;s.o=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},s.O=function(e){return this.inspectOpts.colors=this.useColors,i.inspect(e,this.inspectOpts)}},182:(e,t,r)=>{"use strict";var n=t;n.version=r(9813).i8,n.utils=r(9594),n.rand=r(6723),n.curve=r(2346),n.curves=r(5394),n.ec=r(6637),n.eddsa=r(506)},3847:(e,t,r)=>{"use strict";var n=r(6819),i=r(9594),s=i.getNAF,o=i.getJSF,a=i.assert;function c(e,t){this.type=e,this.p=new n(t.p,16),this.red=t.prime?n.red(t.prime):n.mont(this.p),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.n=t.n&&new n(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function u(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=c,c.prototype.point=function(){throw new Error("Not implemented")},c.prototype.validate=function(){throw new Error("Not implemented")},c.prototype._fixedNafMul=function(e,t){a(e.precomputed);var r=e._getDoubles(),n=s(t,1,this._bitLength),i=(1<<r.step+1)-(r.step%2==0?2:1);i/=3;var o,c,u=[];for(o=0;o<n.length;o+=r.step){c=0;for(var h=o+r.step-1;h>=o;h--)c=(c<<1)+n[h];u.push(c)}for(var d=this.jpoint(null,null,null),l=this.jpoint(null,null,null),f=i;f>0;f--){for(o=0;o<u.length;o++)(c=u[o])===f?l=l.mixedAdd(r.points[o]):c===-f&&(l=l.mixedAdd(r.points[o].neg()));d=d.add(l)}return d.toP()},c.prototype._wnafMul=function(e,t){var r=4,n=e._getNAFPoints(r);r=n.wnd;for(var i=n.points,o=s(t,r,this._bitLength),c=this.jpoint(null,null,null),u=o.length-1;u>=0;u--){for(var h=0;u>=0&&0===o[u];u--)h++;if(u>=0&&h++,c=c.dblp(h),u<0)break;var d=o[u];a(0!==d),c="affine"===e.type?d>0?c.mixedAdd(i[d-1>>1]):c.mixedAdd(i[-d-1>>1].neg()):d>0?c.add(i[d-1>>1]):c.add(i[-d-1>>1].neg())}return"affine"===e.type?c.toP():c},c.prototype._wnafMulAdd=function(e,t,r,n,i){var a,c,u,h=this._wnafT1,d=this._wnafT2,l=this._wnafT3,f=0;for(a=0;a<n;a++){var p=(u=t[a])._getNAFPoints(e);h[a]=p.wnd,d[a]=p.points}for(a=n-1;a>=1;a-=2){var y=a-1,m=a;if(1===h[y]&&1===h[m]){var g=[t[y],null,null,t[m]];0===t[y].y.cmp(t[m].y)?(g[1]=t[y].add(t[m]),g[2]=t[y].toJ().mixedAdd(t[m].neg())):0===t[y].y.cmp(t[m].y.redNeg())?(g[1]=t[y].toJ().mixedAdd(t[m]),g[2]=t[y].add(t[m].neg())):(g[1]=t[y].toJ().mixedAdd(t[m]),g[2]=t[y].toJ().mixedAdd(t[m].neg()));var v=[-3,-1,-5,-7,0,7,5,1,3],b=o(r[y],r[m]);for(f=Math.max(b[0].length,f),l[y]=new Array(f),l[m]=new Array(f),c=0;c<f;c++){var E=0|b[0][c],S=0|b[1][c];l[y][c]=v[3*(E+1)+(S+1)],l[m][c]=0,d[y]=g}}else l[y]=s(r[y],h[y],this._bitLength),l[m]=s(r[m],h[m],this._bitLength),f=Math.max(l[y].length,f),f=Math.max(l[m].length,f)}var A=this.jpoint(null,null,null),I=this._wnafT4;for(a=f;a>=0;a--){for(var w=0;a>=0;){var T=!0;for(c=0;c<n;c++)I[c]=0|l[c][a],0!==I[c]&&(T=!1);if(!T)break;w++,a--}if(a>=0&&w++,A=A.dblp(w),a<0)break;for(c=0;c<n;c++){var C=I[c];0!==C&&(C>0?u=d[c][C-1>>1]:C<0&&(u=d[c][-C-1>>1].neg()),A="affine"===u.type?A.mixedAdd(u):A.add(u))}}for(a=0;a<n;a++)d[a]=null;return i?A:A.toP()},c.BasePoint=u,u.prototype.eq=function(){throw new Error("Not implemented")},u.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(e,t){e=i.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?a(e[e.length-1]%2==0):7===e[0]&&a(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw new Error("Unknown point format")},u.prototype.encodeCompressed=function(e){return this.encode(e,!0)},u.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},u.prototype.encode=function(e,t){return i.encode(this._encode(t),e)},u.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},u.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},u.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],n=this,i=0;i<t;i+=e){for(var s=0;s<e;s++)n=n.dbl();r.push(n)}return{step:e,points:r}},u.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,n=1===r?null:this.dbl(),i=1;i<r;i++)t[i]=t[i-1].add(n);return{wnd:e,points:t}},u.prototype._getBeta=function(){return null},u.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}},3709:(e,t,r)=>{"use strict";var n=r(9594),i=r(6819),s=r(8647),o=r(3847),a=n.assert;function c(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,o.call(this,"edwards",e),this.a=new i(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function u(e,t,r,n,s){o.BasePoint.call(this,e,"projective"),null===t&&null===r&&null===n?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(t,16),this.y=new i(r,16),this.z=n?new i(n,16):this.curve.one,this.t=s&&new i(s,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}s(c,o),e.exports=c,c.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},c.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},c.prototype.jpoint=function(e,t,r,n){return this.point(e,t,r,n)},c.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=this.c2.redSub(this.a.redMul(r)),s=this.one.redSub(this.c2.redMul(this.d).redMul(r)),o=n.redMul(s.redInvm()),a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");var c=a.fromRed().isOdd();return(t&&!c||!t&&c)&&(a=a.redNeg()),this.point(e,a)},c.prototype.pointFromY=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),n=r.redSub(this.c2),s=r.redMul(this.d).redMul(this.c2).redSub(this.a),o=n.redMul(s.redInvm());if(0===o.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw new Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},c.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),n=t.redMul(this.a).redAdd(r),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return 0===n.cmp(i)},s(u,o.BasePoint),c.prototype.pointFromJSON=function(e){return u.fromJSON(this,e)},c.prototype.point=function(e,t,r,n){return new u(this,e,t,r,n)},u.fromJSON=function(e,t){return new u(e,t[0],t[1],t[2])},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},u.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var n=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),s=n.redAdd(t),o=s.redSub(r),a=n.redSub(t),c=i.redMul(o),u=s.redMul(a),h=i.redMul(a),d=o.redMul(s);return this.curve.point(c,u,d,h)},u.prototype._projDbl=function(){var e,t,r,n,i,s,o=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),c=this.y.redSqr();if(this.curve.twisted){var u=(n=this.curve._mulA(a)).redAdd(c);this.zOne?(e=o.redSub(a).redSub(c).redMul(u.redSub(this.curve.two)),t=u.redMul(n.redSub(c)),r=u.redSqr().redSub(u).redSub(u)):(i=this.z.redSqr(),s=u.redSub(i).redISub(i),e=o.redSub(a).redISub(c).redMul(s),t=u.redMul(n.redSub(c)),r=u.redMul(s))}else n=a.redAdd(c),i=this.curve._mulC(this.z).redSqr(),s=n.redSub(i).redSub(i),e=this.curve._mulC(o.redISub(n)).redMul(s),t=this.curve._mulC(n).redMul(a.redISub(c)),r=n.redMul(s);return this.curve.point(e,t,r)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},u.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),s=r.redSub(t),o=i.redSub(n),a=i.redAdd(n),c=r.redAdd(t),u=s.redMul(o),h=a.redMul(c),d=s.redMul(c),l=o.redMul(a);return this.curve.point(u,h,l,d)},u.prototype._projAdd=function(e){var t,r,n=this.z.redMul(e.z),i=n.redSqr(),s=this.x.redMul(e.x),o=this.y.redMul(e.y),a=this.curve.d.redMul(s).redMul(o),c=i.redSub(a),u=i.redAdd(a),h=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(s).redISub(o),d=n.redMul(c).redMul(h);return this.curve.twisted?(t=n.redMul(u).redMul(o.redSub(this.curve._mulA(s))),r=c.redMul(u)):(t=n.redMul(u).redMul(o.redSub(s)),r=this.curve._mulC(c).redMul(u)),this.curve.point(d,t,r)},u.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},u.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},u.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},u.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},u.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},u.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()},u.prototype.getY=function(){return this.normalize(),this.y.fromRed()},u.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},u.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var r=e.clone(),n=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(n),0===this.x.cmp(t))return!0}},u.prototype.toP=u.prototype.normalize,u.prototype.mixedAdd=u.prototype.add},2346:(e,t,r)=>{"use strict";var n=t;n.base=r(3847),n.short=r(6597),n.mont=r(6632),n.edwards=r(3709)},6632:(e,t,r)=>{"use strict";var n=r(6819),i=r(8647),s=r(3847),o=r(9594);function a(e){s.call(this,"mont",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.i4=new n(4).toRed(this.red).redInvm(),this.two=new n(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(e,t,r){s.BasePoint.call(this,e,"projective"),null===t&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new n(t,16),this.z=new n(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(a,s),e.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),n=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return 0===n.redSqrt().redSqr().cmp(n)},i(c,s.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(o.toArray(e,t),1)},a.prototype.point=function(e,t){return new c(this,e,t)},a.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(e,t){return new c(e,t[0],t[1]||e.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},c.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),n=e.redMul(t),i=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(n,i)},c.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),n=this.x.redSub(this.z),i=e.x.redAdd(e.z),s=e.x.redSub(e.z).redMul(r),o=i.redMul(n),a=t.z.redMul(s.redAdd(o).redSqr()),c=t.x.redMul(s.redISub(o).redSqr());return this.curve.point(a,c)},c.prototype.mul=function(e){for(var t=e.clone(),r=this,n=this.curve.point(null,null),i=[];0!==t.cmpn(0);t.iushrn(1))i.push(t.andln(1));for(var s=i.length-1;s>=0;s--)0===i[s]?(r=r.diffAdd(n,this),n=n.dbl()):(n=r.diffAdd(n,this),r=r.dbl());return n},c.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},c.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},6597:(e,t,r)=>{"use strict";var n=r(9594),i=r(6819),s=r(8647),o=r(3847),a=n.assert;function c(e){o.call(this,"short",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function u(e,t,r,n){o.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(t,16),this.y=new i(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(e,t,r,n){o.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(t,16),this.y=new i(r,16),this.z=new i(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}s(c,o),e.exports=c,c.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,r;if(e.beta)t=new i(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=(t=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(e.lambda)r=new i(e.lambda,16);else{var s=this._getEndoRoots(this.n);0===this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))?r=s[0]:(r=s[1],a(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:r,basis:e.basis?e.basis.map((function(e){return{a:new i(e.a,16),b:new i(e.b,16)}})):this._getEndoBasis(r)}}},c.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:i.mont(e),r=new i(2).toRed(t).redInvm(),n=r.redNeg(),s=new i(3).toRed(t).redNeg().redSqrt().redMul(r);return[n.redAdd(s).fromRed(),n.redSub(s).fromRed()]},c.prototype._getEndoBasis=function(e){for(var t,r,n,s,o,a,c,u,h,d=this.n.ushrn(Math.floor(this.n.bitLength()/2)),l=e,f=this.n.clone(),p=new i(1),y=new i(0),m=new i(0),g=new i(1),v=0;0!==l.cmpn(0);){var b=f.div(l);u=f.sub(b.mul(l)),h=m.sub(b.mul(p));var E=g.sub(b.mul(y));if(!n&&u.cmp(d)<0)t=c.neg(),r=p,n=u.neg(),s=h;else if(n&&2==++v)break;c=u,f=l,l=u,m=p,p=h,g=y,y=E}o=u.neg(),a=h;var S=n.sqr().add(s.sqr());return o.sqr().add(a.sqr()).cmp(S)>=0&&(o=t,a=r),n.negative&&(n=n.neg(),s=s.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:n,b:s},{a:o,b:a}]},c.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],n=t[1],i=n.b.mul(e).divRound(this.n),s=r.b.neg().mul(e).divRound(this.n),o=i.mul(r.a),a=s.mul(n.a),c=i.mul(r.b),u=s.mul(n.b);return{k1:e.sub(o).sub(a),k2:c.add(u).neg()}},c.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=r.redSqrt();if(0!==n.redSqr().redSub(r).cmp(this.zero))throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(e,n)},c.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,n=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return 0===r.redSqr().redISub(i).cmpn(0)},c.prototype._endoWnafMulAdd=function(e,t,r){for(var n=this._endoWnafT1,i=this._endoWnafT2,s=0;s<e.length;s++){var o=this._endoSplit(t[s]),a=e[s],c=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),c=c.neg(!0)),n[2*s]=a,n[2*s+1]=c,i[2*s]=o.k1,i[2*s+1]=o.k2}for(var u=this._wnafMulAdd(1,n,i,2*s,r),h=0;h<2*s;h++)n[h]=null,i[h]=null;return u},s(u,o.BasePoint),c.prototype.point=function(e,t,r){return new u(this,e,t,r)},c.prototype.pointFromJSON=function(e,t){return u.fromJSON(this,e,t)},u.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,n=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t}},u.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},u.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var n=e.point(t[0],t[1],r);if(!t[2])return n;function i(t){return e.point(t[0],t[1],r)}var s=t[2];return n.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[n].concat(s.doubles.points.map(i))},naf:s.naf&&{wnd:s.naf.wnd,points:[n].concat(s.naf.points.map(i))}},n},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.inf},u.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),n=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,n)},u.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),n=e.redInvm(),i=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(n),s=i.redSqr().redISub(this.x.redAdd(this.x)),o=i.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,o)},u.prototype.getX=function(){return this.x.fromRed()},u.prototype.getY=function(){return this.y.fromRed()},u.prototype.mul=function(e){return e=new i(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},u.prototype.mulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i):this.curve._wnafMulAdd(1,n,i,2)},u.prototype.jmulAdd=function(e,t,r){var n=[this,t],i=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(n,i,!0):this.curve._wnafMulAdd(1,n,i,2,!0)},u.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},u.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,n=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(n)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(n)}}}return t},u.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},s(h,o.BasePoint),c.prototype.jpoint=function(e,t,r){return new h(this,e,t,r)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),n=this.y.redMul(t).redMul(e);return this.curve.point(r,n)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),n=this.x.redMul(t),i=e.x.redMul(r),s=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(r.redMul(this.z)),a=n.redSub(i),c=s.redSub(o);if(0===a.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),h=u.redMul(a),d=n.redMul(u),l=c.redSqr().redIAdd(h).redISub(d).redISub(d),f=c.redMul(d.redISub(l)).redISub(s.redMul(h)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(l,f,p)},h.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,n=e.x.redMul(t),i=this.y,s=e.y.redMul(t).redMul(this.z),o=r.redSub(n),a=i.redSub(s);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=o.redSqr(),u=c.redMul(o),h=r.redMul(c),d=a.redSqr().redIAdd(u).redISub(h).redISub(h),l=a.redMul(h.redISub(d)).redISub(i.redMul(u)),f=this.z.redMul(o);return this.curve.jpoint(d,l,f)},h.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var r=this;for(t=0;t<e;t++)r=r.dbl();return r}var n=this.curve.a,i=this.curve.tinv,s=this.x,o=this.y,a=this.z,c=a.redSqr().redSqr(),u=o.redAdd(o);for(t=0;t<e;t++){var h=s.redSqr(),d=u.redSqr(),l=d.redSqr(),f=h.redAdd(h).redIAdd(h).redIAdd(n.redMul(c)),p=s.redMul(d),y=f.redSqr().redISub(p.redAdd(p)),m=p.redISub(y),g=f.redMul(m);g=g.redIAdd(g).redISub(l);var v=u.redMul(a);t+1<e&&(c=c.redMul(l)),s=y,a=v,u=g}return this.curve.jpoint(s,u.redMul(i),a)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(n).redISub(s);o=o.redIAdd(o);var a=n.redAdd(n).redIAdd(n),c=a.redSqr().redISub(o).redISub(o),u=s.redIAdd(s);u=(u=u.redIAdd(u)).redIAdd(u),e=c,t=a.redMul(o.redISub(c)).redISub(u),r=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),d=this.y.redSqr(),l=d.redSqr(),f=this.x.redAdd(d).redSqr().redISub(h).redISub(l);f=f.redIAdd(f);var p=h.redAdd(h).redIAdd(h),y=p.redSqr(),m=l.redIAdd(l);m=(m=m.redIAdd(m)).redIAdd(m),e=y.redISub(f).redISub(f),t=p.redMul(f.redISub(e)).redISub(m),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},h.prototype._threeDbl=function(){var e,t,r;if(this.zOne){var n=this.x.redSqr(),i=this.y.redSqr(),s=i.redSqr(),o=this.x.redAdd(i).redSqr().redISub(n).redISub(s);o=o.redIAdd(o);var a=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),c=a.redSqr().redISub(o).redISub(o);e=c;var u=s.redIAdd(s);u=(u=u.redIAdd(u)).redIAdd(u),t=a.redMul(o.redISub(c)).redISub(u),r=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),d=this.y.redSqr(),l=this.x.redMul(d),f=this.x.redSub(h).redMul(this.x.redAdd(h));f=f.redAdd(f).redIAdd(f);var p=l.redIAdd(l),y=(p=p.redIAdd(p)).redAdd(p);e=f.redSqr().redISub(y),r=this.y.redAdd(this.z).redSqr().redISub(d).redISub(h);var m=d.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),t=f.redMul(p.redISub(e)).redISub(m)}return this.curve.jpoint(e,t,r)},h.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,n=this.z,i=n.redSqr().redSqr(),s=t.redSqr(),o=r.redSqr(),a=s.redAdd(s).redIAdd(s).redIAdd(e.redMul(i)),c=t.redAdd(t),u=(c=c.redIAdd(c)).redMul(o),h=a.redSqr().redISub(u.redAdd(u)),d=u.redISub(h),l=o.redSqr();l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var f=a.redMul(d).redISub(l),p=r.redAdd(r).redMul(n);return this.curve.jpoint(h,f,p)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),n=t.redSqr(),i=e.redAdd(e).redIAdd(e),s=i.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(n),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(s)).redSqr(),c=n.redIAdd(n);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var u=i.redIAdd(o).redSqr().redISub(s).redISub(a).redISub(c),h=t.redMul(u);h=(h=h.redIAdd(h)).redIAdd(h);var d=this.x.redMul(a).redISub(h);d=(d=d.redIAdd(d)).redIAdd(d);var l=this.y.redMul(u.redMul(c.redISub(u)).redISub(o.redMul(a)));l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var f=this.z.redAdd(o).redSqr().redISub(r).redISub(a);return this.curve.jpoint(d,l,f)},h.prototype.mul=function(e,t){return e=new i(e,t),this.curve._wnafMul(this,e)},h.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var n=t.redMul(this.z),i=r.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(n)).cmpn(0)},h.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var n=e.clone(),i=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),0===this.x.cmp(r))return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},5394:(e,t,r)=>{"use strict";var n,i=t,s=r(6107),o=r(2346),a=r(9594).assert;function c(e){"short"===e.type?this.curve=new o.short(e):"edwards"===e.type?this.curve=new o.edwards(e):this.curve=new o.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function u(e,t){Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){var r=new c(t);return Object.defineProperty(i,e,{configurable:!0,enumerable:!0,value:r}),r}})}i.PresetCurve=c,u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{n=r(4895)}catch(e){n=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",n]})},6637:(e,t,r)=>{"use strict";var n=r(6819),i=r(3234),s=r(9594),o=r(5394),a=r(6723),c=s.assert,u=r(4025),h=r(4907);function d(e){if(!(this instanceof d))return new d(e);"string"==typeof e&&(c(Object.prototype.hasOwnProperty.call(o,e),"Unknown curve "+e),e=o[e]),e instanceof o.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=d,d.prototype.keyPair=function(e){return new u(this,e)},d.prototype.keyFromPrivate=function(e,t){return u.fromPrivate(this,e,t)},d.prototype.keyFromPublic=function(e,t){return u.fromPublic(this,e,t)},d.prototype.genKeyPair=function(e){e||(e={});for(var t=new i({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),s=this.n.sub(new n(2));;){var o=new n(t.generate(r));if(!(o.cmp(s)>0))return o.iaddn(1),this.keyFromPrivate(o)}},d.prototype._truncateToN=function(e,t){var r=8*e.byteLength()-this.n.bitLength();return r>0&&(e=e.ushrn(r)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},d.prototype.sign=function(e,t,r,s){"object"==typeof r&&(s=r,r=null),s||(s={}),t=this.keyFromPrivate(t,r),e=this._truncateToN(new n(e,16));for(var o=this.n.byteLength(),a=t.getPrivate().toArray("be",o),c=e.toArray("be",o),u=new i({hash:this.hash,entropy:a,nonce:c,pers:s.pers,persEnc:s.persEnc||"utf8"}),d=this.n.sub(new n(1)),l=0;;l++){var f=s.k?s.k(l):new n(u.generate(this.n.byteLength()));if(!((f=this._truncateToN(f,!0)).cmpn(1)<=0||f.cmp(d)>=0)){var p=this.g.mul(f);if(!p.isInfinity()){var y=p.getX(),m=y.umod(this.n);if(0!==m.cmpn(0)){var g=f.invm(this.n).mul(m.mul(t.getPrivate()).iadd(e));if(0!==(g=g.umod(this.n)).cmpn(0)){var v=(p.getY().isOdd()?1:0)|(0!==y.cmp(m)?2:0);return s.canonical&&g.cmp(this.nh)>0&&(g=this.n.sub(g),v^=1),new h({r:m,s:g,recoveryParam:v})}}}}}},d.prototype.verify=function(e,t,r,i){e=this._truncateToN(new n(e,16)),r=this.keyFromPublic(r,i);var s=(t=new h(t,"hex")).r,o=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a,c=o.invm(this.n),u=c.mul(e).umod(this.n),d=c.mul(s).umod(this.n);return this.curve._maxwellTrick?!(a=this.g.jmulAdd(u,r.getPublic(),d)).isInfinity()&&a.eqXToP(s):!(a=this.g.mulAdd(u,r.getPublic(),d)).isInfinity()&&0===a.getX().umod(this.n).cmp(s)},d.prototype.recoverPubKey=function(e,t,r,i){c((3&r)===r,"The recovery param is more than two bits"),t=new h(t,i);var s=this.n,o=new n(e),a=t.r,u=t.s,d=1&r,l=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");a=l?this.curve.pointFromX(a.add(this.curve.n),d):this.curve.pointFromX(a,d);var f=t.r.invm(s),p=s.sub(o).mul(f).umod(s),y=u.mul(f).umod(s);return this.g.mulAdd(p,a,y)},d.prototype.getKeyRecoveryParam=function(e,t,r,n){if(null!==(t=new h(t,n)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,t,i)}catch(e){continue}if(s.eq(r))return i}throw new Error("Unable to find valid recovery factor")}},4025:(e,t,r)=>{"use strict";var n=r(6819),i=r(9594).assert;function s(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=s,s.fromPublic=function(e,t,r){return t instanceof s?t:new s(e,{pub:t,pubEnc:r})},s.fromPrivate=function(e,t,r){return t instanceof s?t:new s(e,{priv:t,privEnc:r})},s.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},s.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},s.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},s.prototype._importPrivate=function(e,t){this.priv=new n(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},s.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?i(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||i(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},s.prototype.derive=function(e){return e.validate()||i(e.validate(),"public point not validated"),e.mul(this.priv).getX()},s.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},s.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},s.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},4907:(e,t,r)=>{"use strict";var n=r(6819),i=r(9594),s=i.assert;function o(e,t){if(e instanceof o)return e;this._importDER(e,t)||(s(e.r&&e.s,"Signature without r or s"),this.r=new n(e.r,16),this.s=new n(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function c(e,t){var r=e[t.place++];if(!(128&r))return r;var n=15&r;if(0===n||n>4)return!1;for(var i=0,s=0,o=t.place;s<n;s++,o++)i<<=8,i|=e[o],i>>>=0;return!(i<=127)&&(t.place=o,i)}function u(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function h(e,t){if(t<128)e.push(t);else{var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}}e.exports=o,o.prototype._importDER=function(e,t){e=i.toArray(e,t);var r=new a;if(48!==e[r.place++])return!1;var s=c(e,r);if(!1===s)return!1;if(s+r.place!==e.length)return!1;if(2!==e[r.place++])return!1;var o=c(e,r);if(!1===o)return!1;var u=e.slice(r.place,o+r.place);if(r.place+=o,2!==e[r.place++])return!1;var h=c(e,r);if(!1===h)return!1;if(e.length!==h+r.place)return!1;var d=e.slice(r.place,h+r.place);if(0===u[0]){if(!(128&u[1]))return!1;u=u.slice(1)}if(0===d[0]){if(!(128&d[1]))return!1;d=d.slice(1)}return this.r=new n(u),this.s=new n(d),this.recoveryParam=null,!0},o.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=u(t),r=u(r);!(r[0]||128&r[1]);)r=r.slice(1);var n=[2];h(n,t.length),(n=n.concat(t)).push(2),h(n,r.length);var s=n.concat(r),o=[48];return h(o,s.length),o=o.concat(s),i.encode(o,e)}},506:(e,t,r)=>{"use strict";var n=r(6107),i=r(5394),s=r(9594),o=s.assert,a=s.parseBytes,c=r(8684),u=r(4420);function h(e){if(o("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof h))return new h(e);e=i[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=n.sha512}e.exports=h,h.prototype.sign=function(e,t){e=a(e);var r=this.keyFromSecret(t),n=this.hashInt(r.messagePrefix(),e),i=this.g.mul(n),s=this.encodePoint(i),o=this.hashInt(s,r.pubBytes(),e).mul(r.priv()),c=n.add(o).umod(this.curve.n);return this.makeSignature({R:i,S:c,Rencoded:s})},h.prototype.verify=function(e,t,r){e=a(e),t=this.makeSignature(t);var n=this.keyFromPublic(r),i=this.hashInt(t.Rencoded(),n.pubBytes(),e),s=this.g.mul(t.S());return t.R().add(n.pub().mul(i)).eq(s)},h.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return s.intFromLE(e.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(e){return c.fromPublic(this,e)},h.prototype.keyFromSecret=function(e){return c.fromSecret(this,e)},h.prototype.makeSignature=function(e){return e instanceof u?e:new u(this,e)},h.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},h.prototype.decodePoint=function(e){var t=(e=s.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),n=0!=(128&e[t]),i=s.intFromLE(r);return this.curve.pointFromY(i,n)},h.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(e){return s.intFromLE(e)},h.prototype.isPoint=function(e){return e instanceof this.pointClass}},8684:(e,t,r)=>{"use strict";var n=r(9594),i=n.assert,s=n.parseBytes,o=n.cachedProperty;function a(e,t){this.eddsa=e,this._secret=s(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=s(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},o(a,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),o(a,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),o(a,"privBytes",(function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,n=t.slice(0,e.encodingLength);return n[0]&=248,n[r]&=127,n[r]|=64,n})),o(a,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),o(a,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),o(a,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),a.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return i(this._secret,"KeyPair is public only"),n.encode(this.secret(),e)},a.prototype.getPublic=function(e){return n.encode(this.pubBytes(),e)},e.exports=a},4420:(e,t,r)=>{"use strict";var n=r(6819),i=r(9594),s=i.assert,o=i.cachedProperty,a=i.parseBytes;function c(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof n&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}o(c,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),o(c,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),o(c,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),o(c,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},e.exports=c},4895:e=>{e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},9594:(e,t,r)=>{"use strict";var n=t,i=r(6819),s=r(1716),o=r(7765);n.assert=s,n.toArray=o.toArray,n.zero2=o.zero2,n.toHex=o.toHex,n.encode=o.encode,n.getNAF=function(e,t,r){var n=new Array(Math.max(e.bitLength(),r)+1);n.fill(0);for(var i=1<<t+1,s=e.clone(),o=0;o<n.length;o++){var a,c=s.andln(i-1);s.isOdd()?(a=c>(i>>1)-1?(i>>1)-c:c,s.isubn(a)):a=0,n[o]=a,s.iushrn(1)}return n},n.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var n,i=0,s=0;e.cmpn(-i)>0||t.cmpn(-s)>0;){var o,a,c=e.andln(3)+i&3,u=t.andln(3)+s&3;3===c&&(c=-1),3===u&&(u=-1),o=0==(1&c)?0:3!==(n=e.andln(7)+i&7)&&5!==n||2!==u?c:-c,r[0].push(o),a=0==(1&u)?0:3!==(n=t.andln(7)+s&7)&&5!==n||2!==c?u:-u,r[1].push(a),2*i===o+1&&(i=1-i),2*s===a+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return r},n.cachedProperty=function(e,t,r){var n="_"+t;e.prototype[t]=function(){return void 0!==this[n]?this[n]:this[n]=r.call(this)}},n.parseBytes=function(e){return"string"==typeof e?n.toArray(e,"hex"):e},n.intFromLE=function(e){return new i(e,"hex","le")}},5975:(e,t,r)=>{for(var n=r(3837),i=r(7891),s=/[\{\[]/,o=/[\}\]]/,a=["do","if","in","for","let","new","try","var","case","else","enum","eval","null","this","true","void","with","await","break","catch","class","const","false","super","throw","while","yield","delete","export","import","public","return","static","switch","typeof","default","extends","finally","package","private","continue","debugger","function","arguments","interface","protected","implements","instanceof","NaN","undefined"],c={},u=0;u<a.length;u++)c[a[u]]=!0;var h=function(e){return i(e)&&!c.hasOwnProperty(e)},d={s:function(e){return""+e},d:function(e){return""+Number(e)},o:function(e){return JSON.stringify(e)}},l=function(){var e=[],t=0,r={},a=function(r){for(var n="";n.length<2*t;)n+="  ";e.push(n+r)},c=function(e){return o.test(e.trim()[0])&&s.test(e[e.length-1])?(t--,a(e),void t++):s.test(e[e.length-1])?(a(e),void t++):o.test(e.trim()[0])?(t--,void a(e)):void a(e)},u=function(e){if(!e)return u;if(1===arguments.length&&e.indexOf("\n")>-1)for(var t=e.trim().split("\n"),r=0;r<t.length;r++)c(t[r].trim());else c(n.format.apply(n,arguments));return u};return u.scope={},u.formats=d,u.sym=function(e){return e&&h(e)||(e="tmp"),r[e]||(r[e]=0),e+(r[e]++||"")},u.property=function(e,t){return 1===arguments.length&&(t=e,e=""),i(t+="")?e?e+"."+t:t:e?e+"["+JSON.stringify(t)+"]":JSON.stringify(t)},u.toString=function(){return e.join("\n")},u.toFunction=function(e){e||(e={});var t="return ("+u.toString()+")";Object.keys(u.scope).forEach((function(t){e[t]||(e[t]=u.scope[t])}));var r=Object.keys(e).map((function(e){return e})),n=r.map((function(t){return e[t]}));return Function.apply(null,r.concat(t)).apply(null,n)},arguments.length&&u.apply(null,arguments),u};l.formats=d,e.exports=l},6530:e=>{"use strict";e.exports=(e,t=process.argv)=>{const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return-1!==n&&(-1===i||n<i)}},6107:(e,t,r)=>{var n=t;n.utils=r(7770),n.common=r(7550),n.sha=r(3146),n.ripemd=r(489),n.hmac=r(3538),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160},7550:(e,t,r)=>{"use strict";var n=r(7770),i=r(1716);function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=s,s.prototype.update=function(e,t){if(e=n.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=n.join32(e,0,e.length-r,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),i(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,n=new Array(r+this.padLength);n[0]=128;for(var i=1;i<r;i++)n[i]=0;if(e<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)n[i++]=0;n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=e>>>24&255,n[i++]=e>>>16&255,n[i++]=e>>>8&255,n[i++]=255&e}else for(n[i++]=255&e,n[i++]=e>>>8&255,n[i++]=e>>>16&255,n[i++]=e>>>24&255,n[i++]=0,n[i++]=0,n[i++]=0,n[i++]=0,s=8;s<this.padLength;s++)n[i++]=0;return n}},3538:(e,t,r)=>{"use strict";var n=r(7770),i=r(1716);function s(e,t,r){if(!(this instanceof s))return new s(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(t,r))}e.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},489:(e,t,r)=>{"use strict";var n=r(7770),i=r(7550),s=n.rotl32,o=n.sum32,a=n.sum32_3,c=n.sum32_4,u=i.BlockHash;function h(){if(!(this instanceof h))return new h;u.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function d(e,t,r,n){return e<=15?t^r^n:e<=31?t&r|~t&n:e<=47?(t|~r)^n:e<=63?t&n|r&~n:t^(r|~n)}function l(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function f(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}n.inherits(h,u),t.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(e,t){for(var r=this.h[0],n=this.h[1],i=this.h[2],u=this.h[3],h=this.h[4],v=r,b=n,E=i,S=u,A=h,I=0;I<80;I++){var w=o(s(c(r,d(I,n,i,u),e[p[I]+t],l(I)),m[I]),h);r=h,h=u,u=s(i,10),i=n,n=w,w=o(s(c(v,d(79-I,b,E,S),e[y[I]+t],f(I)),g[I]),A),v=A,A=S,S=s(E,10),E=b,b=w}w=a(this.h[1],i,S),this.h[1]=a(this.h[2],u,A),this.h[2]=a(this.h[3],h,v),this.h[3]=a(this.h[4],r,b),this.h[4]=a(this.h[0],n,E),this.h[0]=w},h.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"little"):n.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],y=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},3146:(e,t,r)=>{"use strict";t.sha1=r(8148),t.sha224=r(1316),t.sha256=r(5442),t.sha384=r(3041),t.sha512=r(3181)},8148:(e,t,r)=>{"use strict";var n=r(7770),i=r(7550),s=r(4205),o=n.rotl32,a=n.sum32,c=n.sum32_5,u=s.ft_1,h=i.BlockHash,d=[1518500249,1859775393,2400959708,3395469782];function l(){if(!(this instanceof l))return new l;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}n.inherits(l,h),e.exports=l,l.blockSize=512,l.outSize=160,l.hmacStrength=80,l.padLength=64,l.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=o(r[n-3]^r[n-8]^r[n-14]^r[n-16],1);var i=this.h[0],s=this.h[1],h=this.h[2],l=this.h[3],f=this.h[4];for(n=0;n<r.length;n++){var p=~~(n/20),y=c(o(i,5),u(p,s,h,l),f,r[n],d[p]);f=l,l=h,h=o(s,30),s=i,i=y}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],h),this.h[3]=a(this.h[3],l),this.h[4]=a(this.h[4],f)},l.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},1316:(e,t,r)=>{"use strict";var n=r(7770),i=r(5442);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}n.inherits(s,i),e.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}},5442:(e,t,r)=>{"use strict";var n=r(7770),i=r(7550),s=r(4205),o=r(1716),a=n.sum32,c=n.sum32_4,u=n.sum32_5,h=s.ch32,d=s.maj32,l=s.s0_256,f=s.s1_256,p=s.g0_256,y=s.g1_256,m=i.BlockHash,g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function v(){if(!(this instanceof v))return new v;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g,this.W=new Array(64)}n.inherits(v,m),e.exports=v,v.blockSize=512,v.outSize=256,v.hmacStrength=192,v.padLength=64,v.prototype._update=function(e,t){for(var r=this.W,n=0;n<16;n++)r[n]=e[t+n];for(;n<r.length;n++)r[n]=c(y(r[n-2]),r[n-7],p(r[n-15]),r[n-16]);var i=this.h[0],s=this.h[1],m=this.h[2],g=this.h[3],v=this.h[4],b=this.h[5],E=this.h[6],S=this.h[7];for(o(this.k.length===r.length),n=0;n<r.length;n++){var A=u(S,f(v),h(v,b,E),this.k[n],r[n]),I=a(l(i),d(i,s,m));S=E,E=b,b=v,v=a(g,A),g=m,m=s,s=i,i=a(A,I)}this.h[0]=a(this.h[0],i),this.h[1]=a(this.h[1],s),this.h[2]=a(this.h[2],m),this.h[3]=a(this.h[3],g),this.h[4]=a(this.h[4],v),this.h[5]=a(this.h[5],b),this.h[6]=a(this.h[6],E),this.h[7]=a(this.h[7],S)},v.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},3041:(e,t,r)=>{"use strict";var n=r(7770),i=r(3181);function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}n.inherits(s,i),e.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}},3181:(e,t,r)=>{"use strict";var n=r(7770),i=r(7550),s=r(1716),o=n.rotr64_hi,a=n.rotr64_lo,c=n.shr64_hi,u=n.shr64_lo,h=n.sum64,d=n.sum64_hi,l=n.sum64_lo,f=n.sum64_4_hi,p=n.sum64_4_lo,y=n.sum64_5_hi,m=n.sum64_5_lo,g=i.BlockHash,v=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function b(){if(!(this instanceof b))return new b;g.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=v,this.W=new Array(160)}function E(e,t,r,n,i){var s=e&r^~e&i;return s<0&&(s+=4294967296),s}function S(e,t,r,n,i,s){var o=t&n^~t&s;return o<0&&(o+=4294967296),o}function A(e,t,r,n,i){var s=e&r^e&i^r&i;return s<0&&(s+=4294967296),s}function I(e,t,r,n,i,s){var o=t&n^t&s^n&s;return o<0&&(o+=4294967296),o}function w(e,t){var r=o(e,t,28)^o(t,e,2)^o(t,e,7);return r<0&&(r+=4294967296),r}function T(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=4294967296),r}function C(e,t){var r=o(e,t,14)^o(e,t,18)^o(t,e,9);return r<0&&(r+=4294967296),r}function _(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=4294967296),r}function D(e,t){var r=o(e,t,1)^o(e,t,8)^c(e,t,7);return r<0&&(r+=4294967296),r}function R(e,t){var r=a(e,t,1)^a(e,t,8)^u(e,t,7);return r<0&&(r+=4294967296),r}function N(e,t){var r=o(e,t,19)^o(t,e,29)^c(e,t,6);return r<0&&(r+=4294967296),r}function O(e,t){var r=a(e,t,19)^a(t,e,29)^u(e,t,6);return r<0&&(r+=4294967296),r}n.inherits(b,g),e.exports=b,b.blockSize=1024,b.outSize=512,b.hmacStrength=192,b.padLength=128,b.prototype._prepareBlock=function(e,t){for(var r=this.W,n=0;n<32;n++)r[n]=e[t+n];for(;n<r.length;n+=2){var i=N(r[n-4],r[n-3]),s=O(r[n-4],r[n-3]),o=r[n-14],a=r[n-13],c=D(r[n-30],r[n-29]),u=R(r[n-30],r[n-29]),h=r[n-32],d=r[n-31];r[n]=f(i,s,o,a,c,u,h,d),r[n+1]=p(i,s,o,a,c,u,h,d)}},b.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,n=this.h[0],i=this.h[1],o=this.h[2],a=this.h[3],c=this.h[4],u=this.h[5],f=this.h[6],p=this.h[7],g=this.h[8],v=this.h[9],b=this.h[10],D=this.h[11],R=this.h[12],N=this.h[13],O=this.h[14],U=this.h[15];s(this.k.length===r.length);for(var P=0;P<r.length;P+=2){var B=O,x=U,M=C(g,v),L=_(g,v),k=E(g,v,b,D,R),F=S(g,v,b,D,R,N),V=this.k[P],H=this.k[P+1],j=r[P],K=r[P+1],q=y(B,x,M,L,k,F,V,H,j,K),G=m(B,x,M,L,k,F,V,H,j,K);B=w(n,i),x=T(n,i),M=A(n,i,o,a,c),L=I(n,i,o,a,c,u);var z=d(B,x,M,L),$=l(B,x,M,L);O=R,U=N,R=b,N=D,b=g,D=v,g=d(f,p,q,G),v=l(p,p,q,G),f=c,p=u,c=o,u=a,o=n,a=i,n=d(q,G,z,$),i=l(q,G,z,$)}h(this.h,0,n,i),h(this.h,2,o,a),h(this.h,4,c,u),h(this.h,6,f,p),h(this.h,8,g,v),h(this.h,10,b,D),h(this.h,12,R,N),h(this.h,14,O,U)},b.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}},4205:(e,t,r)=>{"use strict";var n=r(7770).rotr32;function i(e,t,r){return e&t^~e&r}function s(e,t,r){return e&t^e&r^t&r}function o(e,t,r){return e^t^r}t.ft_1=function(e,t,r,n){return 0===e?i(t,r,n):1===e||3===e?o(t,r,n):2===e?s(t,r,n):void 0},t.ch32=i,t.maj32=s,t.p32=o,t.s0_256=function(e){return n(e,2)^n(e,13)^n(e,22)},t.s1_256=function(e){return n(e,6)^n(e,11)^n(e,25)},t.g0_256=function(e){return n(e,7)^n(e,18)^e>>>3},t.g1_256=function(e){return n(e,17)^n(e,19)^e>>>10}},7770:(e,t,r)=>{"use strict";var n=r(1716),i=r(8647);function s(e,t){return 55296==(64512&e.charCodeAt(t))&&(!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1)))}function o(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function a(e){return 1===e.length?"0"+e:e}function c(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}t.inherits=i,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var n=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=63&o|128):s(e,i)?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++i)),r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=63&o|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=63&o|128)}else for(i=0;i<e.length;i++)r[i]=0|e[i];return r},t.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=a(e[r].toString(16));return t},t.htonl=o,t.toHex32=function(e,t){for(var r="",n=0;n<e.length;n++){var i=e[n];"little"===t&&(i=o(i)),r+=c(i.toString(16))}return r},t.zero2=a,t.zero8=c,t.join32=function(e,t,r,i){var s=r-t;n(s%4==0);for(var o=new Array(s/4),a=0,c=t;a<o.length;a++,c+=4){var u;u="big"===i?e[c]<<24|e[c+1]<<16|e[c+2]<<8|e[c+3]:e[c+3]<<24|e[c+2]<<16|e[c+1]<<8|e[c],o[a]=u>>>0}return o},t.split32=function(e,t){for(var r=new Array(4*e.length),n=0,i=0;n<e.length;n++,i+=4){var s=e[n];"big"===t?(r[i]=s>>>24,r[i+1]=s>>>16&255,r[i+2]=s>>>8&255,r[i+3]=255&s):(r[i+3]=s>>>24,r[i+2]=s>>>16&255,r[i+1]=s>>>8&255,r[i]=255&s)}return r},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,r){return e+t+r>>>0},t.sum32_4=function(e,t,r,n){return e+t+r+n>>>0},t.sum32_5=function(e,t,r,n,i){return e+t+r+n+i>>>0},t.sum64=function(e,t,r,n){var i=e[t],s=n+e[t+1]>>>0,o=(s<n?1:0)+r+i;e[t]=o>>>0,e[t+1]=s},t.sum64_hi=function(e,t,r,n){return(t+n>>>0<t?1:0)+e+r>>>0},t.sum64_lo=function(e,t,r,n){return t+n>>>0},t.sum64_4_hi=function(e,t,r,n,i,s,o,a){var c=0,u=t;return c+=(u=u+n>>>0)<t?1:0,c+=(u=u+s>>>0)<s?1:0,e+r+i+o+(c+=(u=u+a>>>0)<a?1:0)>>>0},t.sum64_4_lo=function(e,t,r,n,i,s,o,a){return t+n+s+a>>>0},t.sum64_5_hi=function(e,t,r,n,i,s,o,a,c,u){var h=0,d=t;return h+=(d=d+n>>>0)<t?1:0,h+=(d=d+s>>>0)<s?1:0,h+=(d=d+a>>>0)<a?1:0,e+r+i+o+c+(h+=(d=d+u>>>0)<u?1:0)>>>0},t.sum64_5_lo=function(e,t,r,n,i,s,o,a,c,u){return t+n+s+a+u>>>0},t.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},t.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},t.shr64_hi=function(e,t,r){return e>>>r},t.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},3234:(e,t,r)=>{"use strict";var n=r(6107),i=r(7765),s=r(1716);function o(e){if(!(this instanceof o))return new o(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=i.toArray(e.entropy,e.entropyEnc||"hex"),r=i.toArray(e.nonce,e.nonceEnc||"hex"),n=i.toArray(e.pers,e.persEnc||"hex");s(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,n)}e.exports=o,o.prototype._init=function(e,t,r){var n=e.concat(t).concat(r);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},o.prototype._hmac=function(){return new n.hmac(this.hash,this.K)},o.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},o.prototype.reseed=function(e,t,r,n){"string"!=typeof t&&(n=r,r=t,t=null),e=i.toArray(e,t),r=i.toArray(r,n),s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},o.prototype.generate=function(e,t,r,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(n=r,r=t,t=null),r&&(r=i.toArray(r,n||"hex"),this._update(r));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var o=s.slice(0,e);return this._update(r),this._reseed++,i.encode(o,t)}},8647:(e,t,r)=>{try{var n=r(3837);if("function"!=typeof n.inherits)throw"";e.exports=n.inherits}catch(t){e.exports=r(8523)}},8523:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},5498:function(e,t){!function(e){var t,r="undefined",n=r!==typeof Buffer&&Buffer,i=r!==typeof Uint8Array&&Uint8Array,s=r!==typeof ArrayBuffer&&ArrayBuffer,o=[0,0,0,0,0,0,0,0],a=Array.isArray||function(e){return!!e&&"[object Array]"==Object.prototype.toString.call(e)},c=4294967296;function u(a,u,E){var S=u?0:4,A=u?4:0,I=u?0:3,w=u?1:2,T=u?2:1,C=u?3:0,_=u?m:v,D=u?g:b,R=U.prototype,N="is"+a,O="_"+N;return R.buffer=void 0,R.offset=0,R[O]=!0,R.toNumber=P,R.toString=function(e){var t=this.buffer,r=this.offset,n=x(t,r+S),i=x(t,r+A),s="",o=!E&&2147483648&n;o&&(n=~n,i=c-i);e=e||10;for(;;){var a=n%e*c+i;if(n=Math.floor(n/e),i=Math.floor(a/e),s=(a%e).toString(e)+s,!n&&!i)break}o&&(s="-"+s);return s},R.toJSON=P,R.toArray=h,n&&(R.toBuffer=d),i&&(R.toArrayBuffer=l),U[N]=function(e){return!(!e||!e[O])},e[a]=U,U;function U(e,a,u,h){return this instanceof U?function(e,a,u,h,d){i&&s&&(a instanceof s&&(a=new i(a)),h instanceof s&&(h=new i(h)));if(!(a||u||h||t))return void(e.buffer=y(o,0));if(!f(a,u)){var l=t||Array;d=u,h=a,u=0,a=t===n?n.alloc(8):new l(8)}if(e.buffer=a,e.offset=u|=0,r===typeof h)return;"string"==typeof h?function(e,t,r,n){var i=0,s=r.length,o=0,a=0;"-"===r[0]&&i++;var u=i;for(;i<s;){var h=parseInt(r[i++],n);if(!(h>=0))break;a=a*n+h,o=o*n+Math.floor(a/c),a%=c}u&&(o=~o,a?a=c-a:o++);B(e,t+S,o),B(e,t+A,a)}(a,u,h,d||10):f(h,d)?p(a,u,h,d):"number"==typeof d?(B(a,u+S,h),B(a,u+A,d)):h>0?_(a,u,h):h<0?D(a,u,h):p(a,u,o,0)}(this,e,a,u,h):new U(e,a,u,h)}function P(){var e=this.buffer,t=this.offset,r=x(e,t+S),n=x(e,t+A);return E||(r|=0),r?r*c+n:n}function B(e,t,r){e[t+C]=255&r,r>>=8,e[t+T]=255&r,r>>=8,e[t+w]=255&r,r>>=8,e[t+I]=255&r}function x(e,t){return 16777216*e[t+I]+(e[t+w]<<16)+(e[t+T]<<8)+e[t+C]}}function h(e){var r=this.buffer,n=this.offset;return t=null,!1!==e&&a(r)?8===r.length?r:r.slice(n,n+8):y(r,n)}function d(e){var r=this.buffer,i=this.offset;return t=n,!1!==e&&n.isBuffer(r)?8===r.length?r:r.slice(i,i+8):n.from(l.call(this,e))}function l(e){var r=this.buffer,n=this.offset,o=r.buffer;if(t=i,!1!==e&&!r.offset&&o instanceof s)return 8===o.byteLength?o:o.slice(n,n+8);var a=new i(8);return p(a,0,r,n),a.buffer}function f(e,t){var r=e&&e.length;return t|=0,r&&t+8<=r&&"string"!=typeof e[t]}function p(e,t,r,n){t|=0,n|=0;for(var i=0;i<8;i++)e[t++]=255&r[n++]}function y(e,t){return Array.prototype.slice.call(e,t,t+8)}function m(e,t,r){for(var n=t+8;n>t;)e[--n]=255&r,r/=256}function g(e,t,r){var n=t+8;for(r++;n>t;)e[--n]=255&-r^255,r/=256}function v(e,t,r){for(var n=t+8;t<n;)e[t++]=255&r,r/=256}function b(e,t,r){var n=t+8;for(r++;t<n;)e[t++]=255&-r^255,r/=256}u("Uint64BE",!0,!0),u("Int64BE",!0,!1),u("Uint64LE",!1,!0),u("Int64LE",!1,!1)}("string"!=typeof t.nodeName?t:this||{})},285:function(e){!function(t){"use strict";const r="(0?\\d+|0x[a-f0-9]+)",n={fourOctet:new RegExp(`^${r}\\.${r}\\.${r}\\.${r}$`,"i"),threeOctet:new RegExp(`^${r}\\.${r}\\.${r}$`,"i"),twoOctet:new RegExp(`^${r}\\.${r}$`,"i"),longValue:new RegExp(`^${r}$`,"i")},i=new RegExp("^0[0-7]+$","i"),s=new RegExp("^0x[a-f0-9]+$","i"),o="%[0-9a-z]{1,}",a="(?:[0-9a-f]+::?)+",c={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${a})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${r}\\.${r}\\.${r}\\.${r}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${a})|(?:::)(?:${a})?)${r}\\.${r}\\.${r}\\.${r}(${o})?$`,"i")};function u(e,t){if(e.indexOf("::")!==e.lastIndexOf("::"))return null;let r,n,i=0,s=-1,o=(e.match(c.zoneIndex)||[])[0];for(o&&(o=o.substring(1),e=e.replace(/%.+$/,""));(s=e.indexOf(":",s+1))>=0;)i++;if("::"===e.substr(0,2)&&i--,"::"===e.substr(-2,2)&&i--,i>t)return null;for(n=t-i,r=":";n--;)r+="0:";return":"===(e=e.replace("::",r))[0]&&(e=e.slice(1)),":"===e[e.length-1]&&(e=e.slice(0,-1)),t=function(){const t=e.split(":"),r=[];for(let e=0;e<t.length;e++)r.push(parseInt(t[e],16));return r}(),{parts:t,zoneId:o}}function h(e,t,r,n){if(e.length!==t.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let i,s=0;for(;n>0;){if(i=r-n,i<0&&(i=0),e[s]>>i!=t[s]>>i)return!1;n-=r,s+=1}return!0}function d(e){if(s.test(e))return parseInt(e,16);if("0"===e[0]&&!isNaN(parseInt(e[1],10))){if(i.test(e))return parseInt(e,8);throw new Error(`ipaddr: cannot parse ${e} as octal`)}return parseInt(e,10)}function l(e,t){for(;e.length<t;)e=`0${e}`;return e}const f={};f.IPv4=function(){function e(e){if(4!==e.length)throw new Error("ipaddr: ipv4 octet count should be 4");let t,r;for(t=0;t<e.length;t++)if(r=e[t],!(0<=r&&r<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=e}return e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]},e.prototype.kind=function(){return"ipv4"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv4"!==e.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return h(this.octets,e.octets,8,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let n,i,s;for(n=3;n>=0;n-=1){if(i=this.octets[n],!(i in r))return null;if(s=r[i],t&&0!==s)return null;8!==s&&(t=!0),e+=s}return 32-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){return this.octets.slice(0)},e.prototype.toIPv4MappedAddress=function(){return f.IPv6.parse(`::ffff:${this.toString()}`)},e.prototype.toNormalizedString=function(){return this.toString()},e.prototype.toString=function(){return this.octets.join(".")},e}(),f.IPv4.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let s=0;for(;s<4;)i.push(parseInt(r[s],10)|255^parseInt(n[s],10)),s++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.isIPv4=function(e){return null!==this.parser(e)},f.IPv4.isValid=function(e){try{return new this(this.parser(e)),!0}catch(e){return!1}},f.IPv4.isValidFourPartDecimal=function(e){return!(!f.IPv4.isValid(e)||!e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},f.IPv4.networkAddressFromCIDR=function(e){let t,r,n,i,s;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<4;)i.push(parseInt(n[r],10)&parseInt(s[r],10)),r++;return new this(i)}catch(e){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},f.IPv4.parse=function(e){const t=this.parser(e);if(null===t)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(t)},f.IPv4.parseCIDR=function(e){let t;if(t=e.match(/^(.+)\/(\d+)$/)){const e=parseInt(t[2]);if(e>=0&&e<=32){const r=[this.parse(t[1]),e];return Object.defineProperty(r,"toString",{value:function(){return this.join("/")}}),r}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},f.IPv4.parser=function(e){let t,r,i;if(t=e.match(n.fourOctet))return function(){const e=t.slice(1,6),n=[];for(let t=0;t<e.length;t++)r=e[t],n.push(d(r));return n}();if(t=e.match(n.longValue)){if(i=d(t[1]),i>4294967295||i<0)throw new Error("ipaddr: address outside defined range");return function(){const e=[];let t;for(t=0;t<=24;t+=8)e.push(i>>t&255);return e}().reverse()}return(t=e.match(n.twoOctet))?function(){const e=t.slice(1,4),r=[];if(i=d(e[1]),i>16777215||i<0)throw new Error("ipaddr: address outside defined range");return r.push(d(e[0])),r.push(i>>16&255),r.push(i>>8&255),r.push(255&i),r}():(t=e.match(n.threeOctet))?function(){const e=t.slice(1,5),r=[];if(i=d(e[2]),i>65535||i<0)throw new Error("ipaddr: address outside defined range");return r.push(d(e[0])),r.push(d(e[1])),r.push(i>>8&255),r.push(255&i),r}():null},f.IPv4.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>32)throw new Error("ipaddr: invalid IPv4 prefix length");const t=[0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<4&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.IPv6=function(){function e(e,t){let r,n;if(16===e.length)for(this.parts=[],r=0;r<=14;r+=2)this.parts.push(e[r]<<8|e[r+1]);else{if(8!==e.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=e}for(r=0;r<this.parts.length;r++)if(n=this.parts[r],!(0<=n&&n<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");t&&(this.zoneId=t)}return e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]},e.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},e.prototype.kind=function(){return"ipv6"},e.prototype.match=function(e,t){let r;if(void 0===t&&(r=e,e=r[0],t=r[1]),"ipv6"!==e.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return h(this.parts,e.parts,16,t)},e.prototype.prefixLengthFromSubnetMask=function(){let e=0,t=!1;const r={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let n,i;for(let s=7;s>=0;s-=1){if(n=this.parts[s],!(n in r))return null;if(i=r[n],t&&0!==i)return null;16!==i&&(t=!0),e+=i}return 128-e},e.prototype.range=function(){return f.subnetMatch(this,this.SpecialRanges)},e.prototype.toByteArray=function(){let e;const t=[],r=this.parts;for(let n=0;n<r.length;n++)e=r[n],t.push(e>>8),t.push(255&e);return t},e.prototype.toFixedLengthString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(l(this.parts[t].toString(16),4));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const e=this.parts.slice(-2),t=e[0],r=e[1];return new f.IPv4([t>>8,255&t,r>>8,255&r])},e.prototype.toNormalizedString=function(){const e=function(){const e=[];for(let t=0;t<this.parts.length;t++)e.push(this.parts[t].toString(16));return e}.call(this).join(":");let t="";return this.zoneId&&(t=`%${this.zoneId}`),e+t},e.prototype.toRFC5952String=function(){const e=/((^|:)(0(:|$)){2,})/g,t=this.toNormalizedString();let r,n=0,i=-1;for(;r=e.exec(t);)r[0].length>i&&(n=r.index,i=r[0].length);return i<0?t:`${t.substring(0,n)}::${t.substring(n+i)}`},e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},e}(),f.IPv6.broadcastAddressFromCIDR=function(e){try{const t=this.parseCIDR(e),r=t[0].toByteArray(),n=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[];let s=0;for(;s<16;)i.push(parseInt(r[s],10)|255^parseInt(n[s],10)),s++;return new this(i)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},f.IPv6.isIPv6=function(e){return null!==this.parser(e)},f.IPv6.isValid=function(e){if("string"==typeof e&&-1===e.indexOf(":"))return!1;try{const t=this.parser(e);return new this(t.parts,t.zoneId),!0}catch(e){return!1}},f.IPv6.networkAddressFromCIDR=function(e){let t,r,n,i,s;try{for(t=this.parseCIDR(e),n=t[0].toByteArray(),s=this.subnetMaskFromPrefixLength(t[1]).toByteArray(),i=[],r=0;r<16;)i.push(parseInt(n[r],10)&parseInt(s[r],10)),r++;return new this(i)}catch(e){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${e})`)}},f.IPv6.parse=function(e){const t=this.parser(e);if(null===t.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(t.parts,t.zoneId)},f.IPv6.parseCIDR=function(e){let t,r,n;if((r=e.match(/^(.+)\/(\d+)$/))&&(t=parseInt(r[2]),t>=0&&t<=128))return n=[this.parse(r[1]),t],Object.defineProperty(n,"toString",{value:function(){return this.join("/")}}),n;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},f.IPv6.parser=function(e){let t,r,n,i,s,o;if(n=e.match(c.deprecatedTransitional))return this.parser(`::ffff:${n[1]}`);if(c.native.test(e))return u(e,8);if((n=e.match(c.transitional))&&(o=n[6]||"",t=u(n[1].slice(0,-1)+o,6),t.parts)){for(s=[parseInt(n[2]),parseInt(n[3]),parseInt(n[4]),parseInt(n[5])],r=0;r<s.length;r++)if(i=s[r],!(0<=i&&i<=255))return null;return t.parts.push(s[0]<<8|s[1]),t.parts.push(s[2]<<8|s[3]),{parts:t.parts,zoneId:t.zoneId}}return null},f.IPv6.subnetMaskFromPrefixLength=function(e){if((e=parseInt(e))<0||e>128)throw new Error("ipaddr: invalid IPv6 prefix length");const t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let r=0;const n=Math.floor(e/8);for(;r<n;)t[r]=255,r++;return n<16&&(t[n]=Math.pow(2,e%8)-1<<8-e%8),new this(t)},f.fromByteArray=function(e){const t=e.length;if(4===t)return new f.IPv4(e);if(16===t)return new f.IPv6(e);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},f.isValid=function(e){return f.IPv6.isValid(e)||f.IPv4.isValid(e)},f.parse=function(e){if(f.IPv6.isValid(e))return f.IPv6.parse(e);if(f.IPv4.isValid(e))return f.IPv4.parse(e);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},f.parseCIDR=function(e){try{return f.IPv6.parseCIDR(e)}catch(t){try{return f.IPv4.parseCIDR(e)}catch(e){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},f.process=function(e){const t=this.parse(e);return"ipv6"===t.kind()&&t.isIPv4MappedAddress()?t.toIPv4Address():t},f.subnetMatch=function(e,t,r){let n,i,s,o;for(i in null==r&&(r="unicast"),t)if(Object.prototype.hasOwnProperty.call(t,i))for(s=t[i],!s[0]||s[0]instanceof Array||(s=[s]),n=0;n<s.length;n++)if(o=s[n],e.kind()===o[0].kind()&&e.match.apply(e,o))return i;return r},e.exports?e.exports=f:t.ipaddr=f}(this)},5817:(e,t,r)=>{"use strict";var n=r(5488);function i(e){return!0===n(e)&&"[object Object]"===Object.prototype.toString.call(e)}e.exports=function(e){var t,r;return!1!==i(e)&&("function"==typeof(t=e.constructor)&&(!1!==i(r=t.prototype)&&!1!==r.hasOwnProperty("isPrototypeOf")))}},7891:e=>{"use strict";e.exports=function(e){return/^[$A-Z\_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc][$A-Z\_a-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u08a0\u08a2-\u08ac\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32\u0e33\u0e40-\u0e46\u0e81\u0e82\u0e84\u0e87\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa\u0eab\u0ead-\u0eb0\u0eb2\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edf\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u1000-\u102a\u103f\u1050-\u1055\u105a-\u105d\u1061\u1065\u1066\u106e-\u1070\u1075-\u1081\u108e\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fc-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19c1-\u19c7\u1a00-\u1a16\u1a20-\u1a54\u1aa7\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bba-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1cf5\u1cf6\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2cf2\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790-\ua793\ua7a0-\ua7aa\ua7f8-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uaa60-\uaa76\uaa7a\uaa80-\uaaaf\uaab1\uaab5\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadd\uaae0-\uaaea\uaaf2-\uaaf4\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc0-9\u0300-\u036f\u0483-\u0487\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u0669\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u06f0-\u06f9\u0711\u0730-\u074a\u07a6-\u07b0\u07c0-\u07c9\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u08e4-\u08fe\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0966-\u096f\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u09e6-\u09ef\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a66-\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0ae6-\u0aef\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b66-\u0b6f\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0be6-\u0bef\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c66-\u0c6f\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0ce6-\u0cef\u0d02\u0d03\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d66-\u0d6f\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0e50-\u0e59\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0ed0-\u0ed9\u0f18\u0f19\u0f20-\u0f29\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1040-\u1049\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f-\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b4-\u17d3\u17dd\u17e0-\u17e9\u180b-\u180d\u1810-\u1819\u18a9\u1920-\u192b\u1930-\u193b\u1946-\u194f\u19b0-\u19c0\u19c8\u19c9\u19d0-\u19d9\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f-\u1a89\u1a90-\u1a99\u1b00-\u1b04\u1b34-\u1b44\u1b50-\u1b59\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1bad\u1bb0-\u1bb9\u1be6-\u1bf3\u1c24-\u1c37\u1c40-\u1c49\u1c50-\u1c59\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf2-\u1cf4\u1dc0-\u1de6\u1dfc-\u1dff\u200c\u200d\u203f\u2040\u2054\u20d0-\u20dc\u20e1\u20e5-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua620-\ua629\ua66f\ua674-\ua67d\ua69f\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c4\ua8d0-\ua8d9\ua8e0-\ua8f1\ua900-\ua909\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\ua9d0-\ua9d9\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa50-\uaa59\uaa7b\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uaaeb-\uaaef\uaaf5\uaaf6\uabe3-\uabea\uabec\uabed\uabf0-\uabf9\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\ufe33\ufe34\ufe4d-\ufe4f\uff10-\uff19\uff3f]*$/.test(e)}},5488:e=>{"use strict";e.exports=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},8493:(e,t)=>{t.T=new function(){var e,t=!1,r=this;r._DeArray=function(e,t,r){return[e.slice(t,t+r)]},r._EnArray=function(e,t,r,n){for(var i=0;i<r;e[t+i]=n[i]?n[i]:0,i++);},r._DeChar=function(e,t){return String.fromCharCode(e[t])},r._EnChar=function(e,t,r){e[t]=r.charCodeAt(0)},r._DeInt=function(r,n){var i,s,o,a=t?e.len-1:0,c=t?-1:1,u=a+c*e.len;for(i=0,s=a,o=1;s!=u;i+=r[n+s]*o,s+=c,o*=256);return e.bSigned&&i&Math.pow(2,8*e.len-1)&&(i-=Math.pow(2,8*e.len)),i},r._EnInt=function(r,n,i){var s,o=t?e.len-1:0,a=t?-1:1,c=o+a*e.len;for(i=i<e.min?e.min:i>e.max?e.max:i,s=o;s!=c;r[n+s]=255&i,s+=a,i>>=8);},r._DeString=function(e,t,r){for(var n=new Array(r),i=0;i<r;n[i]=String.fromCharCode(e[t+i]),i++);return n.join("")},r._EnString=function(e,t,r,n){for(var i,s=0;s<r;e[t+s]=(i=n.charCodeAt(s))?i:0,s++);},r._De754=function(r,n){var i,s,o,a,c,u,h,d,l,f;for(h=e.mLen,l=(f=(1<<(d=8*e.len-e.mLen-1))-1)>>1,a=t?0:e.len-1,c=t?1:-1,i=r[n+a],a+=c,s=i&(1<<-(u=-7))-1,i>>=-u,u+=d;u>0;s=256*s+r[n+a],a+=c,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=h;u>0;o=256*o+r[n+a],a+=c,u-=8);switch(s){case 0:s=1-l;break;case f:return o?NaN:1/0*(i?-1:1);default:o+=Math.pow(2,h),s-=l}return(i?-1:1)*o*Math.pow(2,s-h)},r._En754=function(r,n,i){var s,o,a,c,u,h,d,l,f,p;for(d=e.mLen,f=(p=(1<<(l=8*e.len-e.mLen-1))-1)>>1,s=i<0?1:0,i=Math.abs(i),isNaN(i)||i==1/0?(a=isNaN(i)?1:0,o=p):(o=Math.floor(Math.log(i)/Math.LN2),i*(h=Math.pow(2,-o))<1&&(o--,h*=2),(i+=o+f>=1?e.rt/h:e.rt*Math.pow(2,1-f))*h>=2&&(o++,h/=2),o+f>=p?(a=0,o=p):o+f>=1?(a=(i*h-1)*Math.pow(2,d),o+=f):(a=i*Math.pow(2,f-1)*Math.pow(2,d),o=0)),c=t?e.len-1:0,u=t?-1:1;d>=8;r[n+c]=255&a,c+=u,a/=256,d-=8);for(o=o<<d|a,l+=d;l>0;r[n+c]=255&o,c+=u,o/=256,l-=8);r[n+c-u]|=128*s},r._DeInt64=function(r,n){var i,s,o,a=t?0:7,c=t?1:-1,u=a+8*c,h=[0,0,!e.bSigned];for(i=a,o=1,s=0;i!=u;h[o]=(h[o]<<8>>>0)+r[n+i],i+=c,o=++s<4?1:0);return h},r._EnInt64=function(e,r,n){var i,s,o,a,c=t?0:7,u=t?1:-1,h=c+8*u;for(i=c,o=1,s=0,a=24;i!=h;e[r+i]=n[o]>>a&255,i+=u,o=++s<4?1:0,a=24-s%4*8);},r._sPattern="(\\d+)?([AxcbBhHsfdiIlLqQ])",r._lenLut={A:1,x:1,c:1,b:1,B:1,h:2,H:2,s:1,f:4,d:8,i:4,I:4,l:4,L:4,q:8,Q:8},r._elLut={A:{en:r._EnArray,de:r._DeArray},s:{en:r._EnString,de:r._DeString},c:{en:r._EnChar,de:r._DeChar},b:{en:r._EnInt,de:r._DeInt,len:1,bSigned:!0,min:-Math.pow(2,7),max:Math.pow(2,7)-1},B:{en:r._EnInt,de:r._DeInt,len:1,bSigned:!1,min:0,max:Math.pow(2,8)-1},h:{en:r._EnInt,de:r._DeInt,len:2,bSigned:!0,min:-Math.pow(2,15),max:Math.pow(2,15)-1},H:{en:r._EnInt,de:r._DeInt,len:2,bSigned:!1,min:0,max:Math.pow(2,16)-1},i:{en:r._EnInt,de:r._DeInt,len:4,bSigned:!0,min:-Math.pow(2,31),max:Math.pow(2,31)-1},I:{en:r._EnInt,de:r._DeInt,len:4,bSigned:!1,min:0,max:Math.pow(2,32)-1},l:{en:r._EnInt,de:r._DeInt,len:4,bSigned:!0,min:-Math.pow(2,31),max:Math.pow(2,31)-1},L:{en:r._EnInt,de:r._DeInt,len:4,bSigned:!1,min:0,max:Math.pow(2,32)-1},f:{en:r._En754,de:r._De754,len:4,mLen:23,rt:Math.pow(2,-24)-Math.pow(2,-77)},d:{en:r._En754,de:r._De754,len:8,mLen:52,rt:0},q:{en:r._EnInt64,de:r._DeInt64,bSigned:!0},Q:{en:r._EnInt64,de:r._DeInt64,bSigned:!1}},r._UnpackSeries=function(t,r,n,i){for(var s=e.de,o=[],a=0;a<t;o.push(s(n,i+a*r)),a++);return o},r._PackSeries=function(t,r,n,i,s,o){for(var a=e.en,c=0;c<t;a(n,i+c*r,s[o+c]),c++);},r.Unpack=function(r,n,i){t="<"!=r.charAt(0),i=i||0;for(var s,o,a,c=new RegExp(this._sPattern,"g"),u=[];s=c.exec(r);){if(i+(o=null==s[1]||""==s[1]?1:parseInt(s[1]))*(a=this._lenLut[s[2]])>n.length)return;switch(s[2]){case"A":case"s":u.push(this._elLut[s[2]].de(n,i,o));break;case"c":case"b":case"B":case"h":case"H":case"i":case"I":case"l":case"L":case"f":case"d":case"q":case"Q":e=this._elLut[s[2]],u.push(this._UnpackSeries(o,a,n,i))}i+=o*a}return Array.prototype.concat.apply([],u)},r.PackTo=function(r,n,i,s){t="<"!=r.charAt(0);for(var o,a,c,u,h=new RegExp(this._sPattern,"g"),d=0;o=h.exec(r);){if(i+(a=null==o[1]||""==o[1]?1:parseInt(o[1]))*(c=this._lenLut[o[2]])>n.length)return!1;switch(o[2]){case"A":case"s":if(d+1>s.length)return!1;this._elLut[o[2]].en(n,i,a,s[d]),d+=1;break;case"c":case"b":case"B":case"h":case"H":case"i":case"I":case"l":case"L":case"f":case"d":case"q":case"Q":if(e=this._elLut[o[2]],d+a>s.length)return!1;this._PackSeries(a,c,n,i,s,d),d+=a;break;case"x":for(u=0;u<a;u++)n[i+u]=0}i+=a*c}return n},r.Pack=function(e,t){return this.PackTo(e,new Array(this.CalcLength(e)),0,t)},r.CalcLength=function(e){for(var t,r=new RegExp(this._sPattern,"g"),n=0;t=r.exec(e);)n+=(null==t[1]||""==t[1]?1:parseInt(t[1]))*this._lenLut[t[2]];return n}}},2595:(e,t,r)=>{var n=r(6271)(r(6335),"DataView");e.exports=n},5666:(e,t,r)=>{var n=r(2638),i=r(760),s=r(3321),o=r(3406),a=r(9696);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=o,c.prototype.set=a,e.exports=c},6904:(e,t,r)=>{var n=r(4053),i=r(1834),s=r(5118),o=r(5287),a=r(1277);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=o,c.prototype.set=a,e.exports=c},6041:(e,t,r)=>{var n=r(6271)(r(6335),"Map");e.exports=n},9159:(e,t,r)=>{var n=r(5669),i=r(7078),s=r(9718),o=r(5176),a=r(2084);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=i,c.prototype.get=s,c.prototype.has=o,c.prototype.set=a,e.exports=c},9085:(e,t,r)=>{var n=r(6271)(r(6335),"Promise");e.exports=n},9307:(e,t,r)=>{var n=r(6271)(r(6335),"Set");e.exports=n},2123:(e,t,r)=>{var n=r(9159),i=r(9503),s=r(3999);function o(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}o.prototype.add=o.prototype.push=i,o.prototype.has=s,e.exports=o},8466:(e,t,r)=>{var n=r(6904),i=r(7459),s=r(9416),o=r(3411),a=r(3392),c=r(9544);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=i,u.prototype.delete=s,u.prototype.get=o,u.prototype.has=a,u.prototype.set=c,e.exports=u},9038:(e,t,r)=>{var n=r(6335).Symbol;e.exports=n},9877:(e,t,r)=>{var n=r(6335).Uint8Array;e.exports=n},713:(e,t,r)=>{var n=r(6271)(r(6335),"WeakMap");e.exports=n},9378:e=>{e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},4099:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},9021:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[i++]=o)}return s}},4412:(e,t,r)=>{var n=r(890),i=r(2892),s=r(1261),o=r(3347),a=r(3089),c=r(8398),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=s(e),h=!r&&i(e),d=!r&&!h&&o(e),l=!r&&!h&&!d&&c(e),f=r||h||d||l,p=f?n(e.length,String):[],y=p.length;for(var m in e)!t&&!u.call(e,m)||f&&("length"==m||d&&("offset"==m||"parent"==m)||l&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||a(m,y))||p.push(m);return p}},7952:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}},8891:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},5144:(e,t,r)=>{var n=r(1860),i=r(5821);e.exports=function(e,t,r){(void 0!==r&&!i(e[t],r)||void 0===r&&!(t in e))&&n(e,t,r)}},2685:(e,t,r)=>{var n=r(1860),i=r(5821),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var o=e[t];s.call(e,t)&&i(o,r)&&(void 0!==r||t in e)||n(e,t,r)}},803:(e,t,r)=>{var n=r(5821);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},4335:(e,t,r)=>{var n=r(9666),i=r(443);e.exports=function(e,t){return e&&n(t,i(t),e)}},6959:(e,t,r)=>{var n=r(9666),i=r(1989);e.exports=function(e,t){return e&&n(t,i(t),e)}},1860:(e,t,r)=>{var n=r(1899);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},1991:(e,t,r)=>{var n=r(8466),i=r(4099),s=r(2685),o=r(4335),a=r(6959),c=r(394),u=r(2753),h=r(5383),d=r(6465),l=r(989),f=r(470),p=r(6513),y=r(6773),m=r(7823),g=r(1200),v=r(1261),b=r(3347),E=r(5485),S=r(7774),A=r(3166),I=r(443),w=r(1989),T="[object Arguments]",C="[object Function]",_="[object Object]",D={};D[T]=D["[object Array]"]=D["[object ArrayBuffer]"]=D["[object DataView]"]=D["[object Boolean]"]=D["[object Date]"]=D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Map]"]=D["[object Number]"]=D[_]=D["[object RegExp]"]=D["[object Set]"]=D["[object String]"]=D["[object Symbol]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D["[object Error]"]=D[C]=D["[object WeakMap]"]=!1,e.exports=function e(t,r,R,N,O,U){var P,B=1&r,x=2&r,M=4&r;if(R&&(P=O?R(t,N,O,U):R(t)),void 0!==P)return P;if(!S(t))return t;var L=v(t);if(L){if(P=y(t),!B)return u(t,P)}else{var k=p(t),F=k==C||"[object GeneratorFunction]"==k;if(b(t))return c(t,B);if(k==_||k==T||F&&!O){if(P=x||F?{}:g(t),!B)return x?d(t,a(P,t)):h(t,o(P,t))}else{if(!D[k])return O?t:{};P=m(t,k,B)}}U||(U=new n);var V=U.get(t);if(V)return V;U.set(t,P),A(t)?t.forEach((function(n){P.add(e(n,r,R,n,t,U))})):E(t)&&t.forEach((function(n,i){P.set(i,e(n,r,R,i,t,U))}));var H=L?void 0:(M?x?f:l:x?w:I)(t);return i(H||t,(function(n,i){H&&(n=t[i=n]),s(P,i,e(n,r,R,i,t,U))})),P}},1683:(e,t,r)=>{var n=r(7774),i=Object.create,s=function(){function e(){}return function(t){if(!n(t))return{};if(i)return i(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=s},6290:(e,t,r)=>{var n=r(6523)();e.exports=n},6907:(e,t,r)=>{var n=r(7952),i=r(1261);e.exports=function(e,t,r){var s=t(e);return i(e)?s:n(s,r(e))}},3318:(e,t,r)=>{var n=r(9038),i=r(3877),s=r(6706),o=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?i(e):s(e)}},6763:(e,t,r)=>{var n=r(3318),i=r(2557);e.exports=function(e){return i(e)&&"[object Arguments]"==n(e)}},8440:(e,t,r)=>{var n=r(4925),i=r(2557);e.exports=function e(t,r,s,o,a){return t===r||(null==t||null==r||!i(t)&&!i(r)?t!=t&&r!=r:n(t,r,s,o,e,a))}},4925:(e,t,r)=>{var n=r(8466),i=r(3185),s=r(1578),o=r(9191),a=r(6513),c=r(1261),u=r(3347),h=r(8398),d="[object Arguments]",l="[object Array]",f="[object Object]",p=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,y,m,g){var v=c(e),b=c(t),E=v?l:a(e),S=b?l:a(t),A=(E=E==d?f:E)==f,I=(S=S==d?f:S)==f,w=E==S;if(w&&u(e)){if(!u(t))return!1;v=!0,A=!1}if(w&&!A)return g||(g=new n),v||h(e)?i(e,t,r,y,m,g):s(e,t,E,r,y,m,g);if(!(1&r)){var T=A&&p.call(e,"__wrapped__"),C=I&&p.call(t,"__wrapped__");if(T||C){var _=T?e.value():e,D=C?t.value():t;return g||(g=new n),m(_,D,r,y,g)}}return!!w&&(g||(g=new n),o(e,t,r,y,m,g))}},5585:(e,t,r)=>{var n=r(6513),i=r(2557);e.exports=function(e){return i(e)&&"[object Map]"==n(e)}},747:(e,t,r)=>{var n=r(4447),i=r(3642),s=r(7774),o=r(1763),a=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,h=c.toString,d=u.hasOwnProperty,l=RegExp("^"+h.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||i(e))&&(n(e)?l:a).test(o(e))}},9515:(e,t,r)=>{var n=r(6513),i=r(2557);e.exports=function(e){return i(e)&&"[object Set]"==n(e)}},6455:(e,t,r)=>{var n=r(3318),i=r(2441),s=r(2557),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(e){return s(e)&&i(e.length)&&!!o[n(e)]}},8769:(e,t,r)=>{var n=r(6639),i=r(27),s=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=[];for(var r in Object(e))s.call(e,r)&&"constructor"!=r&&t.push(r);return t}},8098:(e,t,r)=>{var n=r(7774),i=r(6639),s=r(7282),o=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return s(e);var t=i(e),r=[];for(var a in e)("constructor"!=a||!t&&o.call(e,a))&&r.push(a);return r}},1979:(e,t,r)=>{var n=r(8466),i=r(5144),s=r(6290),o=r(3302),a=r(7774),c=r(1989),u=r(1992);e.exports=function e(t,r,h,d,l){t!==r&&s(r,(function(s,c){if(l||(l=new n),a(s))o(t,r,c,h,e,d,l);else{var f=d?d(u(t,c),s,c+"",t,r,l):void 0;void 0===f&&(f=s),i(t,c,f)}}),c)}},3302:(e,t,r)=>{var n=r(5144),i=r(394),s=r(3450),o=r(2753),a=r(1200),c=r(2892),u=r(1261),h=r(9160),d=r(3347),l=r(4447),f=r(7774),p=r(9638),y=r(8398),m=r(1992),g=r(1272);e.exports=function(e,t,r,v,b,E,S){var A=m(e,r),I=m(t,r),w=S.get(I);if(w)n(e,r,w);else{var T=E?E(A,I,r+"",e,t,S):void 0,C=void 0===T;if(C){var _=u(I),D=!_&&d(I),R=!_&&!D&&y(I);T=I,_||D||R?u(A)?T=A:h(A)?T=o(A):D?(C=!1,T=i(I,!0)):R?(C=!1,T=s(I,!0)):T=[]:p(I)||c(I)?(T=A,c(A)?T=g(A):f(A)&&!l(A)||(T=a(I))):C=!1}C&&(S.set(I,T),b(T,I,v,E,S),S.delete(I)),n(e,r,T)}}},6087:e=>{var t=Math.ceil,r=Math.max;e.exports=function(e,n,i,s){for(var o=-1,a=r(t((n-e)/(i||1)),0),c=Array(a);a--;)c[s?a:++o]=e,e+=i;return c}},5796:(e,t,r)=>{var n=r(8144),i=r(1251),s=r(4445);e.exports=function(e,t){return s(i(e,t,n),e+"")}},9987:(e,t,r)=>{var n=r(5618),i=r(1899),s=r(8144),o=i?function(e,t){return i(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:s;e.exports=o},890:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},2749:(e,t,r)=>{var n=r(3965),i=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},2124:e=>{e.exports=function(e){return function(t){return e(t)}}},7772:e=>{e.exports=function(e,t){return e.has(t)}},8559:(e,t,r)=>{var n=r(8144);e.exports=function(e){return"function"==typeof e?e:n}},4155:(e,t,r)=>{var n=r(9877);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},394:(e,t,r)=>{e=r.nmd(e);var n=r(6335),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,o=s&&s.exports===i?n.Buffer:void 0,a=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}},6796:(e,t,r)=>{var n=r(4155);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},4954:e=>{var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},8336:(e,t,r)=>{var n=r(9038),i=n?n.prototype:void 0,s=i?i.valueOf:void 0;e.exports=function(e){return s?Object(s.call(e)):{}}},3450:(e,t,r)=>{var n=r(4155);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},2753:e=>{e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},9666:(e,t,r)=>{var n=r(2685),i=r(1860);e.exports=function(e,t,r,s){var o=!r;r||(r={});for(var a=-1,c=t.length;++a<c;){var u=t[a],h=s?s(r[u],e[u],u,r,e):void 0;void 0===h&&(h=e[u]),o?i(r,u,h):n(r,u,h)}return r}},5383:(e,t,r)=>{var n=r(9666),i=r(8770);e.exports=function(e,t){return n(e,i(e),t)}},6465:(e,t,r)=>{var n=r(9666),i=r(61);e.exports=function(e,t){return n(e,i(e),t)}},9996:(e,t,r)=>{var n=r(6335)["__core-js_shared__"];e.exports=n},3301:(e,t,r)=>{var n=r(5796),i=r(5675);e.exports=function(e){return n((function(t,r){var n=-1,s=r.length,o=s>1?r[s-1]:void 0,a=s>2?r[2]:void 0;for(o=e.length>3&&"function"==typeof o?(s--,o):void 0,a&&i(r[0],r[1],a)&&(o=s<3?void 0:o,s=1),t=Object(t);++n<s;){var c=r[n];c&&e(t,c,n,o)}return t}))}},6523:e=>{e.exports=function(e){return function(t,r,n){for(var i=-1,s=Object(t),o=n(t),a=o.length;a--;){var c=o[e?a:++i];if(!1===r(s[c],c,s))break}return t}}},6421:(e,t,r)=>{var n=r(6087),i=r(5675),s=r(4430);e.exports=function(e){return function(t,r,o){return o&&"number"!=typeof o&&i(t,r,o)&&(r=o=void 0),t=s(t),void 0===r?(r=t,t=0):r=s(r),o=void 0===o?t<r?1:-1:s(o),n(t,r,o,e)}}},1899:(e,t,r)=>{var n=r(6271),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},3185:(e,t,r)=>{var n=r(2123),i=r(8891),s=r(7772);e.exports=function(e,t,r,o,a,c){var u=1&r,h=e.length,d=t.length;if(h!=d&&!(u&&d>h))return!1;var l=c.get(e),f=c.get(t);if(l&&f)return l==t&&f==e;var p=-1,y=!0,m=2&r?new n:void 0;for(c.set(e,t),c.set(t,e);++p<h;){var g=e[p],v=t[p];if(o)var b=u?o(v,g,p,t,e,c):o(g,v,p,e,t,c);if(void 0!==b){if(b)continue;y=!1;break}if(m){if(!i(t,(function(e,t){if(!s(m,t)&&(g===e||a(g,e,r,o,c)))return m.push(t)}))){y=!1;break}}else if(g!==v&&!a(g,v,r,o,c)){y=!1;break}}return c.delete(e),c.delete(t),y}},1578:(e,t,r)=>{var n=r(9038),i=r(9877),s=r(5821),o=r(3185),a=r(9212),c=r(6128),u=n?n.prototype:void 0,h=u?u.valueOf:void 0;e.exports=function(e,t,r,n,u,d,l){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!d(new i(e),new i(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return s(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var f=a;case"[object Set]":var p=1&n;if(f||(f=c),e.size!=t.size&&!p)return!1;var y=l.get(e);if(y)return y==t;n|=2,l.set(e,t);var m=o(f(e),f(t),n,u,d,l);return l.delete(e),m;case"[object Symbol]":if(h)return h.call(e)==h.call(t)}return!1}},9191:(e,t,r)=>{var n=r(989),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,s,o,a){var c=1&r,u=n(e),h=u.length;if(h!=n(t).length&&!c)return!1;for(var d=h;d--;){var l=u[d];if(!(c?l in t:i.call(t,l)))return!1}var f=a.get(e),p=a.get(t);if(f&&p)return f==t&&p==e;var y=!0;a.set(e,t),a.set(t,e);for(var m=c;++d<h;){var g=e[l=u[d]],v=t[l];if(s)var b=c?s(v,g,l,t,e,a):s(g,v,l,e,t,a);if(!(void 0===b?g===v||o(g,v,r,s,a):b)){y=!1;break}m||(m="constructor"==l)}if(y&&!m){var E=e.constructor,S=t.constructor;E==S||!("constructor"in e)||!("constructor"in t)||"function"==typeof E&&E instanceof E&&"function"==typeof S&&S instanceof S||(y=!1)}return a.delete(e),a.delete(t),y}},1593:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global;e.exports=t},989:(e,t,r)=>{var n=r(6907),i=r(8770),s=r(443);e.exports=function(e){return n(e,s,i)}},470:(e,t,r)=>{var n=r(6907),i=r(61),s=r(1989);e.exports=function(e){return n(e,s,i)}},2773:(e,t,r)=>{var n=r(7574);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},6271:(e,t,r)=>{var n=r(747),i=r(5104);e.exports=function(e,t){var r=i(e,t);return n(r)?r:void 0}},2388:(e,t,r)=>{var n=r(4227)(Object.getPrototypeOf,Object);e.exports=n},3877:(e,t,r)=>{var n=r(9038),i=Object.prototype,s=i.hasOwnProperty,o=i.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var i=o.call(e);return n&&(t?e[a]=r:delete e[a]),i}},8770:(e,t,r)=>{var n=r(9021),i=r(517),s=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,a=o?function(e){return null==e?[]:(e=Object(e),n(o(e),(function(t){return s.call(e,t)})))}:i;e.exports=a},61:(e,t,r)=>{var n=r(7952),i=r(2388),s=r(8770),o=r(517),a=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,s(e)),e=i(e);return t}:o;e.exports=a},6513:(e,t,r)=>{var n=r(2595),i=r(6041),s=r(9085),o=r(9307),a=r(713),c=r(3318),u=r(1763),h="[object Map]",d="[object Promise]",l="[object Set]",f="[object WeakMap]",p="[object DataView]",y=u(n),m=u(i),g=u(s),v=u(o),b=u(a),E=c;(n&&E(new n(new ArrayBuffer(1)))!=p||i&&E(new i)!=h||s&&E(s.resolve())!=d||o&&E(new o)!=l||a&&E(new a)!=f)&&(E=function(e){var t=c(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case y:return p;case m:return h;case g:return d;case v:return l;case b:return f}return t}),e.exports=E},5104:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},2638:(e,t,r)=>{var n=r(7836);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},760:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},3321:(e,t,r)=>{var n=r(7836),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return i.call(t,e)?t[e]:void 0}},3406:(e,t,r)=>{var n=r(7836),i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:i.call(t,e)}},9696:(e,t,r)=>{var n=r(7836);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},6773:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},7823:(e,t,r)=>{var n=r(4155),i=r(6796),s=r(4954),o=r(8336),a=r(3450);e.exports=function(e,t,r){var c=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new c(+e);case"[object DataView]":return i(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return a(e,r);case"[object Map]":case"[object Set]":return new c;case"[object Number]":case"[object String]":return new c(e);case"[object RegExp]":return s(e);case"[object Symbol]":return o(e)}}},1200:(e,t,r)=>{var n=r(1683),i=r(2388),s=r(6639);e.exports=function(e){return"function"!=typeof e.constructor||s(e)?{}:n(i(e))}},3089:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},5675:(e,t,r)=>{var n=r(5821),i=r(6970),s=r(3089),o=r(7774);e.exports=function(e,t,r){if(!o(r))return!1;var a=typeof t;return!!("number"==a?i(r)&&s(t,r.length):"string"==a&&t in r)&&n(r[t],e)}},7574:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},3642:(e,t,r)=>{var n,i=r(9996),s=(n=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!s&&s in e}},6639:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},4053:e=>{e.exports=function(){this.__data__=[],this.size=0}},1834:(e,t,r)=>{var n=r(803),i=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():i.call(t,r,1),--this.size,!0)}},5118:(e,t,r)=>{var n=r(803);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},5287:(e,t,r)=>{var n=r(803);e.exports=function(e){return n(this.__data__,e)>-1}},1277:(e,t,r)=>{var n=r(803);e.exports=function(e,t){var r=this.__data__,i=n(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this}},5669:(e,t,r)=>{var n=r(5666),i=r(6904),s=r(6041);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(s||i),string:new n}}},7078:(e,t,r)=>{var n=r(2773);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},9718:(e,t,r)=>{var n=r(2773);e.exports=function(e){return n(this,e).get(e)}},5176:(e,t,r)=>{var n=r(2773);e.exports=function(e){return n(this,e).has(e)}},2084:(e,t,r)=>{var n=r(2773);e.exports=function(e,t){var r=n(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this}},9212:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},7836:(e,t,r)=>{var n=r(6271)(Object,"create");e.exports=n},27:(e,t,r)=>{var n=r(4227)(Object.keys,Object);e.exports=n},7282:e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},4716:(e,t,r)=>{e=r.nmd(e);var n=r(1593),i=t&&!t.nodeType&&t,s=i&&e&&!e.nodeType&&e,o=s&&s.exports===i&&n.process,a=function(){try{var e=s&&s.require&&s.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=a},6706:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},4227:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},1251:(e,t,r)=>{var n=r(9378),i=Math.max;e.exports=function(e,t,r){return t=i(void 0===t?e.length-1:t,0),function(){for(var s=arguments,o=-1,a=i(s.length-t,0),c=Array(a);++o<a;)c[o]=s[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=s[o];return u[t]=r(c),n(e,this,u)}}},6335:(e,t,r)=>{var n=r(1593),i="object"==typeof self&&self&&self.Object===Object&&self,s=n||i||Function("return this")();e.exports=s},1992:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},9503:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},3999:e=>{e.exports=function(e){return this.__data__.has(e)}},6128:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},4445:(e,t,r)=>{var n=r(9987),i=r(9496)(n);e.exports=i},9496:e=>{var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var i=t(),s=16-(i-n);if(n=i,s>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},7459:(e,t,r)=>{var n=r(6904);e.exports=function(){this.__data__=new n,this.size=0}},9416:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},3411:e=>{e.exports=function(e){return this.__data__.get(e)}},3392:e=>{e.exports=function(e){return this.__data__.has(e)}},9544:(e,t,r)=>{var n=r(6904),i=r(6041),s=r(9159);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var o=r.__data__;if(!i||o.length<199)return o.push([e,t]),this.size=++r.size,this;r=this.__data__=new s(o)}return r.set(e,t),this.size=r.size,this}},1763:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},3965:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},5075:(e,t,r)=>{var n=r(1991);e.exports=function(e){return n(e,5)}},5618:e=>{e.exports=function(e){return function(){return e}}},5821:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},8144:e=>{e.exports=function(e){return e}},2892:(e,t,r)=>{var n=r(6763),i=r(2557),s=Object.prototype,o=s.hasOwnProperty,a=s.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return i(e)&&o.call(e,"callee")&&!a.call(e,"callee")};e.exports=c},1261:e=>{var t=Array.isArray;e.exports=t},6970:(e,t,r)=>{var n=r(4447),i=r(2441);e.exports=function(e){return null!=e&&i(e.length)&&!n(e)}},9160:(e,t,r)=>{var n=r(6970),i=r(2557);e.exports=function(e){return i(e)&&n(e)}},3347:(e,t,r)=>{e=r.nmd(e);var n=r(6335),i=r(5423),s=t&&!t.nodeType&&t,o=s&&e&&!e.nodeType&&e,a=o&&o.exports===s?n.Buffer:void 0,c=(a?a.isBuffer:void 0)||i;e.exports=c},8679:(e,t,r)=>{var n=r(8440);e.exports=function(e,t){return n(e,t)}},4447:(e,t,r)=>{var n=r(3318),i=r(7774);e.exports=function(e){if(!i(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},2441:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},5485:(e,t,r)=>{var n=r(5585),i=r(2124),s=r(4716),o=s&&s.isMap,a=o?i(o):n;e.exports=a},7774:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},2557:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},9638:(e,t,r)=>{var n=r(3318),i=r(2388),s=r(2557),o=Function.prototype,a=Object.prototype,c=o.toString,u=a.hasOwnProperty,h=c.call(Object);e.exports=function(e){if(!s(e)||"[object Object]"!=n(e))return!1;var t=i(e);if(null===t)return!0;var r=u.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==h}},3166:(e,t,r)=>{var n=r(9515),i=r(2124),s=r(4716),o=s&&s.isSet,a=o?i(o):n;e.exports=a},2991:(e,t,r)=>{var n=r(3318),i=r(2557);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==n(e)}},8398:(e,t,r)=>{var n=r(6455),i=r(2124),s=r(4716),o=s&&s.isTypedArray,a=o?i(o):n;e.exports=a},443:(e,t,r)=>{var n=r(4412),i=r(8769),s=r(6970);e.exports=function(e){return s(e)?n(e):i(e)}},1989:(e,t,r)=>{var n=r(4412),i=r(8098),s=r(6970);e.exports=function(e){return s(e)?n(e,!0):i(e)}},2816:(e,t,r)=>{var n=r(9159);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var o=e.apply(this,n);return r.cache=s.set(i,o)||s,o};return r.cache=new(i.Cache||n),r}i.Cache=n,e.exports=i},3458:(e,t,r)=>{var n=r(1979),i=r(3301)((function(e,t,r,i){n(e,t,r,i)}));e.exports=i},8862:(e,t,r)=>{var n=r(6421)();e.exports=n},517:e=>{e.exports=function(){return[]}},5423:e=>{e.exports=function(){return!1}},7273:(e,t,r)=>{var n=r(890),i=r(8559),s=r(5586),o=4294967295,a=Math.min;e.exports=function(e,t){if((e=s(e))<1||e>9007199254740991)return[];var r=o,c=a(e,o);t=i(t),e-=o;for(var u=n(c,t);++r<e;)t(r);return u}},4430:(e,t,r)=>{var n=r(1230),i=1/0;e.exports=function(e){return e?(e=n(e))===i||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},5586:(e,t,r)=>{var n=r(4430);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},1230:(e,t,r)=>{var n=r(2749),i=r(7774),s=r(2991),o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=a.test(e);return r||c.test(e)?u(e.slice(2),r?2:8):o.test(e)?NaN:+e}},1272:(e,t,r)=>{var n=r(9666),i=r(1989);e.exports=function(e){return n(e,i(e))}},1716:e=>{function t(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,r){if(e!=t)throw new Error(r||"Assertion failed: "+e+" != "+t)}},7765:(e,t)=>{"use strict";var r=t;function n(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",r=0;r<e.length;r++)t+=n(e[r].toString(16));return t}r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var n=0;n<e.length;n++)r[n]=0|e[n];return r}if("hex"===t){(e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e);for(n=0;n<e.length;n+=2)r.push(parseInt(e[n]+e[n+1],16))}else for(n=0;n<e.length;n++){var i=e.charCodeAt(n),s=i>>8,o=255&i;s?r.push(s,o):r.push(o)}return r},r.zero2=n,r.toHex=i,r.encode=function(e,t){return"hex"===t?i(e):e}},4476:e=>{var t=1e3,r=60*t,n=60*r,i=24*n,s=7*i,o=365.25*i;function a(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*s;case"days":case"day":case"d":return c*i;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*r;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var s=Math.abs(e);if(s>=i)return a(e,s,i,"day");if(s>=n)return a(e,s,n,"hour");if(s>=r)return a(e,s,r,"minute");if(s>=t)return a(e,s,t,"second");return e+" ms"}(e):function(e){var s=Math.abs(e);if(s>=i)return Math.round(e/i)+"d";if(s>=n)return Math.round(e/n)+"h";if(s>=r)return Math.round(e/r)+"m";if(s>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},1287:(e,t,r)=>{"use strict";const n=r(7616),i=process.hrtime(),s=(new Date).getTime();function o(){let e=process.hrtime(i);return n(s).times(1e6).add(n(e[0]).times(1e9).plus(e[1])).toString()}e.exports=o,e.exports.microseconds=e.exports.micro=function(){return n(o()).divide(1e3).toString()}},8342:()=>{var e;!function(e){!function(t){var r="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=i(e);function i(e,t){return function(r,n){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n}),t&&t(r,n)}}void 0===r.Reflect?r.Reflect=e:n=i(r.Reflect,n),function(e){var t=Object.prototype.hasOwnProperty,r="function"==typeof Symbol,n=r&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=r&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,o={__proto__:[]}instanceof Array,a=!s&&!o,c={create:s?function(){return ne(Object.create(null))}:o?function(){return ne({__proto__:null})}:function(){return ne({})},has:a?function(e,r){return t.call(e,r)}:function(e,t){return t in e},get:a?function(e,r){return t.call(e,r)?e[r]:void 0}:function(e,t){return e[t]}},u=Object.getPrototypeOf(Function),h="object"==typeof process&&process.env&&"true"===process.env.REFLECT_METADATA_USE_MAP_POLYFILL,d=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,l=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,f=new(h||"function"!=typeof WeakMap?re():WeakMap);function p(e,t,r,n){if(x(r)){if(!q(e))throw new TypeError;if(!z(t))throw new TypeError;return w(e,t)}if(!q(e))throw new TypeError;if(!k(t))throw new TypeError;if(!k(n)&&!x(n)&&!M(n))throw new TypeError;return M(n)&&(n=void 0),T(e,t,r=K(r),n)}function y(e,t){function r(r,n){if(!k(r))throw new TypeError;if(!x(n)&&!$(n))throw new TypeError;O(e,t,r,n)}return r}function m(e,t,r,n){if(!k(r))throw new TypeError;return x(n)||(n=K(n)),O(e,t,r,n)}function g(e,t,r){if(!k(t))throw new TypeError;return x(r)||(r=K(r)),_(e,t,r)}function v(e,t,r){if(!k(t))throw new TypeError;return x(r)||(r=K(r)),D(e,t,r)}function b(e,t,r){if(!k(t))throw new TypeError;return x(r)||(r=K(r)),R(e,t,r)}function E(e,t,r){if(!k(t))throw new TypeError;return x(r)||(r=K(r)),N(e,t,r)}function S(e,t){if(!k(e))throw new TypeError;return x(t)||(t=K(t)),U(e,t)}function A(e,t){if(!k(e))throw new TypeError;return x(t)||(t=K(t)),P(e,t)}function I(e,t,r){if(!k(t))throw new TypeError;x(r)||(r=K(r));var n=C(t,r,!1);if(x(n))return!1;if(!n.delete(e))return!1;if(n.size>0)return!0;var i=f.get(t);return i.delete(r),i.size>0||f.delete(t),!0}function w(e,t){for(var r=e.length-1;r>=0;--r){var n=(0,e[r])(t);if(!x(n)&&!M(n)){if(!z(n))throw new TypeError;t=n}}return t}function T(e,t,r,n){for(var i=e.length-1;i>=0;--i){var s=(0,e[i])(t,r,n);if(!x(s)&&!M(s)){if(!k(s))throw new TypeError;n=s}}return n}function C(e,t,r){var n=f.get(e);if(x(n)){if(!r)return;n=new d,f.set(e,n)}var i=n.get(t);if(x(i)){if(!r)return;i=new d,n.set(t,i)}return i}function _(e,t,r){if(D(e,t,r))return!0;var n=Z(t);return!M(n)&&_(e,n,r)}function D(e,t,r){var n=C(t,r,!1);return!x(n)&&H(n.has(e))}function R(e,t,r){if(D(e,t,r))return N(e,t,r);var n=Z(t);return M(n)?void 0:R(e,n,r)}function N(e,t,r){var n=C(t,r,!1);if(!x(n))return n.get(e)}function O(e,t,r,n){C(r,n,!0).set(e,t)}function U(e,t){var r=P(e,t),n=Z(e);if(null===n)return r;var i=U(n,t);if(i.length<=0)return r;if(r.length<=0)return i;for(var s=new l,o=[],a=0,c=r;a<c.length;a++){var u=c[a];s.has(u)||(s.add(u),o.push(u))}for(var h=0,d=i;h<d.length;h++){u=d[h];s.has(u)||(s.add(u),o.push(u))}return o}function P(e,t){var r=[],n=C(e,t,!1);if(x(n))return r;for(var i=Y(n.keys()),s=0;;){var o=J(i);if(!o)return r.length=s,r;var a=Q(o);try{r[s]=a}catch(e){try{X(i)}finally{throw e}}s++}}function B(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function x(e){return void 0===e}function M(e){return null===e}function L(e){return"symbol"==typeof e}function k(e){return"object"==typeof e?null!==e:"function"==typeof e}function F(e,t){switch(B(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",i=W(e,n);if(void 0!==i){var s=i.call(e,r);if(k(s))throw new TypeError;return s}return V(e,"default"===r?"number":r)}function V(e,t){if("string"===t){var r=e.toString;if(G(r))if(!k(i=r.call(e)))return i;if(G(n=e.valueOf))if(!k(i=n.call(e)))return i}else{var n;if(G(n=e.valueOf))if(!k(i=n.call(e)))return i;var i,s=e.toString;if(G(s))if(!k(i=s.call(e)))return i}throw new TypeError}function H(e){return!!e}function j(e){return""+e}function K(e){var t=F(e,3);return L(t)?t:j(t)}function q(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function G(e){return"function"==typeof e}function z(e){return"function"==typeof e}function $(e){switch(B(e)){case 3:case 4:return!0;default:return!1}}function W(e,t){var r=e[t];if(null!=r){if(!G(r))throw new TypeError;return r}}function Y(e){var t=W(e,i);if(!G(t))throw new TypeError;var r=t.call(e);if(!k(r))throw new TypeError;return r}function Q(e){return e.value}function J(e){var t=e.next();return!t.done&&t}function X(e){var t=e.return;t&&t.call(e)}function Z(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===u)return t;if(t!==u)return t;var r=e.prototype,n=r&&Object.getPrototypeOf(r);if(null==n||n===Object.prototype)return t;var i=n.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],r=function(){function e(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},t.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var n=this._keys.length,i=r+1;i<n;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new r(this._keys,this._values,n)},t.prototype.values=function(){return new r(this._keys,this._values,s)},t.prototype.entries=function(){return new r(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function n(e,t){return e}function s(e,t){return t}function o(e,t){return[e,t]}}function te(){return function(){function e(){this._map=new d}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function re(){var e=16,r=c.create(),n=i();return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=s(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=s(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return s(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=s(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}();function i(){var e;do{e="@@WeakMap@@"+u()}while(c.has(r,e));return r[e]=!0,e}function s(e,r){if(!t.call(e,n)){if(!r)return;Object.defineProperty(e,n,{value:c.create()})}return e[n]}function o(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function a(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):o(new Uint8Array(e),e):o(new Array(e),e)}function u(){var t=a(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",n=0;n<e;++n){var i=t[n];4!==n&&6!==n&&8!==n||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}function ne(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",y),e("defineMetadata",m),e("hasMetadata",g),e("hasOwnMetadata",v),e("getMetadata",b),e("getOwnMetadata",E),e("getMetadataKeys",S),e("getOwnMetadataKeys",A),e("deleteMetadata",I)}(n)}()}(e||(e={}))},2414:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventDisposer=t.Event=void 0;var r=function(){function e(){var e=this;this.event={stack:[],index:0},this.ended=!1,this.execute=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(e.ended)throw new Error("event completed");for(var n=0,i=e.event.stack;n<i.length;n++){var s=i[n];s.execute.apply(s,t)}},this.complete=function(){if(e.ended)throw new Error("event completed");for(var t=0,r=e.event.stack;t<r.length;t++){var n=r[t];n.complete&&n.complete()}e.allUnsubscribe(),e.ended=!0},this.error=function(t){if(e.ended)throw new Error("event completed");for(var r=0,n=e.event.stack;r<n.length;r++){var i=n[r];i.error&&i.error(t)}e.allUnsubscribe()},this.allUnsubscribe=function(){if(e.ended)throw new Error("event completed");e.event={stack:[],index:0}},this.subscribe=function(t,r,n){if(e.ended)throw new Error("event completed");var i=e.event.index;e.event.stack.push({execute:t,id:i,complete:r,error:n}),e.event.index++;var s=function(){e.event.stack=e.event.stack.filter((function(e){return e.id!==i&&e}))};return{unSubscribe:s,disposer:function(e){e.push(s)}}},this.once=function(t,r,n){var i=e.subscribe((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];i.unSubscribe(),t.apply(void 0,e)}),r,n)},this.watch=function(t,r){return new Promise((function(n,i){var s=r&&setTimeout((function(){i("Event watch timeout")}),r),o=e.subscribe((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=t.apply(void 0,e);i&&(s&&clearTimeout(s),o(),n(e))})).unSubscribe}))},this.asPromise=function(t){return new Promise((function(r,n){var i=t&&setTimeout((function(){n("Event asPromise timeout")}),t);e.once((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i&&clearTimeout(i),r(e)}),(function(){i&&clearTimeout(i),r([])}),(function(e){i&&clearTimeout(i),n(e)}))}))}}return Object.defineProperty(e.prototype,"returnTrigger",{get:function(){var e=this;return{execute:e.execute,error:e.error,complete:e.complete}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"returnListener",{get:function(){var e=this;return{subscribe:e.subscribe,once:e.once,asPromise:e.asPromise}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.event.stack.length},enumerable:!1,configurable:!0}),e}();t.Event=r;var n=function(){function e(){this._disposer=[]}return e.prototype.push=function(e){this._disposer.push(e)},e.prototype.dispose=function(){this._disposer.forEach((function(e){return e()})),this._disposer=[]},e}();t.EventDisposer=n},8226:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Buffer=void 0;var n=r(2414);t.Buffer=function(e,t){var r=new n.Event,i=[],s=!1;return t.subscribe((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];s||i.length!==e||(i.forEach((function(e){return r.execute.apply(r,e)})),s=!0),s?r.execute.apply(r,t):i.push(t)})),{subscribe:r.subscribe,asPromise:r.asPromise,once:r.once}}},8221:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2414);t.default=function(){var e=[];return{event:function(){var t=new n.Event;return e.push(t),t},finishAll:function(){e.forEach((function(e){return e.allUnsubscribe()})),e=[]}}}},7762:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1424),i=n.__importDefault(r(2275)),s=function(){function e(){this.candidates={}}return e.prototype.exist=function(e){return Object.keys(this.candidates).includes(e)},e.prototype.delete=function(e){delete this.candidates[e]},e.prototype.create=function(e,t){return n.__awaiter(this,void 0,void 0,(function(){var r,s;return n.__generator(this,(function(n){switch(n.label){case 0:return this.exist(e)?[2,{exist:this.candidates[e]}]:[3,1];case 1:return r=new i.default,this.candidates[e]=r,[4,t()];case 2:return s=n.sent(),r.execute.apply(r,s),this.delete(e),[2,{result:s}]}}))}))},e}();t.default=s},2275:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1424),i=r(2414);t.default=i.Event,n.__exportStar(r(2414),t),n.__exportStar(r(8221),t),n.__exportStar(r(7762),t),n.__exportStar(r(8226),t)},5455:(e,t,r)=>{"use strict";const n=r(2037),i=r(6224),s=r(6530),{env:o}=process;let a;function c(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function u(e,t){if(0===a)return 0;if(s("color=16m")||s("color=full")||s("color=truecolor"))return 3;if(s("color=256"))return 2;if(e&&!t&&void 0===a)return 0;const r=a||0;if("dumb"===o.TERM)return r;if("win32"===process.platform){const e=n.release().split(".");return Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in o)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some((e=>e in o))||"codeship"===o.CI_NAME?1:r;if("TEAMCITY_VERSION"in o)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(o.TEAMCITY_VERSION)?1:0;if("truecolor"===o.COLORTERM)return 3;if("TERM_PROGRAM"in o){const e=parseInt((o.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(o.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(o.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(o.TERM)||"COLORTERM"in o?1:r}s("no-color")||s("no-colors")||s("color=false")||s("color=never")?a=0:(s("color")||s("colors")||s("color=true")||s("color=always"))&&(a=1),"FORCE_COLOR"in o&&(a="true"===o.FORCE_COLOR?1:"false"===o.FORCE_COLOR?0:0===o.FORCE_COLOR.length?1:Math.min(parseInt(o.FORCE_COLOR,10),3)),e.exports={supportsColor:function(e){return c(u(e,e&&e.isTTY))},stdout:c(u(!0,i.isatty(1))),stderr:c(u(!0,i.isatty(2)))}},1424:(e,t,r)=>{"use strict";r.r(t),r.d(t,{__assign:()=>s,__asyncDelegator:()=>S,__asyncGenerator:()=>E,__asyncValues:()=>A,__await:()=>b,__awaiter:()=>h,__classPrivateFieldGet:()=>_,__classPrivateFieldIn:()=>R,__classPrivateFieldSet:()=>D,__createBinding:()=>l,__decorate:()=>a,__exportStar:()=>f,__extends:()=>i,__generator:()=>d,__importDefault:()=>C,__importStar:()=>T,__makeTemplateObject:()=>I,__metadata:()=>u,__param:()=>c,__read:()=>y,__rest:()=>o,__spread:()=>m,__spreadArray:()=>v,__spreadArrays:()=>g,__values:()=>p});var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},s.apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function a(e,t,r,n){var i,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(s<3?i(o):s>3?i(t,r,o):i(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,n){t(r,n,e)}}function u(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))}function d(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(o=0)),o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var l=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function f(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||l(t,e,r)}function p(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(y(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n}function v(e,t,r){if(r||2===arguments.length)for(var n,i=0,s=t.length;i<s;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function E(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),s=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){s.push([e,t,r,n])>1||a(e,t)}))})}function a(e,t){try{(r=i[e](t)).value instanceof b?Promise.resolve(r.value.v).then(c,u):h(s[0][2],r)}catch(e){h(s[0][3],e)}var r}function c(e){a("next",e)}function u(e){a("throw",e)}function h(e,t){e(t),s.shift(),s.length&&a(s[0][0],s[0][1])}}function S(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:b(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function A(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=p(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var w=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function T(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&l(t,e,r);return w(t,e),t}function C(e){return e&&e.__esModule?e:{default:e}}function _(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function D(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function R(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},2849:(e,t,r)=>{"use strict";const{createSlicedTable:n}=r(6434),i=r(2148),s=n(2197175160);e.exports=function(e){const t=Buffer.isBuffer(e)?e:Buffer.from(e);return(4294967295^i(s,t,4294967295,0))>>>0}},6865:e=>{"use strict";e.exports=function(e,t,r,n){let i=r;for(let r=n;r<t.length;r+=1){const n=t[r];i=e[0][255&(i^n)]^i>>>8}return i}},4969:(e,t,r)=>{"use strict";const n=r(6865);e.exports=function(e,t,r,i){let s=i,o=r;for(let r=s;r+4<t.length;r+=4){const n=t.readUInt32LE(r)^o;o=e[0][n>>>24&255]^e[1][n>>>16&255]^e[2][n>>>8&255]^e[3][255&n],s+=4}return n(e,t,o,s)}},2148:(e,t,r)=>{"use strict";const n=r(4969);e.exports=function(e,t,r,i){let s=i,o=r;for(let r=s;r+8<t.length;r+=8){const n=t.readUInt32LE(r)^o,i=t.readUInt32LE(r+4);o=e[0][i>>>24&255]^e[1][i>>>16&255]^e[2][i>>>8&255]^e[3][255&i]^e[4][n>>>24&255]^e[5][n>>>16&255]^e[6][n>>>8&255]^e[7][255&n],s+=8}return n(e,t,o,s)}},6434:e=>{"use strict";function t(e){const t=new Uint32Array(256);for(let r=0;r<t.length;r+=1){let n=r;for(let t=0;t<8;t+=1)n=1&n?n>>>1^e:n>>>1;t[r]=n}return t}e.exports={createTable:t,createSlicedTable:function(e){const r=new Array(8),n=t(e);r[0]=n;for(let e=1;e<r.length;e+=1){r[e]=new Uint32Array(256);for(let t=0;t<256;t+=1)r[e][t]=r[e-1][t]>>>8^r[0][255&r[e-1][t]]}return r}}},9100:(e,t,r)=>{!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},n=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var o=t(),a=t([1]),c=t([56129,1]),u=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),h=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),f=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function p(e,t,r,n){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=n>>24&255,e[t+5]=n>>16&255,e[t+6]=n>>8&255,e[t+7]=255&n}function y(e,t,r,n,i){var s,o=0;for(s=0;s<i;s++)o|=e[t+s]^r[n+s];return(1&o-1>>>8)-1}function m(e,t,r,n){return y(e,t,r,n,16)}function g(e,t,r,n){return y(e,t,r,n,32)}function v(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,h=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,d=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,v=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,E=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,S=s,A=o,I=a,w=c,T=u,C=h,_=d,D=l,R=f,N=p,O=y,U=m,P=g,B=v,x=b,M=E,L=0;L<20;L+=2)S^=(i=(P^=(i=(R^=(i=(T^=(i=S+P|0)<<7|i>>>25)+S|0)<<9|i>>>23)+T|0)<<13|i>>>19)+R|0)<<18|i>>>14,C^=(i=(A^=(i=(B^=(i=(N^=(i=C+A|0)<<7|i>>>25)+C|0)<<9|i>>>23)+N|0)<<13|i>>>19)+B|0)<<18|i>>>14,O^=(i=(_^=(i=(I^=(i=(x^=(i=O+_|0)<<7|i>>>25)+O|0)<<9|i>>>23)+x|0)<<13|i>>>19)+I|0)<<18|i>>>14,M^=(i=(U^=(i=(D^=(i=(w^=(i=M+U|0)<<7|i>>>25)+M|0)<<9|i>>>23)+w|0)<<13|i>>>19)+D|0)<<18|i>>>14,S^=(i=(w^=(i=(I^=(i=(A^=(i=S+w|0)<<7|i>>>25)+S|0)<<9|i>>>23)+A|0)<<13|i>>>19)+I|0)<<18|i>>>14,C^=(i=(T^=(i=(D^=(i=(_^=(i=C+T|0)<<7|i>>>25)+C|0)<<9|i>>>23)+_|0)<<13|i>>>19)+D|0)<<18|i>>>14,O^=(i=(N^=(i=(R^=(i=(U^=(i=O+N|0)<<7|i>>>25)+O|0)<<9|i>>>23)+U|0)<<13|i>>>19)+R|0)<<18|i>>>14,M^=(i=(x^=(i=(B^=(i=(P^=(i=M+x|0)<<7|i>>>25)+M|0)<<9|i>>>23)+P|0)<<13|i>>>19)+B|0)<<18|i>>>14;S=S+s|0,A=A+o|0,I=I+a|0,w=w+c|0,T=T+u|0,C=C+h|0,_=_+d|0,D=D+l|0,R=R+f|0,N=N+p|0,O=O+y|0,U=U+m|0,P=P+g|0,B=B+v|0,x=x+b|0,M=M+E|0,e[0]=S>>>0&255,e[1]=S>>>8&255,e[2]=S>>>16&255,e[3]=S>>>24&255,e[4]=A>>>0&255,e[5]=A>>>8&255,e[6]=A>>>16&255,e[7]=A>>>24&255,e[8]=I>>>0&255,e[9]=I>>>8&255,e[10]=I>>>16&255,e[11]=I>>>24&255,e[12]=w>>>0&255,e[13]=w>>>8&255,e[14]=w>>>16&255,e[15]=w>>>24&255,e[16]=T>>>0&255,e[17]=T>>>8&255,e[18]=T>>>16&255,e[19]=T>>>24&255,e[20]=C>>>0&255,e[21]=C>>>8&255,e[22]=C>>>16&255,e[23]=C>>>24&255,e[24]=_>>>0&255,e[25]=_>>>8&255,e[26]=_>>>16&255,e[27]=_>>>24&255,e[28]=D>>>0&255,e[29]=D>>>8&255,e[30]=D>>>16&255,e[31]=D>>>24&255,e[32]=R>>>0&255,e[33]=R>>>8&255,e[34]=R>>>16&255,e[35]=R>>>24&255,e[36]=N>>>0&255,e[37]=N>>>8&255,e[38]=N>>>16&255,e[39]=N>>>24&255,e[40]=O>>>0&255,e[41]=O>>>8&255,e[42]=O>>>16&255,e[43]=O>>>24&255,e[44]=U>>>0&255,e[45]=U>>>8&255,e[46]=U>>>16&255,e[47]=U>>>24&255,e[48]=P>>>0&255,e[49]=P>>>8&255,e[50]=P>>>16&255,e[51]=P>>>24&255,e[52]=B>>>0&255,e[53]=B>>>8&255,e[54]=B>>>16&255,e[55]=B>>>24&255,e[56]=x>>>0&255,e[57]=x>>>8&255,e[58]=x>>>16&255,e[59]=x>>>24&255,e[60]=M>>>0&255,e[61]=M>>>8&255,e[62]=M>>>16&255,e[63]=M>>>24&255}(e,t,r,n)}function b(e,t,r,n){!function(e,t,r,n){for(var i,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,o=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,c=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,u=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,h=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,d=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,f=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,p=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,y=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,m=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,g=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,v=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,b=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,E=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,S=0;S<20;S+=2)s^=(i=(g^=(i=(f^=(i=(u^=(i=s+g|0)<<7|i>>>25)+s|0)<<9|i>>>23)+u|0)<<13|i>>>19)+f|0)<<18|i>>>14,h^=(i=(o^=(i=(v^=(i=(p^=(i=h+o|0)<<7|i>>>25)+h|0)<<9|i>>>23)+p|0)<<13|i>>>19)+v|0)<<18|i>>>14,y^=(i=(d^=(i=(a^=(i=(b^=(i=y+d|0)<<7|i>>>25)+y|0)<<9|i>>>23)+b|0)<<13|i>>>19)+a|0)<<18|i>>>14,E^=(i=(m^=(i=(l^=(i=(c^=(i=E+m|0)<<7|i>>>25)+E|0)<<9|i>>>23)+c|0)<<13|i>>>19)+l|0)<<18|i>>>14,s^=(i=(c^=(i=(a^=(i=(o^=(i=s+c|0)<<7|i>>>25)+s|0)<<9|i>>>23)+o|0)<<13|i>>>19)+a|0)<<18|i>>>14,h^=(i=(u^=(i=(l^=(i=(d^=(i=h+u|0)<<7|i>>>25)+h|0)<<9|i>>>23)+d|0)<<13|i>>>19)+l|0)<<18|i>>>14,y^=(i=(p^=(i=(f^=(i=(m^=(i=y+p|0)<<7|i>>>25)+y|0)<<9|i>>>23)+m|0)<<13|i>>>19)+f|0)<<18|i>>>14,E^=(i=(b^=(i=(v^=(i=(g^=(i=E+b|0)<<7|i>>>25)+E|0)<<9|i>>>23)+g|0)<<13|i>>>19)+v|0)<<18|i>>>14;e[0]=s>>>0&255,e[1]=s>>>8&255,e[2]=s>>>16&255,e[3]=s>>>24&255,e[4]=h>>>0&255,e[5]=h>>>8&255,e[6]=h>>>16&255,e[7]=h>>>24&255,e[8]=y>>>0&255,e[9]=y>>>8&255,e[10]=y>>>16&255,e[11]=y>>>24&255,e[12]=E>>>0&255,e[13]=E>>>8&255,e[14]=E>>>16&255,e[15]=E>>>24&255,e[16]=d>>>0&255,e[17]=d>>>8&255,e[18]=d>>>16&255,e[19]=d>>>24&255,e[20]=l>>>0&255,e[21]=l>>>8&255,e[22]=l>>>16&255,e[23]=l>>>24&255,e[24]=f>>>0&255,e[25]=f>>>8&255,e[26]=f>>>16&255,e[27]=f>>>24&255,e[28]=p>>>0&255,e[29]=p>>>8&255,e[30]=p>>>16&255,e[31]=p>>>24&255}(e,t,r,n)}var E=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function S(e,t,r,n,i,s,o){var a,c,u=new Uint8Array(16),h=new Uint8Array(64);for(c=0;c<16;c++)u[c]=0;for(c=0;c<8;c++)u[c]=s[c];for(;i>=64;){for(v(h,u,o,E),c=0;c<64;c++)e[t+c]=r[n+c]^h[c];for(a=1,c=8;c<16;c++)a=a+(255&u[c])|0,u[c]=255&a,a>>>=8;i-=64,t+=64,n+=64}if(i>0)for(v(h,u,o,E),c=0;c<i;c++)e[t+c]=r[n+c]^h[c];return 0}function A(e,t,r,n,i){var s,o,a=new Uint8Array(16),c=new Uint8Array(64);for(o=0;o<16;o++)a[o]=0;for(o=0;o<8;o++)a[o]=n[o];for(;r>=64;){for(v(c,a,i,E),o=0;o<64;o++)e[t+o]=c[o];for(s=1,o=8;o<16;o++)s=s+(255&a[o])|0,a[o]=255&s,s>>>=8;r-=64,t+=64}if(r>0)for(v(c,a,i,E),o=0;o<r;o++)e[t+o]=c[o];return 0}function I(e,t,r,n,i){var s=new Uint8Array(32);b(s,n,i,E);for(var o=new Uint8Array(8),a=0;a<8;a++)o[a]=n[a+16];return A(e,t,r,o,s)}function w(e,t,r,n,i,s,o){var a=new Uint8Array(32);b(a,s,o,E);for(var c=new Uint8Array(8),u=0;u<8;u++)c[u]=s[u+16];return S(e,t,r,n,i,c,a)}var T=function(e){var t,r,n,i,s,o,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),n=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|n<<6),i=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(n>>>7|i<<9),s=255&e[8]|(255&e[9])<<8,this.r[4]=255&(i>>>4|s<<12),this.r[5]=s>>>1&8190,o=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(s>>>14|o<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(o>>>11|a<<5),c=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function C(e,t,r,n,i,s){var o=new T(s);return o.update(r,n,i),o.finish(e,t),0}function _(e,t,r,n,i,s){var o=new Uint8Array(16);return C(o,0,r,n,i,s),m(e,t,o,0)}function D(e,t,r,n,i){var s;if(r<32)return-1;for(w(e,0,t,0,r,n,i),C(e,16,e,32,r-32,e),s=0;s<16;s++)e[s]=0;return 0}function R(e,t,r,n,i){var s,o=new Uint8Array(32);if(r<32)return-1;if(I(o,0,32,n,i),0!==_(t,16,t,32,r-32,o))return-1;for(w(e,0,t,0,r,n,i),s=0;s<32;s++)e[s]=0;return 0}function N(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function O(e){var t,r,n=1;for(t=0;t<16;t++)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-65536*n;e[0]+=n-1+37*(n-1)}function U(e,t,r){for(var n,i=~(r-1),s=0;s<16;s++)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function P(e,r){var n,i,s,o=t(),a=t();for(n=0;n<16;n++)a[n]=r[n];for(O(a),O(a),O(a),i=0;i<2;i++){for(o[0]=a[0]-65517,n=1;n<15;n++)o[n]=a[n]-65535-(o[n-1]>>16&1),o[n-1]&=65535;o[15]=a[15]-32767-(o[14]>>16&1),s=o[15]>>16&1,o[14]&=65535,U(a,o,1-s)}for(n=0;n<16;n++)e[2*n]=255&a[n],e[2*n+1]=a[n]>>8}function B(e,t){var r=new Uint8Array(32),n=new Uint8Array(32);return P(r,e),P(n,t),g(r,0,n,0)}function x(e){var t=new Uint8Array(32);return P(t,e),1&t[0]}function M(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function L(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]+r[n]}function k(e,t,r){for(var n=0;n<16;n++)e[n]=t[n]-r[n]}function F(e,t,r){var n,i,s=0,o=0,a=0,c=0,u=0,h=0,d=0,l=0,f=0,p=0,y=0,m=0,g=0,v=0,b=0,E=0,S=0,A=0,I=0,w=0,T=0,C=0,_=0,D=0,R=0,N=0,O=0,U=0,P=0,B=0,x=0,M=r[0],L=r[1],k=r[2],F=r[3],V=r[4],H=r[5],j=r[6],K=r[7],q=r[8],G=r[9],z=r[10],$=r[11],W=r[12],Y=r[13],Q=r[14],J=r[15];s+=(n=t[0])*M,o+=n*L,a+=n*k,c+=n*F,u+=n*V,h+=n*H,d+=n*j,l+=n*K,f+=n*q,p+=n*G,y+=n*z,m+=n*$,g+=n*W,v+=n*Y,b+=n*Q,E+=n*J,o+=(n=t[1])*M,a+=n*L,c+=n*k,u+=n*F,h+=n*V,d+=n*H,l+=n*j,f+=n*K,p+=n*q,y+=n*G,m+=n*z,g+=n*$,v+=n*W,b+=n*Y,E+=n*Q,S+=n*J,a+=(n=t[2])*M,c+=n*L,u+=n*k,h+=n*F,d+=n*V,l+=n*H,f+=n*j,p+=n*K,y+=n*q,m+=n*G,g+=n*z,v+=n*$,b+=n*W,E+=n*Y,S+=n*Q,A+=n*J,c+=(n=t[3])*M,u+=n*L,h+=n*k,d+=n*F,l+=n*V,f+=n*H,p+=n*j,y+=n*K,m+=n*q,g+=n*G,v+=n*z,b+=n*$,E+=n*W,S+=n*Y,A+=n*Q,I+=n*J,u+=(n=t[4])*M,h+=n*L,d+=n*k,l+=n*F,f+=n*V,p+=n*H,y+=n*j,m+=n*K,g+=n*q,v+=n*G,b+=n*z,E+=n*$,S+=n*W,A+=n*Y,I+=n*Q,w+=n*J,h+=(n=t[5])*M,d+=n*L,l+=n*k,f+=n*F,p+=n*V,y+=n*H,m+=n*j,g+=n*K,v+=n*q,b+=n*G,E+=n*z,S+=n*$,A+=n*W,I+=n*Y,w+=n*Q,T+=n*J,d+=(n=t[6])*M,l+=n*L,f+=n*k,p+=n*F,y+=n*V,m+=n*H,g+=n*j,v+=n*K,b+=n*q,E+=n*G,S+=n*z,A+=n*$,I+=n*W,w+=n*Y,T+=n*Q,C+=n*J,l+=(n=t[7])*M,f+=n*L,p+=n*k,y+=n*F,m+=n*V,g+=n*H,v+=n*j,b+=n*K,E+=n*q,S+=n*G,A+=n*z,I+=n*$,w+=n*W,T+=n*Y,C+=n*Q,_+=n*J,f+=(n=t[8])*M,p+=n*L,y+=n*k,m+=n*F,g+=n*V,v+=n*H,b+=n*j,E+=n*K,S+=n*q,A+=n*G,I+=n*z,w+=n*$,T+=n*W,C+=n*Y,_+=n*Q,D+=n*J,p+=(n=t[9])*M,y+=n*L,m+=n*k,g+=n*F,v+=n*V,b+=n*H,E+=n*j,S+=n*K,A+=n*q,I+=n*G,w+=n*z,T+=n*$,C+=n*W,_+=n*Y,D+=n*Q,R+=n*J,y+=(n=t[10])*M,m+=n*L,g+=n*k,v+=n*F,b+=n*V,E+=n*H,S+=n*j,A+=n*K,I+=n*q,w+=n*G,T+=n*z,C+=n*$,_+=n*W,D+=n*Y,R+=n*Q,N+=n*J,m+=(n=t[11])*M,g+=n*L,v+=n*k,b+=n*F,E+=n*V,S+=n*H,A+=n*j,I+=n*K,w+=n*q,T+=n*G,C+=n*z,_+=n*$,D+=n*W,R+=n*Y,N+=n*Q,O+=n*J,g+=(n=t[12])*M,v+=n*L,b+=n*k,E+=n*F,S+=n*V,A+=n*H,I+=n*j,w+=n*K,T+=n*q,C+=n*G,_+=n*z,D+=n*$,R+=n*W,N+=n*Y,O+=n*Q,U+=n*J,v+=(n=t[13])*M,b+=n*L,E+=n*k,S+=n*F,A+=n*V,I+=n*H,w+=n*j,T+=n*K,C+=n*q,_+=n*G,D+=n*z,R+=n*$,N+=n*W,O+=n*Y,U+=n*Q,P+=n*J,b+=(n=t[14])*M,E+=n*L,S+=n*k,A+=n*F,I+=n*V,w+=n*H,T+=n*j,C+=n*K,_+=n*q,D+=n*G,R+=n*z,N+=n*$,O+=n*W,U+=n*Y,P+=n*Q,B+=n*J,E+=(n=t[15])*M,o+=38*(A+=n*k),a+=38*(I+=n*F),c+=38*(w+=n*V),u+=38*(T+=n*H),h+=38*(C+=n*j),d+=38*(_+=n*K),l+=38*(D+=n*q),f+=38*(R+=n*G),p+=38*(N+=n*z),y+=38*(O+=n*$),m+=38*(U+=n*W),g+=38*(P+=n*Y),v+=38*(B+=n*Q),b+=38*(x+=n*J),s=(n=(s+=38*(S+=n*L))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),E=(n=E+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),v=(n=v+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),E=(n=E+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),e[0]=s,e[1]=o,e[2]=a,e[3]=c,e[4]=u,e[5]=h,e[6]=d,e[7]=l,e[8]=f,e[9]=p,e[10]=y,e[11]=m,e[12]=g,e[13]=v,e[14]=b,e[15]=E}function V(e,t){F(e,t,t)}function H(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=253;n>=0;n--)V(i,i),2!==n&&4!==n&&F(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function j(e,r){var n,i=t();for(n=0;n<16;n++)i[n]=r[n];for(n=250;n>=0;n--)V(i,i),1!==n&&F(i,i,r);for(n=0;n<16;n++)e[n]=i[n]}function K(e,r,n){var i,s,o=new Uint8Array(32),a=new Float64Array(80),u=t(),h=t(),d=t(),l=t(),f=t(),p=t();for(s=0;s<31;s++)o[s]=r[s];for(o[31]=127&r[31]|64,o[0]&=248,M(a,n),s=0;s<16;s++)h[s]=a[s],l[s]=u[s]=d[s]=0;for(u[0]=l[0]=1,s=254;s>=0;--s)U(u,h,i=o[s>>>3]>>>(7&s)&1),U(d,l,i),L(f,u,d),k(u,u,d),L(d,h,l),k(h,h,l),V(l,f),V(p,u),F(u,d,u),F(d,h,f),L(f,u,d),k(u,u,d),V(h,u),k(d,l,p),F(u,d,c),L(u,u,l),F(d,d,u),F(u,l,p),F(l,h,a),V(h,f),U(u,h,i),U(d,l,i);for(s=0;s<16;s++)a[s+16]=u[s],a[s+32]=d[s],a[s+48]=h[s],a[s+64]=l[s];var y=a.subarray(32),m=a.subarray(16);return H(y,y),F(m,m,y),P(e,m),0}function q(e,t){return K(e,t,s)}function G(e,t){return n(t,32),q(e,t)}function z(e,t,r){var n=new Uint8Array(32);return K(n,r,t),b(e,i,n,E)}T.prototype.blocks=function(e,t,r){for(var n,i,s,o,a,c,u,h,d,l,f,p,y,m,g,v,b,E,S,A=this.fin?0:2048,I=this.h[0],w=this.h[1],T=this.h[2],C=this.h[3],_=this.h[4],D=this.h[5],R=this.h[6],N=this.h[7],O=this.h[8],U=this.h[9],P=this.r[0],B=this.r[1],x=this.r[2],M=this.r[3],L=this.r[4],k=this.r[5],F=this.r[6],V=this.r[7],H=this.r[8],j=this.r[9];r>=16;)l=d=0,l+=(I+=8191&(n=255&e[t+0]|(255&e[t+1])<<8))*P,l+=(w+=8191&(n>>>13|(i=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*j),l+=(T+=8191&(i>>>10|(s=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*H),l+=(C+=8191&(s>>>7|(o=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*V),d=(l+=(_+=8191&(o>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*F))>>>13,l&=8191,l+=(D+=a>>>1&8191)*(5*k),l+=(R+=8191&(a>>>14|(c=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*L),l+=(N+=8191&(c>>>11|(u=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*M),l+=(O+=8191&(u>>>8|(h=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*x),f=d+=(l+=(U+=h>>>5|A)*(5*B))>>>13,f+=I*B,f+=w*P,f+=T*(5*j),f+=C*(5*H),d=(f+=_*(5*V))>>>13,f&=8191,f+=D*(5*F),f+=R*(5*k),f+=N*(5*L),f+=O*(5*M),d+=(f+=U*(5*x))>>>13,f&=8191,p=d,p+=I*x,p+=w*B,p+=T*P,p+=C*(5*j),d=(p+=_*(5*H))>>>13,p&=8191,p+=D*(5*V),p+=R*(5*F),p+=N*(5*k),p+=O*(5*L),y=d+=(p+=U*(5*M))>>>13,y+=I*M,y+=w*x,y+=T*B,y+=C*P,d=(y+=_*(5*j))>>>13,y&=8191,y+=D*(5*H),y+=R*(5*V),y+=N*(5*F),y+=O*(5*k),m=d+=(y+=U*(5*L))>>>13,m+=I*L,m+=w*M,m+=T*x,m+=C*B,d=(m+=_*P)>>>13,m&=8191,m+=D*(5*j),m+=R*(5*H),m+=N*(5*V),m+=O*(5*F),g=d+=(m+=U*(5*k))>>>13,g+=I*k,g+=w*L,g+=T*M,g+=C*x,d=(g+=_*B)>>>13,g&=8191,g+=D*P,g+=R*(5*j),g+=N*(5*H),g+=O*(5*V),v=d+=(g+=U*(5*F))>>>13,v+=I*F,v+=w*k,v+=T*L,v+=C*M,d=(v+=_*x)>>>13,v&=8191,v+=D*B,v+=R*P,v+=N*(5*j),v+=O*(5*H),b=d+=(v+=U*(5*V))>>>13,b+=I*V,b+=w*F,b+=T*k,b+=C*L,d=(b+=_*M)>>>13,b&=8191,b+=D*x,b+=R*B,b+=N*P,b+=O*(5*j),E=d+=(b+=U*(5*H))>>>13,E+=I*H,E+=w*V,E+=T*F,E+=C*k,d=(E+=_*L)>>>13,E&=8191,E+=D*M,E+=R*x,E+=N*B,E+=O*P,S=d+=(E+=U*(5*j))>>>13,S+=I*j,S+=w*H,S+=T*V,S+=C*F,d=(S+=_*k)>>>13,S&=8191,S+=D*L,S+=R*M,S+=N*x,S+=O*B,I=l=8191&(d=(d=((d+=(S+=U*P)>>>13)<<2)+d|0)+(l&=8191)|0),w=f+=d>>>=13,T=p&=8191,C=y&=8191,_=m&=8191,D=g&=8191,R=v&=8191,N=b&=8191,O=E&=8191,U=S&=8191,t+=16,r-=16;this.h[0]=I,this.h[1]=w,this.h[2]=T,this.h[3]=C,this.h[4]=_,this.h[5]=D,this.h[6]=R,this.h[7]=N,this.h[8]=O,this.h[9]=U},T.prototype.finish=function(e,t){var r,n,i,s,o=new Uint16Array(10);if(this.leftover){for(s=this.leftover,this.buffer[s++]=1;s<16;s++)this.buffer[s]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,s=2;s<10;s++)this.h[s]+=r,r=this.h[s]>>>13,this.h[s]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,o[0]=this.h[0]+5,r=o[0]>>>13,o[0]&=8191,s=1;s<10;s++)o[s]=this.h[s]+r,r=o[s]>>>13,o[s]&=8191;for(o[9]-=8192,n=(1^r)-1,s=0;s<10;s++)o[s]&=n;for(n=~n,s=0;s<10;s++)this.h[s]=this.h[s]&n|o[s];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),i=this.h[0]+this.pad[0],this.h[0]=65535&i,s=1;s<8;s++)i=(this.h[s]+this.pad[s]|0)+(i>>>16)|0,this.h[s]=65535&i;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},T.prototype.update=function(e,t,r){var n,i;if(this.leftover){for((i=16-this.leftover)>r&&(i=r),n=0;n<i;n++)this.buffer[this.leftover+n]=e[t+n];if(r-=i,t+=i,this.leftover+=i,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(i=r-r%16,this.blocks(e,t,i),t+=i,r-=i),r){for(n=0;n<r;n++)this.buffer[this.leftover+n]=e[t+n];this.leftover+=r}};var $=D,W=R;var Y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Q(e,t,r,n){for(var i,s,o,a,c,u,h,d,l,f,p,y,m,g,v,b,E,S,A,I,w,T,C,_,D,R,N=new Int32Array(16),O=new Int32Array(16),U=e[0],P=e[1],B=e[2],x=e[3],M=e[4],L=e[5],k=e[6],F=e[7],V=t[0],H=t[1],j=t[2],K=t[3],q=t[4],G=t[5],z=t[6],$=t[7],W=0;n>=128;){for(A=0;A<16;A++)I=8*A+W,N[A]=r[I+0]<<24|r[I+1]<<16|r[I+2]<<8|r[I+3],O[A]=r[I+4]<<24|r[I+5]<<16|r[I+6]<<8|r[I+7];for(A=0;A<80;A++)if(i=U,s=P,o=B,a=x,c=M,u=L,h=k,F,l=V,f=H,p=j,y=K,m=q,g=G,v=z,$,C=65535&(T=$),_=T>>>16,D=65535&(w=F),R=w>>>16,C+=65535&(T=(q>>>14|M<<18)^(q>>>18|M<<14)^(M>>>9|q<<23)),_+=T>>>16,D+=65535&(w=(M>>>14|q<<18)^(M>>>18|q<<14)^(q>>>9|M<<23)),R+=w>>>16,C+=65535&(T=q&G^~q&z),_+=T>>>16,D+=65535&(w=M&L^~M&k),R+=w>>>16,C+=65535&(T=Y[2*A+1]),_+=T>>>16,D+=65535&(w=Y[2*A]),R+=w>>>16,w=N[A%16],_+=(T=O[A%16])>>>16,D+=65535&w,R+=w>>>16,D+=(_+=(C+=65535&T)>>>16)>>>16,C=65535&(T=S=65535&C|_<<16),_=T>>>16,D=65535&(w=E=65535&D|(R+=D>>>16)<<16),R=w>>>16,C+=65535&(T=(V>>>28|U<<4)^(U>>>2|V<<30)^(U>>>7|V<<25)),_+=T>>>16,D+=65535&(w=(U>>>28|V<<4)^(V>>>2|U<<30)^(V>>>7|U<<25)),R+=w>>>16,_+=(T=V&H^V&j^H&j)>>>16,D+=65535&(w=U&P^U&B^P&B),R+=w>>>16,d=65535&(D+=(_+=(C+=65535&T)>>>16)>>>16)|(R+=D>>>16)<<16,b=65535&C|_<<16,C=65535&(T=y),_=T>>>16,D=65535&(w=a),R=w>>>16,_+=(T=S)>>>16,D+=65535&(w=E),R+=w>>>16,P=i,B=s,x=o,M=a=65535&(D+=(_+=(C+=65535&T)>>>16)>>>16)|(R+=D>>>16)<<16,L=c,k=u,F=h,U=d,H=l,j=f,K=p,q=y=65535&C|_<<16,G=m,z=g,$=v,V=b,A%16==15)for(I=0;I<16;I++)w=N[I],C=65535&(T=O[I]),_=T>>>16,D=65535&w,R=w>>>16,w=N[(I+9)%16],C+=65535&(T=O[(I+9)%16]),_+=T>>>16,D+=65535&w,R+=w>>>16,E=N[(I+1)%16],C+=65535&(T=((S=O[(I+1)%16])>>>1|E<<31)^(S>>>8|E<<24)^(S>>>7|E<<25)),_+=T>>>16,D+=65535&(w=(E>>>1|S<<31)^(E>>>8|S<<24)^E>>>7),R+=w>>>16,E=N[(I+14)%16],_+=(T=((S=O[(I+14)%16])>>>19|E<<13)^(E>>>29|S<<3)^(S>>>6|E<<26))>>>16,D+=65535&(w=(E>>>19|S<<13)^(S>>>29|E<<3)^E>>>6),R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,N[I]=65535&D|R<<16,O[I]=65535&C|_<<16;C=65535&(T=V),_=T>>>16,D=65535&(w=U),R=w>>>16,w=e[0],_+=(T=t[0])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[0]=U=65535&D|R<<16,t[0]=V=65535&C|_<<16,C=65535&(T=H),_=T>>>16,D=65535&(w=P),R=w>>>16,w=e[1],_+=(T=t[1])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[1]=P=65535&D|R<<16,t[1]=H=65535&C|_<<16,C=65535&(T=j),_=T>>>16,D=65535&(w=B),R=w>>>16,w=e[2],_+=(T=t[2])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[2]=B=65535&D|R<<16,t[2]=j=65535&C|_<<16,C=65535&(T=K),_=T>>>16,D=65535&(w=x),R=w>>>16,w=e[3],_+=(T=t[3])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[3]=x=65535&D|R<<16,t[3]=K=65535&C|_<<16,C=65535&(T=q),_=T>>>16,D=65535&(w=M),R=w>>>16,w=e[4],_+=(T=t[4])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[4]=M=65535&D|R<<16,t[4]=q=65535&C|_<<16,C=65535&(T=G),_=T>>>16,D=65535&(w=L),R=w>>>16,w=e[5],_+=(T=t[5])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[5]=L=65535&D|R<<16,t[5]=G=65535&C|_<<16,C=65535&(T=z),_=T>>>16,D=65535&(w=k),R=w>>>16,w=e[6],_+=(T=t[6])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[6]=k=65535&D|R<<16,t[6]=z=65535&C|_<<16,C=65535&(T=$),_=T>>>16,D=65535&(w=F),R=w>>>16,w=e[7],_+=(T=t[7])>>>16,D+=65535&w,R+=w>>>16,R+=(D+=(_+=(C+=65535&T)>>>16)>>>16)>>>16,e[7]=F=65535&D|R<<16,t[7]=$=65535&C|_<<16,W+=128,n-=128}return n}function J(e,t,r){var n,i=new Int32Array(8),s=new Int32Array(8),o=new Uint8Array(256),a=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,Q(i,s,t,r),r%=128,n=0;n<r;n++)o[n]=t[a-r+n];for(o[r]=128,o[(r=256-128*(r<112?1:0))-9]=0,p(o,r-8,a/536870912|0,a<<3),Q(i,s,o,r),n=0;n<8;n++)p(e,8*n,i[n],s[n]);return 0}function X(e,r){var n=t(),i=t(),s=t(),o=t(),a=t(),c=t(),u=t(),d=t(),l=t();k(n,e[1],e[0]),k(l,r[1],r[0]),F(n,n,l),L(i,e[0],e[1]),L(l,r[0],r[1]),F(i,i,l),F(s,e[3],r[3]),F(s,s,h),F(o,e[2],r[2]),L(o,o,o),k(a,i,n),k(c,o,s),L(u,o,s),L(d,i,n),F(e[0],a,c),F(e[1],d,u),F(e[2],u,c),F(e[3],a,d)}function Z(e,t,r){var n;for(n=0;n<4;n++)U(e[n],t[n],r)}function ee(e,r){var n=t(),i=t(),s=t();H(s,r[2]),F(n,r[0],s),F(i,r[1],s),P(e,i),e[31]^=x(n)<<7}function te(e,t,r){var n,i;for(N(e[0],o),N(e[1],a),N(e[2],a),N(e[3],o),i=255;i>=0;--i)Z(e,t,n=r[i/8|0]>>(7&i)&1),X(t,e),X(e,e),Z(e,t,n)}function re(e,r){var n=[t(),t(),t(),t()];N(n[0],d),N(n[1],l),N(n[2],a),F(n[3],d,l),te(e,n,r)}function ne(e,r,i){var s,o=new Uint8Array(64),a=[t(),t(),t(),t()];for(i||n(r,32),J(o,r,32),o[0]&=248,o[31]&=127,o[31]|=64,re(a,o),ee(e,a),s=0;s<32;s++)r[s+32]=e[s];return 0}var ie=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function se(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*ie[i-(n-32)],r=Math.floor((t[i]+128)/256),t[i]-=256*r;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;i++)t[i]+=r-(t[31]>>4)*ie[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;i++)t[i]-=r*ie[i];for(n=0;n<32;n++)t[n+1]+=t[n]>>8,e[n]=255&t[n]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;se(e,r)}function ae(e,r,n,i){var s,o,a=new Uint8Array(64),c=new Uint8Array(64),u=new Uint8Array(64),h=new Float64Array(64),d=[t(),t(),t(),t()];J(a,i,32),a[0]&=248,a[31]&=127,a[31]|=64;var l=n+64;for(s=0;s<n;s++)e[64+s]=r[s];for(s=0;s<32;s++)e[32+s]=a[32+s];for(J(u,e.subarray(32),n+32),oe(u),re(d,u),ee(e,d),s=32;s<64;s++)e[s]=i[s];for(J(c,e,n+64),oe(c),s=0;s<64;s++)h[s]=0;for(s=0;s<32;s++)h[s]=u[s];for(s=0;s<32;s++)for(o=0;o<32;o++)h[s+o]+=c[s]*a[o];return se(e.subarray(32),h),l}function ce(e,r,n,i){var s,c=new Uint8Array(32),h=new Uint8Array(64),d=[t(),t(),t(),t()],l=[t(),t(),t(),t()];if(n<64)return-1;if(function(e,r){var n=t(),i=t(),s=t(),c=t(),h=t(),d=t(),l=t();return N(e[2],a),M(e[1],r),V(s,e[1]),F(c,s,u),k(s,s,e[2]),L(c,e[2],c),V(h,c),V(d,h),F(l,d,h),F(n,l,s),F(n,n,c),j(n,n),F(n,n,s),F(n,n,c),F(n,n,c),F(e[0],n,c),V(i,e[0]),F(i,i,c),B(i,s)&&F(e[0],e[0],f),V(i,e[0]),F(i,i,c),B(i,s)?-1:(x(e[0])===r[31]>>7&&k(e[0],o,e[0]),F(e[3],e[0],e[1]),0)}(l,i))return-1;for(s=0;s<n;s++)e[s]=r[s];for(s=0;s<32;s++)e[s+32]=i[s];if(J(h,e,n),oe(h),te(d,l,h),re(l,r.subarray(32)),X(d,l),ee(c,d),n-=64,g(r,0,c,0)){for(s=0;s<n;s++)e[s]=0;return-1}for(s=0;s<n;s++)e[s]=r[s+64];return n}var ue=16,he=64,de=32,le=64;function fe(e,t){if(32!==e.length)throw new Error("bad key size");if(24!==t.length)throw new Error("bad nonce size")}function pe(){for(var e=0;e<arguments.length;e++)if(!(arguments[e]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function ye(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:b,crypto_stream_xor:w,crypto_stream:I,crypto_stream_salsa20_xor:S,crypto_stream_salsa20:A,crypto_onetimeauth:C,crypto_onetimeauth_verify:_,crypto_verify_16:m,crypto_verify_32:g,crypto_secretbox:D,crypto_secretbox_open:R,crypto_scalarmult:K,crypto_scalarmult_base:q,crypto_box_beforenm:z,crypto_box_afternm:$,crypto_box:function(e,t,r,n,i,s){var o=new Uint8Array(32);return z(o,i,s),$(e,t,r,n,o)},crypto_box_open:function(e,t,r,n,i,s){var o=new Uint8Array(32);return z(o,i,s),W(e,t,r,n,o)},crypto_box_keypair:G,crypto_hash:J,crypto_sign:ae,crypto_sign_keypair:ne,crypto_sign_open:ce,crypto_secretbox_KEYBYTES:32,crypto_secretbox_NONCEBYTES:24,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:ue,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:32,crypto_box_SECRETKEYBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:he,crypto_sign_PUBLICKEYBYTES:de,crypto_sign_SECRETKEYBYTES:le,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64,gf:t,D:u,L:ie,pack25519:P,unpack25519:M,M:F,A:L,S:V,Z:k,pow2523:j,add:X,set25519:N,modL:se,scalarmult:te,scalarbase:re},e.randomBytes=function(e){var t=new Uint8Array(e);return n(t,e),t},e.secretbox=function(e,t,r){pe(e,t,r),fe(r,t);for(var n=new Uint8Array(32+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+32]=e[s];return D(i,n,n.length,t,r),i.subarray(ue)},e.secretbox.open=function(e,t,r){pe(e,t,r),fe(r,t);for(var n=new Uint8Array(ue+e.length),i=new Uint8Array(n.length),s=0;s<e.length;s++)n[s+ue]=e[s];return n.length<32||0!==R(i,n,n.length,t,r)?null:i.subarray(32)},e.secretbox.keyLength=32,e.secretbox.nonceLength=24,e.secretbox.overheadLength=ue,e.scalarMult=function(e,t){if(pe(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return K(r,e,t),r},e.scalarMult.base=function(e){if(pe(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return q(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox(t,r,s)},e.box.before=function(e,t){pe(e,t),function(e,t){if(32!==e.length)throw new Error("bad public key size");if(32!==t.length)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return z(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,n,i){var s=e.box.before(n,i);return e.secretbox.open(t,r,s)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(32);return G(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(pe(e),32!==e.length)throw new Error("bad secret key size");var t=new Uint8Array(32);return q(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=32,e.box.secretKeyLength=32,e.box.sharedKeyLength=32,e.box.nonceLength=24,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(pe(e,t),t.length!==le)throw new Error("bad secret key size");var r=new Uint8Array(he+e.length);return ae(r,e,e.length,t),r},e.sign.open=function(e,t){if(pe(e,t),t.length!==de)throw new Error("bad public key size");var r=new Uint8Array(e.length),n=ce(r,e,e.length,t);if(n<0)return null;for(var i=new Uint8Array(n),s=0;s<i.length;s++)i[s]=r[s];return i},e.sign.detached=function(t,r){for(var n=e.sign(t,r),i=new Uint8Array(he),s=0;s<i.length;s++)i[s]=n[s];return i},e.sign.detached.verify=function(e,t,r){if(pe(e,t,r),t.length!==he)throw new Error("bad signature size");if(r.length!==de)throw new Error("bad public key size");var n,i=new Uint8Array(he+e.length),s=new Uint8Array(he+e.length);for(n=0;n<he;n++)i[n]=t[n];for(n=0;n<e.length;n++)i[n+he]=e[n];return ce(s,i,i.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(de),t=new Uint8Array(le);return ne(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(pe(e),e.length!==le)throw new Error("bad secret key size");for(var t=new Uint8Array(de),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(pe(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(de),r=new Uint8Array(le),n=0;n<32;n++)r[n]=e[n];return ne(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=de,e.sign.secretKeyLength=le,e.sign.seedLength=32,e.sign.signatureLength=he,e.hash=function(e){pe(e);var t=new Uint8Array(64);return J(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return pe(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===y(e,0,t,0,e.length))},e.setPRNG=function(e){n=e},function(){var t="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){e.setPRNG((function(e,r){var n,i=new Uint8Array(r);for(n=0;n<r;n+=65536)t.getRandomValues(i.subarray(n,n+Math.min(r-n,65536)));for(n=0;n<r;n++)e[n]=i[n];ye(i)}))}else(t=r(6113))&&t.randomBytes&&e.setPRNG((function(e,r){var n,i=t.randomBytes(r);for(n=0;n<r;n++)e[n]=i[n];ye(i)}))}()}(e.exports?e.exports:self.nacl=self.nacl||{})},2751:(e,t,r)=>{var n=t,{Buffer:i}=r(4300),s=r(2037);n.toBuffer=function(e,t,r){var n;if(r=~~r,this.isV4Format(e))n=t||new i(r+4),e.split(/\./g).map((e=>{n[r++]=255&parseInt(e,10)}));else if(this.isV6Format(e)){var s,o=e.split(":",8);for(s=0;s<o.length;s++){var a;this.isV4Format(o[s])&&(a=this.toBuffer(o[s]),o[s]=a.slice(0,2).toString("hex")),a&&++s<8&&o.splice(s,0,a.slice(2,4).toString("hex"))}if(""===o[0])for(;o.length<8;)o.unshift("0");else if(""===o[o.length-1])for(;o.length<8;)o.push("0");else if(o.length<8){for(s=0;s<o.length&&""!==o[s];s++);var c=[s,1];for(s=9-o.length;s>0;s--)c.push("0");o.splice.apply(o,c)}for(n=t||new i(r+16),s=0;s<o.length;s++){var u=parseInt(o[s],16);n[r++]=u>>8&255,n[r++]=255&u}}if(!n)throw Error(`Invalid ip address: ${e}`);return n},n.toString=function(e,t,r){t=~~t;var n,i=[];if(4===(r=r||e.length-t)){for(n=0;n<r;n++)i.push(e[t+n]);i=i.join(".")}else if(16===r){for(n=0;n<r;n+=2)i.push(e.readUInt16BE(t+n).toString(16));i=(i=(i=i.join(":")).replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3")).replace(/:{3,4}/,"::")}return i};var o=/^(\d{1,3}\.){3,3}\d{1,3}$/,a=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;function c(e){return 4===e?"ipv4":6===e?"ipv6":e?e.toLowerCase():"ipv4"}n.isV4Format=function(e){return o.test(e)},n.isV6Format=function(e){return a.test(e)},n.fromPrefixLen=function(e,t){var r=4;"ipv6"===(t=e>32?"ipv6":c(t))&&(r=16);for(var s=new i(r),o=0,a=s.length;o<a;++o){var u=8;e<8&&(u=e),e-=u,s[o]=255&~(255>>u)}return n.toString(s)},n.mask=function(e,t){e=n.toBuffer(e),t=n.toBuffer(t);var r,s=new i(Math.max(e.length,t.length));if(e.length===t.length)for(r=0;r<e.length;r++)s[r]=e[r]&t[r];else if(4===t.length)for(r=0;r<t.length;r++)s[r]=e[e.length-4+r]&t[r];else{for(r=0;r<s.length-6;r++)s[r]=0;for(s[10]=255,s[11]=255,r=0;r<e.length;r++)s[r+12]=e[r]&t[r+12];r+=12}for(;r<s.length;r++)s[r]=0;return n.toString(s)},n.cidr=function(e){var t=e.split("/"),r=t[0];if(2!==t.length)throw new Error(`invalid CIDR subnet: ${r}`);var i=n.fromPrefixLen(parseInt(t[1],10));return n.mask(r,i)},n.subnet=function(e,t){for(var r=n.toLong(n.mask(e,t)),i=n.toBuffer(t),s=0,o=0;o<i.length;o++)if(255===i[o])s+=8;else for(var a=255&i[o];a;)a=a<<1&255,s++;var c=Math.pow(2,32-s);return{networkAddress:n.fromLong(r),firstAddress:c<=2?n.fromLong(r):n.fromLong(r+1),lastAddress:c<=2?n.fromLong(r+c-1):n.fromLong(r+c-2),broadcastAddress:n.fromLong(r+c-1),subnetMask:t,subnetMaskLength:s,numHosts:c<=2?c:c-2,length:c,contains:e=>r===n.toLong(n.mask(e,t))}},n.cidrSubnet=function(e){var t=e.split("/"),r=t[0];if(2!==t.length)throw new Error(`invalid CIDR subnet: ${r}`);var i=n.fromPrefixLen(parseInt(t[1],10));return n.subnet(r,i)},n.not=function(e){for(var t=n.toBuffer(e),r=0;r<t.length;r++)t[r]=255^t[r];return n.toString(t)},n.or=function(e,t){var r;if(e=n.toBuffer(e),t=n.toBuffer(t),e.length===t.length){for(r=0;r<e.length;++r)e[r]|=t[r];return n.toString(e)}var i=e,s=t;t.length>e.length&&(i=t,s=e);var o=i.length-s.length;for(r=o;r<i.length;++r)i[r]|=s[r-o];return n.toString(i)},n.isEqual=function(e,t){var r;if(e=n.toBuffer(e),t=n.toBuffer(t),e.length===t.length){for(r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}if(4===t.length){var i=t;t=e,e=i}for(r=0;r<10;r++)if(0!==t[r])return!1;var s=t.readUInt16BE(10);if(0!==s&&65535!==s)return!1;for(r=0;r<4;r++)if(e[r]!==t[r+12])return!1;return!0},n.isPrivate=function(e){return/^(::f{4}:)?10\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?192\.168\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?172\.(1[6-9]|2\d|30|31)\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^(::f{4}:)?169\.254\.([0-9]{1,3})\.([0-9]{1,3})$/i.test(e)||/^f[cd][0-9a-f]{2}:/i.test(e)||/^fe80:/i.test(e)||/^::1$/.test(e)||/^::$/.test(e)},n.isPublic=function(e){return!n.isPrivate(e)},n.isLoopback=function(e){return/^(::f{4}:)?127\.([0-9]{1,3})\.([0-9]{1,3})\.([0-9]{1,3})/.test(e)||/^fe80::1$/.test(e)||/^::1$/.test(e)||/^::$/.test(e)},n.loopback=function(e){if("ipv4"!==(e=c(e))&&"ipv6"!==e)throw new Error("family must be ipv4 or ipv6");return"ipv4"===e?"127.0.0.1":"fe80::1"},n.address=function(e,t){var r=s.networkInterfaces();if(t=c(t),e&&"private"!==e&&"public"!==e){var i=r[e].filter((e=>c(e.family)===t));if(0===i.length)return;return i[0].address}var o=Object.keys(r).map((i=>{var s=r[i].filter((r=>(r.family=c(r.family),r.family===t&&!n.isLoopback(r.address)&&(!e||("public"===e?n.isPrivate(r.address):n.isPublic(r.address))))));return s.length?s[0].address:void 0})).filter(Boolean);return o.length?o[0]:n.loopback(t)},n.toLong=function(e){var t=0;return e.split(".").forEach((e=>{t<<=8,t+=parseInt(e)})),t>>>0},n.fromLong=function(e){return`${e>>>24}.${e>>16&255}.${e>>8&255}.${255&e}`}},3211:e=>{"use strict";class t extends Error{constructor(e){super(e||"Promise was canceled"),this.name="CancelError"}get isCanceled(){return!0}}class r{static fn(e){return(...t)=>new r(((r,n,i)=>{t.push(i),e(...t).then(r,n)}))}constructor(e){this._cancelHandlers=[],this._isPending=!0,this._isCanceled=!1,this._rejectOnCancel=!0,this._promise=new Promise(((t,r)=>{this._reject=r;const n=e=>{if(!this._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");this._cancelHandlers.push(e)};return Object.defineProperties(n,{shouldReject:{get:()=>this._rejectOnCancel,set:e=>{this._rejectOnCancel=e}}}),e((e=>{this._isCanceled&&n.shouldReject||(this._isPending=!1,t(e))}),(e=>{this._isPending=!1,r(e)}),n)}))}then(e,t){return this._promise.then(e,t)}catch(e){return this._promise.catch(e)}finally(e){return this._promise.finally(e)}cancel(e){if(this._isPending&&!this._isCanceled){if(this._isCanceled=!0,this._cancelHandlers.length>0)try{for(const e of this._cancelHandlers)e()}catch(e){return void this._reject(e)}this._rejectOnCancel&&this._reject(new t(e))}}get isCanceled(){return this._isCanceled}}Object.setPrototypeOf(r.prototype,Promise.prototype),e.exports=r,e.exports.CancelError=t},7199:(e,t,r)=>{var n=r(7163).Symbol;e.exports=n},6190:(e,t,r)=>{var n=r(7199),i=r(4211),s=r(7951),o=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":o&&o in Object(e)?i(e):s(e)}},9433:(e,t,r)=>{var n=r(4139),i=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(i,""):e}},9758:e=>{var t="object"==typeof global&&global&&global.Object===Object&&global;e.exports=t},4211:(e,t,r)=>{var n=r(7199),i=Object.prototype,s=i.hasOwnProperty,o=i.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=s.call(e,a),r=e[a];try{e[a]=void 0;var n=!0}catch(e){}var i=o.call(e);return n&&(t?e[a]=r:delete e[a]),i}},7951:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},7163:(e,t,r)=>{var n=r(9758),i="object"==typeof self&&self&&self.Object===Object&&self,s=n||i||Function("return this")();e.exports=s},4139:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},4519:(e,t,r)=>{var n=r(5264),i=r(2567),s=r(8389),o=Math.max,a=Math.min;e.exports=function(e,t,r){var c,u,h,d,l,f,p=0,y=!1,m=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var r=c,n=u;return c=u=void 0,p=t,d=e.apply(n,r)}function b(e){return p=e,l=setTimeout(S,t),y?v(e):d}function E(e){var r=e-f;return void 0===f||r>=t||r<0||m&&e-p>=h}function S(){var e=i();if(E(e))return A(e);l=setTimeout(S,function(e){var r=t-(e-f);return m?a(r,h-(e-p)):r}(e))}function A(e){return l=void 0,g&&c?v(e):(c=u=void 0,d)}function I(){var e=i(),r=E(e);if(c=arguments,u=this,f=e,r){if(void 0===l)return b(f);if(m)return clearTimeout(l),l=setTimeout(S,t),v(f)}return void 0===l&&(l=setTimeout(S,t)),d}return t=s(t)||0,n(r)&&(y=!!r.leading,h=(m="maxWait"in r)?o(s(r.maxWait)||0,t):h,g="trailing"in r?!!r.trailing:g),I.cancel=function(){void 0!==l&&clearTimeout(l),p=0,c=f=u=l=void 0},I.flush=function(){return void 0===l?d:A(i())},I}},5264:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3057:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},3384:(e,t,r)=>{var n=r(6190),i=r(3057);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==n(e)}},2567:(e,t,r)=>{var n=r(7163);e.exports=function(){return n.Date.now()}},2499:(e,t,r)=>{var n=r(4519),i=r(5264);e.exports=function(e,t,r){var s=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(r)&&(s="leading"in r?!!r.leading:s,o="trailing"in r?!!r.trailing:o),n(e,t,{leading:s,maxWait:t,trailing:o})}},8389:(e,t,r)=>{var n=r(9433),i=r(5264),s=r(3384),o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(s(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=a.test(e);return r||c.test(e)?u(e.slice(2),r?2:8):o.test(e)?NaN:+e}},7446:(e,t,r)=>{const n=r(6691),i=r(5111),{mkdirpNative:s,mkdirpNativeSync:o}=r(9278),{mkdirpManual:a,mkdirpManualSync:c}=r(2649),{useNative:u,useNativeSync:h}=r(264),d=(e,t)=>(e=i(e),t=n(t),u(t)?s(e,t):a(e,t));d.sync=(e,t)=>(e=i(e),t=n(t),h(t)?o(e,t):c(e,t)),d.native=(e,t)=>s(i(e),n(t)),d.manual=(e,t)=>a(i(e),n(t)),d.nativeSync=(e,t)=>o(i(e),n(t)),d.manualSync=(e,t)=>c(i(e),n(t)),e.exports=d},7301:(e,t,r)=>{const{dirname:n}=r(1017),i=(e,t,r)=>r===t?Promise.resolve():e.statAsync(t).then((e=>e.isDirectory()?r:void 0),(r=>"ENOENT"===r.code?i(e,n(t),t):void 0)),s=(e,t,r)=>{if(r!==t)try{return e.statSync(t).isDirectory()?r:void 0}catch(r){return"ENOENT"===r.code?s(e,n(t),t):void 0}};e.exports={findMade:i,findMadeSync:s}},2649:(e,t,r)=>{const{dirname:n}=r(1017),i=(e,t,r)=>{t.recursive=!1;const s=n(e);return s===e?t.mkdirAsync(e,t).catch((e=>{if("EISDIR"!==e.code)throw e})):t.mkdirAsync(e,t).then((()=>r||e),(n=>{if("ENOENT"===n.code)return i(s,t).then((r=>i(e,t,r)));if("EEXIST"!==n.code&&"EROFS"!==n.code)throw n;return t.statAsync(e).then((e=>{if(e.isDirectory())return r;throw n}),(()=>{throw n}))}))},s=(e,t,r)=>{const i=n(e);if(t.recursive=!1,i===e)try{return t.mkdirSync(e,t)}catch(e){if("EISDIR"!==e.code)throw e;return}try{return t.mkdirSync(e,t),r||e}catch(n){if("ENOENT"===n.code)return s(e,t,s(i,t,r));if("EEXIST"!==n.code&&"EROFS"!==n.code)throw n;try{if(!t.statSync(e).isDirectory())throw n}catch(e){throw n}}};e.exports={mkdirpManual:i,mkdirpManualSync:s}},9278:(e,t,r)=>{const{dirname:n}=r(1017),{findMade:i,findMadeSync:s}=r(7301),{mkdirpManual:o,mkdirpManualSync:a}=r(2649);e.exports={mkdirpNative:(e,t)=>{t.recursive=!0;return n(e)===e?t.mkdirAsync(e,t):i(t,e).then((r=>t.mkdirAsync(e,t).then((()=>r)).catch((r=>{if("ENOENT"===r.code)return o(e,t);throw r}))))},mkdirpNativeSync:(e,t)=>{t.recursive=!0;if(n(e)===e)return t.mkdirSync(e,t);const r=s(t,e);try{return t.mkdirSync(e,t),r}catch(r){if("ENOENT"===r.code)return a(e,t);throw r}}}},6691:(e,t,r)=>{const{promisify:n}=r(3837),i=r(7147);e.exports=e=>{if(e)if("object"==typeof e)e={mode:511,fs:i,...e};else if("number"==typeof e)e={mode:e,fs:i};else{if("string"!=typeof e)throw new TypeError("invalid options argument");e={mode:parseInt(e,8),fs:i}}else e={mode:511,fs:i};return e.mkdir=e.mkdir||e.fs.mkdir||i.mkdir,e.mkdirAsync=n(e.mkdir),e.stat=e.stat||e.fs.stat||i.stat,e.statAsync=n(e.stat),e.statSync=e.statSync||e.fs.statSync||i.statSync,e.mkdirSync=e.mkdirSync||e.fs.mkdirSync||i.mkdirSync,e}},5111:(e,t,r)=>{const n=process.env.__TESTING_MKDIRP_PLATFORM__||process.platform,{resolve:i,parse:s}=r(1017);e.exports=e=>{if(/\0/.test(e))throw Object.assign(new TypeError("path must be a string without null bytes"),{path:e,code:"ERR_INVALID_ARG_VALUE"});if(e=i(e),"win32"===n){const t=/[*|"<>?:]/,{root:r}=s(e);if(t.test(e.substr(r.length)))throw Object.assign(new Error("Illegal characters in path."),{path:e,code:"EINVAL"})}return e}},264:(e,t,r)=>{const n=r(7147),i=(process.env.__TESTING_MKDIRP_NODE_VERSION__||process.version).replace(/^v/,"").split("."),s=+i[0]>10||10==+i[0]&&+i[1]>=12,o=s?e=>e.mkdir===n.mkdir:()=>!1,a=s?e=>e.mkdirSync===n.mkdirSync:()=>!1;e.exports={useNative:o,useNativeSync:a}},3079:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.MixinDeviceBase=t.ScryptedDeviceBase=void 0,i(r(3261),t);const s=r(3261);class o extends s.DeviceBase{constructor(e){super(),this.nativeId=e}get storage(){return this._storage||(this._storage=deviceManager.getDeviceStorage(this.nativeId)),this._storage}get log(){return this._log||(this._log=deviceManager.getDeviceLogger(this.nativeId)),this._log}get console(){return this._console||(this._console=deviceManager.getDeviceConsole(this.nativeId)),this._console}async createMediaObject(e,t){return mediaManager.createMediaObject(e,t,{sourceId:this.id})}getMediaObjectConsole(e){return"string"!=typeof e.sourceId?this.console:deviceManager.getMixinConsole(e.sourceId,this.nativeId)}_lazyLoadDeviceState(){this._deviceState||(this.nativeId?this._deviceState=deviceManager.getDeviceState(this.nativeId):this._deviceState=deviceManager.getDeviceState())}onDeviceEvent(e,t){return deviceManager.onDeviceEvent(this.nativeId,e,t)}}t.ScryptedDeviceBase=o;class a extends s.DeviceBase{constructor(e){super(),this._listeners=new Set,this.nativeId=systemManager.getDeviceById(this.id)?.nativeId,this.mixinDevice=e.mixinDevice,this.mixinDeviceInterfaces=e.mixinDeviceInterfaces,this.mixinStorageSuffix=e.mixinStorageSuffix,this._deviceState=e.mixinDeviceState,this._deviceState.__rpcproxy_traps_all_properties&&deviceManager.createDeviceState&&"string"==typeof this._deviceState.id&&(this._deviceState=deviceManager.createDeviceState(this._deviceState.id,this._deviceState.setState)),this.mixinProviderNativeId=e.mixinProviderNativeId}get storage(){if(!this._storage){const e=this.mixinStorageSuffix,t=this.id+(e?":"+e:"");this._storage=deviceManager.getMixinStorage(t,this.mixinProviderNativeId)}return this._storage}get console(){return this._console||(deviceManager.getMixinConsole?this._console=deviceManager.getMixinConsole(this.id,this.mixinProviderNativeId):this._console=deviceManager.getDeviceConsole(this.mixinProviderNativeId)),this._console}async createMediaObject(e,t){return mediaManager.createMediaObject(e,t,{sourceId:this.id})}getMediaObjectConsole(e){return"string"!=typeof e.sourceId?this.console:deviceManager.getMixinConsole(e.sourceId,this.mixinProviderNativeId)}onDeviceEvent(e,t){return deviceManager.onMixinEvent(this.id,this,e,t)}_lazyLoadDeviceState(){}manageListener(e){this._listeners.add(e)}release(){for(const e of this._listeners)e.removeListener()}}t.MixinDeviceBase=a,function(){function e(e){return function(){return this._lazyLoadDeviceState(),this._deviceState?.[e]}}function t(e){return function(t){this._lazyLoadDeviceState(),this._deviceState?this._deviceState[e]=t:console.warn("device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.")}}for(const r of Object.values(s.ScryptedInterfaceProperty))r!==s.ScryptedInterfaceProperty.nativeId&&(Object.defineProperty(o.prototype,r,{set:t(r),get:e(r)}),Object.defineProperty(a.prototype,r,{set:t(r),get:e(r)}))}();let c={};try{let e;try{e=pluginRuntimeAPI}catch(e){}c=Object.assign(c,{log:deviceManager.getDeviceLogger(void 0),deviceManager,endpointManager,mediaManager,systemManager,pluginHostAPI,...e});try{systemManager.setScryptedInterfaceDescriptors?.(s.TYPES_VERSION,s.ScryptedInterfaceDescriptors)?.catch((()=>{}))}catch(e){}}catch(e){console.error("sdk initialization error, import @scrypted/types or use @scrypted/client instead",e)}t.default=c},9383:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.StorageSettings=void 0;const o=s(r(3079)),{systemManager:a}=o.default;t.StorageSettings=class{constructor(e,t){this.device=e,this.settings=t,this.values={},this.hasValue={};for(const e of Object.keys(t)){const r=t[e],n=()=>this.getItem(e);let i;i="clippath"!==r.type?n:()=>{try{return JSON.parse(n())}catch(e){}},Object.defineProperty(this.values,e,{get:i,set:t=>this.putSetting(e,t),enumerable:!0}),Object.defineProperty(this.hasValue,e,{get:()=>null!=this.device.storage.getItem(e),enumerable:!0})}}get keys(){const e={};for(const t of Object.keys(this.settings))e[t]=t;return e}async getSettings(){const e=await(this.options?.onGet?.()),t=[];for(const[r,n]of Object.entries(this.settings)){let i=Object.assign({},n);e?.[r]&&(i=Object.assign(i,e[r])),i.onGet&&(i=Object.assign(i,await i.onGet())),i.hide||await(this.options?.hide?.[r]?.())||(i.key=r,i.value=this.getItemInternal(r,i),t.push(i),delete i.onPut,delete i.onGet,delete i.mapPut,delete i.mapGet)}return t}async putSetting(e,t){const r=this.settings[e];let n;return r&&(n=this.getItemInternal(e,r)),this.putSettingInternal(r,n,e,t)}putSettingInternal(e,t,r,n){e?.noStore||(e?.mapPut&&(n=e.mapPut(t,n)),"object"==typeof n?this.device.storage.setItem(r,JSON.stringify(n)):this.device.storage.setItem(r,n?.toString())),e?.onPut?.(t,n),this.device.onDeviceEvent(o.ScryptedInterface.Settings,void 0)}getItemInternal(e,t){if(!t)return this.device.storage.getItem(e);const r=function(e,t,r){const n=t.multiple?"array":t.type;if("boolean"===n)return"true"===e||"false"!==e&&(r()||!1);if("number"===n)return parseFloat(e)||r()||0;if("integer"===n)return parseInt(e)||r()||0;if("array"===n)try{return JSON.parse(e)}catch(e){return r()||[]}if("device"===n)return a.getDeviceById(e);if(e&&t.json)try{return JSON.parse(e)}catch(e){return r()}return e||r()}(this.device.storage.getItem(e),t,(()=>t.persistedDefaultValue?(this.putSettingInternal(t,void 0,e,t.persistedDefaultValue),t.persistedDefaultValue):t.defaultValue));return t.mapGet?t.mapGet(r):r}getItem(e){return this.getItemInternal(e,this.settings[e])}}},3261:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScryptedMimeTypes=t.ScryptedInterface=t.MediaPlayerState=t.SecuritySystemObstruction=t.SecuritySystemMode=t.AirQuality=t.LockState=t.ThermostatMode=t.TemperatureUnit=t.FanMode=t.HumidityMode=t.ScryptedDeviceType=t.ScryptedInterfaceDescriptors=t.ScryptedInterfaceMethod=t.ScryptedInterfaceProperty=t.DeviceBase=t.TYPES_VERSION=void 0,t.TYPES_VERSION="0.2.63";t.DeviceBase=class{},function(e){e.id="id",e.info="info",e.interfaces="interfaces",e.mixins="mixins",e.name="name",e.nativeId="nativeId",e.pluginId="pluginId",e.providedInterfaces="providedInterfaces",e.providedName="providedName",e.providedRoom="providedRoom",e.providedType="providedType",e.providerId="providerId",e.room="room",e.type="type",e.on="on",e.brightness="brightness",e.colorTemperature="colorTemperature",e.rgb="rgb",e.hsv="hsv",e.running="running",e.paused="paused",e.docked="docked",e.temperatureSetting="temperatureSetting",e.thermostatActiveMode="thermostatActiveMode",e.thermostatAvailableModes="thermostatAvailableModes",e.thermostatMode="thermostatMode",e.thermostatSetpoint="thermostatSetpoint",e.thermostatSetpointHigh="thermostatSetpointHigh",e.thermostatSetpointLow="thermostatSetpointLow",e.temperature="temperature",e.temperatureUnit="temperatureUnit",e.humidity="humidity",e.ptzCapabilities="ptzCapabilities",e.lockState="lockState",e.entryOpen="entryOpen",e.batteryLevel="batteryLevel",e.online="online",e.fromMimeType="fromMimeType",e.toMimeType="toMimeType",e.binaryState="binaryState",e.tampered="tampered",e.powerDetected="powerDetected",e.audioDetected="audioDetected",e.motionDetected="motionDetected",e.ambientLight="ambientLight",e.occupied="occupied",e.flooded="flooded",e.ultraviolet="ultraviolet",e.luminance="luminance",e.position="position",e.securitySystemState="securitySystemState",e.pm10Density="pm10Density",e.pm25Density="pm25Density",e.vocDensity="vocDensity",e.noxDensity="noxDensity",e.co2ppm="co2ppm",e.airQuality="airQuality",e.humiditySetting="humiditySetting",e.fan="fan",e.applicationInfo="applicationInfo"}(t.ScryptedInterfaceProperty||(t.ScryptedInterfaceProperty={})),function(e){e.listen="listen",e.probe="probe",e.setName="setName",e.setRoom="setRoom",e.setType="setType",e.getPluginJson="getPluginJson",e.turnOff="turnOff",e.turnOn="turnOn",e.setBrightness="setBrightness",e.getTemperatureMaxK="getTemperatureMaxK",e.getTemperatureMinK="getTemperatureMinK",e.setColorTemperature="setColorTemperature",e.setRgb="setRgb",e.setHsv="setHsv",e.sendNotification="sendNotification",e.start="start",e.stop="stop",e.pause="pause",e.resume="resume",e.dock="dock",e.setTemperature="setTemperature",e.setThermostatMode="setThermostatMode",e.setThermostatSetpoint="setThermostatSetpoint",e.setThermostatSetpointHigh="setThermostatSetpointHigh",e.setThermostatSetpointLow="setThermostatSetpointLow",e.setTemperatureUnit="setTemperatureUnit",e.getPictureOptions="getPictureOptions",e.takePicture="takePicture",e.getAudioStream="getAudioStream",e.startDisplay="startDisplay",e.stopDisplay="stopDisplay",e.getVideoStream="getVideoStream",e.getVideoStreamOptions="getVideoStreamOptions",e.getRecordingStream="getRecordingStream",e.getRecordingStreamCurrentTime="getRecordingStreamCurrentTime",e.getRecordingStreamOptions="getRecordingStreamOptions",e.getRecordingStreamThumbnail="getRecordingStreamThumbnail",e.ptzCommand="ptzCommand",e.getRecordedEvents="getRecordedEvents",e.getVideoClip="getVideoClip",e.getVideoClipThumbnail="getVideoClipThumbnail",e.getVideoClips="getVideoClips",e.removeVideoClips="removeVideoClips",e.setVideoStreamOptions="setVideoStreamOptions",e.startIntercom="startIntercom",e.stopIntercom="stopIntercom",e.lock="lock",e.unlock="unlock",e.addPassword="addPassword",e.getPasswords="getPasswords",e.removePassword="removePassword",e.activate="activate",e.deactivate="deactivate",e.isReversible="isReversible",e.closeEntry="closeEntry",e.openEntry="openEntry",e.getDevice="getDevice",e.releaseDevice="releaseDevice",e.adoptDevice="adoptDevice",e.discoverDevices="discoverDevices",e.createDevice="createDevice",e.getCreateDeviceSettings="getCreateDeviceSettings",e.getRefreshFrequency="getRefreshFrequency",e.refresh="refresh",e.getMediaStatus="getMediaStatus",e.load="load",e.seek="seek",e.skipNext="skipNext",e.skipPrevious="skipPrevious",e.convert="convert",e.getSettings="getSettings",e.putSetting="putSetting",e.armSecuritySystem="armSecuritySystem",e.disarmSecuritySystem="disarmSecuritySystem",e.getReadmeMarkdown="getReadmeMarkdown",e.getOauthUrl="getOauthUrl",e.onOauthCallback="onOauthCallback",e.canMixin="canMixin",e.getMixin="getMixin",e.releaseMixin="releaseMixin",e.onRequest="onRequest",e.onConnection="onConnection",e.onPush="onPush",e.run="run",e.eval="eval",e.loadScripts="loadScripts",e.saveScript="saveScript",e.trackObjects="trackObjects",e.getDetectionInput="getDetectionInput",e.getObjectTypes="getObjectTypes",e.detectObjects="detectObjects",e.getDetectionModel="getDetectionModel",e.setHumidity="setHumidity",e.setFan="setFan",e.startRTCSignalingSession="startRTCSignalingSession",e.createRTCSignalingSession="createRTCSignalingSession",e.getScryptedUserAccessControl="getScryptedUserAccessControl"}(t.ScryptedInterfaceMethod||(t.ScryptedInterfaceMethod={})),t.ScryptedInterfaceDescriptors={ScryptedDevice:{name:"ScryptedDevice",methods:["listen","probe","setName","setRoom","setType"],properties:["id","info","interfaces","mixins","name","nativeId","pluginId","providedInterfaces","providedName","providedRoom","providedType","providerId","room","type"]},ScryptedPlugin:{name:"ScryptedPlugin",methods:["getPluginJson"],properties:[]},OnOff:{name:"OnOff",methods:["turnOff","turnOn"],properties:["on"]},Brightness:{name:"Brightness",methods:["setBrightness"],properties:["brightness"]},ColorSettingTemperature:{name:"ColorSettingTemperature",methods:["getTemperatureMaxK","getTemperatureMinK","setColorTemperature"],properties:["colorTemperature"]},ColorSettingRgb:{name:"ColorSettingRgb",methods:["setRgb"],properties:["rgb"]},ColorSettingHsv:{name:"ColorSettingHsv",methods:["setHsv"],properties:["hsv"]},Notifier:{name:"Notifier",methods:["sendNotification"],properties:[]},StartStop:{name:"StartStop",methods:["start","stop"],properties:["running"]},Pause:{name:"Pause",methods:["pause","resume"],properties:["paused"]},Dock:{name:"Dock",methods:["dock"],properties:["docked"]},TemperatureSetting:{name:"TemperatureSetting",methods:["setTemperature","setThermostatMode","setThermostatSetpoint","setThermostatSetpointHigh","setThermostatSetpointLow"],properties:["temperatureSetting","thermostatActiveMode","thermostatAvailableModes","thermostatMode","thermostatSetpoint","thermostatSetpointHigh","thermostatSetpointLow"]},Thermometer:{name:"Thermometer",methods:["setTemperatureUnit"],properties:["temperature","temperatureUnit"]},HumiditySensor:{name:"HumiditySensor",methods:[],properties:["humidity"]},Camera:{name:"Camera",methods:["getPictureOptions","takePicture"],properties:[]},Microphone:{name:"Microphone",methods:["getAudioStream"],properties:[]},Display:{name:"Display",methods:["startDisplay","stopDisplay"],properties:[]},VideoCamera:{name:"VideoCamera",methods:["getVideoStream","getVideoStreamOptions"],properties:[]},VideoRecorder:{name:"VideoRecorder",methods:["getRecordingStream","getRecordingStreamCurrentTime","getRecordingStreamOptions","getRecordingStreamThumbnail"],properties:[]},PanTiltZoom:{name:"PanTiltZoom",methods:["ptzCommand"],properties:["ptzCapabilities"]},EventRecorder:{name:"EventRecorder",methods:["getRecordedEvents"],properties:[]},VideoClips:{name:"VideoClips",methods:["getVideoClip","getVideoClipThumbnail","getVideoClips","removeVideoClips"],properties:[]},VideoCameraConfiguration:{name:"VideoCameraConfiguration",methods:["setVideoStreamOptions"],properties:[]},Intercom:{name:"Intercom",methods:["startIntercom","stopIntercom"],properties:[]},Lock:{name:"Lock",methods:["lock","unlock"],properties:["lockState"]},PasswordStore:{name:"PasswordStore",methods:["addPassword","getPasswords","removePassword"],properties:[]},Scene:{name:"Scene",methods:["activate","deactivate","isReversible"],properties:[]},Entry:{name:"Entry",methods:["closeEntry","openEntry"],properties:[]},EntrySensor:{name:"EntrySensor",methods:[],properties:["entryOpen"]},DeviceProvider:{name:"DeviceProvider",methods:["getDevice","releaseDevice"],properties:[]},DeviceDiscovery:{name:"DeviceDiscovery",methods:["adoptDevice","discoverDevices"],properties:[]},DeviceCreator:{name:"DeviceCreator",methods:["createDevice","getCreateDeviceSettings"],properties:[]},Battery:{name:"Battery",methods:[],properties:["batteryLevel"]},Refresh:{name:"Refresh",methods:["getRefreshFrequency","refresh"],properties:[]},MediaPlayer:{name:"MediaPlayer",methods:["getMediaStatus","load","seek","skipNext","skipPrevious"],properties:[]},Online:{name:"Online",methods:[],properties:["online"]},BufferConverter:{name:"BufferConverter",methods:["convert"],properties:["fromMimeType","toMimeType"]},Settings:{name:"Settings",methods:["getSettings","putSetting"],properties:[]},BinarySensor:{name:"BinarySensor",methods:[],properties:["binaryState"]},TamperSensor:{name:"TamperSensor",methods:[],properties:["tampered"]},PowerSensor:{name:"PowerSensor",methods:[],properties:["powerDetected"]},AudioSensor:{name:"AudioSensor",methods:[],properties:["audioDetected"]},MotionSensor:{name:"MotionSensor",methods:[],properties:["motionDetected"]},AmbientLightSensor:{name:"AmbientLightSensor",methods:[],properties:["ambientLight"]},OccupancySensor:{name:"OccupancySensor",methods:[],properties:["occupied"]},FloodSensor:{name:"FloodSensor",methods:[],properties:["flooded"]},UltravioletSensor:{name:"UltravioletSensor",methods:[],properties:["ultraviolet"]},LuminanceSensor:{name:"LuminanceSensor",methods:[],properties:["luminance"]},PositionSensor:{name:"PositionSensor",methods:[],properties:["position"]},SecuritySystem:{name:"SecuritySystem",methods:["armSecuritySystem","disarmSecuritySystem"],properties:["securitySystemState"]},PM10Sensor:{name:"PM10Sensor",methods:[],properties:["pm10Density"]},PM25Sensor:{name:"PM25Sensor",methods:[],properties:["pm25Density"]},VOCSensor:{name:"VOCSensor",methods:[],properties:["vocDensity"]},NOXSensor:{name:"NOXSensor",methods:[],properties:["noxDensity"]},CO2Sensor:{name:"CO2Sensor",methods:[],properties:["co2ppm"]},AirQualitySensor:{name:"AirQualitySensor",methods:[],properties:["airQuality"]},Readme:{name:"Readme",methods:["getReadmeMarkdown"],properties:[]},OauthClient:{name:"OauthClient",methods:["getOauthUrl","onOauthCallback"],properties:[]},MixinProvider:{name:"MixinProvider",methods:["canMixin","getMixin","releaseMixin"],properties:[]},HttpRequestHandler:{name:"HttpRequestHandler",methods:["onRequest"],properties:[]},EngineIOHandler:{name:"EngineIOHandler",methods:["onConnection"],properties:[]},PushHandler:{name:"PushHandler",methods:["onPush"],properties:[]},Program:{name:"Program",methods:["run"],properties:[]},Scriptable:{name:"Scriptable",methods:["eval","loadScripts","saveScript"],properties:[]},ObjectTracker:{name:"ObjectTracker",methods:["trackObjects"],properties:[]},ObjectDetector:{name:"ObjectDetector",methods:["getDetectionInput","getObjectTypes"],properties:[]},ObjectDetection:{name:"ObjectDetection",methods:["detectObjects","getDetectionModel"],properties:[]},HumiditySetting:{name:"HumiditySetting",methods:["setHumidity"],properties:["humiditySetting"]},Fan:{name:"Fan",methods:["setFan"],properties:["fan"]},RTCSignalingChannel:{name:"RTCSignalingChannel",methods:["startRTCSignalingSession"],properties:[]},RTCSignalingClient:{name:"RTCSignalingClient",methods:["createRTCSignalingSession"],properties:[]},LauncherApplication:{name:"LauncherApplication",methods:[],properties:["applicationInfo"]},ScryptedUser:{name:"ScryptedUser",methods:["getScryptedUserAccessControl"],properties:[]}},function(e){e.Builtin="Builtin",e.Camera="Camera",e.Fan="Fan",e.Light="Light",e.Switch="Switch",e.Outlet="Outlet",e.Sensor="Sensor",e.Scene="Scene",e.Program="Program",e.Automation="Automation",e.Vacuum="Vacuum",e.Notifier="Notifier",e.Thermostat="Thermostat",e.Lock="Lock",e.PasswordControl="PasswordControl",e.Display="Display",e.SmartDisplay="SmartDisplay",e.Speaker="Speaker",e.SmartSpeaker="SmartSpeaker",e.Event="Event",e.Entry="Entry",e.Garage="Garage",e.DeviceProvider="DeviceProvider",e.DataSource="DataSource",e.API="API",e.Doorbell="Doorbell",e.Irrigation="Irrigation",e.Valve="Valve",e.Person="Person",e.SecuritySystem="SecuritySystem",e.WindowCovering="WindowCovering",e.Siren="Siren",e.Unknown="Unknown"}(t.ScryptedDeviceType||(t.ScryptedDeviceType={})),function(e){e.Humidify="Humidify",e.Dehumidify="Dehumidify",e.Auto="Auto",e.Off="Off"}(t.HumidityMode||(t.HumidityMode={})),function(e){e.Auto="Auto",e.Manual="Manual"}(t.FanMode||(t.FanMode={})),function(e){e.C="C",e.F="F"}(t.TemperatureUnit||(t.TemperatureUnit={})),function(e){e.Off="Off",e.Cool="Cool",e.Heat="Heat",e.HeatCool="HeatCool",e.Auto="Auto",e.FanOnly="FanOnly",e.Purifier="Purifier",e.Eco="Eco",e.Dry="Dry",e.On="On"}(t.ThermostatMode||(t.ThermostatMode={})),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Jammed="Jammed"}(t.LockState||(t.LockState={})),function(e){e.Unknown="Unknown",e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Inferior="Inferior",e.Poor="Poor"}(t.AirQuality||(t.AirQuality={})),function(e){e.Disarmed="Disarmed",e.HomeArmed="HomeArmed",e.AwayArmed="AwayArmed",e.NightArmed="NightArmed"}(t.SecuritySystemMode||(t.SecuritySystemMode={})),function(e){e.Sensor="Sensor",e.Occupied="Occupied",e.Time="Time",e.Error="Error"}(t.SecuritySystemObstruction||(t.SecuritySystemObstruction={})),function(e){e.Idle="Idle",e.Playing="Playing",e.Paused="Paused",e.Buffering="Buffering"}(t.MediaPlayerState||(t.MediaPlayerState={})),function(e){e.ScryptedDevice="ScryptedDevice",e.ScryptedPlugin="ScryptedPlugin",e.OnOff="OnOff",e.Brightness="Brightness",e.ColorSettingTemperature="ColorSettingTemperature",e.ColorSettingRgb="ColorSettingRgb",e.ColorSettingHsv="ColorSettingHsv",e.Notifier="Notifier",e.StartStop="StartStop",e.Pause="Pause",e.Dock="Dock",e.TemperatureSetting="TemperatureSetting",e.Thermometer="Thermometer",e.HumiditySensor="HumiditySensor",e.Camera="Camera",e.Microphone="Microphone",e.Display="Display",e.VideoCamera="VideoCamera",e.VideoRecorder="VideoRecorder",e.PanTiltZoom="PanTiltZoom",e.EventRecorder="EventRecorder",e.VideoClips="VideoClips",e.VideoCameraConfiguration="VideoCameraConfiguration",e.Intercom="Intercom",e.Lock="Lock",e.PasswordStore="PasswordStore",e.Scene="Scene",e.Entry="Entry",e.EntrySensor="EntrySensor",e.DeviceProvider="DeviceProvider",e.DeviceDiscovery="DeviceDiscovery",e.DeviceCreator="DeviceCreator",e.Battery="Battery",e.Refresh="Refresh",e.MediaPlayer="MediaPlayer",e.Online="Online",e.BufferConverter="BufferConverter",e.Settings="Settings",e.BinarySensor="BinarySensor",e.TamperSensor="TamperSensor",e.PowerSensor="PowerSensor",e.AudioSensor="AudioSensor",e.MotionSensor="MotionSensor",e.AmbientLightSensor="AmbientLightSensor",e.OccupancySensor="OccupancySensor",e.FloodSensor="FloodSensor",e.UltravioletSensor="UltravioletSensor",e.LuminanceSensor="LuminanceSensor",e.PositionSensor="PositionSensor",e.SecuritySystem="SecuritySystem",e.PM10Sensor="PM10Sensor",e.PM25Sensor="PM25Sensor",e.VOCSensor="VOCSensor",e.NOXSensor="NOXSensor",e.CO2Sensor="CO2Sensor",e.AirQualitySensor="AirQualitySensor",e.Readme="Readme",e.OauthClient="OauthClient",e.MixinProvider="MixinProvider",e.HttpRequestHandler="HttpRequestHandler",e.EngineIOHandler="EngineIOHandler",e.PushHandler="PushHandler",e.Program="Program",e.Scriptable="Scriptable",e.ObjectTracker="ObjectTracker",e.ObjectDetector="ObjectDetector",e.ObjectDetection="ObjectDetection",e.HumiditySetting="HumiditySetting",e.Fan="Fan",e.RTCSignalingChannel="RTCSignalingChannel",e.RTCSignalingClient="RTCSignalingClient",e.LauncherApplication="LauncherApplication",e.ScryptedUser="ScryptedUser"}(t.ScryptedInterface||(t.ScryptedInterface={})),function(e){e.Url="text/x-uri",e.InsecureLocalUrl="text/x-insecure-local-uri",e.LocalUrl="text/x-local-uri",e.PushEndpoint="text/x-push-endpoint",e.SchemePrefix="x-scrypted/x-scrypted-scheme-",e.MediaStreamUrl="text/x-media-url",e.MediaObject="x-scrypted/x-scrypted-media-object",e.RequestMediaObject="x-scrypted/x-scrypted-request-media-object",e.RequestMediaStream="x-scrypted/x-scrypted-request-stream",e.MediaStreamFeedback="x-scrypted/x-media-stream-feedback",e.ScryptedDevice="x-scrypted/x-scrypted-device",e.ScryptedDeviceId="x-scrypted/x-scrypted-device-id",e.FFmpegInput="x-scrypted/x-ffmpeg-input",e.FFmpegTranscodeStream="x-scrypted/x-ffmpeg-transcode-stream",e.RTCSignalingChannel="x-scrypted/x-scrypted-rtc-signaling-channel",e.RTCSignalingSession="x-scrypted/x-scrypted-rtc-signaling-session",e.RTCConnectionManagement="x-scrypted/x-scrypted-rtc-connection-management"}(t.ScryptedMimeTypes||(t.ScryptedMimeTypes={}))},7733:e=>{const t=require("realfs");e.exports=t},1629:e=>{const t=require("source-map-support/register");e.exports=t},9491:e=>{"use strict";e.exports=require("assert")},4300:e=>{"use strict";e.exports=require("buffer")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},1891:e=>{"use strict";e.exports=require("dgram")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},1808:e=>{"use strict";e.exports=require("net")},2037:e=>{"use strict";e.exports=require("os")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},1576:e=>{"use strict";e.exports=require("string_decoder")},9512:e=>{"use strict";e.exports=require("timers")},6224:e=>{"use strict";e.exports=require("tty")},3837:e=>{"use strict";e.exports=require("util")},2296:(e,t)=>{var r,n=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.decode=function(e,t,r){if(t=~~t,(r=r||e.length-t)===n.size)return n.decode(e,t,r);if(r===i.size)return i.decode(e,t,r);throw Error(`Invalid buffer size needs to be ${n.size} for v4 or ${i.size} for v6.`)},e.encode=function(e,t,r){r=~~r;const o=s(e);"function"==typeof t&&(t=t(r+o));if(o===n.size)return n.encode(e,t,r);return i.encode(e,t,r)},e.familyOf=function(e){return s(e)===n.size?1:2},e.name=void 0,e.sizeOf=s,e.v6=e.v4=void 0;const t=/^(\d{1,3}\.){3,3}\d{1,3}$/,r=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i,n={name:"v4",size:4,isFormat:e=>t.test(e),encode(e,t,r){r=~~r,t=t||new Uint8Array(r+4);const n=e.length;let i=0;for(let s=0;s<n;){const n=e.charCodeAt(s++);46===n?(t[r++]=i,i=0):i=10*i+(n-48)}return t[r]=i,t},decode:(e,t)=>(t=~~t,`${e[t++]}.${e[t++]}.${e[t++]}.${e[t]}`)};e.v4=n;const i={name:"v6",size:16,isFormat:e=>e.length>0&&r.test(e),encode(e,t,r){let n=(r=~~r)+16,i=-1,s=0,o=0,a=!0,c=!1;t=t||new Uint8Array(r+16);for(let u=0;u<e.length;u++){let h=e.charCodeAt(u);58===h?(a?-1!==i?(r<n&&(t[r]=0),r<n-1&&(t[r+1]=0),r+=2):r<n&&(i=r):(!0===c?(r<n&&(t[r]=o),r++):(r<n&&(t[r]=s>>8),r<n-1&&(t[r+1]=255&s),r+=2),s=0,o=0),a=!0,c=!1):46===h?(r<n&&(t[r]=o),r++,o=0,s=0,a=!1,c=!0):(a=!1,h>=97?h-=87:h>=65?h-=55:(h-=48,o=10*o+h),s=(s<<4)+h)}if(!1===a)!0===c?(r<n&&(t[r]=o),r++):(r<n&&(t[r]=s>>8),r<n-1&&(t[r+1]=255&s),r+=2);else if(0===i)r<n&&(t[r]=0),r<n-1&&(t[r+1]=0),r+=2;else if(-1!==i){r+=2;for(let e=Math.min(r-1,n-1);e>=i+2;e--)t[e]=t[e-2];t[i]=0,t[i+1]=0,i=r}if(i!==r&&-1!==i)for(r>n-2&&(r=n-2);n>i;)t[--n]=r<n&&r>i?t[--r]:0;else for(;r<n;)t[r++]=0;return t},decode(e,t){t=~~t;let r="";for(let n=0;n<16;n+=2)0!==n&&(r+=":"),r+=(e[t+n]<<8|e[t+n+1]).toString(16);return r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};e.v6=i;function s(e){if(n.isFormat(e))return n.size;if(i.isFormat(e))return i.size;throw Error(`Invalid ip address: ${e}`)}return e.name="ip","default"in e?e.default:e}({});void 0===(r=function(){return n}.apply(t,[]))||(e.exports=r)},2736:(e,t,r)=>{var n,i=function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{if(r(2037).cpus().find((e=>cpus.model.toLowerCase().includes("armv6"))))throw new Error("Workaround for V8 crashing on ARMv6 platform when using WASM");t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function n(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function i(e){return!0===(e&&e.__isLong__)}function s(e){var t=Math.clz32(e&-e);return e?31-t:t}n.prototype.__isLong__,Object.defineProperty(n.prototype,"__isLong__",{value:!0}),n.isLong=i;var o={},a={};function c(e,t){var r,n,i;return t?(i=0<=(e>>>=0)&&e<256)&&(n=a[e])?n:(r=h(e,0,!0),i&&(a[e]=r),r):(i=-128<=(e|=0)&&e<128)&&(n=o[e])?n:(r=h(e,e<0?-1:0,!1),i&&(o[e]=r),r)}function u(e,t){if(isNaN(e))return t?b:v;if(t){if(e<0)return b;if(e>=y)return w}else{if(e<=-m)return T;if(e+1>=m)return I}return e<0?u(-e,t).neg():h(e%p|0,e/p|0,t)}function h(e,t,r){return new n(e,t,r)}n.fromInt=c,n.fromNumber=u,n.fromBits=h;var d=Math.pow;function l(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?b:v;if((r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return l(e.substring(1),t,r).neg();for(var i=u(d(r,8)),s=v,o=0;o<e.length;o+=8){var a=Math.min(8,e.length-o),c=parseInt(e.substring(o,o+a),r);if(a<8){var h=u(d(r,a));s=s.mul(h).add(u(c))}else s=(s=s.mul(i)).add(u(c))}return s.unsigned=t,s}function f(e,t){return"number"==typeof e?u(e,t):"string"==typeof e?l(e,t):h(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}n.fromString=l,n.fromValue=f;var p=4294967296,y=p*p,m=y/2,g=c(1<<24),v=c(0);n.ZERO=v;var b=c(0,!0);n.UZERO=b;var E=c(1);n.ONE=E;var S=c(1,!0);n.UONE=S;var A=c(-1);n.NEG_ONE=A;var I=h(-1,2147483647,!1);n.MAX_VALUE=I;var w=h(-1,-1,!0);n.MAX_UNSIGNED_VALUE=w;var T=h(0,-2147483648,!1);n.MIN_VALUE=T;var C=n.prototype;C.toInt=function(){return this.unsigned?this.low>>>0:this.low},C.toNumber=function(){return this.unsigned?(this.high>>>0)*p+(this.low>>>0):this.high*p+(this.low>>>0)},C.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(T)){var t=u(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var i=u(d(e,6),this.unsigned),s=this,o="";;){var a=s.div(i),c=(s.sub(a.mul(i)).toInt()>>>0).toString(e);if((s=a).isZero())return c+o;for(;c.length<6;)c="0"+c;o=""+c+o}},C.getHighBits=function(){return this.high},C.getHighBitsUnsigned=function(){return this.high>>>0},C.getLowBits=function(){return this.low},C.getLowBitsUnsigned=function(){return this.low>>>0},C.getNumBitsAbs=function(){if(this.isNegative())return this.eq(T)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},C.isZero=function(){return 0===this.high&&0===this.low},C.eqz=C.isZero,C.isNegative=function(){return!this.unsigned&&this.high<0},C.isPositive=function(){return this.unsigned||this.high>=0},C.isOdd=function(){return 1==(1&this.low)},C.isEven=function(){return 0==(1&this.low)},C.equals=function(e){return i(e)||(e=f(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&(this.high===e.high&&this.low===e.low)},C.eq=C.equals,C.notEquals=function(e){return!this.eq(e)},C.neq=C.notEquals,C.ne=C.notEquals,C.lessThan=function(e){return this.comp(e)<0},C.lt=C.lessThan,C.lessThanOrEqual=function(e){return this.comp(e)<=0},C.lte=C.lessThanOrEqual,C.le=C.lessThanOrEqual,C.greaterThan=function(e){return this.comp(e)>0},C.gt=C.greaterThan,C.greaterThanOrEqual=function(e){return this.comp(e)>=0},C.gte=C.greaterThanOrEqual,C.ge=C.greaterThanOrEqual,C.compare=function(e){if(i(e)||(e=f(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},C.comp=C.compare,C.negate=function(){return!this.unsigned&&this.eq(T)?T:this.not().add(E)},C.neg=C.negate,C.add=function(e){i(e)||(e=f(e));var t=this.high>>>16,r=65535&this.high,n=this.low>>>16,s=65535&this.low,o=e.high>>>16,a=65535&e.high,c=e.low>>>16,u=0,d=0,l=0,p=0;return l+=(p+=s+(65535&e.low))>>>16,d+=(l+=n+c)>>>16,u+=(d+=r+a)>>>16,u+=t+o,h((l&=65535)<<16|(p&=65535),(u&=65535)<<16|(d&=65535),this.unsigned)},C.subtract=function(e){return i(e)||(e=f(e)),this.add(e.neg())},C.sub=C.subtract,C.multiply=function(e){if(this.isZero())return this;if(i(e)||(e=f(e)),t)return h(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?b:v;if(this.eq(T))return e.isOdd()?T:v;if(e.eq(T))return this.isOdd()?T:v;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return u(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,n=65535&this.high,s=this.low>>>16,o=65535&this.low,a=e.high>>>16,c=65535&e.high,d=e.low>>>16,l=65535&e.low,p=0,y=0,m=0,E=0;return m+=(E+=o*l)>>>16,y+=(m+=s*l)>>>16,m&=65535,y+=(m+=o*d)>>>16,p+=(y+=n*l)>>>16,y&=65535,p+=(y+=s*d)>>>16,y&=65535,p+=(y+=o*c)>>>16,p+=r*l+n*d+s*c+o*a,h((m&=65535)<<16|(E&=65535),(p&=65535)<<16|(y&=65535),this.unsigned)},C.mul=C.multiply,C.divide=function(e){if(i(e)||(e=f(e)),e.isZero())throw Error("division by zero");var r,n,s;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?h((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?b:v;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return b;if(e.gt(this.shru(1)))return S;s=b}else{if(this.eq(T))return e.eq(E)||e.eq(A)?T:e.eq(T)?E:(r=this.shr(1).div(e).shl(1)).eq(v)?e.isNegative()?E:A:(n=this.sub(e.mul(r)),s=r.add(n.div(e)));if(e.eq(T))return this.unsigned?b:v;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=v}for(n=this;n.gte(e);){r=Math.max(1,Math.floor(n.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),a=o<=48?1:d(2,o-48),c=u(r),l=c.mul(e);l.isNegative()||l.gt(n);)l=(c=u(r-=a,this.unsigned)).mul(e);c.isZero()&&(c=E),s=s.add(c),n=n.sub(l)}return s},C.div=C.divide,C.modulo=function(e){return i(e)||(e=f(e)),t?h((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},C.mod=C.modulo,C.rem=C.modulo,C.not=function(){return h(~this.low,~this.high,this.unsigned)},C.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},C.clz=C.countLeadingZeros,C.countTrailingZeros=function(){return this.low?s(this.low):s(this.high)+32},C.ctz=C.countTrailingZeros,C.and=function(e){return i(e)||(e=f(e)),h(this.low&e.low,this.high&e.high,this.unsigned)},C.or=function(e){return i(e)||(e=f(e)),h(this.low|e.low,this.high|e.high,this.unsigned)},C.xor=function(e){return i(e)||(e=f(e)),h(this.low^e.low,this.high^e.high,this.unsigned)},C.shiftLeft=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?h(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):h(0,this.low<<e-32,this.unsigned)},C.shl=C.shiftLeft,C.shiftRight=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?h(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):h(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},C.shr=C.shiftRight,C.shiftRightUnsigned=function(e){return i(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?h(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):h(32===e?this.high:this.high>>>e-32,0,this.unsigned)},C.shru=C.shiftRightUnsigned,C.shr_u=C.shiftRightUnsigned,C.rotateLeft=function(e){var t;return i(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?h(this.high,this.low,this.unsigned):e<32?(t=32-e,h(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(t=32-(e-=32),h(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},C.rotl=C.rotateLeft,C.rotateRight=function(e){var t;return i(e)&&(e=e.toInt()),0==(e&=63)?this:32===e?h(this.high,this.low,this.unsigned):e<32?(t=32-e,h(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(t=32-(e-=32),h(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},C.rotr=C.rotateRight,C.toSigned=function(){return this.unsigned?h(this.low,this.high,!1):this},C.toUnsigned=function(){return this.unsigned?this:h(this.low,this.high,!0)},C.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},C.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},C.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},n.fromBytes=function(e,t,r){return r?n.fromBytesLE(e,t):n.fromBytesBE(e,t)},n.fromBytesLE=function(e,t){return new n(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},n.fromBytesBE=function(e,t){return new n(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};var _=n;return e.default=_,"default"in e?e.default:e}({});void 0===(n=function(){return i}.apply(t,[]))||(e.exports=n)},8087:e=>{"use strict";var t=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],r="undefined"==typeof globalThis?global:globalThis;e.exports=function(){for(var e=[],n=0;n<t.length;n++)"function"==typeof r[t[n]]&&(e[e.length]=t[n]);return e}},2752:(e,t,r)=>{"use strict";var n=r(49)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n},6892:e=>{"use strict";var t=Symbol.iterator;e.exports=function(e){if(null!=e&&void 0!==e[t])return e[t]()}},1163:(e,t,r)=>{"use strict";var n=r(6603),i=r(5638),s=r(1680),o=r(854);e.exports=function(e){if(e&&"object"==typeof e){if(n(e))return"Map";if(i(e))return"Set";if(s(e))return"WeakMap";if(o(e))return"WeakSet"}return!1}},8257:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var n=r(2037);function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){var t="function"==typeof Map?new Map:void 0;return o=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return a(e,arguments,h(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,e)},o(e)}function a(e,t,r){return a=c()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&u(i,r.prototype),i},a.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}let d=function(e){function t(e,r,...n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e instanceof Array||(n=(void 0===r?[]:[r]).concat(n),r=e,e=[]),(i=function(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?s(e):t}(this,h(t).call(this,r))).code=r||"E_UNEXPECTED",i.params=n,i.wrappedErrors=e,i.name=i.toString(),Error.captureStackTrace&&Error.captureStackTrace(s(i),i.constructor),i}var r,o,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),r=t,(o=[{key:"toString",value:function(){return(this.wrappedErrors.length?this.wrappedErrors[this.wrappedErrors.length-1].stack+n.EOL:"")+this.constructor.name+": "+this.code+" ("+this.params.join(", ")+")"}}])&&i(r.prototype,o),a&&i(r,a),t}(o(Error));function l(e){return e instanceof d||e.constructor&&e.constructor.name&&e.constructor.name.endsWith("Error")&&"string"==typeof e.code&&f(e.code)&&e.params&&e.params instanceof Array}function f(e){return/^([A-Z0-9_]+)$/.test(e)}d.wrap=function(e,t,...r){let n=null;const i=f(e.message),s=(e.wrappedErrors||[]).concat(e);return t||(t=i?e.message:"E_UNEXPECTED"),e.message&&!i&&r.push(e.message),n=new d(s,t,...r),n},d.cast=function(e,...t){return l(e)?e:d.wrap.apply(d,[e].concat(t))},d.bump=function(e,...t){return l(e)?d.wrap.apply(d,[e,e.code].concat(e.params)):d.wrap.apply(d,[e].concat(t))};const p=d},9518:e=>{"use strict";e.exports={i8:"1.1.5"}},1761:e=>{"use strict";e.exports=JSON.parse('[{"type":"a","child":[{"type":"(","child":[{"type":"y","child":[]},{"type":"v","child":[]}]}]}]')},9763:e=>{"use strict";e.exports=JSON.parse('{"name":"hap-nodejs","version":"0.9.4","betaVersion":"0.10.0","description":"HAP-NodeJS is a Node.js implementation of HomeKit Accessory Server.","main":"dist/index.js","types":"dist/index.d.ts","maintainers":["Andreas Bauer <mail@anderl-bauer.de>"],"author":"Khaos Tian <khaos.tian@gmail.com> (https://tz.is/)","homepage":"https://github.com/homebridge/HAP-NodeJS","license":"Apache-2.0","scripts":{"clean":"rimraf dist && rimraf coverage","build":"rimraf dist && tsc && node .github/workflows/node-persist-ignore.js","prepublishOnly":"npm run build","postpublish":"npm run clean","test":"jest","test-coverage":"jest --coverage","start":"node dist/BridgedCore.js","docs":"typedoc src/index.ts"},"keywords":["hap-nodejs","hap","homekit","homekit-accessory-protocol","homekit-server","homekit-protocol","homekit-device","homekit-accessory","hap-server","homekit-support","siri"],"repository":{"type":"git","url":"https://github.com/homebridge/HAP-NodeJS.git"},"bugs":{"url":"https://github.com/homebridge/HAP-NodeJS/issues"},"engines":{"node":">=10.17.0"},"files":["README.md","LICENSE","dist","@types"],"dependencies":{"@homebridge/ciao":"^1.1.5","@homebridge/dbus-native":"^0.5.0","bonjour-hap":"^3.6.4","debug":"^4.3.2","fast-srp-hap":"2.0.4","futoin-hkdf":"^1.5.1","ip":"^1.1.5","source-map-support":"^0.5.21","tslib":"^2.4.0","tweetnacl":"^1.0.3"},"devDependencies":{"@types/debug":"^4.1.7","@types/escape-html":"^1.0.1","@types/jest":"^27.0.2","@types/node":"^10.17.60","commander":"^6.2.1","escape-html":"^1.0.3","jest":"^27.2.4","rimraf":"^3.0.2","semver":"^7.3.5","simple-plist":"^1.1.1","ts-jest":"^27.0.5","ts-node":"^10.2.1","typedoc":"^0.22.11","typescript":"~4.4.3"}}')},9813:e=>{"use strict";e.exports={i8:"6.5.4"}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n={};(()=>{"use strict";r.r(n),r.d(n,{HomeKitPlugin:()=>JD,default:()=>XD});var e={};r.r(e),r.d(e,{Any:()=>Mp,BaseBlock:()=>Jl,BaseStringBlock:()=>Zl,BitString:()=>Qf,BmpString:()=>gp,Boolean:()=>zf,CharacterString:()=>Dp,Choice:()=>Lp,Constructed:()=>Hf,DATE:()=>Op,DateTime:()=>Pp,Duration:()=>Bp,EndOfContent:()=>Kf,Enumerated:()=>rp,GeneralString:()=>_p,GeneralizedTime:()=>Np,GraphicString:()=>Tp,HexBlock:()=>Gl,IA5String:()=>wp,Integer:()=>tp,Null:()=>qf,NumericString:()=>Ep,ObjectIdentifier:()=>sp,OctetString:()=>Wf,Primitive:()=>Lf,PrintableString:()=>Sp,RawData:()=>Fp,RelativeObjectIdentifier:()=>cp,Repeated:()=>kp,Sequence:()=>up,Set:()=>hp,TIME:()=>xp,TeletexString:()=>Ap,TimeOfDay:()=>Up,UTCTime:()=>Rp,UniversalString:()=>bp,Utf8String:()=>yp,ValueBlock:()=>$l,VideotexString:()=>Ip,ViewWriter:()=>Bl,VisibleString:()=>Cp,compareSchema:()=>Vp,fromBER:()=>Ff,verifySchema:()=>Hp});var t=r(3079),i=r.n(t),s=r(9383);const o="1.2.13";async function a(){try{const e=(await i().endpointManager.getLocalAddresses())?.[0];return e}catch(e){}}var c=r(9491),u=r.n(c),h=r(2790),d=r.n(h),l=r(2361),f=r(6113),p=r.n(f),y=r(1808),m=r.n(y);let g;function v(e){return!!e&&("true"===e||"1"===e)}!function(e){e.IMAGE="image"}(g||(g={}));var b=r(5816),E=r.n(b),S=r(1382),A=r.n(S),I=r(8332);const w=d()("HAP-NodeJS:Advertiser");let T,C,_;!function(e){e[e.NOT_PAIRED=1]="NOT_PAIRED",e[e.NOT_JOINED_WIFI=2]="NOT_JOINED_WIFI",e[e.PROBLEM_DETECTED=4]="PROBLEM_DETECTED"}(T||(T={})),function(e){e[e.SUPPORTS_HARDWARE_AUTHENTICATION=1]="SUPPORTS_HARDWARE_AUTHENTICATION",e[e.SUPPORTS_SOFTWARE_AUTHENTICATION=2]="SUPPORTS_SOFTWARE_AUTHENTICATION"}(C||(C={})),function(e){e.UPDATED_NAME="updated-name"}(_||(_={}));class D extends l.EventEmitter{static protocolVersion="1.1";static protocolVersionService="1.1.0";constructor(e,t,r){super(),this.accessoryInfo=e,this.setupHash=D.computeSetupHash(e),this.responder=E().getResponder({...t}),this.advertisedService=this.responder.createService({name:this.accessoryInfo.displayName,type:b.ServiceType.HAP,txt:D.createTxt(e,this.setupHash),...r}),this.advertisedService.on(b.ServiceEvent.NAME_CHANGED,this.emit.bind(this,_.UPDATED_NAME)),w(`Preparing Advertiser for '${this.accessoryInfo.displayName}' using ciao backend!`)}initPort(e){this.advertisedService.updatePort(e)}startAdvertising(){return w(`Starting to advertise '${this.accessoryInfo.displayName}' using ciao backend!`),this.advertisedService.advertise()}updateAdvertisement(e){this.advertisedService.updateTxt(D.createTxt(this.accessoryInfo,this.setupHash),e)}async destroy(){await this.responder.shutdown(),this.removeAllListeners()}static createTxt(e,t){const r=[];return e.paired()||r.push(T.NOT_PAIRED),{"c#":e.getConfigVersion(),ff:D.ff(),id:e.username,md:e.model,pv:D.protocolVersion,"s#":1,sf:D.sf(...r),ci:e.category,sh:t}}static computeSetupHash(e){const t=p().createHash("sha512");return t.update(e.setupID+e.username.toUpperCase()),t.digest().slice(0,4).toString("base64")}static ff(...e){let t=0;return e.forEach((e=>t|=e)),t}static sf(...e){let t=0;return e.forEach((e=>t|=e)),t}}class R extends l.EventEmitter{destroyed=!1;constructor(e,t,r){super(),this.accessoryInfo=e,this.setupHash=D.computeSetupHash(e),this.serviceOptions=r,this.bonjour=A()(t),w(`Preparing Advertiser for '${this.accessoryInfo.displayName}' using bonjour-hap backend!`)}initPort(e){this.port=e}startAdvertising(){if(u()(!this.destroyed,"Can't advertise on a destroyed bonjour instance!"),null==this.port)throw new Error("Tried starting bonjour-hap advertisement without initializing port!");w(`Starting to advertise '${this.accessoryInfo.displayName}' using bonjour-hap backend!`),this.advertisement&&this.destroy();const e=this.accessoryInfo.username.replace(/:/gi,"_")+".local";return this.advertisement=this.bonjour.publish({name:this.accessoryInfo.displayName,type:"hap",port:this.port,txt:D.createTxt(this.accessoryInfo,this.setupHash),host:e,addUnsafeServiceEnumerationRecord:!0,...this.serviceOptions}),t=1,new Promise((e=>{setTimeout((()=>e()),t)}));var t}updateAdvertisement(e){this.advertisement&&this.advertisement.updateTxt(D.createTxt(this.accessoryInfo,this.setupHash),e)}destroy(){this.advertisement?this.advertisement.stop((()=>{this.advertisement.destroy(),this.advertisement=void 0,this.bonjour.destroy()})):this.bonjour.destroy()}}class N extends l.EventEmitter{constructor(e){super(),this.accessoryInfo=e,this.setupHash=D.computeSetupHash(e),this.bus=I.systemBus(),w(`Preparing Advertiser for '${this.accessoryInfo.displayName}' using Avahi backend!`)}createTxt(){return Object.entries(D.createTxt(this.accessoryInfo,this.setupHash)).map((e=>Buffer.from(e[0]+"="+e[1])))}initPort(e){this.port=e}async startAdvertising(){if(null==this.port)throw new Error("Tried starting Avahi advertisement without initializing port!");if(!this.bus)throw new Error("Tried to start Avahi advertisement on a destroyed advertiser!");w(`Starting to advertise '${this.accessoryInfo.displayName}' using Avahi backend!`),this.path=await N.avahiInvoke(this.bus,"/","Server","EntryGroupNew"),await N.avahiInvoke(this.bus,this.path,"EntryGroup","AddService",{body:[-1,-1,0,this.accessoryInfo.displayName,"_hap._tcp","","",this.port,this.createTxt()],signature:"iiussssqaay"}),await N.avahiInvoke(this.bus,this.path,"EntryGroup","Commit")}async updateAdvertisement(e){if(!this.bus)throw new Error("Tried to update Avahi advertisement on a destroyed advertiser!");if(this.path)try{await N.avahiInvoke(this.bus,this.path,"EntryGroup","UpdateServiceTxt",{body:[-1,-1,0,this.accessoryInfo.displayName,"_hap._tcp","",this.createTxt()],signature:"iiusssaay"})}catch(e){console.error("Failed to update avahi advertisement: "+e)}else w("Tried to update advertisement without a valid `path`!")}async destroy(){if(!this.bus)throw new Error("Tried to destroy Avahi advertisement on a destroyed advertiser!");if(this.path){try{await N.avahiInvoke(this.bus,this.path,"EntryGroup","Free")}catch(e){w("Destroying Avahi advertisement failed: "+e)}this.path=void 0}this.bus.connection.stream.destroy(),this.bus=void 0}static async isAvailable(){const e=I.systemBus();try{try{await this.messageBusConnectionResult(e)}catch(e){return w("Avahi/DBus classified unavailable due to missing dbus interface!"),!1}try{const t=await this.avahiInvoke(e,"/","Server","GetVersionString");w("Detected Avahi over DBus interface running version '%s'.",t)}catch(e){return w("Avahi/DBus classified unavailable due to missing avahi interface!"),!1}return!0}finally{e.connection.stream.destroy()}}static messageBusConnectionResult(e){return new Promise(((t,r)=>{let n=t=>{e.connection.removeListener("connect",i),r(t)},i=()=>{e.connection.removeListener("error",n),t()};e.connection.once("connect",i),e.connection.once("error",n)}))}static avahiInvoke(e,t,r,n,i){return new Promise(((s,o)=>{let a={destination:"org.freedesktop.Avahi",path:t,interface:"org.freedesktop.Avahi."+r,member:n,...i||{}};e.invoke(a,((e,t)=>{e?o(new Error(`avahiInvoke error: ${JSON.stringify(e)}`)):s(t)}))}))}}class O{constructor(e){this.cameraSource=e}handleSnapshotRequest(e,t){this.cameraSource.handleSnapshotRequest(e,((e,r)=>{t(e||void 0,r)}))}prepareStream(e,t){this.cameraSource.prepareStream(e,(e=>{t(void 0,e)}))}handleStreamRequest(e,t){this.cameraSource.handleStreamRequest(e),t()}forwardCloseConnection(e){this.cameraSource.handleCloseConnection(e)}}var U=r(1891),P=r.n(U);class B{startingPort=1e4;constructor(e){this.options=e,this.type=e.isIPV6?"udp6":"udp4",this.startingPort=1e4,this.outgoingAddress=e.outgoingAddress,this.outgoingPort=e.outgoingPort,this.incomingPayloadType=0,this.outgoingSSRC=e.outgoingSSRC,this.disabled=e.disabled,this.incomingSSRC=null,this.outgoingPayloadType=null}setup=()=>this.createSocketPair(this.type).then((e=>(this.incomingRTPSocket=e[0],this.incomingRTCPSocket=e[1],this.createSocket(this.type)))).then((e=>{this.outgoingSocket=e,this.onBound()}));destroy=()=>{this.incomingRTPSocket&&this.incomingRTPSocket.close(),this.incomingRTCPSocket&&this.incomingRTCPSocket.close(),this.outgoingSocket&&this.outgoingSocket.close()};incomingRTPPort=()=>{const e=this.incomingRTPSocket.address();if("string"!=typeof e)return e.port};incomingRTCPPort=()=>{const e=this.incomingRTCPSocket.address();if("string"!=typeof e)return e.port};outgoingLocalPort=()=>{const e=this.outgoingSocket.address();return"string"!=typeof e?e.port:0};setServerAddress=e=>{this.serverAddress=e};setServerRTPPort=e=>{this.serverRTPPort=e};setServerRTCPPort=e=>{this.serverRTCPPort=e};setIncomingPayloadType=e=>{this.incomingPayloadType=e};setOutgoingPayloadType=e=>{this.outgoingPayloadType=e};sendOut=e=>{this.outgoingAddress&&this.outgoingPort&&this.outgoingSocket.send(e,this.outgoingPort,this.outgoingAddress)};sendBack=e=>{this.serverAddress&&this.serverRTCPPort&&this.outgoingSocket.send(e,this.serverRTCPPort,this.serverAddress)};onBound=()=>{this.disabled||(this.incomingRTPSocket.on("message",(e=>{this.rtpMessage(e)})),this.incomingRTCPSocket.on("message",(e=>{this.rtcpMessage(e)})),this.outgoingSocket.on("message",(e=>{this.rtcpReply(e)})))};rtpMessage=e=>{if(e.length<12)return void this.sendOut(e);let t=e.readUInt8(1);(127&t)==this.incomingPayloadType&&(t=128&t|this.outgoingPayloadType,e.writeUInt8(t,1)),null===this.incomingSSRC&&(this.incomingSSRC=e.readUInt32BE(4)),e.writeUInt32BE(this.outgoingSSRC,8),this.sendOut(e)};processRTCPMessage=(e,t)=>{let r=[],n=0;for(;n+4<=e.length;){let i=e.readUInt8(n+1),s=4*e.readUInt16BE(n+2);if(n+4+s>e.length)break;let o=e.slice(n,n+4+s);o=t(i,o),o&&r.push(o),n+=4+s}return r.length>0?Buffer.concat(r):null};rtcpMessage=e=>{let t=this.processRTCPMessage(e,((e,t)=>(200!=e||t.length<8||(null===this.incomingSSRC&&(this.incomingSSRC=t.readUInt32BE(4)),t.writeUInt32BE(this.outgoingSSRC,4)),t)));t&&this.sendOut(t)};rtcpReply=e=>{let t=this.processRTCPMessage(e,((e,t)=>(201!=e||t.length<12||t.writeUInt32BE(this.incomingSSRC,8),t)));t&&this.sendOut(t)};createSocket=e=>new Promise((t=>{const r=()=>{const n=P().createSocket(e);n.once("error",(()=>{65535==this.startingPort?this.startingPort=1e4:++this.startingPort,n.close(),r()})),n.on("listening",(()=>{t(n)})),n.bind(this.startingPort)};r()}));createSocketPair=e=>new Promise((t=>{const r=()=>{let n=P().createSocket(e),i=P().createSocket(e),s={socket1:0,socket2:0};const o=()=>{0!=s.socket1&&0!=s.socket2&&(2!=s.socket1||2!=s.socket2?(65534==this.startingPort?this.startingPort=1e4:++this.startingPort,n.close(),i.close(),r()):t([n,i]))};n.once("error",(function(){s.socket1=1,o()})),i.once("error",(function(){s.socket2=1,o()})),n.once("listening",(function(){s.socket1=2,o()})),i.once("listening",(function(){s.socket2=2,o()})),n.bind(this.startingPort),i.bind(this.startingPort+1)};r()}))}const x="-0000-1000-8000-0026BB765291";function M(e){const t=p().createHash("sha1");t.update(e);const r=t.digest("hex");let n=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>(n+=1,"y"===e?(3&parseInt("0x"+r[n],16)|8).toString(16):r[n])))}const L=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function k(e){return L.test(e)}function F(e,t=0){if("string"==typeof e&&k(e))return e;let r=t;return e.toString("hex",r,r+=4)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+=2)+"-"+e.toString("hex",r,r+6)}function V(e,t,r=0){const n=Buffer.from(e.replace(/-/g,""),"hex");return t?(n.copy(t,r),t):n}const H=/^0*([0-9a-f]{1,8})-([0-9a-f]{4}-){3}[0-9a-f]{12}$/i;function j(e,t=x){if(!k(e))throw new TypeError("uuid was not a valid UUID or short form UUID");if(t&&!k("00000000"+t))throw new TypeError("base was not a valid base UUID");return t&&!e.endsWith(t)?e.toUpperCase():e.replace(H,"$1").toUpperCase()}function K(e){let t=!1;return(...r)=>{if(t)throw new Error("This callback function has already been called by someone else; it can only be called one time.");return t=!0,e(...r)}}var q=r(6957),G=r(1501),z=r.n(G);const $=require("url");var W=r(6425);const Y=require("http");var Q=r.n(Y),J=r(2037),X=r.n(J),Z=r(5962),ee=r.n(Z);function te(e,t,r,n,i){return ee()(r,i,{hash:e,salt:t,info:n})}function re(e,t,r,n,i){t.length<12&&(t=Buffer.concat([Buffer.alloc(12-t.length,0),t]));const s=p().createDecipheriv("chacha20-poly1305",e,t,{authTagLength:16});r&&s.setAAD(r),s.setAuthTag(i);const o=s.update(n);return s.final(),o}function ne(e,t,r,n){t.length<12&&(t=Buffer.concat([Buffer.alloc(12-t.length,0),t]));const i=p().createCipheriv("chacha20-poly1305",e,t,{authTagLength:16});r&&i.setAAD(r);const s=i.update(n);i.final();return{ciphertext:s,authTag:i.getAuthTag()}}p().getCiphers().includes("chacha20-poly1305")||u().fail("The cipher 'chacha20-poly1305' is not supported with your current running nodejs version v"+process.version+". At least a nodejs version of v10.17.0 (excluding v11.0 and v11.1) is required!");const ie=4294967295;function se(e){u()(e>-1&&e<=9007199254740991,"number out of range"),u()(Math.floor(e)===e,"number must be an integer");let t=0;const r=4294967295&e,n=r<0?2147483648+(2147483647&e):r;return e>ie&&(t=(e-n)/4294967296),[t,n]}function oe(e,t,r=0){const n=se(e);t.writeUInt32LE(n[1],r),t.writeUInt32LE(n[0],r+4)}d()("HAP-NodeJS:net-utils");function ae(){let e,t,r;for(const[n,i]of Object.entries(X().networkInterfaces())){let s=!1;for(const o of i)o.internal&&(s=!0,"IPv4"===o.family||4===o.family?r||(r=o.address):"IPv6"!==o.family&&6!==o.family||(o.scopeid?t||(t=o.address+"%"+n):e||(e=o.address)));if(s)break}const n=r||e||t;if(!n)throw new Error("Could not find a valid loopback address on the platform!");return n}let ce;function ue(){try{return ce??(ce=ae())}catch(e){return void console.log(e.stack)}}const he=d()("HAP-NodeJS:EventedHTTPServer"),de=d()("HAP-NodeJS:EventedHTTPServer:Connection");class le{accessoryToControllerCount=0;controllerToAccessoryCount=0;constructor(e,t,r,n,i){this.clientPublicKey=e,this.secretKey=t,this.publicKey=r,this.sharedSecret=n,this.hkdfPairEncryptionKey=i,this.accessoryToControllerKey=Buffer.alloc(0),this.controllerToAccessoryKey=Buffer.alloc(0)}}let fe,pe,ye;!function(e){e.LISTENING="listening",e.CONNECTION_OPENED="connection-opened",e.REQUEST="request",e.CONNECTION_CLOSED="connection-closed"}(fe||(fe={}));class me extends l.EventEmitter{static CONNECTION_TIMEOUT_LIMIT=16;static MAX_CONNECTION_IDLE_TIME=36e5;connections=new Set;connectionsByUsername=new Map;constructor(){super(),this.tcpServer=m().createServer();setInterval((()=>{let e="";for(const t of this.connections)e&&(e+=", "),e+=t.remoteAddress+":"+t.remotePort;he("Currently "+this.connections.size+" hap connections open: "+e)}),6e4).unref()}scheduleNextConnectionIdleTimeout(){if(this.connectionIdleTimeout=void 0,!this.tcpServer.listening)return;he("Running idle timeout timer...");const e=(new Date).getTime();let t=-1;for(const r of this.connections){const n=e-r.lastSocketOperation;n>=me.MAX_CONNECTION_IDLE_TIME?(he("[%s] Closing connection as it was inactive for "+n+"ms"),r.close()):t=Math.max(t,me.MAX_CONNECTION_IDLE_TIME-n)}this.connections.size>=me.CONNECTION_TIMEOUT_LIMIT&&(this.connectionIdleTimeout=setTimeout(this.scheduleNextConnectionIdleTimeout.bind(this),t))}listen(e,t){this.tcpServer.listen(e,t,(()=>{const e=this.tcpServer.address();he("Server listening on %s:%s","IPv6"===e.family?`[${e.address}]`:e.address,e.port),this.emit(fe.LISTENING,e.port,e.address)})),this.tcpServer.on("connection",this.onConnection.bind(this))}stop(){this.tcpServer.close();for(const e of this.connections)e.close()}destroy(){this.stop(),this.removeAllListeners()}broadcastEvent(e,t,r,n,i){for(const s of this.connections)s!==n?s.sendEvent(e,t,r,i):he("[%s] Muting event '%s' notification for this connection since it originated here.",s.remoteAddress,e+"."+t)}onConnection(e){const t=new ge(this,e);t.on(ye.REQUEST,((e,r)=>{this.emit(fe.REQUEST,t,e,r)})),t.on(ye.AUTHENTICATED,this.handleConnectionAuthenticated.bind(this,t)),t.on(ye.CLOSED,this.handleConnectionClose.bind(this,t)),this.connections.add(t),he("[%s] New connection from client on interface %s (%s)",t.remoteAddress,t.networkInterface,t.localAddress),this.emit(fe.CONNECTION_OPENED,t),this.connections.size>=me.CONNECTION_TIMEOUT_LIMIT&&!this.connectionIdleTimeout&&this.scheduleNextConnectionIdleTimeout()}handleConnectionAuthenticated(e,t){const r=this.connectionsByUsername.get(t);r?r.includes(e)||r.push(e):this.connectionsByUsername.set(t,[e])}handleConnectionClose(e){if(this.emit(fe.CONNECTION_CLOSED,e),this.connections.delete(e),e.username){const t=this.connectionsByUsername.get(e.username);if(t){const r=t.indexOf(e);-1!==r&&t.splice(r,1),0===t.length&&this.connectionsByUsername.delete(e.username)}}}static destroyExistingConnectionsAfterUnpair(e,t){const r=e.server.connectionsByUsername.get(t);if(r)for(const t of r)t.closeConnectionAsOfUnpair(e)}}!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.FULLY_SET_UP=1]="FULLY_SET_UP",e[e.AUTHENTICATED=2]="AUTHENTICATED",e[e.TO_BE_TEARED_DOWN=3]="TO_BE_TEARED_DOWN",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(pe||(pe={})),function(e){e.REQUEST="request",e.AUTHENTICATED="authenticated",e.CLOSED="closed"}(ye||(ye={}));class ge extends l.EventEmitter{state=pe.CONNECTING;lastSocketOperation=(new Date).getTime();pendingClientSocketData=Buffer.alloc(0);handlingRequest=!1;registeredEvents=new Set;queuedEvents=[];pendingEventData=[];constructor(e,t){super(),this.server=e,this.sessionID=M(t.remoteAddress+":"+t.remotePort),this.localAddress=t.localAddress,this.remoteAddress=t.remoteAddress,this.remotePort=t.remotePort,this.networkInterface=ge.getLocalNetworkInterface(t),this.tcpSocket=t,this.tcpSocket.on("data",this.onTCPSocketData.bind(this)),this.tcpSocket.on("close",this.onTCPSocketClose.bind(this)),this.tcpSocket.on("error",this.onTCPSocketError.bind(this)),this.tcpSocket.setNoDelay(!0),this.internalHttpServer=Q().createServer(),this.internalHttpServer.timeout=0,this.internalHttpServer.keepAliveTimeout=0,this.internalHttpServer.on("listening",this.onHttpServerListening.bind(this)),this.internalHttpServer.on("request",this.handleHttpServerRequest.bind(this)),this.internalHttpServer.on("error",this.onHttpServerError.bind(this)),this.internalHttpServer.listen(0,this.internalHttpServerAddress=ue())}connectionAuthenticated(e){this.state=pe.AUTHENTICATED,this.username=e,this.emit(ye.AUTHENTICATED,e)}isAuthenticated(){return this.state===pe.AUTHENTICATED}close(){this.state>=pe.CLOSING||(this.state=pe.CLOSING,this.tcpSocket.destroy())}closeConnectionAsOfUnpair(e){this===e?this.state=pe.TO_BE_TEARED_DOWN:this.close()}sendEvent(e,t,r,n){u()(null!=e,"HAPConnection.sendEvent: aid must be defined!"),u()(null!=t,"HAPConnection.sendEvent: iid must be defined!");const i=e+"."+t;if(!this.registeredEvents.has(i))return;const s={aid:e,iid:t,value:r};if(n)return this.queuedEvents.push(s),this.eventsTimer&&clearTimeout(this.eventsTimer),void this.handleEventsTimeout();for(let n=this.queuedEvents.length-1;n>=0;n--){const i=this.queuedEvents[n];if(i.aid===e&&i.iid===t){if(i.value===r)return;break}}this.queuedEvents.push(s),this.handlingRequest||this.eventsTimer||(this.eventsTimer=setTimeout(this.handleEventsTimeout.bind(this),250),this.eventsTimer.unref())}handleEventsTimeout(){this.eventsTimer=void 0,this.state>pe.AUTHENTICATED||this.handlingRequest||this.writeQueuedEventNotifications()}writePendingEventNotifications(){for(const e of this.pendingEventData)this.tcpSocket.write(this.encrypt(e));this.pendingEventData.splice(0,this.pendingEventData.length)}writeQueuedEventNotifications(){if(0===this.queuedEvents.length||this.eventsTimer)return;const e={characteristics:[]};for(const t of this.queuedEvents)this.registeredEvents.has(t.aid+"."+t.iid)&&e.characteristics.push(t);this.queuedEvents.splice(0,this.queuedEvents.length),this.writeEventNotification(e)}writeEventNotification(e){de("[%s] Sending HAP event notifications %o",this.remoteAddress,e.characteristics);const t=Buffer.from(JSON.stringify(e),"utf8"),r=Buffer.from("EVENT/1.0 200 OK\r\nContent-Type: application/hap+json\r\nContent-Length: "+t.length+"\r\n\r\n","utf8"),n=Buffer.concat([r,t]);this.handlingRequest?this.pendingEventData.push(n):this.tcpSocket.write(this.encrypt(n),this.handleTCPSocketWriteFulfilled.bind(this))}enableEventNotifications(e,t){this.registeredEvents.add(e+"."+t)}disableEventNotifications(e,t){this.registeredEvents.delete(e+"."+t)}hasEventNotifications(e,t){return this.registeredEvents.has(e+"."+t)}getRegisteredEvents(){return this.registeredEvents}clearRegisteredEvents(){this.registeredEvents.clear()}encrypt(e){return this.encryption&&this.encryption.accessoryToControllerKey.length>0&&this.encryption.controllerToAccessoryCount>0?function(e,t){let r=Buffer.alloc(0);const n=e.length;for(let i=0;i<n;){const s=Math.min(n-i,1024),o=Buffer.alloc(2);o.writeUInt16LE(s,0);const a=Buffer.alloc(8);oe(t.accessoryToControllerCount++,a,0);const c=ne(t.accessoryToControllerKey,a,o,e.slice(i,i+s));i+=s,r=Buffer.concat([r,o,c.ciphertext,c.authTag])}return r}(e,this.encryption):e}decrypt(e){return this.encryption&&this.encryption.controllerToAccessoryKey.length>0?function(e,t){t.incompleteFrame&&(e=Buffer.concat([t.incompleteFrame,e]),t.incompleteFrame=void 0);let r=Buffer.alloc(0);const n=e.length;for(let i=0;i<n;){const s=e.slice(i,i+2).readUInt16LE(0);if(s>n-i-2-16){t.incompleteFrame=e.slice(i);break}const o=Buffer.alloc(8);oe(t.controllerToAccessoryCount++,o,0);const a=re(t.controllerToAccessoryKey,o,e.slice(i,i+2),e.slice(i+2,i+2+s),e.slice(i+2+s,i+2+s+16));r=Buffer.concat([r,a]),i+=18+s}return r}(e,this.encryption):e}onHttpServerListening(){const e=this.internalHttpServer.address(),t="IPv6"===e.family?`[${e.address}]`:e.address;this.internalHttpServerPort=e.port,de("[%s] Internal HTTP server listening on %s:%s",this.remoteAddress,t,e.port),this.internalHttpServer.on("close",this.onHttpServerClose.bind(this)),this.httpSocket=m().createConnection(this.internalHttpServerPort,this.internalHttpServerAddress),this.httpSocket.setNoDelay(!0),this.httpSocket.on("data",this.handleHttpServerResponse.bind(this)),this.httpSocket.on("error",this.onHttpSocketError.bind(this)),this.httpSocket.on("close",this.onHttpSocketClose.bind(this)),this.httpSocket.on("connect",(()=>{this.state=pe.FULLY_SET_UP,de("[%s] Internal HTTP socket connected. HAPConnection now fully set up!",this.remoteAddress),this.pendingClientSocketData&&this.pendingClientSocketData.length>0&&this.httpSocket.write(this.pendingClientSocketData),this.pendingClientSocketData=void 0}))}onTCPSocketData(e){if(!(this.state>pe.AUTHENTICATED)){this.handlingRequest=!0,this.lastSocketOperation=(new Date).getTime();try{e=this.decrypt(e)}catch(e){return de("[%s] Error occurred trying to decrypt incoming packet: %s",this.remoteAddress,e.message),void this.close()}this.state<pe.FULLY_SET_UP?this.pendingClientSocketData=Buffer.concat([this.pendingClientSocketData,e]):this.httpSocket.write(e)}}handleHttpServerRequest(e,t){this.state>pe.AUTHENTICATED||(e.socket.setNoDelay(!0),t.connection.setNoDelay(!0),de("[%s] HTTP request: %s",this.remoteAddress,e.url),this.emit(ye.REQUEST,e,t))}handleHttpServerResponse(e){e=this.encrypt(e),this.tcpSocket.write(e,this.handleTCPSocketWriteFulfilled.bind(this)),de("[%s] HTTP Response is finished",this.remoteAddress),this.handlingRequest=!1,this.state===pe.TO_BE_TEARED_DOWN?setTimeout((()=>this.close()),10):this.state<pe.TO_BE_TEARED_DOWN&&(this.writePendingEventNotifications(),this.writeQueuedEventNotifications())}handleTCPSocketWriteFulfilled(){this.lastSocketOperation=(new Date).getTime()}onTCPSocketError(e){de("[%s] Client connection error: %s",this.remoteAddress,e.message)}onTCPSocketClose(){this.state=pe.CLOSED,de("[%s] Client connection closed",this.remoteAddress),this.httpSocket&&this.httpSocket.destroy(),this.internalHttpServer.close(),this.emit(ye.CLOSED),this.removeAllListeners()}onHttpServerError(e){de("[%s] HTTP server error: %s",this.remoteAddress,e.message),"EADDRINUSE"===e.code&&(this.internalHttpServerPort=void 0,this.internalHttpServer.close(),this.internalHttpServer.listen(0,this.internalHttpServerAddress=ue()))}onHttpServerClose(){de("[%s] HTTP server was closed",this.remoteAddress),this.close()}onHttpSocketError(e){de("[%s] HTTP connection error: ",this.remoteAddress,e.message)}onHttpSocketClose(){de("[%s] HTTP connection was closed",this.remoteAddress),this.internalHttpServer.close()}getLocalAddress(e){const t=X().networkInterfaces()[this.networkInterface];if("ipv4"===e){for(const e of t)if("IPv4"===e.family||4===e.family)return e.address;throw new Error("Could not find "+e+" address for interface "+this.networkInterface)}{let r;for(const e of t)if("IPv6"===e.family||6===e.family){if(!e.scopeid)return e.address;r||(r=e.address)}if(!r)throw new Error("Could not find "+e+" address for interface "+this.networkInterface);return r}}static getLocalNetworkInterface(e){let t=e.localAddress;if(t.startsWith("::ffff:"))t=t.substring(7);else{const e=t.indexOf("%");-1!==e&&(t=t.substring(0,e))}const r=X().networkInterfaces();for(const[e,n]of Object.entries(r))for(const r of n)if(r.address===t)return e;const n=m().isIPv4(t)?"IPv4":"IPv6";for(const[e,i]of Object.entries(r))for(const r of i)if(r.family===n&&(0,W.getNetAddress)(t,r.netmask)===(0,W.getNetAddress)(r.address,r.netmask))return e;return console.log(`WARNING couldn't map socket coming from remote address ${e.remoteAddress}:${e.remotePort} at local address ${e.localAddress} to a interface!`),Object.keys(r)[1]}}function ve(e,t,...r){const n=[];if("number"==typeof t?t=Buffer.from([t]):"string"==typeof t&&(t=Buffer.from(t)),Array.isArray(t)){let r=!0;for(const i of t)r?r=!1:n.push(Buffer.from([0,0])),n.push(ve(e,i))}else if(t.length<=255)n.push(Buffer.concat([Buffer.from([e,t.length]),t]));else{let r=t.length,i=0;for(;r>0;)r>=255?(n.push(Buffer.concat([Buffer.from([e,255]),t.slice(i,i+255)])),r-=255,i+=255):(n.push(Buffer.concat([Buffer.from([e,r]),t.slice(i)])),r-=r)}if(r.length>=2){const[e,t,...i]=r,s=ve(e,t,...i);n.push(s)}return Buffer.concat(n)}function be(e){const t={};let r=e.length,n=0;for(;r>0;){const i=e[n],s=e[n+1];n+=2,r-=2;const o=e.slice(n,n+s);t[i]?t[i]=Buffer.concat([t[i],o]):t[i]=o,n+=s,r-=s}return t}function Ee(e){const t=Buffer.alloc(4);return t.writeUInt32LE(e,0),t}function Se(e){const t=Buffer.alloc(2);return t.writeUInt16LE(e,0),t}const Ae=d()("HAP-NodeJS:HAPServer");var Ie,we,Te;let Ce,_e;function De(e){return e>=_e.NOT_ALLOWED_IN_CURRENT_STATE&&e<=_e.INSUFFICIENT_PRIVILEGES}!function(e){e[e.REQUEST_TYPE=0]="REQUEST_TYPE",e[e.METHOD=0]="METHOD",e[e.USERNAME=1]="USERNAME",e[e.IDENTIFIER=1]="IDENTIFIER",e[e.SALT=2]="SALT",e[e.PUBLIC_KEY=3]="PUBLIC_KEY",e[e.PASSWORD_PROOF=4]="PASSWORD_PROOF",e[e.ENCRYPTED_DATA=5]="ENCRYPTED_DATA",e[e.SEQUENCE_NUM=6]="SEQUENCE_NUM",e[e.STATE=6]="STATE",e[e.ERROR_CODE=7]="ERROR_CODE",e[e.RETRY_DELAY=8]="RETRY_DELAY",e[e.CERTIFICATE=9]="CERTIFICATE",e[e.PROOF=10]="PROOF",e[e.SIGNATURE=10]="SIGNATURE",e[e.PERMISSIONS=11]="PERMISSIONS",e[e.FRAGMENT_DATA=12]="FRAGMENT_DATA",e[e.FRAGMENT_LAST=13]="FRAGMENT_LAST",e[e.SEPARATOR=255]="SEPARATOR"}(Ie||(Ie={})),function(e){e[e.PAIR_SETUP=0]="PAIR_SETUP",e[e.PAIR_SETUP_WITH_AUTH=1]="PAIR_SETUP_WITH_AUTH",e[e.PAIR_VERIFY=2]="PAIR_VERIFY",e[e.ADD_PAIRING=3]="ADD_PAIRING",e[e.REMOVE_PAIRING=4]="REMOVE_PAIRING",e[e.LIST_PAIRINGS=5]="LIST_PAIRINGS"}(we||(we={})),function(e){e[e.M1=1]="M1",e[e.M2=2]="M2",e[e.M3=3]="M3",e[e.M4=4]="M4",e[e.M5=5]="M5",e[e.M6=6]="M6"}(Te||(Te={})),function(e){e[e.UNKNOWN=1]="UNKNOWN",e[e.INVALID_REQUEST=2]="INVALID_REQUEST",e[e.AUTHENTICATION=2]="AUTHENTICATION",e[e.BACKOFF=3]="BACKOFF",e[e.MAX_PEERS=4]="MAX_PEERS",e[e.MAX_TRIES=5]="MAX_TRIES",e[e.UNAVAILABLE=6]="UNAVAILABLE",e[e.BUSY=7]="BUSY"}(Ce||(Ce={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.INSUFFICIENT_PRIVILEGES=-70401]="INSUFFICIENT_PRIVILEGES",e[e.SERVICE_COMMUNICATION_FAILURE=-70402]="SERVICE_COMMUNICATION_FAILURE",e[e.RESOURCE_BUSY=-70403]="RESOURCE_BUSY",e[e.READ_ONLY_CHARACTERISTIC=-70404]="READ_ONLY_CHARACTERISTIC",e[e.WRITE_ONLY_CHARACTERISTIC=-70405]="WRITE_ONLY_CHARACTERISTIC",e[e.NOTIFICATION_NOT_SUPPORTED=-70406]="NOTIFICATION_NOT_SUPPORTED",e[e.OUT_OF_RESOURCE=-70407]="OUT_OF_RESOURCE",e[e.OPERATION_TIMED_OUT=-70408]="OPERATION_TIMED_OUT",e[e.RESOURCE_DOES_NOT_EXIST=-70409]="RESOURCE_DOES_NOT_EXIST",e[e.INVALID_VALUE_IN_REQUEST=-70410]="INVALID_VALUE_IN_REQUEST",e[e.INSUFFICIENT_AUTHORIZATION=-70411]="INSUFFICIENT_AUTHORIZATION",e[e.NOT_ALLOWED_IN_CURRENT_STATE=-70412]="NOT_ALLOWED_IN_CURRENT_STATE"}(_e||(_e={}));let Re,Ne,Oe;!function(e){e[e.OK=200]="OK",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.MULTI_STATUS=207]="MULTI_STATUS",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE"}(Re||(Re={})),function(e){e[e.OK=200]="OK",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.METHOD_NOT_ALLOWED=405]="METHOD_NOT_ALLOWED",e[e.TOO_MANY_REQUESTS=429]="TOO_MANY_REQUESTS",e[e.CONNECTION_AUTHORIZATION_REQUIRED=470]="CONNECTION_AUTHORIZATION_REQUIRED",e[e.INTERNAL_SERVER_ERROR=500]="INTERNAL_SERVER_ERROR"}(Ne||(Ne={})),function(e){e.LISTENING="listening",e.IDENTIFY="identify",e.ADD_PAIRING="add-pairing",e.REMOVE_PAIRING="remove-pairing",e.LIST_PAIRINGS="list-pairings",e.PAIR="pair",e.ACCESSORIES="accessories",e.GET_CHARACTERISTICS="get-characteristics",e.SET_CHARACTERISTICS="set-characteristics",e.REQUEST_RESOURCE="request-resource",e.CONNECTION_CLOSED="connection-closed"}(Oe||(Oe={}));class Ue extends l.EventEmitter{unsuccessfulPairAttempts=0;constructor(e){super(),this.accessoryInfo=e,this.allowInsecureRequest=!1,this.httpServer=new me,this.httpServer.on(fe.LISTENING,this.onListening.bind(this)),this.httpServer.on(fe.REQUEST,this.handleRequestOnHAPConnection.bind(this)),this.httpServer.on(fe.CONNECTION_CLOSED,this.handleConnectionClosed.bind(this))}listen(e=0,t){"::"===t&&(t=void 0),this.httpServer.listen(e,t)}stop(){this.httpServer.stop()}destroy(){this.stop(),this.removeAllListeners()}sendEventNotifications(e,t,r,n,i){try{this.httpServer.broadcastEvent(e,t,r,n,i)}catch(e){console.warn("["+this.accessoryInfo.username+"] Error when sending event notifications: "+e.message)}}onListening(e,t){this.emit(Oe.LISTENING,e,t)}handleRequestOnHAPConnection(e,t,r){Ae("[%s] HAP Request: %s %s",this.accessoryInfo.username,t.method,t.url);const n=[];t.on("data",(e=>n.push(e))),t.on("end",(()=>{const i=new $.URL(t.url,"http://hap-nodejs.local"),s=this.getHandler(i);if(s){const o=Buffer.concat(n);try{s(e,i,t,o,r)}catch(e){Ae("[%s] Error executing route handler: %s",this.accessoryInfo.username,e.stack),r.writeHead(Re.INTERNAL_SERVER_ERROR,{"Content-Type":"application/hap+json"}),r.end(JSON.stringify({status:_e.RESOURCE_BUSY}))}}else Ae("[%s] WARNING: Handler for %s not implemented",this.accessoryInfo.username,t.url),r.writeHead(Re.NOT_FOUND,{"Content-Type":"application/hap+json"}),r.end(JSON.stringify({status:_e.RESOURCE_DOES_NOT_EXIST}))}))}handleConnectionClosed(e){this.emit(Oe.CONNECTION_CLOSED,e)}getHandler(e){switch(e.pathname.toLowerCase()){case"/identify":return this.handleIdentifyRequest.bind(this);case"/pair-setup":return this.handlePairSetup.bind(this);case"/pair-verify":return this.handlePairVerify.bind(this);case"/pairings":return this.handlePairings.bind(this);case"/accessories":return this.handleAccessories.bind(this);case"/characteristics":return this.handleCharacteristics.bind(this);case"/prepare":return this.handlePrepareWrite.bind(this);case"/resource":return this.handleResource.bind(this);default:return}}handleIdentifyRequest(e,t,r,n,i){if(!this.allowInsecureRequest&&this.accessoryInfo.paired())return i.writeHead(Re.BAD_REQUEST,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INSUFFICIENT_PRIVILEGES}));this.emit(Oe.IDENTIFY,K((e=>{e?(Ae("[%s] Identification error: %s",this.accessoryInfo.username,e.message),i.writeHead(Re.INTERNAL_SERVER_ERROR,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({status:_e.RESOURCE_BUSY}))):(Ae("[%s] Identification success",this.accessoryInfo.username),i.writeHead(Re.NO_CONTENT),i.end())})))}handlePairSetup(e,t,r,n,i){if(!this.allowInsecureRequest&&this.accessoryInfo.paired())return i.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),void i.end(ve(Ie.STATE,Te.M2,Ie.ERROR_CODE,Ce.UNAVAILABLE));if(this.unsuccessfulPairAttempts>100)return Ae("[%s] Reached maximum amount of unsuccessful pair attempts!",this.accessoryInfo.username),i.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),void i.end(ve(Ie.STATE,Te.M2,Ie.ERROR_CODE,Ce.MAX_TRIES));const s=be(n),o=s[Ie.SEQUENCE_NUM][0];if(o==Te.M1)this.handlePairSetupM1(e,r,i);else if(o==Te.M3&&e._pairSetupState===Te.M2)this.handlePairSetupM3(e,r,i,s);else{if(o!=Te.M5||e._pairSetupState!==Te.M4)return i.writeHead(Ne.BAD_REQUEST,{"Content-Type":"application/pairing+tlv8"}),void i.end(ve(Ie.STATE,o+1,Ie.ERROR_CODE,Ce.UNKNOWN));this.handlePairSetupM5(e,r,i,s)}}handlePairSetupM1(e,t,r){Ae("[%s] Pair step 1/5",this.accessoryInfo.username);const n=p().randomBytes(16),i=q.SRP.params.hap;q.SRP.genKey(32).then((t=>{const s=new q.SrpServer(i,n,Buffer.from("Pair-Setup"),Buffer.from(this.accessoryInfo.pincode),t),o=s.computeB();e.srpServer=s,r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M2,Ie.SALT,n,Ie.PUBLIC_KEY,o)),e._pairSetupState=Te.M2})).catch((e=>{Ae("[%s] Error occurred when generating srp key: %s",this.accessoryInfo.username,e.message),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.STATE,Te.M2,Ie.ERROR_CODE,Ce.UNKNOWN))}))}handlePairSetupM3(e,t,r,n){Ae("[%s] Pair step 2/5",this.accessoryInfo.username);const i=n[Ie.PUBLIC_KEY],s=n[Ie.PASSWORD_PROOF],o=e.srpServer;o.setA(i);try{o.checkM1(s)}catch(t){return this.unsuccessfulPairAttempts++,Ae("[%s] Error while checking pincode: %s",this.accessoryInfo.username,t.message),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M4,Ie.ERROR_CODE,Ce.AUTHENTICATION)),void(e._pairSetupState=void 0)}const a=o.computeM2();r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M4,Ie.PASSWORD_PROOF,a)),e._pairSetupState=Te.M4}handlePairSetupM5(e,t,r,n){Ae("[%s] Pair step 3/5",this.accessoryInfo.username);const i=e.srpServer,s=n[Ie.ENCRYPTED_DATA],o=Buffer.alloc(s.length-16),a=Buffer.alloc(16);s.copy(o,0,0,s.length-16),s.copy(a,0,s.length-16,s.length);const c=i.computeK(),u=te("sha512",Buffer.from("Pair-Setup-Encrypt-Salt"),c,Buffer.from("Pair-Setup-Encrypt-Info"),32);let h;try{h=re(u,Buffer.from("PS-Msg05"),null,o,a)}catch(t){return Ae("[%s] Error while decrypting and verifying M5 subTlv: %s",this.accessoryInfo.username),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M4,Ie.ERROR_CODE,Ce.AUTHENTICATION)),void(e._pairSetupState=void 0)}const d=be(h),l=d[Ie.USERNAME],f=d[Ie.PUBLIC_KEY],p=d[Ie.PROOF];this.handlePairSetupM5_2(e,t,r,l,f,p,u)}handlePairSetupM5_2(e,t,r,n,i,s,o){Ae("[%s] Pair step 4/5",this.accessoryInfo.username);const a=e.srpServer.computeK(),c=te("sha512",Buffer.from("Pair-Setup-Controller-Sign-Salt"),a,Buffer.from("Pair-Setup-Controller-Sign-Info"),32),u=Buffer.concat([c,n,i]);if(!z().sign.detached.verify(u,s,i))return Ae("[%s] Invalid signature",this.accessoryInfo.username),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M6,Ie.ERROR_CODE,Ce.AUTHENTICATION)),void(e._pairSetupState=void 0);this.handlePairSetupM5_3(e,t,r,n,i,o)}handlePairSetupM5_3(e,t,r,n,i,s){Ae("[%s] Pair step 5/5",this.accessoryInfo.username);const o=e.srpServer.computeK(),a=te("sha512",Buffer.from("Pair-Setup-Accessory-Sign-Salt"),o,Buffer.from("Pair-Setup-Accessory-Sign-Info"),32),c=this.accessoryInfo.signPk,u=Buffer.from(this.accessoryInfo.username),h=Buffer.concat([a,u,c]),d=Buffer.from(this.accessoryInfo.signSk),l=z().sign.detached(h,d),f=ve(Ie.USERNAME,u,Ie.PUBLIC_KEY,c,Ie.PROOF,l),p=ne(s,Buffer.from("PS-Msg06"),null,f);this.emit(Oe.PAIR,n.toString(),i,K((t=>{if(t)return Ae("[%s] Error adding pairing info: %s",this.accessoryInfo.username,t.message),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M6,Ie.ERROR_CODE,Ce.UNKNOWN)),void(e._pairSetupState=void 0);r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M6,Ie.ENCRYPTED_DATA,Buffer.concat([p.ciphertext,p.authTag]))),e._pairSetupState=void 0})))}handlePairVerify(e,t,r,n,i){const s=be(n),o=s[Ie.SEQUENCE_NUM][0];if(o==Te.M1)this.handlePairVerifyM1(e,r,i,s);else{if(o!=Te.M3||e._pairVerifyState!==Te.M2)return i.writeHead(Ne.BAD_REQUEST,{"Content-Type":"application/pairing+tlv8"}),void i.end(ve(Ie.STATE,o+1,Ie.ERROR_CODE,Ce.UNKNOWN));this.handlePairVerifyM2(e,r,i,s)}}handlePairVerifyM1(e,t,r,n){Ae("[%s] Pair verify step 1/2",this.accessoryInfo.username);const i=n[Ie.PUBLIC_KEY],s=z().box.keyPair(),o=Buffer.from(s.secretKey),a=Buffer.from(s.publicKey),c=Buffer.from((u=o,h=i,z().scalarMult(u,h)));var u,h;const d=Buffer.from(this.accessoryInfo.username),l=Buffer.concat([a,d,i]),f=Buffer.from(this.accessoryInfo.signSk),p=z().sign.detached(l,f),y=te("sha512",Buffer.from("Pair-Verify-Encrypt-Salt"),c,Buffer.from("Pair-Verify-Encrypt-Info"),32).slice(0,32);e.encryption=new le(i,o,a,c,y);const m=ve(Ie.USERNAME,d,Ie.PROOF,p),g=ne(y,Buffer.from("PV-Msg02"),null,m);r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M2,Ie.ENCRYPTED_DATA,Buffer.concat([g.ciphertext,g.authTag]),Ie.PUBLIC_KEY,a)),e._pairVerifyState=Te.M2}handlePairVerifyM2(e,t,r,n){Ae("[%s] Pair verify step 2/2",this.accessoryInfo.username);const i=n[Ie.ENCRYPTED_DATA],s=Buffer.alloc(i.length-16),o=Buffer.alloc(16);i.copy(s,0,0,i.length-16),i.copy(o,0,i.length-16,i.length);const a=e.encryption;let c;try{c=re(a.hkdfPairEncryptionKey,Buffer.from("PV-Msg03"),null,s,o)}catch(t){return Ae("[%s] M3: Failed to decrypt and/or verify",this.accessoryInfo.username),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.STATE,Te.M4,Ie.ERROR_CODE,Ce.AUTHENTICATION)),void(e._pairVerifyState=void 0)}const u=be(c),h=u[Ie.USERNAME],d=u[Ie.PROOF],l=Buffer.concat([a.clientPublicKey,h,a.publicKey]),f=this.accessoryInfo.getClientPublicKey(h.toString());if(!f)return Ae("[%s] Client %s attempting to verify, but we are not paired; rejecting client",this.accessoryInfo.username,h),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.STATE,Te.M4,Ie.ERROR_CODE,Ce.AUTHENTICATION)),void(e._pairVerifyState=void 0);if(!z().sign.detached.verify(l,d,f))return Ae("[%s] Client %s provided an invalid signature",this.accessoryInfo.username,h),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.STATE,Te.M4,Ie.ERROR_CODE,Ce.AUTHENTICATION)),void(e._pairVerifyState=void 0);Ae("[%s] Client %s verification complete",this.accessoryInfo.username,h),r.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),r.end(ve(Ie.SEQUENCE_NUM,Te.M4));const p=Buffer.from("Control-Salt"),y=Buffer.from("Control-Read-Encryption-Key"),m=Buffer.from("Control-Write-Encryption-Key");a.accessoryToControllerKey=te("sha512",p,a.sharedSecret,y,32),a.controllerToAccessoryKey=te("sha512",p,a.sharedSecret,m,32),e.connectionAuthenticated(h.toString()),e._pairVerifyState=void 0}handlePairings(e,t,r,n,i){if(!this.allowInsecureRequest&&!e.isAuthenticated())return i.writeHead(Ne.CONNECTION_AUTHORIZATION_REQUIRED,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INSUFFICIENT_PRIVILEGES}));const s=be(n),o=s[Ie.METHOD][0];if(s[Ie.STATE][0]===Te.M1)if(o===we.ADD_PAIRING){const t=s[Ie.IDENTIFIER].toString(),r=s[Ie.PUBLIC_KEY],n=s[Ie.PERMISSIONS][0];this.emit(Oe.ADD_PAIRING,e,t,r,n,K((e=>{if(e>0)return Ae("[%s] Pairings: failed ADD_PAIRING with code %d",this.accessoryInfo.username,e),i.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),void i.end(ve(Ie.STATE,Te.M2,Ie.ERROR_CODE,e));i.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),i.end(ve(Ie.STATE,Te.M2)),Ae("[%s] Pairings: successfully executed ADD_PAIRING",this.accessoryInfo.username)})))}else if(o===we.REMOVE_PAIRING){const t=s[Ie.IDENTIFIER].toString();this.emit(Oe.REMOVE_PAIRING,e,t,K((e=>{if(e>0)return Ae("[%s] Pairings: failed REMOVE_PAIRING with code %d",this.accessoryInfo.username,e),i.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),void i.end(ve(Ie.STATE,Te.M2,Ie.ERROR_CODE,e));i.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),i.end(ve(Ie.STATE,Te.M2)),Ae("[%s] Pairings: successfully executed REMOVE_PAIRING",this.accessoryInfo.username)})))}else o===we.LIST_PAIRINGS&&this.emit(Oe.LIST_PAIRINGS,e,K(((e,t)=>{if(e>0)return Ae("[%s] Pairings: failed LIST_PAIRINGS with code %d",this.accessoryInfo.username,e),i.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),void i.end(ve(Ie.STATE,Te.M2,Ie.ERROR_CODE,e));const r=[];t.forEach(((e,t)=>{t>0&&r.push(Ie.SEPARATOR,Buffer.alloc(0)),r.push(Ie.IDENTIFIER,e.username,Ie.PUBLIC_KEY,e.publicKey,Ie.PERMISSIONS,e.permission)}));const n=ve(Ie.STATE,Te.M2,...r);i.writeHead(Ne.OK,{"Content-Type":"application/pairing+tlv8"}),i.end(n),Ae("[%s] Pairings: successfully executed LIST_PAIRINGS",this.accessoryInfo.username)})))}handleAccessories(e,t,r,n,i){if(!this.allowInsecureRequest&&!e.isAuthenticated())return i.writeHead(Ne.CONNECTION_AUTHORIZATION_REQUIRED,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INSUFFICIENT_PRIVILEGES}));this.emit(Oe.ACCESSORIES,e,K(((e,t)=>{e?(i.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({status:e.status}))):(i.writeHead(Re.OK,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify(t)))})))}handleCharacteristics(e,t,r,n,i){if(!this.allowInsecureRequest&&!e.isAuthenticated())return i.writeHead(Ne.CONNECTION_AUTHORIZATION_REQUIRED,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INSUFFICIENT_PRIVILEGES}));if("GET"===r.method){const r=t.searchParams,n=r.get("id");if(!n)return i.writeHead(Re.BAD_REQUEST,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INVALID_VALUE_IN_REQUEST}));const s=[];for(const e of n.split(",")){const t=e.split(".");s.push({aid:parseInt(t[0],10),iid:parseInt(t[1],10)})}const o={ids:s,includeMeta:v(r.get("meta")),includePerms:v(r.get("perms")),includeType:v(r.get("type")),includeEvent:v(r.get("ev"))};this.emit(Oe.GET_CHARACTERISTICS,e,o,K(((e,t)=>{if(e)return i.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:e.status}));const r=t.characteristics;let n=!1;for(const e of r)if(e.status){n=!0;break}if(n)for(const e of r)e.status||(e.status=_e.SUCCESS);i.writeHead(n?Re.MULTI_STATUS:Re.OK,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({characteristics:r}))})))}else if("PUT"===r.method){if(!e.isAuthenticated()&&(!r.headers||r.headers&&r.headers.authorization!==this.accessoryInfo.pincode))return i.writeHead(Ne.CONNECTION_AUTHORIZATION_REQUIRED,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INSUFFICIENT_PRIVILEGES}));if(0===n.length)return i.writeHead(400,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INVALID_VALUE_IN_REQUEST}));const t=JSON.parse(n.toString("utf8"));this.emit(Oe.SET_CHARACTERISTICS,e,t,K(((e,t)=>{if(e)return i.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:e.status}));const r=t.characteristics;let n=!1;for(const e of r)if(e.status||void 0!==e.value){n=!0;break}if(n){for(const e of r)void 0===e.status&&(e.status=_e.SUCCESS);i.writeHead(Re.MULTI_STATUS,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({characteristics:r}))}else i.writeHead(Re.NO_CONTENT),i.end()})))}else i.writeHead(Re.BAD_REQUEST,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({status:_e.INVALID_VALUE_IN_REQUEST}))}handlePrepareWrite(e,t,r,n,i){if(!this.allowInsecureRequest&&!e.isAuthenticated())return i.writeHead(Ne.CONNECTION_AUTHORIZATION_REQUIRED,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INSUFFICIENT_PRIVILEGES}));if("PUT"==r.method){if(0==n.length)return i.writeHead(Re.BAD_REQUEST,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INVALID_VALUE_IN_REQUEST}));const t=JSON.parse(n.toString());if(t.pid&&t.ttl)return Ae("[%s] Received prepare write request with pid %d and ttl %d",this.accessoryInfo.username,t.pid,t.ttl),e.timedWriteTimeout&&clearTimeout(e.timedWriteTimeout),e.timedWritePid=t.pid,e.timedWriteTimeout=setTimeout((()=>{Ae("[%s] Timed write request timed out for pid %d",this.accessoryInfo.username,t.pid),e.timedWritePid=void 0,e.timedWriteTimeout=void 0}),t.ttl),i.writeHead(Re.OK,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.SUCCESS}));i.writeHead(Re.BAD_REQUEST,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({status:_e.INVALID_VALUE_IN_REQUEST}))}else i.writeHead(Re.BAD_REQUEST,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({status:_e.INVALID_VALUE_IN_REQUEST}))}handleResource(e,t,r,n,i){if(!(e.isAuthenticated()||this.allowInsecureRequest&&r.headers&&r.headers.authorization===this.accessoryInfo.pincode))return i.writeHead(Ne.CONNECTION_AUTHORIZATION_REQUIRED,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INSUFFICIENT_PRIVILEGES}));if("POST"===r.method){if(0===n.length)return i.writeHead(Re.BAD_REQUEST,{"Content-Type":"application/hap+json"}),void i.end(JSON.stringify({status:_e.INVALID_VALUE_IN_REQUEST}));const e=JSON.parse(n.toString());this.emit(Oe.REQUEST_RESOURCE,e,K(((e,t)=>{e?(i.writeHead(e.httpCode,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({status:e.status}))):(i.writeHead(Re.OK,{"Content-Type":"image/jpeg"}),i.end(t))})))}else i.writeHead(Re.BAD_REQUEST,{"Content-Type":"application/hap+json"}),i.end(JSON.stringify({status:_e.INVALID_VALUE_IN_REQUEST}))}}const Pe=d()("HAP-NodeJS:Service");let Be;!function(e){e.CHARACTERISTIC_CHANGE="characteristic-change",e.SERVICE_CONFIGURATION_CHANGE="service-configurationChange",e.CHARACTERISTIC_WARNING="characteristic-warning"}(Be||(Be={}));class xe extends l.EventEmitter{iid=null;name=null;characteristics=[];optionalCharacteristics=[];isHiddenService=!1;isPrimaryService=!1;linkedServices=[];constructor(e="",t,r){if(super(),u()(t,"Services must be created with a valid UUID."),this.displayName=e,this.UUID=t,this.subtype=r,e){(this.getCharacteristic(sn.Name)||this.addCharacteristic(sn.Name)).updateValue(e)}}getServiceId(){return this.UUID+(this.subtype||"")}addCharacteristic(e,...t){let r="function"==typeof e?new e(...t):e;for(const e of this.characteristics)if(e.UUID===r.UUID){if("00000052-0000-1000-8000-0026BB765291"===r.UUID)return e;throw new Error("Cannot add a Characteristic with the same UUID as another Characteristic in this Service: "+e.UUID)}if(this.characteristics.length>=100)throw new Error("Cannot add more than 100 characteristics to a single service!");return this.setupCharacteristicEventHandlers(r),this.characteristics.push(r),this.emit(Be.SERVICE_CONFIGURATION_CHANGE),r}setPrimaryService(e=!0){this.isPrimaryService=e,this.emit(Be.SERVICE_CONFIGURATION_CHANGE)}setHiddenService(e=!0){this.isHiddenService=e,this.emit(Be.SERVICE_CONFIGURATION_CHANGE)}addLinkedService(e){this.linkedServices.includes(e)||this.linkedServices.push(e),this.emit(Be.SERVICE_CONFIGURATION_CHANGE)}removeLinkedService(e){const t=this.linkedServices.indexOf(e);-1!==t&&this.linkedServices.splice(t,1),this.emit(Be.SERVICE_CONFIGURATION_CHANGE)}removeCharacteristic(e){const t=this.characteristics.indexOf(e);-1!==t&&(this.characteristics.splice(t,1),e.removeAllListeners(),this.emit(Be.SERVICE_CONFIGURATION_CHANGE))}getCharacteristic(e){for(const t of this.characteristics){if("string"==typeof e&&t.displayName===e)return t;if("function"==typeof e&&(t instanceof e||e.UUID===t.UUID))return t}if("function"==typeof e){for(const t of this.optionalCharacteristics)if(t instanceof e||e.UUID===t.UUID)return this.addCharacteristic(e);const t=this.addCharacteristic(e);return e.UUID!==sn.Name.UUID&&this.emitCharacteristicWarningEvent(t,qr.WARN_MESSAGE,"Characteristic not in required or optional characteristic section for service "+this.constructor.name+". Adding anyway."),t}}testCharacteristic(e){for(const t of this.characteristics){if("string"==typeof e&&t.displayName===e)return!0;if("function"==typeof e&&(t instanceof e||e.UUID===t.UUID))return!0}return!1}setCharacteristic(e,t){return this.getCharacteristic(e).setValue(t),this}updateCharacteristic(e,t){return this.getCharacteristic(e).updateValue(t),this}addOptionalCharacteristic(e){"function"==typeof e&&(e=new e),this.optionalCharacteristics.push(e)}replaceCharacteristicsFromService(e){if(this.UUID!==e.UUID)throw new Error(`Incompatible services. Tried replacing characteristics of ${this.UUID} with characteristics from ${e.UUID}`);const t={};e.characteristics.forEach((e=>t[e.UUID]=e)),this.characteristics.forEach((e=>{const r=t[e.UUID];if(r){if(delete t[e.UUID],!r.value&&0!==r.value&&!1!==r.value)return;e.replaceBy(r)}})),Object.values(t).forEach((e=>this.addCharacteristic(e)))}getCharacteristicByIID(e){for(const t of this.characteristics)if(t.iid===e)return t}_assignIDs(e,t,r=0){"0000003E-0000-1000-8000-0026BB765291"===this.UUID?this.iid=1:this.iid=r+e.getIID(t,this.UUID,this.subtype);for(const r of this.characteristics)r._assignID(e,t,this.UUID,this.subtype)}toHAP(e,t=!0){return new Promise((r=>{u()(this.iid,"iid cannot be undefined for service '"+this.displayName+"'"),u()(this.characteristics.length,"service '"+this.displayName+"' does not have any characteristics!");const n={type:j(this.UUID),iid:this.iid,characteristics:[],hidden:!!this.isHiddenService||void 0,primary:!!this.isPrimaryService||void 0};if(this.linkedServices.length){n.linked=[];for(const e of this.linkedServices)e.iid?n.linked.push(e.iid):Pe(`iid of linked service '${e.displayName}' ${e.UUID} is undefined on service '${this.displayName}'`)}const i=new Set;let s=setTimeout((()=>{for(const e of i)this.emitCharacteristicWarningEvent(e,qr.SLOW_READ,`The read handler for the characteristic '${e.displayName}' was slow to respond!`);s=setTimeout((()=>{s=void 0;for(const e of i)this.emitCharacteristicWarningEvent(e,qr.TIMEOUT_READ,"The read handler for the characteristic '"+e?.displayName+"' didn't respond at all!. Please check that you properly call the callback!"),n.characteristics.push(e.internalHAPRepresentation());i.clear(),r(n)}),6e3)}),3e3);for(const o of this.characteristics)i.add(o),o.toHAP(e,t).then((e=>{s&&(i.delete(o),n.characteristics.push(e),0===i.size&&(s&&(clearTimeout(s),s=void 0),r(n)))}))}))}internalHAPRepresentation(){u()(this.iid,"iid cannot be undefined for service '"+this.displayName+"'"),u()(this.characteristics.length,"service '"+this.displayName+"' does not have any characteristics!");const e={type:j(this.UUID),iid:this.iid,characteristics:this.characteristics.map((e=>e.internalHAPRepresentation())),hidden:!!this.isHiddenService||void 0,primary:!!this.isPrimaryService||void 0};if(this.linkedServices.length){e.linked=[];for(const t of this.linkedServices)t.iid?e.linked.push(t.iid):Pe(`iid of linked service '${t.displayName}' ${t.UUID} is undefined on service '${this.displayName}'`)}return e}setupCharacteristicEventHandlers(e){e.on(rn.CHANGE,(t=>{this.emit(Be.CHARACTERISTIC_CHANGE,{...t,characteristic:e})})),e.on(rn.CHARACTERISTIC_WARNING,this.emitCharacteristicWarningEvent.bind(this,e))}emitCharacteristicWarningEvent(e,t,r,n){this.emit(Be.CHARACTERISTIC_WARNING,{characteristic:e,type:t,message:r,originatorChain:[this.displayName,e.displayName],stack:n})}_sideloadCharacteristics(e){for(const t of e)this.setupCharacteristicEventHandlers(t);this.characteristics=e.slice()}static serialize(e){let t;return"Service"!==e.constructor.name&&(t=e.constructor.name),{displayName:e.displayName,UUID:e.UUID,subtype:e.subtype,constructorName:t,hiddenService:e.isHiddenService,primaryService:e.isPrimaryService,characteristics:e.characteristics.map((e=>sn.serialize(e))),optionalCharacteristics:e.optionalCharacteristics.map((e=>sn.serialize(e)))}}static deserialize(e){let t;if(e.constructorName&&e.constructorName.charAt(0).toUpperCase()===e.constructorName.charAt(0)&&xe[e.constructorName]){t=new(0,xe[e.constructorName])(e.displayName,e.subtype)}else t=new xe(e.displayName,e.UUID,e.subtype);t.isHiddenService=!!e.hiddenService,t.isPrimaryService=!!e.primaryService;const r=e.characteristics.map((e=>sn.deserialize(e)));return t._sideloadCharacteristics(r),e.optionalCharacteristics&&(t.optionalCharacteristics=e.optionalCharacteristics.map((e=>sn.deserialize(e)))),t}}const Me=d()("HAP-NodeJS:DataStream:Parser");class Le{static TERMINATOR={type:"terminator"}}class ke{constructor(e){this.value=e}equals(e){return this.constructor.name===e.constructor.name&&e.value===this.value}}class Fe extends ke{}class Ve extends ke{}class He extends ke{}class je extends ke{}class Ke extends ke{}class qe extends ke{}class Ge extends ke{}class ze extends ke{constructor(e){u()(k(e),"invalid uuid format"),super(e)}}let $e;!function(e){e[e.INVALID=0]="INVALID",e[e.TRUE=1]="TRUE",e[e.FALSE=2]="FALSE",e[e.TERMINATOR=3]="TERMINATOR",e[e.NULL=4]="NULL",e[e.UUID=5]="UUID",e[e.DATE=6]="DATE",e[e.INTEGER_MINUS_ONE=7]="INTEGER_MINUS_ONE",e[e.INTEGER_RANGE_START_0=8]="INTEGER_RANGE_START_0",e[e.INTEGER_RANGE_STOP_39=46]="INTEGER_RANGE_STOP_39",e[e.INT8=48]="INT8",e[e.INT16LE=49]="INT16LE",e[e.INT32LE=50]="INT32LE",e[e.INT64LE=51]="INT64LE",e[e.FLOAT32LE=53]="FLOAT32LE",e[e.FLOAT64LE=54]="FLOAT64LE",e[e.UTF8_LENGTH_START=64]="UTF8_LENGTH_START",e[e.UTF8_LENGTH_STOP=96]="UTF8_LENGTH_STOP",e[e.UTF8_LENGTH8=97]="UTF8_LENGTH8",e[e.UTF8_LENGTH16LE=98]="UTF8_LENGTH16LE",e[e.UTF8_LENGTH32LE=99]="UTF8_LENGTH32LE",e[e.UTF8_LENGTH64LE=100]="UTF8_LENGTH64LE",e[e.UTF8_NULL_TERMINATED=111]="UTF8_NULL_TERMINATED",e[e.DATA_LENGTH_START=112]="DATA_LENGTH_START",e[e.DATA_LENGTH_STOP=144]="DATA_LENGTH_STOP",e[e.DATA_LENGTH8=145]="DATA_LENGTH8",e[e.DATA_LENGTH16LE=146]="DATA_LENGTH16LE",e[e.DATA_LENGTH32LE=147]="DATA_LENGTH32LE",e[e.DATA_LENGTH64LE=148]="DATA_LENGTH64LE",e[e.DATA_TERMINATED=159]="DATA_TERMINATED",e[e.COMPRESSION_START=160]="COMPRESSION_START",e[e.COMPRESSION_STOP=207]="COMPRESSION_STOP",e[e.ARRAY_LENGTH_START=208]="ARRAY_LENGTH_START",e[e.ARRAY_LENGTH_STOP=222]="ARRAY_LENGTH_STOP",e[e.ARRAY_TERMINATED=223]="ARRAY_TERMINATED",e[e.DICTIONARY_LENGTH_START=224]="DICTIONARY_LENGTH_START",e[e.DICTIONARY_LENGTH_STOP=238]="DICTIONARY_LENGTH_STOP",e[e.DICTIONARY_TERMINATED=239]="DICTIONARY_TERMINATED"}($e||($e={}));class We{static decode(e){const t=e.readTag();if(t===$e.INVALID)throw new Error("HDSDecoder: zero tag detected on index "+e.readerIndex);if(t===$e.TRUE)return e.readTrue();if(t===$e.FALSE)return e.readFalse();if(t===$e.TERMINATOR)return Le.TERMINATOR;if(t===$e.NULL)return null;if(t===$e.UUID)return e.readUUID();if(t===$e.DATE)return e.readSecondsSince2001_01_01();if(t===$e.INTEGER_MINUS_ONE)return e.readNegOne();if(t>=$e.INTEGER_RANGE_START_0&&t<=$e.INTEGER_RANGE_STOP_39)return e.readIntRange(t);if(t===$e.INT8)return e.readInt8();if(t===$e.INT16LE)return e.readInt16LE();if(t===$e.INT32LE)return e.readInt32LE();if(t===$e.INT64LE)return e.readInt64LE();if(t===$e.FLOAT32LE)return e.readFloat32LE();if(t===$e.FLOAT64LE)return e.readFloat64LE();if(t>=$e.UTF8_LENGTH_START&&t<=$e.UTF8_LENGTH_STOP){const r=t-$e.UTF8_LENGTH_START;return e.readUTF8(r)}if(t===$e.UTF8_LENGTH8)return e.readUTF8_Length8();if(t===$e.UTF8_LENGTH16LE)return e.readUTF8_Length16LE();if(t===$e.UTF8_LENGTH32LE)return e.readUTF8_Length32LE();if(t===$e.UTF8_LENGTH64LE)return e.readUTF8_Length64LE();if(t===$e.UTF8_NULL_TERMINATED)return e.readUTF8_NULL_terminated();if(!(t>=$e.DATA_LENGTH_START&&t<=$e.DATA_LENGTH_STOP)){if(t===$e.DATA_LENGTH8)return e.readData_Length8();if(t===$e.DATA_LENGTH16LE)return e.readData_Length16LE();if(t===$e.DATA_LENGTH32LE)return e.readData_Length32LE();if(t===$e.DATA_LENGTH64LE)return e.readData_Length64LE();if(t===$e.DATA_TERMINATED)return e.readData_terminated();if(t>=$e.COMPRESSION_START&&t<=$e.COMPRESSION_STOP){const r=t-$e.COMPRESSION_START;return e.decompressData(r)}if(t>=$e.ARRAY_LENGTH_START&&t<=$e.ARRAY_LENGTH_STOP){const r=t-$e.ARRAY_LENGTH_START,n=[];for(let t=0;t<r;t++)n.push(this.decode(e));return n}if(t===$e.ARRAY_TERMINATED){const t=[];let r;for(;(r=this.decode(e))!=Le.TERMINATOR;)t.push(r);return t}if(t>=$e.DICTIONARY_LENGTH_START&&t<=$e.DICTIONARY_LENGTH_STOP){const r=t-$e.DICTIONARY_LENGTH_START,n={};for(let t=0;t<r;t++){n[this.decode(e)]=this.decode(e)}return n}if(t===$e.DICTIONARY_TERMINATED){const t={};let r;for(;(r=this.decode(e))!=Le.TERMINATOR;)t[r]=this.decode(e);return t}throw new Error("HDSDecoder: encountered unknown tag on index "+e.readerIndex+": "+t.toString(16))}{const r=t-$e.DATA_LENGTH_START;e.readData(r)}}static encode(e,t){if(void 0===e)throw new Error("HDSEncoder: cannot encode undefined");if(null!==e)switch(typeof e){case"boolean":e?t.writeTrue():t.writeFalse();break;case"number":Number.isInteger(e)?t.writeNumber(e):t.writeFloat64LE(new qe(e));break;case"string":t.writeUTF8(e);break;case"object":if(Array.isArray(e)){const r=e.length;r<=12?t.writeTag($e.ARRAY_LENGTH_START+r):t.writeTag($e.ARRAY_TERMINATED),e.forEach((e=>{this.encode(e,t)})),r>12&&t.writeTag($e.TERMINATOR)}else if(e instanceof ke)if(e instanceof Fe)t.writeInt8(e);else if(e instanceof Ve)t.writeInt16LE(e);else if(e instanceof He)t.writeInt32LE(e);else if(e instanceof je)t.writeInt64LE(e);else if(e instanceof Ke)t.writeFloat32LE(e);else if(e instanceof qe)t.writeFloat64LE(e);else if(e instanceof Ge)t.writeSecondsSince2001_01_01(e);else{if(!(e instanceof ze))throw new Error("Unknown wrapped object 'ValueWrapper' of class "+e.constructor.name);t.writeUUID(e.value)}else if(e instanceof Buffer)t.writeData(e);else{const r=Object.entries(e);r.length<=14?t.writeTag($e.DICTIONARY_LENGTH_START+r.length):t.writeTag($e.DICTIONARY_TERMINATED),r.forEach((e=>{this.encode(e[0],t),this.encode(e[1],t)})),r.length>14&&t.writeTag($e.TERMINATOR)}break;default:throw new Error("HDSEncoder: no idea how to encode value of type '"+typeof e+"': "+e)}else t.writeTag($e.NULL)}}class Ye{trackedCompressedData=[];constructor(e){this.data=e,this.readerIndex=0}finished(){if(this.readerIndex<this.data.length){const e=this.data.slice(this.readerIndex,this.data.length).toString("hex");Me("WARNING Finished reading HDS stream, but there are still %d bytes remaining () %s",this.data.length-this.readerIndex,e)}}decompressData(e){if(e>=this.trackedCompressedData.length)throw new Error("HDSDecoder: Tried decompression of data for an index out of range (index "+e+" and got "+this.trackedCompressedData.length+" elements)");return this.trackedCompressedData[e]}trackData(e){return this.trackedCompressedData.push(e),e}ensureLength(e){if(this.readerIndex+e>this.data.length){const t=this.data.length-this.readerIndex;throw new Error("HDSDecoder: End of data stream. Tried reading "+e+" bytes however got only "+t+" remaining!")}}readTag(){return this.ensureLength(1),this.data.readUInt8(this.readerIndex++)}readTrue(){return this.trackData(!0)}readFalse(){return this.trackData(!1)}readNegOne(){return this.trackData(-1)}readIntRange(e){return this.trackData(e-$e.INTEGER_RANGE_START_0)}readInt8(){return this.ensureLength(1),this.trackData(this.data.readInt8(this.readerIndex++))}readInt16LE(){this.ensureLength(2);const e=this.data.readInt16LE(this.readerIndex);return this.readerIndex+=2,this.trackData(e)}readInt32LE(){this.ensureLength(4);const e=this.data.readInt32LE(this.readerIndex);return this.readerIndex+=4,this.trackData(e)}readInt64LE(){this.ensureLength(8);const e=this.data.readInt32LE(this.readerIndex);let t=4294967296*this.data.readInt32LE(this.readerIndex+4)+e;return e<0&&(t+=4294967296),this.readerIndex+=8,this.trackData(t)}readFloat32LE(){this.ensureLength(4);const e=this.data.readFloatLE(this.readerIndex);return this.readerIndex+=4,this.trackData(e)}readFloat64LE(){this.ensureLength(8);const e=this.data.readDoubleLE(this.readerIndex);return this.trackData(e)}readLength8(){return this.ensureLength(1),this.data.readUInt8(this.readerIndex++)}readLength16LE(){this.ensureLength(2);const e=this.data.readUInt16LE(this.readerIndex);return this.readerIndex+=2,e}readLength32LE(){this.ensureLength(4);const e=this.data.readUInt32LE(this.readerIndex);return this.readerIndex+=4,e}readLength64LE(){this.ensureLength(8);const e=this.data.readUInt32LE(this.readerIndex),t=4294967296*this.data.readUInt32LE(this.readerIndex+4)+e;return this.readerIndex+=8,t}readUTF8(e){this.ensureLength(e);const t=this.data.toString("utf8",this.readerIndex,this.readerIndex+e);return this.readerIndex+=e,this.trackData(t)}readUTF8_Length8(){const e=this.readLength8();return this.readUTF8(e)}readUTF8_Length16LE(){const e=this.readLength16LE();return this.readUTF8(e)}readUTF8_Length32LE(){const e=this.readLength32LE();return this.readUTF8(e)}readUTF8_Length64LE(){const e=this.readLength64LE();return this.readUTF8(e)}readUTF8_NULL_terminated(){let e,t=this.readerIndex;for(;;){if(e=this.data[t],void 0===e)throw new Error("HDSDecoder: Reached end of data stream while reading NUL terminated string!");if(0===e)break;t++}const r=this.data.toString("utf8",this.readerIndex,t);return this.readerIndex=t+1,this.trackData(r)}readData(e){this.ensureLength(e);const t=this.data.slice(this.readerIndex,this.readerIndex+e);return this.readerIndex+=e,this.trackData(t)}readData_Length8(){const e=this.readLength8();return this.readData(e)}readData_Length16LE(){const e=this.readLength16LE();return this.readData(e)}readData_Length32LE(){const e=this.readLength32LE();return this.readData(e)}readData_Length64LE(){const e=this.readLength64LE();return this.readData(e)}readData_terminated(){let e,t=this.readerIndex;for(;;){if(e=this.data[t],void 0===e)throw new Error("HDSDecoder: Reached end of data stream while reading terminated data!");if(e===$e.TERMINATOR)break;t++}const r=this.data.slice(this.readerIndex,t);return this.readerIndex=t+1,this.trackData(r)}readSecondsSince2001_01_01(){return this.readFloat64LE()}readUUID(){this.ensureLength(16);const e=F(this.data,this.readerIndex);return this.readerIndex+=16,this.trackData(e)}}class Qe{writtenData=[];push(e){this.writtenData.push(e)}indexOf(e){for(let t=0;t<this.writtenData.length;t++){const r=this.writtenData[t];if(e===r)return t;if(e instanceof ke&&r instanceof ke&&e.equals(r))return t}return-1}}class Je{static chunkSize=128;writtenData=new Qe;constructor(){this.data=Buffer.alloc(Je.chunkSize),this.writerIndex=0}length(){return this.writerIndex}getData(){return this.data.slice(0,this.writerIndex)}ensureLength(e){const t=this.writerIndex+e-this.data.length;if(t>0){const e=Math.ceil(t/Je.chunkSize);this.data=Buffer.concat([this.data,Buffer.alloc(e*Je.chunkSize)])}}compressDataIfPossible(e){const t=this.writtenData.indexOf(e);return t<0?(this.writtenData.push(e),!1):t<=$e.COMPRESSION_STOP-$e.COMPRESSION_START&&(this.writeTag($e.COMPRESSION_START+t),!0)}writeTag(e){this.ensureLength(1),this.data.writeUInt8(e,this.writerIndex++)}writeTrue(){this.writeTag($e.TRUE)}writeFalse(){this.writeTag($e.FALSE)}writeNumber(e){if(-1===e)this.writeTag($e.INTEGER_MINUS_ONE);else if(e>=0&&e<=39)this.writeTag($e.INTEGER_RANGE_START_0+e);else if(e>=-128&&e<=127)this.writeInt8(new Fe(e));else if(e>=-32768&&e<=32767)this.writeInt16LE(new Ve(e));else if(e>=-2147483648&&e<=-2147483648)this.writeInt32LE(new He(e));else{if(!(e>=Number.MIN_SAFE_INTEGER&&e<=Number.MAX_SAFE_INTEGER))throw new Error("Tried writing unrepresentable number ("+e+")");this.writeInt64LE(new je(e))}}writeInt8(e){this.compressDataIfPossible(e)||(this.ensureLength(2),this.writeTag($e.INT8),this.data.writeInt8(e.value,this.writerIndex++))}writeInt16LE(e){this.compressDataIfPossible(e)||(this.ensureLength(3),this.writeTag($e.INT16LE),this.data.writeInt16LE(e.value,this.writerIndex),this.writerIndex+=2)}writeInt32LE(e){this.compressDataIfPossible(e)||(this.ensureLength(5),this.writeTag($e.INT32LE),this.data.writeInt32LE(e.value,this.writerIndex),this.writerIndex+=4)}writeInt64LE(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag($e.INT64LE),this.data.writeUInt32LE(e.value,this.writerIndex),this.data.writeUInt32LE(0,this.writerIndex+4),this.writerIndex+=8)}writeFloat32LE(e){this.compressDataIfPossible(e)||(this.ensureLength(5),this.writeTag($e.FLOAT32LE),this.data.writeFloatLE(e.value,this.writerIndex),this.writerIndex+=4)}writeFloat64LE(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag($e.FLOAT64LE),this.data.writeDoubleLE(e.value,this.writerIndex),this.writerIndex+=8)}writeLength8(e){this.ensureLength(1),this.data.writeUInt8(e,this.writerIndex++)}writeLength16LE(e){this.ensureLength(2),this.data.writeUInt16LE(e,this.writerIndex),this.writerIndex+=2}writeLength32LE(e){this.ensureLength(4),this.data.writeUInt32LE(e,this.writerIndex),this.writerIndex+=4}writeLength64LE(e){this.ensureLength(8),oe(e,this.data,this.writerIndex),this.writerIndex+=8}writeUTF8(e){if(this.compressDataIfPossible(e))return;const t=Buffer.byteLength(e);t<=32?(this.ensureLength(1+t),this.writeTag($e.UTF8_LENGTH_START+e.length),this._writeUTF8(e)):t<=255?this.writeUTF8_Length8(e):t<=65535?this.writeUTF8_Length16LE(e):t<=4294967295?this.writeUTF8_Length32LE(e):t<=Number.MAX_SAFE_INTEGER?this.writeUTF8_Length64LE(e):this.writeUTF8_NULL_terminated(e)}_writeUTF8(e){const t=Buffer.byteLength(e);this.ensureLength(t),this.data.write(e,this.writerIndex,void 0,"utf8"),this.writerIndex+=t}writeUTF8_Length8(e){const t=Buffer.byteLength(e);this.ensureLength(2+t),this.writeTag($e.UTF8_LENGTH8),this.writeLength8(t),this._writeUTF8(e)}writeUTF8_Length16LE(e){const t=Buffer.byteLength(e);this.ensureLength(3+t),this.writeTag($e.UTF8_LENGTH16LE),this.writeLength16LE(t),this._writeUTF8(e)}writeUTF8_Length32LE(e){const t=Buffer.byteLength(e);this.ensureLength(5+t),this.writeTag($e.UTF8_LENGTH32LE),this.writeLength32LE(t),this._writeUTF8(e)}writeUTF8_Length64LE(e){const t=Buffer.byteLength(e);this.ensureLength(9+t),this.writeTag($e.UTF8_LENGTH64LE),this.writeLength64LE(t),this._writeUTF8(e)}writeUTF8_NULL_terminated(e){this.ensureLength(1+Buffer.byteLength(e)+1),this.writeTag($e.UTF8_NULL_TERMINATED),this._writeUTF8(e),this.data.writeUInt8(0,this.writerIndex++)}writeData(e){this.compressDataIfPossible(e)||(e.length<=32?(this.writeTag($e.DATA_LENGTH_START+e.length),this._writeData(e)):e.length<=255?this.writeData_Length8(e):e.length<=65535?this.writeData_Length16LE(e):e.length<=4294967295?this.writeData_Length32LE(e):e.length<=Number.MAX_SAFE_INTEGER?this.writeData_Length64LE(e):this.writeData_terminated(e))}_writeData(e){this.ensureLength(e.length);for(let t=0;t<e.length;t++)this.data[this.writerIndex++]=e[t]}writeData_Length8(e){this.ensureLength(2+e.length),this.writeTag($e.DATA_LENGTH8),this.writeLength8(e.length),this._writeData(e)}writeData_Length16LE(e){this.ensureLength(3+e.length),this.writeTag($e.DATA_LENGTH16LE),this.writeLength16LE(e.length),this._writeData(e)}writeData_Length32LE(e){this.ensureLength(5+e.length),this.writeTag($e.DATA_LENGTH32LE),this.writeLength32LE(e.length),this._writeData(e)}writeData_Length64LE(e){this.ensureLength(9+e.length),this.writeTag($e.DATA_LENGTH64LE),this.writeLength64LE(e.length),this._writeData(e)}writeData_terminated(e){this.ensureLength(1+e.length+1),this.writeTag($e.DATA_TERMINATED),this._writeData(e),this.writeTag($e.TERMINATOR)}writeSecondsSince2001_01_01(e){this.compressDataIfPossible(e)||(this.ensureLength(9),this.writeTag($e.DATE),this.data.writeDoubleLE(e.value,this.writerIndex),this.writerIndex+=8)}writeUUID(e){u()(k(e),"supplied uuid is invalid"),this.compressDataIfPossible(new ze(e))||(this.ensureLength(17),this.writeTag($e.UUID),V(e,this.data,this.writerIndex),this.writerIndex+=16)}}const Xe=d()("HAP-NodeJS:DataStream:Server");let Ze,et,tt,rt;!function(e){e.CONTROL="control",e.TARGET_CONTROL="targetControl",e.DATA_SEND="dataSend"}(Ze||(Ze={})),function(e){e.HELLO="hello",e.WHOAMI="whoami",e.OPEN="open",e.DATA="data",e.ACK="ack",e.CLOSE="close"}(et||(et={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.OUT_OF_MEMORY=1]="OUT_OF_MEMORY",e[e.TIMEOUT=2]="TIMEOUT",e[e.HEADER_ERROR=3]="HEADER_ERROR",e[e.PAYLOAD_ERROR=4]="PAYLOAD_ERROR",e[e.MISSING_PROTOCOL=5]="MISSING_PROTOCOL",e[e.PROTOCOL_SPECIFIC_ERROR=6]="PROTOCOL_SPECIFIC_ERROR"}(tt||(tt={})),function(e){e[e.NORMAL=0]="NORMAL",e[e.NOT_ALLOWED=1]="NOT_ALLOWED",e[e.BUSY=2]="BUSY",e[e.CANCELLED=3]="CANCELLED",e[e.UNSUPPORTED=4]="UNSUPPORTED",e[e.UNEXPECTED_FAILURE=5]="UNEXPECTED_FAILURE",e[e.TIMEOUT=6]="TIMEOUT",e[e.BAD_DATA=7]="BAD_DATA",e[e.PROTOCOL_ERROR=8]="PROTOCOL_ERROR",e[e.INVALID_CONFIGURATION=9]="INVALID_CONFIGURATION"}(rt||(rt={}));class nt extends Error{constructor(e){super("HDSProtocolError: "+e),assert(e!==rt.NORMAL,"Cannot initialize a HDSProtocolError with NORMAL!"),this.reason=e}}var it,st,ot;let at,ct,ut;!function(e){e[e.UNINITIALIZED=0]="UNINITIALIZED",e[e.BINDING=1]="BINDING",e[e.LISTENING=2]="LISTENING",e[e.CLOSING=3]="CLOSING"}(it||(it={})),function(e){e[e.UNIDENTIFIED=0]="UNIDENTIFIED",e[e.EXPECTING_HELLO=1]="EXPECTING_HELLO",e[e.READY=2]="READY",e[e.CLOSING=3]="CLOSING",e[e.CLOSED=4]="CLOSED"}(st||(st={})),function(e){e[e.EVENT=1]="EVENT",e[e.REQUEST=2]="REQUEST",e[e.RESPONSE=3]="RESPONSE"}(ot||(ot={})),function(e){e.CONNECTION_OPENED="connection-opened",e.CONNECTION_CLOSED="connection-closed"}(at||(at={}));class ht extends l.EventEmitter{static version="1.0";state=it.UNINITIALIZED;static accessoryToControllerInfo=Buffer.from("HDS-Read-Encryption-Key");static controllerToAccessoryInfo=Buffer.from("HDS-Write-Encryption-Key");preparedSessions=[];connections=[];removeListenersOnceClosed=!1;internalEventEmitter=new l.EventEmitter;constructor(){super()}onEventMessage(e,t,r){return this.internalEventEmitter.on(e+"-e-"+t,r),this}removeEventHandler(e,t,r){return this.internalEventEmitter.removeListener(e+"-e-"+t,r),this}onRequestMessage(e,t,r){return this.internalEventEmitter.on(e+"-r-"+t,r),this}removeRequestHandler(e,t,r){return this.internalEventEmitter.removeListener(e+"-r-"+t,r),this}prepareSession(e,t,r){Xe("Preparing for incoming HDS connection from %s",e.sessionID);const n=p().randomBytes(32),i=Buffer.concat([t,n]),s={connection:e,accessoryToControllerEncryptionKey:te("sha512",i,e.encryption.sharedSecret,ht.accessoryToControllerInfo,32),controllerToAccessoryEncryptionKey:te("sha512",i,e.encryption.sharedSecret,ht.controllerToAccessoryInfo,32),accessoryKeySalt:n,connectTimeout:setTimeout((()=>this.timeoutPreparedSession(s)),1e4)};s.connectTimeout.unref(),this.preparedSessions.push(s),this.checkTCPServerEstablished(s,(e=>{e?r(e):r(void 0,s)}))}timeoutPreparedSession(e){Xe("Prepared HDS session timed out out since no connection was opened for 10 seconds (%s)",e.connection.sessionID);const t=this.preparedSessions.indexOf(e);t>=0&&this.preparedSessions.splice(t,1),this.checkCloseable()}checkTCPServerEstablished(e,t){switch(this.state){case it.UNINITIALIZED:Xe("Starting up TCP server."),this.tcpServer=m().createServer(),this.tcpServer.once("listening",this.listening.bind(this,e,t)),this.tcpServer.on("connection",this.onConnection.bind(this)),this.tcpServer.on("close",this.closed.bind(this)),this.tcpServer.listen(),this.state=it.BINDING;break;case it.BINDING:Xe("TCP server already running. Waiting for it to bind."),this.tcpServer.once("listening",this.listening.bind(this,e,t));break;case it.LISTENING:Xe("Instructing client to connect to already running TCP server"),e.port=this.tcpPort,t();break;case it.CLOSING:Xe("TCP socket is currently closing. Trying again when server is fully closed and opening a new one then."),this.tcpServer.once("close",(()=>setTimeout((()=>this.checkTCPServerEstablished(e,t)),10)))}}listening(e,t){this.state=it.LISTENING;const r=this.tcpServer.address();r&&"string"!=typeof r&&(this.tcpPort=r.port,e.port=r.port,Xe("TCP server is now listening for new data stream connections on port %s",r.port),t())}onConnection(e){Xe("[%s] New DataStream connection was established",e.remoteAddress);const t=new lt(e);t.on(ct.IDENTIFICATION,this.handleSessionIdentification.bind(this,t)),t.on(ct.HANDLE_MESSAGE_GLOBALLY,this.handleMessageGlobally.bind(this,t)),t.on(ct.CLOSED,this.connectionClosed.bind(this,t)),this.connections.push(t),this.emit(at.CONNECTION_OPENED,t)}handleSessionIdentification(e,t,r){let n;for(let r=0;r<this.preparedSessions.length;r++){const i=this.preparedSessions[r];if(e.decryptHDSFrame(t,i.controllerToAccessoryEncryptionKey)){n=i;break}}if(r(n),n){Xe("[%s] Connection was successfully identified (linked with sessionId: %s)",e.remoteAddress,n.connection.sessionID);const t=this.preparedSessions.indexOf(n);t>=0&&this.preparedSessions.splice(t,1),clearTimeout(n.connectTimeout),n.connectTimeout=void 0}else Xe("[%s] Could not identify connection. Terminating.",e.remoteAddress),e.close()}handleMessageGlobally(e,t){u().notStrictEqual(t.type,ot.RESPONSE);let r="";const n=[];let i;t.type===ot.EVENT?r="-e-":t.type===ot.REQUEST&&(r="-r-",n.push(t.id)),n.push(t.message);try{i=this.internalEventEmitter.emit(t.protocol+r+t.topic,e,...n)}catch(r){i=!0,Xe("[%s] Error occurred while dispatching handler for HDS message: %o",e.remoteAddress,t),Xe(r.stack)}i||Xe("[%s] WARNING no handler was found for message: %o",e.remoteAddress,t)}connectionClosed(e){Xe("[%s] DataStream connection closed",e.remoteAddress),this.connections.splice(this.connections.indexOf(e),1),this.emit(at.CONNECTION_CLOSED,e),this.checkCloseable(),this.state===it.CLOSING&&this.removeListenersOnceClosed&&0===this.connections.length&&this.removeAllListeners()}checkCloseable(){0===this.connections.length&&0===this.preparedSessions.length&&this.state<it.CLOSING&&(Xe("Last connection disconnected. Closing the server now."),this.state=it.CLOSING,this.tcpServer.close())}destroy(){if(this.state>it.UNINITIALIZED&&this.state<it.CLOSING){this.tcpServer.close();for(const e of this.connections)e.close()}this.state=it.CLOSING,this.removeListenersOnceClosed=!0,this.internalEventEmitter.removeAllListeners()}closed(){this.tcpServer=void 0,this.tcpPort=void 0,this.state=it.UNINITIALIZED}}!function(e){e.IDENTIFICATION="identification",e.HANDLE_MESSAGE_GLOBALLY="handle-message-globally",e.CLOSED="closed"}(ct||(ct={})),function(e){e[e.ILLEGAL_STATE=1]="ILLEGAL_STATE",e[e.CLOSED_SOCKET=2]="CLOSED_SOCKET",e[e.MAX_PAYLOAD_LENGTH=3]="MAX_PAYLOAD_LENGTH"}(ut||(ut={}));class dt extends Error{constructor(e,t){super(e),this.type=t}}class lt extends l.EventEmitter{static MAX_PAYLOAD_LENGTH=1048575;state=st.UNIDENTIFIED;protocolHandlers={};responseHandlers={};responseTimers={};constructor(e){super(),this.socket=e,this.remoteAddress=e.remoteAddress,this.socket.setNoDelay(!0),this.socket.setKeepAlive(!0),this.accessoryToControllerNonce=0,this.accessoryToControllerNonceBuffer=Buffer.alloc(8),this.controllerToAccessoryNonce=0,this.controllerToAccessoryNonceBuffer=Buffer.alloc(8),this.hapConnectionClosedListener=this.onHAPSessionClosed.bind(this),this.addProtocolHandler(Ze.CONTROL,{requestHandler:{[et.HELLO]:this.handleHello.bind(this)}}),this.helloTimer=setTimeout((()=>{Xe("[%s] Hello message did not arrive in time. Killing the connection",this.remoteAddress),this.close()}),1e4),this.socket.on("data",this.onSocketData.bind(this)),this.socket.on("error",this.onSocketError.bind(this)),this.socket.on("close",this.onSocketClose.bind(this)),this.setMaxListeners(100)}handleHello(e,t){Xe("[%s] Received hello message from client: %o",this.remoteAddress,t),clearTimeout(this.helloTimer),this.helloTimer=void 0,this.state=st.READY,this.sendResponse(Ze.CONTROL,et.HELLO,e)}addProtocolHandler(e,t){return void 0===this.protocolHandlers[e]&&(this.protocolHandlers[e]=t,!0)}removeProtocolHandler(e,t){this.protocolHandlers[e]===t&&delete this.protocolHandlers[e]}sendEvent(e,t,r={}){const n={};n.protocol=e,n.event=t,this.sendHDSFrame(n,r)}sendRequest(e,t,r={},n){let i;do{i=Math.floor(4294967295*Math.random())}while(void 0!==this.responseHandlers[i]);this.responseHandlers[i]=n,this.responseTimers[i]=setTimeout((()=>{this.close();const e=this.responseHandlers[i];delete this.responseHandlers[i],delete this.responseTimers[i],e(new Error("timeout"),void 0,{})}),1e4);const s={};s.protocol=e,s.request=t,s.id=new je(i),this.sendHDSFrame(s,r)}sendResponse(e,t,r,n=tt.SUCCESS,i={}){const s={};s.protocol=e,s.response=t,s.id=new je(r),s.status=new je(n),this.sendHDSFrame(s,i)}onSocketData(e){if(this.state>=st.CLOSING)return;let t=0;const r=this.decodeHDSFrames(e);if(0===r.length)return;if(this.state===st.UNIDENTIFIED){const e=r[t++];if(this.emit(ct.IDENTIFICATION,e,(e=>{e&&(this.connection=e.connection,this.accessoryToControllerEncryptionKey=e.accessoryToControllerEncryptionKey,this.controllerToAccessoryEncryptionKey=e.controllerToAccessoryEncryptionKey,this.state=st.EXPECTING_HELLO,this.connection.on(ye.CLOSED,this.hapConnectionClosedListener),Xe("[%s] Registering CLOSED handler to HAP connection. Connection currently has %d close handlers!",this.remoteAddress,this.connection.listeners(ye.CLOSED).length))})),this.state===st.UNIDENTIFIED)return}for(;t<r.length;t++)if(!this.decryptHDSFrame(r[t]))return Xe("[%s] HDS frame decryption or authentication failed. Connection will be terminated!",this.remoteAddress),void this.close();const n=this.decodePayloads(r);if(this.state===st.EXPECTING_HELLO){const e=n[0];if(e.protocol!==Ze.CONTROL||e.type!==ot.REQUEST||e.topic!==et.HELLO)return Xe("[%s] First message received was not the expected hello message. Instead got: %o",this.remoteAddress,e),void this.close()}n.forEach((e=>{if(e.type===ot.RESPONSE){const t=this.responseHandlers[e.id],r=this.responseTimers[e.id];if(r&&(clearTimeout(r),delete this.responseTimers[e.id]),!t)return void Xe("WARNING we received a response to a request we have not sent: %o",e);try{t(void 0,e.status,e.message)}catch(t){Xe("[%s] Error occurred while dispatching response handler for HDS message: %o",this.remoteAddress,e),Xe(t.stack)}delete this.responseHandlers[e.id]}else{const t=this.protocolHandlers[e.protocol];if(void 0===t)return void this.emit(ct.HANDLE_MESSAGE_GLOBALLY,e);if(e.type===ot.EVENT){let r;if(!t.eventHandler||!(r=t.eventHandler[e.topic]))return void Xe("[%s] WARNING no event handler was found for message: %o",this.remoteAddress,e);try{r(e.message)}catch(t){Xe("[%s] Error occurred while dispatching event handler for HDS message: %o",this.remoteAddress,e),Xe(t.stack)}}else if(e.type===ot.REQUEST){let r;if(!t.requestHandler||!(r=t.requestHandler[e.topic]))return void Xe("[%s] WARNING no request handler was found for message: %o",this.remoteAddress,e);try{r(e.id,e.message)}catch(t){Xe("[%s] Error occurred while dispatching request handler for HDS message: %o",this.remoteAddress,e),Xe(t.stack)}}else Xe("[%s] Encountered unknown message type with id %d",this.remoteAddress,e.type)}}))}decodeHDSFrames(e){void 0!==this.frameBuffer&&(e=Buffer.concat([this.frameBuffer,e]),this.frameBuffer=void 0);const t=e.length,r=[];for(let n=0;n<t;){if(n+4>t){this.frameBuffer=e.slice(n);break}const i=e.readUInt8(n),s=e.readUIntBE(n+1,3);if(s>lt.MAX_PAYLOAD_LENGTH)return Xe("[%s] Connection send payload with size bigger than the maximum allow for data stream",this.remoteAddress),this.close(),[];if(s+16>t-n-4){this.frameBuffer=e.slice(n);break}const o=n+4,a=o+s,c=e.slice(n,o),u=e.slice(o,a),h=Buffer.alloc(s),d=e.slice(a,a+16);if(n=a+16,1===i){const e={header:c,cipheredPayload:u,authTag:d};r.push(e)}else Xe("[%s] Encountered unknown payload type %d for payload: %s",this.remoteAddress,h.toString("hex"))}return r}decryptHDSFrame(e,t){oe(this.controllerToAccessoryNonce,this.controllerToAccessoryNonceBuffer,0);const r=t||this.controllerToAccessoryEncryptionKey;try{return e.plaintextPayload=re(r,this.controllerToAccessoryNonceBuffer,e.header,e.cipheredPayload,e.authTag),this.controllerToAccessoryNonce++,!0}catch(e){return!1}}decodePayloads(e){const t=[];return e.forEach((e=>{const r=e.plaintextPayload;if(!r)throw new dt("Reached illegal state. Encountered HDSFrame with wasn't decrypted yet!",ut.ILLEGAL_STATE);const n=r.readUInt8(0),i=r.length-n-1,s=1+n,o=new Ye(r.slice(1,1+n)),a=new Ye(r.slice(s,s+i));let c,u,h;try{c=We.decode(o),o.finished()}catch(e){return void Xe("[%s] Failed to decode header payload: %s",this.remoteAddress,e.message)}try{u=We.decode(a),a.finished()}catch(e){return void Xe("[%s] Failed to decode message payload: %s (header: %o)",this.remoteAddress,e.message,c)}const d=c.protocol;let l,f,p;if(void 0!==c.event)h=ot.EVENT,l=c.event;else if(void 0!==c.request)h=ot.REQUEST,l=c.request,f=c.id;else{if(void 0===c.response)return void Xe("[%s] Encountered unknown payload header format: %o (message: %o)",this.remoteAddress,c,u);h=ot.RESPONSE,l=c.response,f=c.id,p=c.status}const y={type:h,protocol:d,topic:l,id:f,status:p,message:u};t.push(y)})),t}sendHDSFrame(e,t){if(this.state>=st.CLOSING)throw new dt("Cannot send message on closing/closed socket!",ut.CLOSED_SOCKET);const r=new Je,n=new Je;We.encode(e,r),We.encode(t,n);const i=Buffer.alloc(1);i.writeUInt8(r.length(),0);const s=Buffer.concat([i,r.getData(),n.getData()]);if(s.length>lt.MAX_PAYLOAD_LENGTH)throw new dt("Tried sending payload with length larger than the maximum allowed for data stream",ut.MAX_PAYLOAD_LENGTH);const o=Buffer.alloc(1);o.writeUInt8(1,0);let a=Buffer.alloc(4);a.writeUInt32BE(s.length,0),a=a.slice(1,4);const c=Buffer.concat([o,a]);oe(this.accessoryToControllerNonce++,this.accessoryToControllerNonceBuffer);const u=ne(this.accessoryToControllerEncryptionKey,this.accessoryToControllerNonceBuffer,c,s);this.socket.write(Buffer.concat([c,u.ciphertext,u.authTag]))}close(){this.state>=st.CLOSING||(this.state=st.CLOSING,this.socket.end())}isConsideredClosed(){return this.state>=st.CLOSING}onHAPSessionClosed(){Xe("[%s] HAP connection disconnected. Also closing DataStream connection now.",this.remoteAddress),this.close()}onSocketError(e){Xe("[%s] Encountered socket error: %s",this.remoteAddress,e.message)}onSocketClose(){this.state=st.CLOSED,this.emit(ct.CLOSED),this.connection?.removeListener(ye.CLOSED,this.hapConnectionClosedListener),this.removeAllListeners()}}const ft=d()("HAP-NodeJS:DataStream:Management");var pt,yt,mt,gt,vt,bt,Et;let St,At;!function(e){e[e.TRANSFER_TRANSPORT_CONFIGURATION=1]="TRANSFER_TRANSPORT_CONFIGURATION"}(pt||(pt={})),function(e){e[e.TRANSPORT_TYPE=1]="TRANSPORT_TYPE"}(yt||(yt={})),function(e){e[e.SESSION_COMMAND_TYPE=1]="SESSION_COMMAND_TYPE",e[e.TRANSPORT_TYPE=2]="TRANSPORT_TYPE",e[e.CONTROLLER_KEY_SALT=3]="CONTROLLER_KEY_SALT"}(mt||(mt={})),function(e){e[e.STATUS=1]="STATUS",e[e.TRANSPORT_TYPE_SESSION_PARAMETERS=2]="TRANSPORT_TYPE_SESSION_PARAMETERS",e[e.ACCESSORY_KEY_SALT=3]="ACCESSORY_KEY_SALT"}(gt||(gt={})),function(e){e[e.TCP_LISTENING_PORT=1]="TCP_LISTENING_PORT"}(vt||(vt={})),function(e){e[e.HOMEKIT_DATA_STREAM=0]="HOMEKIT_DATA_STREAM"}(bt||(bt={})),function(e){e[e.START_SESSION=0]="START_SESSION"}(Et||(Et={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.GENERIC_ERROR=1]="GENERIC_ERROR",e[e.BUSY=2]="BUSY"}(St||(St={}));class It{dataStreamServer=new ht;lastSetupDataStreamTransportResponse="";constructor(e){const t=[bt.HOMEKIT_DATA_STREAM];this.supportedDataStreamTransportConfiguration=this.buildSupportedDataStreamTransportConfigurationTLV(t),this.dataStreamTransportManagementService=e||this.constructService(),this.setupServiceHandlers()}destroy(){this.dataStreamServer.destroy(),this.dataStreamTransportManagementService.getCharacteristic(sn.SetupDataStreamTransport).removeOnGet().removeAllListeners(rn.SET),this.lastSetupDataStreamTransportResponse=""}getService(){return this.dataStreamTransportManagementService}onEventMessage(e,t,r){return this.dataStreamServer.onEventMessage(e,t,r),this}removeEventHandler(e,t,r){return this.dataStreamServer.removeEventHandler(e,t,r),this}onRequestMessage(e,t,r){return this.dataStreamServer.onRequestMessage(e,t,r),this}removeRequestHandler(e,t,r){return this.dataStreamServer.removeRequestHandler(e,t,r),this}onServerEvent(e,t){return this.dataStreamServer.on(e,t),this}handleSetupDataStreamTransportWrite(e,t,r){const n=be(Buffer.from(e,"base64")),i=n[mt.SESSION_COMMAND_TYPE][0],s=n[mt.TRANSPORT_TYPE][0],o=n[mt.CONTROLLER_KEY_SALT];ft("Received setup write with command %s and transport type %s",Et[i],bt[s]),i===Et.START_SESSION&&s===bt.HOMEKIT_DATA_STREAM&&32===o.length?this.dataStreamServer.prepareSession(r,o,((e,r)=>{if(e||!r)return void t(e??new Error("PreparedSession was undefined!"));const n=ve(vt.TCP_LISTENING_PORT,Se(r.port));let i=Buffer.concat([ve(gt.STATUS,St.SUCCESS),ve(gt.TRANSPORT_TYPE_SESSION_PARAMETERS,n)]);this.lastSetupDataStreamTransportResponse=i.toString("base64"),i=Buffer.concat([i,ve(gt.ACCESSORY_KEY_SALT,r.accessoryKeySalt)]),t(null,i.toString("base64"))})):t(_e.INVALID_VALUE_IN_REQUEST)}buildSupportedDataStreamTransportConfigurationTLV(e){const t=[];return e.forEach((e=>{const r=ve(yt.TRANSPORT_TYPE,e),n=ve(pt.TRANSFER_TRANSPORT_CONFIGURATION,r);t.push(n)})),Buffer.concat(t).toString("base64")}constructService(){const e=new xe.DataStreamTransportManagement("","");return e.setCharacteristic(sn.SupportedDataStreamTransportConfiguration,this.supportedDataStreamTransportConfiguration),e.setCharacteristic(sn.Version,ht.version),e}setupServiceHandlers(){this.dataStreamTransportManagementService.getCharacteristic(sn.SetupDataStreamTransport).onGet((()=>this.lastSetupDataStreamTransportResponse)).on(rn.SET,((e,t,r,n)=>{if(!n)return ft("Set event handler for SetupDataStreamTransport cannot be called from plugin! Connection undefined!"),void t(_e.INVALID_VALUE_IN_REQUEST);this.handleSetupDataStreamTransportWrite(e,t,n)})).updateValue(this.lastSetupDataStreamTransportResponse)}}function wt(e){return"serialize"in e&&"deserialize"in e&&"setupStateChangeDelegate"in e}!function(e){e.CAMERA="camera",e.REMOTE="remote",e.TV="tv",e.ROUTER="router",e.LOCK="lock",e.CHARACTERISTIC_TRANSITION="characteristic-transition"}(At||(At={}));const Tt=d()("HAP-NodeJS:Camera:Controller");let Ct;!function(e){e.MICROPHONE_PROPERTIES_CHANGED="microphone-change",e.SPEAKER_PROPERTIES_CHANGED="speaker-change"}(Ct||(Ct={}));class _t extends l.EventEmitter{static STREAM_MANAGEMENT="streamManagement";legacyMode=!1;streamManagements=[];microphoneMuted=!1;microphoneVolume=100;speakerMuted=!1;speakerVolume=100;connectionMap=new Map;constructor(e,t=!1){super(),this.streamCount=Math.max(1,e.cameraStreamCount||1),this.delegate=e.delegate,this.streamingOptions=e.streamingOptions,this.recordingOptions=e.recording?.options,this.recordingDelegate=e.recording?.delegate,this.legacyMode=t}controllerId(){return At.CAMERA}forceStopStreamingSession(e){this.streamManagements.forEach((t=>{t.sessionIdentifier===e&&t.forceStop()}))}static generateSynchronisationSource(){const e=p().randomBytes(4);return e[0]=0,e.readInt32BE(0)}setMicrophoneMuted(e=!0){this.microphoneService&&(this.microphoneMuted=e,this.microphoneService.updateCharacteristic(sn.Mute,e))}setMicrophoneVolume(e){this.microphoneService&&(this.microphoneVolume=e,this.microphoneService.updateCharacteristic(sn.Volume,e))}setSpeakerMuted(e=!0){this.speakerService&&(this.speakerMuted=e,this.speakerService.updateCharacteristic(sn.Mute,e))}setSpeakerVolume(e){this.speakerService&&(this.speakerVolume=e,this.speakerService.updateCharacteristic(sn.Volume,e))}emitMicrophoneChange(){this.emit(Ct.MICROPHONE_PROPERTIES_CHANGED,this.microphoneMuted,this.microphoneVolume)}emitSpeakerChange(){this.emit(Ct.SPEAKER_PROPERTIES_CHANGED,this.speakerMuted,this.speakerVolume)}constructServices(){for(let e=0;e<this.streamCount;e++){const t=new hr(e,this.streamingOptions,this.delegate);this.streamManagements.push(t),this.recordingOptions&&t.getService().setCharacteristic(sn.Active,1)}!this.legacyMode&&this.streamingOptions.audio&&(this.microphoneService=new xe.Microphone("",""),this.microphoneService.setCharacteristic(sn.Volume,this.microphoneVolume),this.streamingOptions.audio.twoWayAudio&&(this.speakerService=new xe.Speaker("",""),this.speakerService.setCharacteristic(sn.Volume,this.speakerVolume))),this.recordingOptions&&(this.cameraOperatingModeService=new xe.CameraOperatingMode("",""),this.recordingManagement=new _r(this.recordingOptions,this.recordingDelegate),this.dataStreamManagement=new It,this.recordingOptions.motionService&&(this.motionService=new wc("",""),this.motionService.setCharacteristic(sn.Active,1),this.recordingManagement.getService().addLinkedService(this.motionService)),this.recordingManagement.getService().addLinkedService(this.dataStreamManagement.getService()));const e={microphone:this.microphoneService,speaker:this.speakerService,cameraOperatingMode:this.cameraOperatingModeService,cameraEventRecordingManagement:this.recordingManagement?.getService(),dataStreamTransportManagement:this.dataStreamManagement?.getService(),motionService:this.motionService};return this.streamManagements.forEach(((t,r)=>e[_t.STREAM_MANAGEMENT+r]=t.getService())),e}initWithServices(e){let t=!1;for(let r=0;;r++){let n=e[_t.STREAM_MANAGEMENT+r];if(r<this.streamCount)if(n)this.streamManagements.push(new hr(r,this.streamingOptions,this.delegate,n));else{const n=new hr(r,this.streamingOptions,this.delegate);this.streamManagements.push(n),e[_t.STREAM_MANAGEMENT+r]=n.getService(),t=!0}else{if(!n)break;delete e[_t.STREAM_MANAGEMENT+r],t=!0}}if(!this.legacyMode&&this.streamingOptions.audio?e.microphone?this.microphoneService=e.microphone:(this.microphoneService=new xe.Microphone("",""),this.microphoneService.setCharacteristic(sn.Volume,this.microphoneVolume),e.microphone=this.microphoneService,t=!0):e.microphone&&(delete e.microphone,t=!0),!this.legacyMode&&this.streamingOptions.audio?.twoWayAudio?e.speaker?this.speakerService=e.speaker:(this.speakerService=new xe.Speaker("",""),this.speakerService.setCharacteristic(sn.Volume,this.speakerVolume),e.speaker=this.speakerService,t=!0):e.speaker&&(delete e.speaker,t=!0),this.recordingOptions?(e.cameraOperatingMode?this.cameraOperatingModeService=e.cameraOperatingMode:(this.cameraOperatingModeService=new xe.CameraOperatingMode("",""),e.cameraOperatingMode=this.cameraOperatingModeService,t=!0),e.cameraEventRecordingManagement?this.recordingManagement=new _r(this.recordingOptions,this.recordingDelegate,e.cameraEventRecordingManagement):(this.recordingManagement=new _r(this.recordingOptions,this.recordingDelegate),e.cameraEventRecordingManagement=this.recordingManagement.getService(),t=!0),e.dataStreamTransportManagement?this.dataStreamManagement=new It(e.dataStreamTransportManagement):(this.dataStreamManagement=new It,e.dataStreamTransportManagement=this.dataStreamManagement.getService(),t=!0),this.recordingOptions.motionService?e.motionService||(this.motionService=new wc("",""),e.motionService=this.motionService,t=!0):e.motionService&&(delete e.motionService,t=!0)):(e.cameraOperatingMode&&(delete e.cameraOperatingMode,t=!0),e.cameraEventRecordingManagement&&(delete e.cameraEventRecordingManagement,t=!0),e.dataStreamTransportManagement&&(delete e.dataStreamTransportManagement,t=!0),e.motionService&&(delete e.motionService,t=!0)),this.migrateFromDoorbell(e)&&(t=!0),t)return e}migrateFromDoorbell(e){return!!e.doorbell&&(delete e.doorbell,!0)}configureServices(){this.microphoneService&&(this.microphoneService.getCharacteristic(sn.Mute).on(rn.GET,(e=>{e(void 0,this.microphoneMuted)})).on(rn.SET,((e,t)=>{this.microphoneMuted=e,t(),this.emitMicrophoneChange()})),this.microphoneService.getCharacteristic(sn.Volume).on(rn.GET,(e=>{e(void 0,this.microphoneVolume)})).on(rn.SET,((e,t)=>{this.microphoneVolume=e,t(),this.emitMicrophoneChange()}))),this.speakerService&&(this.speakerService.getCharacteristic(sn.Mute).on(rn.GET,(e=>{e(void 0,this.speakerMuted)})).on(rn.SET,((e,t)=>{this.speakerMuted=e,t(),this.emitSpeakerChange()})),this.speakerService.getCharacteristic(sn.Volume).on(rn.GET,(e=>{e(void 0,this.speakerVolume)})).on(rn.SET,((e,t)=>{this.speakerVolume=e,t(),this.emitSpeakerChange()}))),this.dataStreamManagement&&this.dataStreamManagement.onRequestMessage(Ze.DATA_SEND,et.OPEN,this.handleDataSendOpen.bind(this)).onEventMessage(Ze.DATA_SEND,et.CLOSE,this.handleDataSendClose.bind(this)).onServerEvent(at.CONNECTION_CLOSED,this.handleDataStreamConnectionClosed.bind(this))}async handleDataSendOpen(e,t,r){const n=r.streamId,i=this.recordingDelegate.handleFragmentsRequests(e);this.connectionMap.set(n,{generator:i,connection:e});let s=!0;try{let r=1;for await(const o of i){const i=s;s&&(s=!1,e.sendResponse(Ze.DATA_SEND,et.OPEN,t,tt.SUCCESS,{status:tt.SUCCESS}));let a=0,c=1;for(;a<o.length;){const t=o.slice(a,a+262144);a+=t.length;const s={streamId:n,packets:[{metadata:{dataType:i?"mediaInitialization":"mediaFragment",dataSequenceNumber:r,isLastDataChunk:a>=o.length,dataChunkSequenceNumber:c},data:t}]};e.sendEvent(Ze.DATA_SEND,et.DATA,s),c++}r++}}catch(e){}finally{s&&e.sendResponse(Ze.DATA_SEND,et.OPEN,t,tt.PROTOCOL_SPECIFIC_ERROR,{status:tt.PROTOCOL_SPECIFIC_ERROR})}}async handleDataSendClose(e,t){const r=t.streamId,n=this.connectionMap.get(r);if(!n)return;this.connectionMap.delete(r);const{generator:i}=n;i.throw("dataSend close")}handleDataStreamConnectionClosed(e){for(const[t,{generator:r,connection:n}]of this.connectionMap.entries())n===e&&(this.connectionMap.delete(t),r.throw("connection closed"))}handleControllerRemoved(){this.handleFactoryReset();for(const e of this.streamManagements)e.destroy();this.streamManagements.splice(0,this.streamManagements.length),this.microphoneService=void 0,this.speakerService=void 0,this.removeAllListeners()}handleFactoryReset(){this.streamManagements.forEach((e=>e.handleFactoryReset())),this.microphoneMuted=!1,this.microphoneVolume=100,this.speakerMuted=!1,this.speakerVolume=100}handleSnapshotRequest(e,t,r,n){return new Promise(((i,s)=>{let o=setTimeout((()=>{console.warn(`[${r}] The image snapshot handler for the given accessory is slow to respond! See https://git.io/JtMGR for more info.`),o=setTimeout((()=>{o=void 0,console.warn(`[${r}] The image snapshot handler for the given accessory didn't respond at all! See https://git.io/JtMGR for more info.`),s(_e.OPERATION_TIMED_OUT)}),17e3),o.unref()}),5e3);o.unref();try{this.delegate.handleSnapshotRequest({height:e,width:t,reason:n},((e,t)=>{o&&(clearTimeout(o),o=void 0,e?"number"==typeof e?s(e):(Tt("[%s] Error getting snapshot: %s",r,e.stack),s(_e.SERVICE_COMMUNICATION_FAILURE)):t&&0!==t.length?i(t):(console.warn(`[${r}] Snapshot request handler provided empty image buffer!`),s(_e.SERVICE_COMMUNICATION_FAILURE)))}))}catch(e){if(!o)return;clearTimeout(o),o=void 0,console.warn(`[${r}] Unhandled error thrown inside snapshot request handler: ${e.stack}`),s(_e.SERVICE_COMMUNICATION_FAILURE)}}))}handleCloseConnection(e){this.delegate instanceof O&&this.delegate.forwardCloseConnection(e)}}const Dt=d()("HAP-NodeJS:Camera:RTPStreamManagement");var Rt,Nt,Ot,Ut,Pt,Bt;let xt,Mt,Lt;var kt,Ft,Vt,Ht,jt,Kt,qt,Gt,zt;let $t;var Wt,Yt,Qt,Jt,Xt,Zt,er,tr,rr,nr,ir,sr,or;let ar,cr,ur;!function(e){e[e.STATUS=1]="STATUS"}(Rt||(Rt={})),function(e){e[e.AVAILABLE=0]="AVAILABLE",e[e.IN_USE=1]="IN_USE",e[e.UNAVAILABLE=2]="UNAVAILABLE"}(Nt||(Nt={})),function(e){e[e.VIDEO_CODEC_CONFIGURATION=1]="VIDEO_CODEC_CONFIGURATION"}(Ot||(Ot={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES"}(Ut||(Ut={})),function(e){e[e.PROFILE_ID=1]="PROFILE_ID",e[e.LEVEL=2]="LEVEL",e[e.PACKETIZATION_MODE=3]="PACKETIZATION_MODE",e[e.CVO_ENABLED=4]="CVO_ENABLED",e[e.CVO_ID=5]="CVO_ID"}(Pt||(Pt={})),function(e){e[e.IMAGE_WIDTH=1]="IMAGE_WIDTH",e[e.IMAGE_HEIGHT=2]="IMAGE_HEIGHT",e[e.FRAME_RATE=3]="FRAME_RATE"}(Bt||(Bt={})),function(e){e[e.H264=0]="H264",e[e.H265=1]="H265"}(xt||(xt={})),function(e){e[e.BASELINE=0]="BASELINE",e[e.MAIN=1]="MAIN",e[e.HIGH=2]="HIGH"}(Mt||(Mt={})),function(e){e[e.LEVEL3_1=0]="LEVEL3_1",e[e.LEVEL3_2=1]="LEVEL3_2",e[e.LEVEL4_0=2]="LEVEL4_0"}(Lt||(Lt={})),function(e){e[e.NON_INTERLEAVED=0]="NON_INTERLEAVED"}(kt||(kt={})),function(e){e[e.UNSUPPORTED=0]="UNSUPPORTED",e[e.SUPPORTED=1]="SUPPORTED"}(Ft||(Ft={})),function(e){e[e.AUDIO_CODEC_CONFIGURATION=1]="AUDIO_CODEC_CONFIGURATION",e[e.COMFORT_NOISE_SUPPORT=2]="COMFORT_NOISE_SUPPORT"}(Vt||(Vt={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS"}(Ht||(Ht={})),function(e){e[e.PCMU=0]="PCMU",e[e.PCMA=1]="PCMA",e[e.AAC_ELD=2]="AAC_ELD",e[e.OPUS=3]="OPUS",e[e.MSBC=4]="MSBC",e[e.AMR=5]="AMR",e[e.AMR_WB=6]="AMR_WB"}(jt||(jt={})),function(e){e[e.CHANNEL=1]="CHANNEL",e[e.BIT_RATE=2]="BIT_RATE",e[e.SAMPLE_RATE=3]="SAMPLE_RATE",e[e.PACKET_TIME=4]="PACKET_TIME"}(Kt||(Kt={})),function(e){e[e.VARIABLE=0]="VARIABLE",e[e.CONSTANT=1]="CONSTANT"}(qt||(qt={})),function(e){e[e.KHZ_8=0]="KHZ_8",e[e.KHZ_16=1]="KHZ_16",e[e.KHZ_24=2]="KHZ_24"}(Gt||(Gt={})),function(e){e[e.SRTP_CRYPTO_SUITE=2]="SRTP_CRYPTO_SUITE"}(zt||(zt={})),function(e){e[e.AES_CM_128_HMAC_SHA1_80=0]="AES_CM_128_HMAC_SHA1_80",e[e.AES_CM_256_HMAC_SHA1_80=1]="AES_CM_256_HMAC_SHA1_80",e[e.NONE=2]="NONE"}($t||($t={})),function(e){e[e.SESSION_ID=1]="SESSION_ID",e[e.CONTROLLER_ADDRESS=3]="CONTROLLER_ADDRESS",e[e.VIDEO_SRTP_PARAMETERS=4]="VIDEO_SRTP_PARAMETERS",e[e.AUDIO_SRTP_PARAMETERS=5]="AUDIO_SRTP_PARAMETERS"}(Wt||(Wt={})),function(e){e[e.ADDRESS_VERSION=1]="ADDRESS_VERSION",e[e.ADDRESS=2]="ADDRESS",e[e.VIDEO_RTP_PORT=3]="VIDEO_RTP_PORT",e[e.AUDIO_RTP_PORT=4]="AUDIO_RTP_PORT"}(Yt||(Yt={})),function(e){e[e.IPV4=0]="IPV4",e[e.IPV6=1]="IPV6"}(Qt||(Qt={})),function(e){e[e.SRTP_CRYPTO_SUITE=1]="SRTP_CRYPTO_SUITE",e[e.MASTER_KEY=2]="MASTER_KEY",e[e.MASTER_SALT=3]="MASTER_SALT"}(Jt||(Jt={})),function(e){e[e.SESSION_ID=1]="SESSION_ID",e[e.STATUS=2]="STATUS",e[e.ACCESSORY_ADDRESS=3]="ACCESSORY_ADDRESS",e[e.VIDEO_SRTP_PARAMETERS=4]="VIDEO_SRTP_PARAMETERS",e[e.AUDIO_SRTP_PARAMETERS=5]="AUDIO_SRTP_PARAMETERS",e[e.VIDEO_SSRC=6]="VIDEO_SSRC",e[e.AUDIO_SSRC=7]="AUDIO_SSRC"}(Xt||(Xt={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.BUSY=1]="BUSY",e[e.ERROR=2]="ERROR"}(Zt||(Zt={})),function(e){e[e.SESSION_CONTROL=1]="SESSION_CONTROL",e[e.SELECTED_VIDEO_PARAMETERS=2]="SELECTED_VIDEO_PARAMETERS",e[e.SELECTED_AUDIO_PARAMETERS=3]="SELECTED_AUDIO_PARAMETERS"}(er||(er={})),function(e){e[e.SESSION_IDENTIFIER=1]="SESSION_IDENTIFIER",e[e.COMMAND=2]="COMMAND"}(tr||(tr={})),function(e){e[e.END_SESSION=0]="END_SESSION",e[e.START_SESSION=1]="START_SESSION",e[e.SUSPEND_SESSION=2]="SUSPEND_SESSION",e[e.RESUME_SESSION=3]="RESUME_SESSION",e[e.RECONFIGURE_SESSION=4]="RECONFIGURE_SESSION"}(rr||(rr={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES",e[e.RTP_PARAMETERS=4]="RTP_PARAMETERS"}(nr||(nr={})),function(e){e[e.PAYLOAD_TYPE=1]="PAYLOAD_TYPE",e[e.SYNCHRONIZATION_SOURCE=2]="SYNCHRONIZATION_SOURCE",e[e.MAX_BIT_RATE=3]="MAX_BIT_RATE",e[e.MIN_RTCP_INTERVAL=4]="MIN_RTCP_INTERVAL",e[e.MAX_MTU=5]="MAX_MTU"}(ir||(ir={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.RTP_PARAMETERS=3]="RTP_PARAMETERS",e[e.COMFORT_NOISE=4]="COMFORT_NOISE"}(sr||(sr={})),function(e){e[e.PAYLOAD_TYPE=1]="PAYLOAD_TYPE",e[e.SYNCHRONIZATION_SOURCE=2]="SYNCHRONIZATION_SOURCE",e[e.MAX_BIT_RATE=3]="MAX_BIT_RATE",e[e.MIN_RTCP_INTERVAL=4]="MIN_RTCP_INTERVAL",e[e.COMFORT_NOISE_PAYLOAD_TYPE=6]="COMFORT_NOISE_PAYLOAD_TYPE"}(or||(or={})),function(e){e.PCMU="PCMU",e.PCMA="PCMA",e.AAC_ELD="AAC-eld",e.OPUS="OPUS",e.MSBC="mSBC",e.AMR="AMR",e.AMR_WB="AMR-WB"}(ar||(ar={})),function(e){e[e.KHZ_8=8]="KHZ_8",e[e.KHZ_16=16]="KHZ_16",e[e.KHZ_24=24]="KHZ_24"}(cr||(cr={})),function(e){e.RECONFIGURE="reconfigure",e.START="start",e.STOP="stop"}(ur||(ur={}));class hr{static SRTPCryptoSuites=$t;static VideoCodecParamProfileIDTypes=Mt;static VideoCodecParamLevelTypes=Object.freeze({TYPE3_1:0,TYPE3_2:1,TYPE4_0:2});videoOnly=!1;sessionIdentifier=void 0;streamStatus=Nt.AVAILABLE;selectedConfiguration="";setupEndpointsResponse="";constructor(e,t,r,n){if(this.delegate=r,this.requireProxy=t.proxy||!1,this.disableAudioProxy=t.disable_audio_proxy||!1,!function(e){return"srtp"in e}(t)?this.supportedCryptoSuites=t.supportedCryptoSuites:this.supportedCryptoSuites=[t.srtp?$t.AES_CM_128_HMAC_SHA1_80:$t.NONE],0===this.supportedCryptoSuites.length&&this.supportedCryptoSuites.push($t.NONE),!t.video)throw new Error("Video parameters cannot be undefined in options");this.supportedRTPConfiguration=hr._supportedRTPConfiguration(this.supportedCryptoSuites),this.supportedVideoStreamConfiguration=hr._supportedVideoStreamConfiguration(t.video),this.supportedAudioStreamConfiguration=this._supportedAudioStreamConfiguration(t.audio),this.service=n||this.constructService(e),this.setupServiceHandlers(),this.resetSetupEndpointsResponse(),this.resetSelectedStreamConfiguration()}forceStop(){this.handleSessionClosed()}getService(){return this.service}handleCloseConnection(e){}handleFactoryReset(){this.resetSelectedStreamConfiguration(),this.resetSetupEndpointsResponse()}destroy(){this.activeConnection&&this._handleStopStream()}constructService(e){const t=new xe.CameraRTPStreamManagement("",e.toString());return t.setCharacteristic(sn.Active,!0),t}setupServiceHandlers(){this.service.setCharacteristic(sn.SupportedRTPConfiguration,this.supportedRTPConfiguration),this.service.setCharacteristic(sn.SupportedVideoStreamConfiguration,this.supportedVideoStreamConfiguration),this.service.setCharacteristic(sn.SupportedAudioStreamConfiguration,this.supportedAudioStreamConfiguration),this._updateStreamStatus(Nt.AVAILABLE),this.service.setCharacteristic(sn.SetupEndpoints,this.setupEndpointsResponse),this.service.getCharacteristic(sn.SelectedRTPStreamConfiguration).on(rn.GET,(e=>{e(null,this.selectedConfiguration)})).on(rn.SET,this._handleSelectedStreamConfigurationWrite.bind(this)),this.service.getCharacteristic(sn.SetupEndpoints).on(rn.GET,(e=>{e(null,this.setupEndpointsResponse)})).on(rn.SET,((e,t,r,n)=>{if(!n)return Dt("Set event handler for SetupEndpoints cannot be called from plugin. Connection undefined!"),void t(_e.INVALID_VALUE_IN_REQUEST);this.handleSetupEndpoints(e,t,n)}))}handleSessionClosed(){this.resetSelectedStreamConfiguration(),this.resetSetupEndpointsResponse(),this.activeConnectionClosedListener&&this.activeConnection&&(this.activeConnection.removeListener(ye.CLOSED,this.activeConnectionClosedListener),this.activeConnectionClosedListener=void 0),this._updateStreamStatus(Nt.AVAILABLE),this.sessionIdentifier=void 0,this.activeConnection=void 0,this.connectionID=void 0,this.ipVersion=void 0,this.videoProxy&&(this.videoProxy.destroy(),this.videoProxy=void 0),this.audioProxy&&(this.audioProxy.destroy(),this.audioProxy=void 0)}_handleSelectedStreamConfigurationWrite(e,t){const r=be(Buffer.from(e,"base64")),n=be(r[er.SESSION_CONTROL]),i=F(n[tr.SESSION_IDENTIFIER]),s=n[tr.COMMAND][0];if(i!==this.sessionIdentifier)return Dt(`Received unknown session Identifier with request to ${rr[s]}`),void t(_e.INVALID_VALUE_IN_REQUEST);this.selectedConfiguration=e;const o=(e,r)=>{t(e,r),e&&this.handleSessionClosed()};switch(s){case rr.START_SESSION:const e=be(r[er.SELECTED_VIDEO_PARAMETERS]),n=be(r[er.SELECTED_AUDIO_PARAMETERS]);this._handleStartStream(e,n,o);break;case rr.RECONFIGURE_SESSION:const i=be(r[er.SELECTED_VIDEO_PARAMETERS]);this.handleReconfigureStream(i,o);break;case rr.END_SESSION:this._handleStopStream(o);break;case rr.RESUME_SESSION:case rr.SUSPEND_SESSION:default:return Dt(`Unhandled request type ${rr[s]}`),void t(_e.INVALID_VALUE_IN_REQUEST)}}_handleStartStream(e,t,r){const n=e[nr.CODEC_TYPE],i=e[nr.CODEC_PARAMETERS],s=e[nr.ATTRIBUTES],o=e[nr.RTP_PARAMETERS],a=be(i),c=a[Pt.PROFILE_ID][0],u=a[Pt.LEVEL][0],h=a[Pt.PACKETIZATION_MODE][0],d=a[Pt.CVO_ENABLED];let l;d&&d[0]===Ft.SUPPORTED&&(l=a[Pt.CVO_ID].readUInt8(0));const f=be(s),p=f[Bt.IMAGE_WIDTH].readUInt16LE(0),y=f[Bt.IMAGE_HEIGHT].readUInt16LE(0),m=f[Bt.FRAME_RATE].readUInt8(0),g=be(o),v=g[ir.PAYLOAD_TYPE].readUInt8(0),b=g[ir.SYNCHRONIZATION_SOURCE].readUInt32LE(0),E=g[ir.MAX_BIT_RATE].readUInt16LE(0),S=g[ir.MIN_RTCP_INTERVAL].readFloatLE(0);let A="ipv6"===this.ipVersion?1228:1378;g[ir.MAX_MTU]&&(A=g[ir.MAX_MTU].readUInt16LE(0));const I=t[sr.CODEC_TYPE][0],w=t[sr.CODEC_PARAMETERS],T=t[sr.RTP_PARAMETERS],C=!!t[sr.COMFORT_NOISE].readUInt8(0),_=be(w),D=_[Kt.CHANNEL][0],R=_[Kt.BIT_RATE][0],N=_[Kt.SAMPLE_RATE][0],O=_[Kt.PACKET_TIME].readUInt8(0),U=be(T),P=U[or.PAYLOAD_TYPE].readUInt8(0),B=U[or.SYNCHRONIZATION_SOURCE].readUInt32LE(0),x=U[or.MAX_BIT_RATE].readUInt16LE(0),M=U[or.MIN_RTCP_INTERVAL].readFloatLE(0),L=U[or.COMFORT_NOISE_PAYLOAD_TYPE].readUInt8(0);this.requireProxy&&(this.videoProxy.setOutgoingPayloadType(v),this.disableAudioProxy||this.audioProxy.setOutgoingPayloadType(P));const k={codec:n.readUInt8(0),profile:c,level:u,packetizationMode:h,cvoId:l,width:p,height:y,fps:m,pt:v,ssrc:b,max_bit_rate:E,rtcp_interval:S,mtu:A};let F,V;switch(I){case jt.PCMU:F=ar.PCMU;break;case jt.PCMA:F=ar.PCMA;break;case jt.AAC_ELD:F=ar.AAC_ELD;break;case jt.OPUS:F=ar.OPUS;break;case jt.MSBC:F=ar.MSBC;break;case jt.AMR:F=ar.AMR;break;case jt.AMR_WB:F=ar.AMR_WB;break;default:throw new Error(`Encountered unknown selected audio codec ${I}`)}switch(N){case Gt.KHZ_8:V=8;break;case Gt.KHZ_16:V=16;break;case Gt.KHZ_24:V=24;break;default:throw new Error(`Encountered unknown selected audio samplerate ${N}`)}const H={codec:F,channel:D,bit_rate:R,sample_rate:V,packet_time:O,pt:P,ssrc:B,max_bit_rate:x,rtcp_interval:M,comfort_pt:L,comfortNoiseEnabled:C},j={sessionID:this.sessionIdentifier,type:ur.START,video:k,audio:H};this.delegate.handleStreamRequest(j,(e=>r(e)))}handleReconfigureStream(e,t){const r=e[nr.ATTRIBUTES],n=e[nr.RTP_PARAMETERS],i=be(r),s=i[Bt.IMAGE_WIDTH].readUInt16LE(0),o=i[Bt.IMAGE_HEIGHT].readUInt16LE(0),a=i[Bt.FRAME_RATE].readUInt8(0),c=be(n),u={width:s,height:o,fps:a,max_bit_rate:c[ir.MAX_BIT_RATE].readUInt16LE(0),rtcp_interval:c[ir.MIN_RTCP_INTERVAL].readFloatLE(0)||.5},h={sessionID:this.sessionIdentifier,type:ur.RECONFIGURE,video:u};this.delegate.handleStreamRequest(h,(e=>t(e)))}_handleStopStream(e){const t={sessionID:this.sessionIdentifier,type:ur.STOP};this.handleSessionClosed(),this.delegate.handleStreamRequest(t,(t=>e?e(t):void 0))}handleSetupEndpoints(e,t,r){const n=be(Buffer.from(e,"base64")),i=F(n[Wt.SESSION_ID]);if(this.streamStatus!==Nt.AVAILABLE)return this.setupEndpointsResponse=ve(Xt.SESSION_ID,V(i),Xt.STATUS,Zt.BUSY).toString("base64"),void t();this.activeConnection=r,this.activeConnection.on(ye.CLOSED,this.activeConnectionClosedListener=this._handleStopStream.bind(this)),this.connectionID=r.sessionID,this.sessionIdentifier=i,this._updateStreamStatus(Nt.IN_USE);const s=be(n[Wt.CONTROLLER_ADDRESS]),o=s[Yt.ADDRESS_VERSION][0],a=s[Yt.ADDRESS].toString("utf8"),c=s[Yt.VIDEO_RTP_PORT].readUInt16LE(0),u=s[Yt.AUDIO_RTP_PORT].readUInt16LE(0),h=be(n[Wt.VIDEO_SRTP_PARAMETERS]),d=h[Jt.SRTP_CRYPTO_SUITE][0],l=h[Jt.MASTER_KEY],f=h[Jt.MASTER_SALT],y=be(n[Wt.AUDIO_SRTP_PARAMETERS]),m=y[Jt.SRTP_CRYPTO_SUITE][0],g=y[Jt.MASTER_KEY],v=y[Jt.MASTER_SALT];Dt("Session: ",i,"\nControllerAddress: ",a,"\nVideoPort: ",c,"\nAudioPort: ",u,"\nVideo Crypto: ",d,"\nVideo Master Key: ",l,"\nVideo Master Salt: ",f,"\nAudio Crypto: ",m,"\nAudio Master Key: ",g,"\nAudio Master Salt: ",v);const b={connection:r,sessionID:i,targetAddress:a,addressVersion:o===Qt.IPV6?"ipv6":"ipv4",video:{port:c,srtpCryptoSuite:d,srtp_key:l,srtp_salt:f},audio:{port:u,srtpCryptoSuite:m,srtp_key:g,srtp_salt:v}},E=[];this.requireProxy&&(b.targetAddress=r.getLocalAddress(o===Qt.IPV6?"ipv6":"ipv4"),this.videoProxy=new B({outgoingAddress:a,outgoingPort:c,outgoingSSRC:p().randomBytes(4).readUInt32LE(0),disabled:!1}),E.push(this.videoProxy.setup().then((()=>{b.video.proxy_rtp=this.videoProxy.incomingRTPPort(),b.video.proxy_rtcp=this.videoProxy.incomingRTCPPort()}))),this.disableAudioProxy||(this.audioProxy=new B({outgoingAddress:a,outgoingPort:u,outgoingSSRC:p().randomBytes(4).readUInt32LE(0),disabled:this.videoOnly}),E.push(this.audioProxy.setup().then((()=>{b.audio.proxy_rtp=this.audioProxy.incomingRTPPort(),b.audio.proxy_rtcp=this.audioProxy.incomingRTCPPort()}))))),Promise.all(E).then((()=>{this.delegate.prepareStream(b,K(((e,n)=>{e||!n?(Dt(`PrepareStream request encountered an error: ${e?e.message:void 0}`),this.setupEndpointsResponse=ve(Xt.SESSION_ID,V(i),Xt.STATUS,Zt.ERROR).toString("base64"),this.handleSessionClosed(),t(e)):this.generateSetupEndpointResponse(r,i,b,n,t)})))}))}generateSetupEndpointResponse(e,t,r,n,i){let s,o,a,c,u,h,d,l,f,p,y,g=r.addressVersion;if(!this.videoOnly&&!n.audio)throw new Error("Audio was enabled but not supplied in PrepareStreamResponse!");const v=n.audio||{port:r.audio.port,ssrc:_t.generateSynchronisationSource(),srtp_key:r.audio.srtp_key,srtp_salt:r.audio.srtp_salt};if(this.requireProxy){const t=n.video;if(s=e.getLocalAddress(r.addressVersion),c=$t.NONE,u=Buffer.alloc(0),h=Buffer.alloc(0),d=$t.NONE,l=Buffer.alloc(0),f=Buffer.alloc(0),this.videoProxy.setIncomingPayloadType(t.proxy_pt),this.videoProxy.setServerAddress(t.proxy_server_address),this.videoProxy.setServerRTPPort(t.proxy_server_rtp),this.videoProxy.setServerRTCPPort(t.proxy_server_rtcp),o=this.videoProxy.outgoingLocalPort(),p=this.videoProxy.outgoingSSRC,this.disableAudioProxy){const e=n.audio;a=e.port,y=e.ssrc}else{const e=n.audio;this.audioProxy.setIncomingPayloadType(e.proxy_pt),this.audioProxy.setServerAddress(e.proxy_server_address),this.audioProxy.setServerRTPPort(e.proxy_server_rtp),this.audioProxy.setServerRTCPPort(e.proxy_server_rtcp),a=this.audioProxy.outgoingLocalPort(),y=this.audioProxy.outgoingSSRC}}else{const t=n.video,i=v;if(n.addressOverride?(g=m().isIPv4(n.addressOverride)?"ipv4":"ipv6",s=n.addressOverride):s=e.getLocalAddress(g),r.addressVersion!==g)throw new Error(`Incoming and outgoing ip address versions must match! Expected ${r.addressVersion} but got ${g}`);if(o=t.port,a=i.port,r.video.srtpCryptoSuite!==$t.NONE&&(void 0===t.srtp_key||void 0===t.srtp_salt))throw new Error("SRTP was selected for the prepared video stream, but no 'srtp_key' or 'srtp_salt' was specified!");if(r.audio.srtpCryptoSuite!==$t.NONE&&(void 0===i.srtp_key||void 0===i.srtp_salt))throw new Error("SRTP was selected for the prepared audio stream, but no 'srtp_key' or 'srtp_salt' was specified!");c=r.video.srtpCryptoSuite,u=t.srtp_key||Buffer.alloc(0),h=t.srtp_salt||Buffer.alloc(0),d=r.audio.srtpCryptoSuite,l=i.srtp_key||Buffer.alloc(0),f=i.srtp_salt||Buffer.alloc(0),p=t.ssrc,y=i.ssrc}this.ipVersion=g;const b=ve(Yt.ADDRESS_VERSION,"ipv4"===g?Qt.IPV4:Qt.IPV6,Yt.ADDRESS,s,Yt.VIDEO_RTP_PORT,Se(o),Yt.AUDIO_RTP_PORT,Se(a)),E=ve(Jt.SRTP_CRYPTO_SUITE,c,Jt.MASTER_KEY,u,Jt.MASTER_SALT,h),S=ve(Jt.SRTP_CRYPTO_SUITE,d,Jt.MASTER_KEY,l,Jt.MASTER_SALT,f);this.setupEndpointsResponse=ve(Xt.SESSION_ID,V(t),Xt.STATUS,Zt.SUCCESS,Xt.ACCESSORY_ADDRESS,b,Xt.VIDEO_SRTP_PARAMETERS,E,Xt.AUDIO_SRTP_PARAMETERS,S,Xt.VIDEO_SSRC,Ee(p),Xt.AUDIO_SSRC,Ee(y)).toString("base64"),i()}_updateStreamStatus(e){this.streamStatus=e,this.service.updateCharacteristic(sn.StreamingStatus,ve(Rt.STATUS,this.streamStatus).toString("base64"))}static _supportedRTPConfiguration(e){return 1===e.length&&e[0]===$t.NONE&&Dt("Client claims it doesn't support SRTP. The stream may stops working with future iOS releases."),ve(zt.SRTP_CRYPTO_SUITE,e).toString("base64")}static _supportedVideoStreamConfiguration(e){if(!e.codec)throw new Error("Video codec cannot be undefined");if(!e.resolutions)throw new Error("Video resolutions cannot be undefined");let t=ve(Pt.PROFILE_ID,e.codec.profiles,Pt.LEVEL,e.codec.levels,Pt.PACKETIZATION_MODE,kt.NON_INTERLEAVED);null!=e.cvoId&&(t=Buffer.concat([t,ve(Pt.CVO_ENABLED,Ft.SUPPORTED,Pt.CVO_ID,e.cvoId)]));const r=ve(Ut.CODEC_TYPE,e.codec.type||xt.H264,Ut.CODEC_PARAMETERS,t,Ut.ATTRIBUTES,e.resolutions.map((e=>{if(3!=e.length)throw new Error("Unexpected video resolution");const t=Buffer.alloc(2),r=Buffer.alloc(2),n=Buffer.alloc(1);return t.writeUInt16LE(e[0],0),r.writeUInt16LE(e[1],0),n.writeUInt8(e[2],0),ve(Bt.IMAGE_WIDTH,t,Bt.IMAGE_HEIGHT,r,Bt.FRAME_RATE,n)})));return ve(Ot.VIDEO_CODEC_CONFIGURATION,r).toString("base64")}checkForLegacyAudioCodecRepresentation(e){const t={};e.slice().forEach((r=>{const n=t[r.type];if(n){"number"==typeof n.samplerate&&(n.samplerate=[n.samplerate]),n.samplerate=n.samplerate.concat(r.samplerate);const t=e.indexOf(r);t>=0&&e.splice(t,1)}else t[r.type]=r}))}_supportedAudioStreamConfiguration(e){const t=e&&!!e.comfort_noise,r=e&&e.codecs||[];this.checkForLegacyAudioCodecRepresentation(r),0===r.length&&(Dt("Client doesn't support any audio codec that HomeKit supports."),this.videoOnly=!0,r.push({type:ar.OPUS,samplerate:[cr.KHZ_16,cr.KHZ_24]}));const n=r.map((e=>{let t;switch(e.type){case ar.OPUS:t=jt.OPUS;break;case ar.AAC_ELD:t=jt.AAC_ELD;break;case ar.PCMA:t=jt.PCMA;break;case ar.PCMU:t=jt.PCMU;break;case ar.MSBC:t=jt.MSBC;break;case ar.AMR:t=jt.AMR;break;case ar.AMR_WB:t=jt.AMR_WB;break;default:throw new Error("Unsupported codec: "+e.type)}const r=("number"==typeof e.samplerate?[e.samplerate]:e.samplerate).map((t=>{let r;switch(t){case cr.KHZ_8:r=Gt.KHZ_8;break;case cr.KHZ_16:r=Gt.KHZ_16;break;case cr.KHZ_24:r=Gt.KHZ_24;break;default:console.log("Unsupported sample rate: ",e.samplerate),r=-1}return r})).filter((e=>-1!==e));if(0===r.length)throw new Error("Audio samplerate cannot be empty!");const n=ve(Kt.CHANNEL,Math.max(1,e.audioChannels||1),Kt.BIT_RATE,e.bitrate||qt.VARIABLE,Kt.SAMPLE_RATE,r);return ve(Ht.CODEC_TYPE,t,Ht.CODEC_PARAMETERS,n)}));return ve(Vt.AUDIO_CODEC_CONFIGURATION,n,Vt.COMFORT_NOISE_SUPPORT,t?1:0).toString("base64")}resetSetupEndpointsResponse(){this.setupEndpointsResponse=ve(Xt.STATUS,Zt.ERROR).toString("base64"),this.service.updateCharacteristic(sn.SetupEndpoints,this.setupEndpointsResponse)}resetSelectedStreamConfiguration(){this.selectedConfiguration=ve(er.SESSION_CONTROL,ve(tr.COMMAND,rr.SUSPEND_SESSION)).toString("base64"),this.service.updateCharacteristic(sn.SelectedRTPStreamConfiguration,this.selectedConfiguration)}}const dr=d()("HAP-NodeJS:Camera:RecordingManagement");var lr,fr,pr,yr,mr;let gr,vr;!function(e){e[e.VARIABLE=0]="VARIABLE",e[e.CONSTANT=1]="CONSTANT"}(lr||(lr={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS",e[e.ATTRIBUTES=3]="ATTRIBUTES"}(fr||(fr={})),function(e){e[e.PROFILE_ID=1]="PROFILE_ID",e[e.LEVEL=2]="LEVEL",e[e.BITRATE=3]="BITRATE",e[e.IFRAME_INTERVAL=4]="IFRAME_INTERVAL"}(pr||(pr={})),function(e){e[e.IMAGE_WIDTH=1]="IMAGE_WIDTH",e[e.IMAGE_HEIGHT=2]="IMAGE_HEIGHT",e[e.FRAME_RATE=3]="FRAME_RATE"}(yr||(yr={})),function(e){e[e.SELECTED_GENERAL_CONFIGURATION=1]="SELECTED_GENERAL_CONFIGURATION",e[e.SELECTED_VIDEO_CONFIGURATION=2]="SELECTED_VIDEO_CONFIGURATION",e[e.SELECTED_AUDIO_CONFIGURATION=3]="SELECTED_AUDIO_CONFIGURATION"}(mr||(mr={})),function(e){e[e.AAC_LC=0]="AAC_LC",e[e.AAC_ELD=1]="AAC_ELD"}(gr||(gr={})),function(e){e[e.KHZ_8=0]="KHZ_8",e[e.KHZ_16=1]="KHZ_16",e[e.KHZ_24=2]="KHZ_24",e[e.KHZ_32=3]="KHZ_32",e[e.KHZ_44_1=4]="KHZ_44_1",e[e.KHZ_48=5]="KHZ_48"}(vr||(vr={}));const br={0:8,1:16,2:24,3:32,4:44.1,5:48};var Er,Sr,Ar,Ir,wr,Tr,Cr;!function(e){e[e.VIDEO_CODEC_CONFIGURATION=1]="VIDEO_CODEC_CONFIGURATION"}(Er||(Er={})),function(e){e[e.PREBUFFER_LENGTH=1]="PREBUFFER_LENGTH",e[e.EVENT_TRIGGER_OPTIONS=2]="EVENT_TRIGGER_OPTIONS",e[e.MEDIA_CONTAINER_CONFIGURATIONS=3]="MEDIA_CONTAINER_CONFIGURATIONS"}(Sr||(Sr={})),function(e){e[e.MEDIA_CONTAINER_TYPE=1]="MEDIA_CONTAINER_TYPE",e[e.MEDIA_CONTAINER_PARAMETERS=2]="MEDIA_CONTAINER_PARAMETERS"}(Ar||(Ar={})),function(e){e[e.FRAGMENT_LENGTH=1]="FRAGMENT_LENGTH"}(Ir||(Ir={})),function(e){e[e.CHANNEL=1]="CHANNEL",e[e.BIT_RATE=2]="BIT_RATE",e[e.SAMPLE_RATE=3]="SAMPLE_RATE",e[e.MAX_AUDIO_BITRATE=4]="MAX_AUDIO_BITRATE"}(wr||(wr={})),function(e){e[e.CODEC_TYPE=1]="CODEC_TYPE",e[e.CODEC_PARAMETERS=2]="CODEC_PARAMETERS"}(Tr||(Tr={})),function(e){e[e.AUDIO_CODEC_CONFIGURATION=1]="AUDIO_CODEC_CONFIGURATION"}(Cr||(Cr={}));class _r{static _supportedCameraRecordingConfiguration(e){const t=Buffer.alloc(4),r=Buffer.alloc(8);return t.writeInt32LE(e.prebufferLength,0),r.writeInt32LE(e.eventTriggerOptions,0),ve(Sr.PREBUFFER_LENGTH,t,Sr.EVENT_TRIGGER_OPTIONS,r,Sr.MEDIA_CONTAINER_CONFIGURATIONS,e.mediaContainerConfigurations.map((e=>{const t=Buffer.alloc(4);return t.writeInt32LE(e.fragmentLength,0),ve(Ar.MEDIA_CONTAINER_TYPE,e.type,Ar.MEDIA_CONTAINER_PARAMETERS,ve(Ir.FRAGMENT_LENGTH,t))}))).toString("base64")}static _supportedVideoRecordingConfiguration(e){if(!e.codec)throw new Error("Video codec cannot be undefined");if(!e.resolutions)throw new Error("Video resolutions cannot be undefined");let t=ve(pr.PROFILE_ID,e.codec.profiles,pr.LEVEL,e.codec.levels);const r=ve(fr.CODEC_TYPE,e.codec.type||xt.H264,fr.CODEC_PARAMETERS,t,fr.ATTRIBUTES,e.resolutions.map((e=>{if(3!=e.length)throw new Error("Unexpected video resolution");const t=Buffer.alloc(2),r=Buffer.alloc(2),n=Buffer.alloc(1);return t.writeUInt16LE(e[0],0),r.writeUInt16LE(e[1],0),n.writeUInt8(e[2],0),ve(yr.IMAGE_WIDTH,t,yr.IMAGE_HEIGHT,r,yr.FRAME_RATE,n)})));return ve(Er.VIDEO_CODEC_CONFIGURATION,r).toString("base64")}_supportedAudioStreamConfiguration(e){const t=e&&e.codecs||[];0===t.length&&(dr("Client doesn't support any audio codec that HomeKit supports."),t.push({type:gr.AAC_LC,bitrateMode:0,audioChannels:1,samplerate:[vr.KHZ_16,vr.KHZ_24]}));const r=t.map((e=>{const t="number"==typeof e.samplerate?[e.samplerate]:e.samplerate;if(0===t.length)throw new Error("Audio samplerate cannot be empty!");const r=ve(wr.CHANNEL,Math.max(1,e.audioChannels||1),wr.BIT_RATE,e.bitrateMode||lr.VARIABLE,wr.SAMPLE_RATE,t);return ve(Tr.CODEC_TYPE,e.type,Tr.CODEC_PARAMETERS,r)}));return ve(Cr.AUDIO_CODEC_CONFIGURATION,r).toString("base64")}constructor(e,t,r){this.delegate=t,this.service=r||this.constructService(),this.setupServiceHandlers(),this.supportedCameraRecordingConfiguration=_r._supportedCameraRecordingConfiguration(e),this.supportedVideoRecordingConfiguration=_r._supportedVideoRecordingConfiguration(e.video),this.supportedAudioRecordingConfiguration=this._supportedAudioStreamConfiguration(e.audio)}constructService(){const e=new xe.CameraRecordingManagement("","");return e.getCharacteristic(sn.SupportedCameraRecordingConfiguration).on("get",(e=>{e(null,this.supportedCameraRecordingConfiguration)})),e.getCharacteristic(sn.SupportedVideoRecordingConfiguration).on("get",(e=>{e(null,this.supportedVideoRecordingConfiguration)})),e.getCharacteristic(sn.SupportedAudioRecordingConfiguration).on("get",(e=>{e(null,this.supportedAudioRecordingConfiguration)})),e}setupServiceHandlers(){this.service.setCharacteristic(sn.SelectedCameraRecordingConfiguration,"")}static parseSelectedConfiguration(e){const t=be(Buffer.from(e,"base64")),r=be(t[mr.SELECTED_GENERAL_CONFIGURATION]),n=be(t[mr.SELECTED_VIDEO_CONFIGURATION]),i=be(t[mr.SELECTED_AUDIO_CONFIGURATION]),s=n[fr.CODEC_TYPE][0],o=be(n[fr.CODEC_PARAMETERS]),a=be(n[fr.ATTRIBUTES]),c=a[yr.IMAGE_WIDTH].readInt16LE(0),u=a[yr.IMAGE_HEIGHT].readInt16LE(0),h=a[yr.FRAME_RATE][0],d=o[pr.PROFILE_ID][0],l=o[pr.LEVEL][0],f=o[pr.BITRATE].readInt32LE(0),p=o[pr.IFRAME_INTERVAL].readInt32LE(0),y=r[Sr.PREBUFFER_LENGTH].readInt32LE(0),m=be(r[Sr.MEDIA_CONTAINER_CONFIGURATIONS]),g=m[Ar.MEDIA_CONTAINER_TYPE][0],v=be(m[Ar.MEDIA_CONTAINER_PARAMETERS])[Ir.FRAGMENT_LENGTH].readInt32LE(0),b=i[Tr.CODEC_TYPE][0],E=be(i[Tr.CODEC_PARAMETERS]);return{mediaContainerConfiguration:{prebufferLength:y,type:g,fragmentLength:v},videoCodec:{type:s,bitrate:f,level:l,profile:d,resolution:[c,u,h],iFrameInterval:p},audioCodec:{audioChannels:E[wr.CHANNEL][0],type:b,samplerate:E[wr.SAMPLE_RATE][0],bitrateMode:E[wr.BIT_RATE][0],bitrate:E[wr.MAX_AUDIO_BITRATE].readUInt32LE(0)}}}getService(){return this.service}}var Dr=r(3837),Rr=r.n(Dr);class Nr{static INSTANCE=new Nr;static storage(){return this.INSTANCE.storage()}static setStorage(e){if(this.INSTANCE.localStore)throw new Error("setStorage may only be called once");this.INSTANCE.localStore=e}storage(){if(!this.localStore)throw new Error("no storage specified. consider using node-persist@^0.0.11");return this.localStore}}const Or=r(9763);let Ur;!function(e){e[e.USER=0]="USER",e[e.ADMIN=1]="ADMIN"}(Ur||(Ur={}));class Pr{static deviceIdPattern=/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/;configVersion=1;lastFirmwareVersion="";constructor(e){this.username=e,this.displayName="",this.model="",this.category="",this.pincode="",this.signSk=Buffer.alloc(0),this.signPk=Buffer.alloc(0),this.pairedClients={},this.pairedAdminClients=0,this.configHash="",this.setupID=""}addPairedClient(e,t,r){this.pairedClients[e]={username:e,publicKey:t,permission:r},r===Ur.ADMIN&&this.pairedAdminClients++}updatePermission(e,t){const r=this.pairedClients[e];if(r){const e=r.permission;r.permission=t,e===Ur.ADMIN&&t!==Ur.ADMIN?this.pairedAdminClients--:e!==Ur.ADMIN&&t===Ur.ADMIN&&this.pairedAdminClients++}}listPairings(){const e=[];for(const t of Object.values(this.pairedClients))e.push(t);return e}removePairedClient(e,t){if(this._removePairedClient0(e,t),0===this.pairedAdminClients)for(const t of Object.keys(this.pairedClients))this._removePairedClient0(e,t)}_removePairedClient0(e,t){this.pairedClients[t]&&this.pairedClients[t].permission===Ur.ADMIN&&this.pairedAdminClients--,delete this.pairedClients[t],me.destroyExistingConnectionsAfterUnpair(e,t)}isPaired(e){return!!this.pairedClients[e]}hasAdminPermissions(e){if(!e)return!1;const t=this.pairedClients[e];return!!t&&t.permission===Ur.ADMIN}getClientPublicKey(e){const t=this.pairedClients[e];return t?t.publicKey:void 0}paired=()=>Object.keys(this.pairedClients).length>0;checkForCurrentConfigurationNumberIncrement(e,t){const r=p().createHash("sha1");r.update(JSON.stringify(e));const n=r.digest("hex");let i=!1;return n!==this.configHash&&(this.configVersion++,this.configHash=n,this.ensureConfigVersionBounds(),i=!0),this.lastFirmwareVersion!==Or.version&&(this.lastFirmwareVersion=Or.version,i=!0),i&&this.save(),i}getConfigVersion(){return this.configVersion}ensureConfigVersionBounds(){this.configVersion=this.configVersion%65536,0===this.configVersion&&(this.configVersion=1)}save=()=>{const e={displayName:this.displayName,category:this.category,pincode:this.pincode,signSk:this.signSk.toString("hex"),signPk:this.signPk.toString("hex"),pairedClients:{},pairedClientsPermission:{},configVersion:this.configVersion,configHash:this.configHash,setupID:this.setupID,lastFirmwareVersion:this.lastFirmwareVersion};for(const[t,r]of Object.entries(this.pairedClients))e.pairedClients[t]=r.publicKey.toString("hex"),e.pairedClientsPermission[t]=r.permission;const t=Pr.persistKey(this.username);Nr.storage().setItemSync(t,e)};static persistKey=e=>Rr().format("AccessoryInfo.%s.json",e.replace(/:/g,"").toUpperCase());static create=e=>{Pr.assertValidUsername(e);const t=new Pr(e);t.lastFirmwareVersion=Or.version;const r=z().sign.keyPair();return t.signSk=Buffer.from(r.secretKey),t.signPk=Buffer.from(r.publicKey),t};static load=e=>{Pr.assertValidUsername(e);const t=Pr.persistKey(e),r=Nr.storage().getItem(t);if(r){const t=new Pr(e);t.displayName=r.displayName||"",t.category=r.category||"",t.pincode=r.pincode||"",t.signSk=Buffer.from(r.signSk||"","hex"),t.signPk=Buffer.from(r.signPk||"","hex"),t.pairedClients={};for(const e of Object.keys(r.pairedClients||{})){const n=r.pairedClients[e];let i=r.pairedClientsPermission?r.pairedClientsPermission[e]:void 0;void 0===i&&(i=Ur.ADMIN),t.pairedClients[e]={username:e,publicKey:Buffer.from(n,"hex"),permission:i},i===Ur.ADMIN&&t.pairedAdminClients++}return t.configVersion=r.configVersion||1,t.configHash=r.configHash||"",t.setupID=r.setupID||"",t.lastFirmwareVersion=r.lastFirmwareVersion||Or.version,t.ensureConfigVersionBounds(),t}return null};static remove(e){const t=Pr.persistKey(e);Nr.storage().removeItemSync(t)}static assertValidUsername=e=>{u().ok(Pr.deviceIdPattern.test(e),"The supplied username ("+e+") is not valid (expected a format like 'XX:XX:XX:XX:XX:XX' with XX being a valid hexadecimal string). Note that, if you had this accessory already paired with the invalid username, you will need to repair the accessory and reconfigure your services in the Home app. Using an invalid username will lead to unexpected behaviour.")}}const Br=d()("HAP-NodeJS:ControllerStorage");class xr{initialized=!1;fileCreated=!1;purgeUnidentifiedAccessoryData=!0;trackedControllers=[];controllerData={};constructor(e){this.accessoryUUID=e.UUID}enqueueSaveRequest(e=0){if(this.parent)return void this.parent.enqueueSaveRequest(e);const t=Date.now()+e;if(this.queuedSaveTimeout){if(t<=(this.queuedSaveTime??0))return;clearTimeout(this.queuedSaveTimeout)}this.queuedSaveTimeout=setTimeout((()=>{this.queuedSaveTimeout=this.queuedSaveTime=void 0,this.save()}),e).unref(),this.queuedSaveTime=Date.now()+e}linkAccessory(e){this.linkedAccessories||(this.linkedAccessories=[]);const t=e.controllerStorage;this.linkedAccessories.push(t),t.parent=this;const r=this.restoredAccessories&&this.restoredAccessories[e.UUID];this.initialized&&t.init(r)}trackController(e){e.setupStateChangeDelegate(this.handleStateChange.bind(this,e)),this.initialized?this.restoreController(e):this.trackedControllers.push(e)}untrackController(e){const t=this.trackedControllers.indexOf(e);-1!==t&&this.trackedControllers.splice(t,1),e.setupStateChangeDelegate(void 0),this.purgeControllerData(e)}purgeControllerData(e){delete this.controllerData[e.controllerId()],this.initialized&&this.enqueueSaveRequest(100)}handleStateChange(e){const t=e.controllerId(),r=e.serialize();if(r){let e=this.controllerData[t];e?e.data=r:this.controllerData[t]={data:r}}else delete this.controllerData[t];this.initialized&&this.enqueueSaveRequest(100)}restoreController(e){if(!this.initialized)throw new Error("Illegal state. Controller data wasn't loaded yet!");const t=this.controllerData[e.controllerId()];if(t){try{e.deserialize(t.data)}catch(t){console.warn(`Could not initialize controller of type '${e.controllerId()}' from data stored on disk. Resetting to default: ${t.stack}`),e.handleFactoryReset()}t.purgeOnNextLoad=void 0}}init(e){if(this.initialized)throw new Error(`ControllerStorage for accessory ${this.accessoryUUID} was already initialized!`);this.initialized=!0,e&&e.forEach((e=>this.controllerData[e.type]=e.controllerData));const t=[];this.trackedControllers.forEach((e=>{this.restoreController(e),t.push(e.controllerId())})),this.trackedControllers.splice(0,this.trackedControllers.length);let r=!1;Object.entries(this.controllerData).forEach((([e,n])=>{if(n.purgeOnNextLoad)return delete this.controllerData[e],void(r=!0);t.includes(e)||(n.purgeOnNextLoad=!0)})),r&&this.enqueueSaveRequest(500)}load(e){if(this.username)throw new Error("ControllerStorage was already loaded!");this.username=e;const t=xr.persistKey(e),r=Nr.storage().getItem(t);let n;r&&(this.fileCreated=!0,n=r.accessories[this.accessoryUUID],delete r.accessories[this.accessoryUUID]),this.init(n),this.linkedAccessories&&this.linkedAccessories.forEach((e=>{const t=r&&r.accessories[e.accessoryUUID];e.init(t),r&&delete r.accessories[e.accessoryUUID]})),r&&Object.keys(r.accessories).length>0&&(this.purgeUnidentifiedAccessoryData?Br("Purging unidentified controller data for bridge %s",e):this.restoredAccessories=r.accessories)}save(){if(this.parent)return void this.parent.save();if(!this.initialized)throw new Error("ControllerStorage has not yet been loaded!");if(!this.username)throw new Error("Cannot save controllerData for a storage without a username!");const e={[this.accessoryUUID]:this.controllerData};this.linkedAccessories&&this.linkedAccessories.forEach((t=>e[t.accessoryUUID]=t.controllerData));const t=this.restoredAccessories||{};Object.entries(e).forEach((([e,r])=>{const n=Object.entries(r);n.length>0&&(t[e]=n.map((([e,t])=>({type:e,controllerData:t}))))}));const r=xr.persistKey(this.username);if(Object.keys(t).length>0){const e={accessories:t};this.fileCreated=!0,Nr.storage().setItemSync(r,e)}else this.fileCreated&&(this.fileCreated=!1,Nr.storage().removeItemSync(r))}static persistKey(e){return Rr().format("ControllerStorage.%s.json",e.replace(/:/g,"").toUpperCase())}static remove(e){const t=xr.persistKey(e);Nr.storage().removeItemSync(t)}}class Mr{_cache={};_usedCache=null;_savedCacheHash="";constructor(e){this.username=e}startTrackingUsage=()=>{this._usedCache={}};stopTrackingUsageAndExpireUnused=()=>{this._cache=this._usedCache||this._cache,this._usedCache=null};getCache=e=>{const t=this._cache[e];return this._usedCache&&void 0!==t&&(this._usedCache[e]=t),t};setCache=(e,t)=>(this._cache[e]=t,this._usedCache&&(this._usedCache[e]=t),t);getAID=e=>{const t=e;return this.getCache("|nextAID"),this.getCache(t)||this.setCache(t,this.getNextAID())};getIID=(e,t,r,n)=>{const i=e+"|"+t+(r?"|"+r:"")+(n?"|"+n:"");return this.getCache(e+"|nextIID"),this.getCache(i)||this.setCache(i,this.getNextIID(e))};getNextAID=()=>{const e="|nextAID",t=this.getCache(e)||2;return this.setCache(e,t+1),t};getNextIID=e=>{const t=e+"|nextIID",r=this.getCache(t)||2;return this.setCache(t,r+1),r};save=()=>{const e=p().createHash("sha1").update(JSON.stringify(this._cache)).digest("hex");if(e!=this._savedCacheHash){const t={cache:this._cache},r=Mr.persistKey(this.username);Nr.storage().setItemSync(r,t),this._savedCacheHash=e}};static persistKey=e=>Rr().format("IdentifierCache.%s.json",e.replace(/:/g,"").toUpperCase());static load=e=>{const t=Mr.persistKey(e),r=Nr.storage().getItem(t);if(r){const t=new Mr(e);return t._cache=r.cache,t._savedCacheHash=p().createHash("sha1").update(JSON.stringify(t._cache)).digest("hex"),t}return null};static remove(e){const t=this.persistKey(e);Nr.storage().removeItemSync(t)}}function Lr(e,t){const r={};for(const[t,n]of Object.entries(e))r[t]=n;if(t)for(const[e,n]of Object.entries(t))r[e]=n;return r}function kr(e,t){if("boolean"==typeof e)return e?1:0;if("number"==typeof e){if(!t.minStep||t.minStep>=1)return e;const r=t.minValue??0,n=1/t.minStep;return Math.round(1e4*(Math.round((e-r)*n)/n+r))/1e4}return e}function Fr(e){switch(e){case Jr.INT:case Jr.FLOAT:case Jr.UINT8:case Jr.UINT16:case Jr.UINT32:case Jr.UINT64:return!0;default:return!1}}function Vr(e){switch(e){case Jr.INT:return-2147483648;case Jr.FLOAT:return-Number.MAX_VALUE;case Jr.UINT8:case Jr.UINT16:case Jr.UINT32:case Jr.UINT64:return 0;default:throw new Error("Unable to determine numeric lower bound for "+e)}}function Hr(e){switch(e){case Jr.INT:return 2147483647;case Jr.FLOAT:return Number.MAX_VALUE;case Jr.UINT8:return 255;case Jr.UINT16:return 65535;case Jr.UINT32:return 4294967295;case Jr.UINT64:return 0x10000000000000000;default:throw new Error("Unable to determine numeric lower bound for "+e)}}const jr=d()("HAP-NodeJS:Accessory");let Kr,qr,Gr;var zr;let $r;!function(e){e[e.OTHER=1]="OTHER",e[e.BRIDGE=2]="BRIDGE",e[e.FAN=3]="FAN",e[e.GARAGE_DOOR_OPENER=4]="GARAGE_DOOR_OPENER",e[e.LIGHTBULB=5]="LIGHTBULB",e[e.DOOR_LOCK=6]="DOOR_LOCK",e[e.OUTLET=7]="OUTLET",e[e.SWITCH=8]="SWITCH",e[e.THERMOSTAT=9]="THERMOSTAT",e[e.SENSOR=10]="SENSOR",e[e.ALARM_SYSTEM=11]="ALARM_SYSTEM",e[e.SECURITY_SYSTEM=11]="SECURITY_SYSTEM",e[e.DOOR=12]="DOOR",e[e.WINDOW=13]="WINDOW",e[e.WINDOW_COVERING=14]="WINDOW_COVERING",e[e.PROGRAMMABLE_SWITCH=15]="PROGRAMMABLE_SWITCH",e[e.RANGE_EXTENDER=16]="RANGE_EXTENDER",e[e.CAMERA=17]="CAMERA",e[e.IP_CAMERA=17]="IP_CAMERA",e[e.VIDEO_DOORBELL=18]="VIDEO_DOORBELL",e[e.AIR_PURIFIER=19]="AIR_PURIFIER",e[e.AIR_HEATER=20]="AIR_HEATER",e[e.AIR_CONDITIONER=21]="AIR_CONDITIONER",e[e.AIR_HUMIDIFIER=22]="AIR_HUMIDIFIER",e[e.AIR_DEHUMIDIFIER=23]="AIR_DEHUMIDIFIER",e[e.APPLE_TV=24]="APPLE_TV",e[e.HOMEPOD=25]="HOMEPOD",e[e.SPEAKER=26]="SPEAKER",e[e.AIRPORT=27]="AIRPORT",e[e.SPRINKLER=28]="SPRINKLER",e[e.FAUCET=29]="FAUCET",e[e.SHOWER_HEAD=30]="SHOWER_HEAD",e[e.TELEVISION=31]="TELEVISION",e[e.TARGET_CONTROLLER=32]="TARGET_CONTROLLER",e[e.ROUTER=33]="ROUTER",e[e.AUDIO_RECEIVER=34]="AUDIO_RECEIVER",e[e.TV_SET_TOP_BOX=35]="TV_SET_TOP_BOX",e[e.TV_STREAMING_STICK=36]="TV_STREAMING_STICK"}(Kr||(Kr={})),function(e){e.SLOW_WRITE="slow-write",e.TIMEOUT_WRITE="timeout-write",e.SLOW_READ="slow-read",e.TIMEOUT_READ="timeout-read",e.WARN_MESSAGE="warn-message",e.ERROR_MESSAGE="error-message",e.DEBUG_MESSAGE="debug-message"}(qr||(qr={})),function(e){e.CIAO="ciao",e.BONJOUR="bonjour-hap",e.AVAHI="avahi"}(Gr||(Gr={})),function(e){e[e.REGULAR_REQUEST=0]="REGULAR_REQUEST",e[e.TIMED_WRITE_AUTHENTICATED=1]="TIMED_WRITE_AUTHENTICATED",e[e.TIMED_WRITE_REJECTED=2]="TIMED_WRITE_REJECTED"}(zr||(zr={})),function(e){e.IDENTIFY="identify",e.LISTENING="listening",e.ADVERTISED="advertised",e.SERVICE_CONFIGURATION_CHANGE="service-configurationChange",e.SERVICE_CHARACTERISTIC_CHANGE="service-characteristic-change",e.PAIRED="paired",e.UNPAIRED="unpaired",e.CHARACTERISTIC_WARNING="characteristic-warning"}($r||($r={}));class Wr extends l.EventEmitter{static Categories=Kr;aid=null;_isBridge=!1;bridged=!1;bridgedAccessories=[];reachable=!0;category=Kr.OTHER;services=[];shouldPurgeUnusedIDs=!0;initialized=!1;controllers={};_setupID=null;controllerStorage=new xr(this);lastAccessoriesRequest=0;constructor(e,t){super(),this.displayName=e,this.UUID=t,u()(e,"Accessories must be created with a non-empty displayName."),u()(t,"Accessories must be created with a valid UUID."),u()(k(t),"UUID '"+t+"' is not a valid UUID. Try using the provided 'generateUUID' function to create a valid UUID from any arbitrary string, like a serial number."),this.addService(xe.AccessoryInformation).setCharacteristic(sn.Name,e),this.getService(xe.AccessoryInformation).getCharacteristic(sn.Identify).on(rn.SET,((e,t)=>{if(e){const e=!0;this.identificationRequest(e,t)}}))}identificationRequest(e,t){jr("[%s] Identification request",this.displayName),this.listeners($r.IDENTIFY).length>0?this.emit($r.IDENTIFY,e,t):(jr("[%s] Identification request ignored; no listeners to 'identify' event",this.displayName),t())}addService(e,...t){const r="function"==typeof e?new e(t[0],t[1],t[2]):e;for(const e of this.services)if(e.UUID===r.UUID){if(!r.subtype)throw new Error("Cannot add a Service with the same UUID '"+e.UUID+"' as another Service in this Accessory without also defining a unique 'subtype' property.");if(r.subtype===e.subtype)throw new Error("Cannot add a Service with the same UUID '"+e.UUID+"' and subtype '"+e.subtype+"' as another Service in this Accessory.")}if(this.services.length>=100)throw new Error("Cannot add more than 100 services to a single accessory!");return this.services.push(r),r.isPrimaryService&&(void 0!==this.primaryService&&(this.primaryService.isPrimaryService=!1),this.primaryService=r),this.bridged?this.emit($r.SERVICE_CONFIGURATION_CHANGE,{service:r}):this.enqueueConfigurationUpdate(),this.setupServiceEventHandlers(r),r}setPrimaryService(e){e.setPrimaryService()}removeService(e){const t=this.services.indexOf(e);t>=0&&(this.services.splice(t,1),this.primaryService===e&&(this.primaryService=void 0),this.removeLinkedService(e),this.bridged?this.emit($r.SERVICE_CONFIGURATION_CHANGE,{service:e}):this.enqueueConfigurationUpdate(),e.removeAllListeners())}removeLinkedService(e){for(const t of this.services)t.removeLinkedService(e)}getService(e){for(const t of this.services){if("string"==typeof e&&(t.displayName===e||t.name===e||t.subtype===e))return t;if("function"==typeof e&&(t instanceof e||e.UUID===t.UUID))return t}}getServiceById(e,t){for(const r of this.services){if("string"==typeof e&&(r.displayName===e||r.name===e)&&r.subtype===t)return r;if("function"==typeof e&&(r instanceof e||e.UUID===r.UUID)&&r.subtype===t)return r}}getPrimaryAccessory=()=>this.bridged?this.bridge:this;updateReachability(e){if(!this.bridged)throw new Error("Cannot update reachability on non-bridged accessory!");this.reachable=e,jr("Reachability update is no longer being supported.")}addBridgedAccessory(e,t=!1){if(e._isBridge)throw new Error("Cannot Bridge another Bridge!");for(const t of this.bridgedAccessories)if(t.UUID===e.UUID)throw new Error("Cannot add a bridged Accessory with the same UUID as another bridged Accessory: "+t.UUID);if(this.bridgedAccessories.length>=149)throw new Error("Cannot Bridge more than 149 Accessories");return e.on($r.SERVICE_CHARACTERISTIC_CHANGE,(t=>this.handleCharacteristicChangeEvent(e,t.service,t))),e.on($r.SERVICE_CONFIGURATION_CHANGE,this.enqueueConfigurationUpdate.bind(this)),e.on($r.CHARACTERISTIC_WARNING,this.handleCharacteristicWarning.bind(this)),e.bridged=!0,e.bridge=this,this.bridgedAccessories.push(e),this.controllerStorage.linkAccessory(e),t||this.enqueueConfigurationUpdate(),e}addBridgedAccessories(e){for(const t of e)this.addBridgedAccessory(t,!0);this.enqueueConfigurationUpdate()}removeBridgedAccessory(e,t){if(e._isBridge)throw new Error("Cannot Bridge another Bridge!");const r=this.bridgedAccessories.findIndex((t=>t.UUID===e.UUID));if(-1===r)throw new Error("Cannot find the bridged Accessory to remove.");this.bridgedAccessories.splice(r,1),e.removeAllListeners(),t||this.enqueueConfigurationUpdate()}removeBridgedAccessories(e){for(const t of e)this.removeBridgedAccessory(t,!0);this.enqueueConfigurationUpdate()}removeAllBridgedAccessories(){for(let e=this.bridgedAccessories.length-1;e>=0;e--)this.removeBridgedAccessory(this.bridgedAccessories[e],!0);this.enqueueConfigurationUpdate()}getCharacteristicByIID(e){for(const t of this.services){const r=t.getCharacteristicByIID(e);if(r)return r}}getAccessoryByAID(e){if(1===e)return this;for(const t of this.bridgedAccessories)if(t.aid===e)return t}findCharacteristic(e,t){const r=this.getAccessoryByAID(e);return r&&r.getCharacteristicByIID(t)}configureCameraSource(e){if(0===e.streamControllers.length)throw new Error("Malformed legacy CameraSource. Did not expose any StreamControllers!");const t=e.streamControllers[0].options,r={cameraStreamCount:e.streamControllers.length,streamingOptions:t,delegate:new O(e)},n=new _t(r,!0);return this.configureController(n),e.services.forEach((e=>{e.UUID!==xe.CameraRTPStreamManagement.UUID&&e.UUID!==xe.CameraOperatingMode.UUID&&e.UUID!==xe.CameraRecordingManagement.UUID&&this.addService(e)})),e.streamControllers=n.streamManagements,n}configureController(e){const t="function"==typeof e?new e:e,r=t.controllerId();if(this.controllers[r])throw new Error(`A Controller with the type/id '${r}' was already added to the accessory ${this.displayName}`);const n=this.serializedControllers&&this.serializedControllers[r];let i;if(n){const e=Lr(n),s=t.initWithServices(n);i=s||n,s&&this.handleUpdatedControllerServiceMap(e,s),t.configureServices(),delete this.serializedControllers[r],0===Object.entries(this.serializedControllers).length&&(this.serializedControllers=void 0)}else i=t.constructServices(),t.configureServices(),Object.values(i).forEach((e=>{e&&!this.services.includes(e)&&this.addService(e)}));const s={controller:t,serviceMap:i};wt(t)&&this.controllerStorage.trackController(t),this.controllers[r]=s,t instanceof _t&&(this.activeCameraController=t)}removeController(e){const t=e.controllerId(),r=this.controllers[t];if(r){if(r.controller!==e)throw new Error("["+this.displayName+"] tried removing a controller with the id/type '"+t+"' though provided controller isn't the same which is registered!");wt(e)&&this.controllerStorage.untrackController(e),e.handleFactoryReset&&e.handleFactoryReset(),e.handleControllerRemoved(),delete this.controllers[t],this.activeCameraController===e&&(this.activeCameraController=void 0),Object.values(r.serviceMap).forEach((e=>{e&&this.removeService(e)}))}this.serializedControllers&&delete this.serializedControllers[t]}handleAccessoryUnpairedForControllers(){for(const e of Object.values(this.controllers)){const t=e.controller;t.handleFactoryReset&&t.handleFactoryReset(),wt(t)&&this.controllerStorage.purgeControllerData(t)}}handleUpdatedControllerServiceMap(e,t){t=Lr(t),Object.keys(e).forEach((r=>{const n=e[r],i=t[r];n&&i&&(delete e[r],delete t[r],n!==i&&(this.removeService(n),this.addService(i)))})),Object.values(e).forEach((e=>{e&&this.removeService(e)})),Object.values(t).forEach((e=>{e&&this.addService(e)}))}setupURI(){if(this._setupURI)return this._setupURI;const e=Buffer.alloc(8);let t=this._accessoryInfo&&parseInt(this._accessoryInfo.pincode.replace(/-/g,""),10);const r=this._accessoryInfo&&this._accessoryInfo.category>>1;t|=1<<28,e.writeUInt32BE(t,4),this._accessoryInfo&&1&this._accessoryInfo.category&&(e[4]=128|e[4]),e.writeUInt32BE(r,0);let n=(e.readUInt32BE(4)+e.readUInt32BE(0)*Math.pow(2,32)).toString(36).toUpperCase();if(9!=n.length)for(let e=0;e<=9-n.length;e++)n="0"+n;return this._setupURI="X-HM://"+n+this._setupID,this._setupURI}validateAccessory(e){const t=this.getService(xe.AccessoryInformation);if(t){const e=(e,t)=>{t||console.log("HAP-NodeJS WARNING: The accessory '"+this.displayName+"' is getting published with the characteristic '"+e+"' (of the AccessoryInformation service) not having a value set. This might prevent the accessory from being added to the Home App or leading to the accessory being unresponsive!")},r=t.getCharacteristic(sn.Model).value,n=t.getCharacteristic(sn.SerialNumber).value,i=t.getCharacteristic(sn.FirmwareRevision).value,s=t.getCharacteristic(sn.Name).value;e("Model",r),e("SerialNumber",n),e("FirmwareRevision",i),e("Name",s)}else console.log("HAP-NodeJS WARNING: The accessory '"+this.displayName+"' is getting published without a AccessoryInformation service. This might prevent the accessory from being added to the Home app or leading to the accessory being unresponsive!");e&&u()(Buffer.from(this.displayName,"utf8").length<=63,"Accessory displayName cannot be longer than 63 bytes!"),this.bridged&&this.bridgedAccessories.forEach((e=>e.validateAccessory()))}_assignIDs(e){this._identifierCache&&this.shouldPurgeUnusedIDs&&this._identifierCache.startTrackingUsage(),this.bridged?this.aid=e.getAID(this.UUID):this.aid=1;for(const t of this.services)this._isBridge?t._assignIDs(e,this.UUID,2e9):t._assignIDs(e,this.UUID);for(const t of this.bridgedAccessories)t._assignIDs(e);this._identifierCache&&(this.shouldPurgeUnusedIDs&&this._identifierCache.stopTrackingUsageAndExpireUnused(),this._identifierCache.save())}disableUnusedIDPurge=()=>{this.shouldPurgeUnusedIDs=!1};enableUnusedIDPurge=()=>{this.shouldPurgeUnusedIDs=!0};purgeUnusedIDs=()=>{const e=this.shouldPurgeUnusedIDs;this.shouldPurgeUnusedIDs=!0,this._assignIDs(this._identifierCache),this.shouldPurgeUnusedIDs=e};async toHAP(e,t=!0){u()(this.aid,"aid cannot be undefined for accessory '"+this.displayName+"'"),u()(this.services.length,"accessory '"+this.displayName+"' does not have any services!");const r=[{aid:this.aid,services:await Promise.all(this.services.map((r=>r.toHAP(e,t))))}];return this.bridged||r.push(...await Promise.all(this.bridgedAccessories.map((r=>r.toHAP(e,t).then((e=>e[0])))))),r}internalHAPRepresentation(e=!0){e&&this._assignIDs(this._identifierCache),u()(this.aid,"aid cannot be undefined for accessory '"+this.displayName+"'"),u()(this.services.length,"accessory '"+this.displayName+"' does not have any services!");const t=[{aid:this.aid,services:this.services.map((e=>e.internalHAPRepresentation()))}];if(!this.bridged)for(const e of this.bridgedAccessories)t.push(e.internalHAPRepresentation(!1)[0]);return t}async publish(e,t){e.advertiser||null==e.useLegacyAdvertiser||(e.advertiser=e.useLegacyAdvertiser?Gr.BONJOUR:Gr.CIAO,console.warn('DEPRECATED The PublishInfo.useLegacyAdvertiser option has been removed. Please use the PublishInfo.advertiser property to enable "ciao" (useLegacyAdvertiser=false) or "bonjour-hap" (useLegacyAdvertiser=true) mdns advertiser libraries!')),e.mdns&&e.advertiser!==Gr.BONJOUR&&console.log("DEPRECATED user supplied a custom 'mdns' option. This option is deprecated and ignored. Please move to the new 'bind' option.");let r=this.getService(xe.ProtocolInformation);r||(r=this.addService(xe.ProtocolInformation)),r.setCharacteristic(sn.Version,D.protocolVersionService),this.lastKnownUsername&&this.lastKnownUsername!==e.username&&Wr.cleanupAccessoryData(this.lastKnownUsername),!this.initialized&&(e.addIdentifyingMaterial??1)&&(this.displayName=this.displayName+" "+p().createHash("sha512").update(e.username,"utf8").digest("hex").slice(0,4).toUpperCase(),this.getService(xe.AccessoryInformation).updateCharacteristic(sn.Name,this.displayName)),this._accessoryInfo=Pr.load(e.username),this._accessoryInfo||(jr("[%s] Creating new AccessoryInfo for our HAP server",this.displayName),this._accessoryInfo=Pr.create(e.username)),e.setupID?this._setupID=e.setupID:void 0===this._accessoryInfo.setupID||""===this._accessoryInfo.setupID?this._setupID=Wr._generateSetupID():this._setupID=this._accessoryInfo.setupID,this._accessoryInfo.setupID=this._setupID,this._accessoryInfo.displayName=this.displayName.replace(/\./gi,"-"),this._accessoryInfo.model=this.getService(xe.AccessoryInformation).getCharacteristic(sn.Model).value,this._accessoryInfo.category=e.category||Kr.OTHER,this._accessoryInfo.pincode=e.pincode,this._accessoryInfo.save(),this._identifierCache=Mr.load(e.username),this._identifierCache||(jr("[%s] Creating new IdentifierCache",this.displayName),this._identifierCache=new Mr(e.username)),this._isBridge&&0==this.bridgedAccessories.length&&(this.disableUnusedIDPurge(),this.controllerStorage.purgeUnidentifiedAccessoryData=!1),this.initialized||this.controllerStorage.load(e.username),this._assignIDs(this._identifierCache);const n=this.internalHAPRepresentation(!1);this._accessoryInfo.checkForCurrentConfigurationNumberIncrement(n,!0),this.validateAccessory(!0);const i=Wr.parseBindOption(e);let s=e.advertiser??Gr.BONJOUR;switch(e.advertiser!==Gr.AVAHI||await N.isAvailable()||(console.error('[${this.displayName}] Selected "'+Gr.AVAHI+'" advertiser though it isn\'t available on the platform. Reverting to "'+Gr.BONJOUR+'"'),s=Gr.BONJOUR),s){case Gr.CIAO:this._advertiser=new D(this._accessoryInfo,{interface:i.advertiserAddress},{restrictedAddresses:i.serviceRestrictedAddress,disabledIpv6:i.serviceDisableIpv6});break;case Gr.BONJOUR:this._advertiser=new R(this._accessoryInfo,e.mdns,{restrictedAddresses:i.serviceRestrictedAddress,disabledIpv6:i.serviceDisableIpv6});break;case Gr.AVAHI:this._advertiser=new N(this._accessoryInfo);break;default:throw new Error("Unsupported advertiser setting: '"+e.advertiser+"'")}this._advertiser.on(_.UPDATED_NAME,(e=>{this.displayName=e,this._accessoryInfo&&(this._accessoryInfo.displayName=e,this._accessoryInfo.save()),this.getService(xe.AccessoryInformation).updateCharacteristic(sn.Name,e)})),this._server=new Ue(this._accessoryInfo),this._server.allowInsecureRequest=!!t,this._server.on(Oe.LISTENING,this.onListening.bind(this)),this._server.on(Oe.IDENTIFY,this.identificationRequest.bind(this,!1)),this._server.on(Oe.PAIR,this.handleInitialPairSetupFinished.bind(this)),this._server.on(Oe.ADD_PAIRING,this.handleAddPairing.bind(this)),this._server.on(Oe.REMOVE_PAIRING,this.handleRemovePairing.bind(this)),this._server.on(Oe.LIST_PAIRINGS,this.handleListPairings.bind(this)),this._server.on(Oe.ACCESSORIES,this.handleAccessories.bind(this)),this._server.on(Oe.GET_CHARACTERISTICS,this.handleGetCharacteristics.bind(this)),this._server.on(Oe.SET_CHARACTERISTICS,this.handleSetCharacteristics.bind(this)),this._server.on(Oe.CONNECTION_CLOSED,this.handleHAPConnectionClosed.bind(this)),this._server.on(Oe.REQUEST_RESOURCE,this.handleResource.bind(this)),this._server.listen(e.port,i.serverAddress),this.initialized=!0}destroy(){let e=this.unpublish();return this._accessoryInfo&&(Wr.cleanupAccessoryData(this._accessoryInfo.username),this._accessoryInfo=void 0,this._identifierCache=void 0,this.controllerStorage=new xr(this)),this.removeAllListeners(),e}async unpublish(){this._server&&(this._server.destroy(),this._server=void 0),this._advertiser&&(await this._advertiser.destroy(),this._advertiser=void 0)}enqueueConfigurationUpdate(){this.configurationChangeDebounceTimeout||(this.configurationChangeDebounceTimeout=setTimeout((()=>{if(this.configurationChangeDebounceTimeout=void 0,this._advertiser&&this._advertiser){const e=this.internalHAPRepresentation();this._accessoryInfo?.checkForCurrentConfigurationNumberIncrement(e)&&this._advertiser.updateAdvertisement()}}),1e3),this.configurationChangeDebounceTimeout.unref())}onListening(e,t){u()(this._advertiser,"Advertiser wasn't created at onListening!"),this._advertiser.initPort(e),this._advertiser.startAdvertising().then((()=>this.emit($r.ADVERTISED))).catch((e=>console.error("Could not create mDNS advertisement. The HAP-Server won't be discoverable: "+e))),this.emit($r.LISTENING,e,t)}handleInitialPairSetupFinished(e,t,r){jr("[%s] Paired with client %s",this.displayName,e),this._accessoryInfo&&this._accessoryInfo.addPairedClient(e,t,Ur.ADMIN),this._accessoryInfo&&this._accessoryInfo.save(),this._advertiser&&this._advertiser.updateAdvertisement(),r(),this.emit($r.PAIRED)}handleAddPairing(e,t,r,n,i){if(!this._accessoryInfo)return void i(Ce.UNAVAILABLE);if(!this._accessoryInfo.hasAdminPermissions(e.username))return void i(Ce.AUTHENTICATION);const s=this._accessoryInfo.getClientPublicKey(t);if(s){if(s.toString()!==r.toString())return void i(Ce.UNKNOWN);this._accessoryInfo.updatePermission(t,n)}else this._accessoryInfo.addPairedClient(t,r,n);this._accessoryInfo.save(),i(0)}handleRemovePairing(e,t,r){if(this._accessoryInfo)if(this._accessoryInfo.hasAdminPermissions(e.username)){if(this._accessoryInfo.removePairedClient(e,t),this._accessoryInfo.save(),r(0),!this._accessoryInfo.paired()){this._advertiser&&this._advertiser.updateAdvertisement(),this.emit($r.UNPAIRED),this.handleAccessoryUnpairedForControllers();for(const e of this.bridgedAccessories)e.handleAccessoryUnpairedForControllers()}}else r(Ce.AUTHENTICATION);else r(Ce.UNAVAILABLE)}handleListPairings(e,t){this._accessoryInfo?this._accessoryInfo.hasAdminPermissions(e.username)?t(0,this._accessoryInfo.listPairings()):t(Ce.AUTHENTICATION):t(Ce.UNAVAILABLE)}handleAccessories(e,t){this._assignIDs(this._identifierCache);const r=Date.now(),n=r-this.lastAccessoriesRequest>5e3;this.lastAccessoriesRequest=r,this.toHAP(e,n).then((e=>{t(void 0,{accessories:e})}),(e=>{console.error("["+this.displayName+"] /accessories request error with: "+e.stack),t({httpCode:Re.INTERNAL_SERVER_ERROR,status:_e.SERVICE_COMMUNICATION_FAILURE})}))}handleGetCharacteristics(e,t,r){const n=[],i={characteristics:n},s=new Set(t.ids.map((e=>e.aid+"."+e.iid)));if(s.size!==t.ids.length)return void r({httpCode:Re.UNPROCESSABLE_ENTITY,status:_e.INVALID_VALUE_IN_REQUEST});let o=setTimeout((()=>{for(const e of s){const t=e.split("."),r=parseInt(t[0],10),n=parseInt(t[1],10),i=this.getAccessoryByAID(r),s=i.getCharacteristicByIID(n);this.sendCharacteristicWarning(s,qr.SLOW_READ,"The read handler for the characteristic '"+s.displayName+"' on the accessory '"+i.displayName+"' was slow to respond!")}o=setTimeout((()=>{o=void 0;for(const e of s){const t=e.split("."),r=parseInt(t[0],10),i=parseInt(t[1],10),s=this.getAccessoryByAID(r),o=s.getCharacteristicByIID(i);this.sendCharacteristicWarning(o,qr.TIMEOUT_READ,"The read handler for the characteristic '"+o.displayName+"' on the accessory '"+s.displayName+"' didn't respond at all!. Please check that you properly call the callback!"),n.push({aid:r,iid:i,status:_e.OPERATION_TIMED_OUT})}s.clear(),r(void 0,i)}),6e3),o.unref()}),3e3);o.unref();for(const a of t.ids){const c=a.aid+"."+a.iid;this.handleCharacteristicRead(e,a,t).then((e=>({aid:a.aid,iid:a.iid,...e})),(e=>(console.error(`[${this.displayName}] Read request for characteristic ${c} encountered an error: ${e.stack}`),{aid:a.aid,iid:a.iid,status:_e.SERVICE_COMMUNICATION_FAILURE}))).then((e=>{o&&(s.delete(c),n.push(e),0===s.size&&(o&&(clearTimeout(o),o=void 0),r(void 0,i)))}))}}async handleCharacteristicRead(e,t,r){const n=this.findCharacteristic(t.aid,t.iid);if(!n)return jr("[%s] Could not find a Characteristic with aid of %s and iid of %s",this.displayName,t.aid,t.iid),{status:_e.INVALID_VALUE_IN_REQUEST};if(!n.props.perms.includes(Zr.PAIRED_READ))return jr("[%s] Tried reading from characteristic which does not allow reading (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),{status:_e.WRITE_ONLY_CHARACTERISTIC};if(n.props.adminOnlyAccess&&n.props.adminOnlyAccess.includes(en.READ)){let r=!0;if(e.username&&this._accessoryInfo||(r=!1,jr("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for reading (aid of %s and iid of %s)",this.displayName,t.aid,t.iid)),!r||!this._accessoryInfo.hasAdminPermissions(e.username))return{status:_e.INSUFFICIENT_PRIVILEGES}}return n.handleGetRequest(e).then((i=>{i=kr(i,n.props),jr('[%s] Got Characteristic "%s" value: "%s"',this.displayName,n.displayName,i);const s={value:null==i?null:i};return r.includeMeta&&(s.format=n.props.format,s.unit=n.props.unit,s.minValue=n.props.minValue,s.maxValue=n.props.maxValue,s.minStep=n.props.minStep,s.maxLen=n.props.maxLen||n.props.maxDataLen),r.includePerms&&(s.perms=n.props.perms),r.includeType&&(s.type=j(this.UUID)),r.includeEvent&&(s.ev=e.hasEventNotifications(t.aid,t.iid)),s}),(e=>(jr('[%s] Error getting value for characteristic "%s": %s',this.displayName,n.displayName,_e[e]),{status:e})))}handleSetCharacteristics(e,t,r){jr("[%s] Processing characteristic set: %s",this.displayName,JSON.stringify(t));let n=zr.REGULAR_REQUEST;void 0!==t.pid&&(e.timedWritePid===t.pid?(n=zr.TIMED_WRITE_AUTHENTICATED,clearTimeout(e.timedWriteTimeout),e.timedWritePid=void 0,e.timedWriteTimeout=void 0,jr("[%s] Timed write request got acknowledged for pid %d",this.displayName,t.pid)):(n=zr.TIMED_WRITE_REJECTED,jr("[%s] TTL for timed write request has probably expired for pid %d",this.displayName,t.pid)));const i=[],s={characteristics:i},o=new Set(t.characteristics.map((e=>e.aid+"."+e.iid)));if(o.size!==t.characteristics.length)return void r({httpCode:Re.UNPROCESSABLE_ENTITY,status:_e.INVALID_VALUE_IN_REQUEST});let a=setTimeout((()=>{for(const e of o){const t=e.split("."),r=parseInt(t[0],10),n=parseInt(t[1],10),i=this.getAccessoryByAID(r),s=i.getCharacteristicByIID(n);this.sendCharacteristicWarning(s,qr.SLOW_WRITE,"The write handler for the characteristic '"+s.displayName+"' on the accessory '"+i.displayName+"' was slow to respond!")}a=setTimeout((()=>{a=void 0;for(const e of o){const t=e.split("."),r=parseInt(t[0],10),n=parseInt(t[1],10),s=this.getAccessoryByAID(r),o=s.getCharacteristicByIID(n);this.sendCharacteristicWarning(o,qr.TIMEOUT_WRITE,"The write handler for the characteristic '"+o.displayName+"' on the accessory '"+s.displayName+"' didn't respond at all!. Please check that you properly call the callback!"),i.push({aid:r,iid:n,status:_e.OPERATION_TIMED_OUT})}o.clear(),r(void 0,s)}),6e3),a.unref()}),3e3);a.unref();for(const c of t.characteristics){const t=c.aid+"."+c.iid;this.handleCharacteristicWrite(e,c,n).then((e=>({aid:c.aid,iid:c.iid,...e})),(e=>(console.error(`[${this.displayName}] Write request for characteristic ${t} encountered an error: ${e.stack}`),{aid:c.aid,iid:c.iid,status:_e.SERVICE_COMMUNICATION_FAILURE}))).then((e=>{a&&(o.delete(t),i.push(e),0===o.size&&(a&&(clearTimeout(a),a=void 0),r(void 0,s)))}))}}async handleCharacteristicWrite(e,t,r){const n=this.findCharacteristic(t.aid,t.iid);let i;if(!n)return jr("[%s] Could not find a Characteristic with aid of %s and iid of %s",this.displayName,t.aid,t.iid),{status:_e.INVALID_VALUE_IN_REQUEST};if(r===zr.TIMED_WRITE_REJECTED)return{status:_e.INVALID_VALUE_IN_REQUEST};if(null!=t.ev){if(e.hasEventNotifications(t.aid,t.iid)!=t.ev){if(!n.props.perms.includes(Zr.NOTIFY))return jr("[%s] Tried %s notifications for Characteristic which does not allow notify (aid of %s and iid of %s)",this.displayName,t.ev?"enabling":"disabling",t.aid,t.iid),{status:_e.NOTIFICATION_NOT_SUPPORTED};if(n.props.adminOnlyAccess&&n.props.adminOnlyAccess.includes(en.NOTIFY)){let r=!0;if(e.username&&this._accessoryInfo||(r=!1,jr("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for notify (aid of %s and iid of %s)",this.displayName,t.aid,t.iid)),!r||!this._accessoryInfo.hasAdminPermissions(e.username))return{status:_e.INSUFFICIENT_PRIVILEGES}}t.ev?(e.enableEventNotifications(t.aid,t.iid),n.subscribe(),i=!0,jr('[%s] Registered Characteristic "%s" on "%s" for events',e.remoteAddress,n.displayName,this.displayName)):(n.unsubscribe(),e.disableEventNotifications(t.aid,t.iid),i=!1,jr('[%s] Unregistered Characteristic "%s" on "%s" for events',e.remoteAddress,n.displayName,this.displayName))}}if(null!=t.value){if(!n.props.perms.includes(Zr.PAIRED_WRITE))return jr("[%s] Tried writing to Characteristic which does not allow writing (aid of %s and iid of %s)",this.displayName,t.aid,t.iid),{status:_e.READ_ONLY_CHARACTERISTIC};if(n.props.adminOnlyAccess&&n.props.adminOnlyAccess.includes(en.WRITE)){let r=!0;if(e.username&&this._accessoryInfo||(r=!1,jr("[%s] Could not verify admin permissions for Characteristic which requires admin permissions for write (aid of %s and iid of %s)",this.displayName,t.aid,t.iid)),!r||!this._accessoryInfo.hasAdminPermissions(e.username))return{status:_e.INSUFFICIENT_PRIVILEGES}}if(n.props.perms.includes(Zr.ADDITIONAL_AUTHORIZATION)&&n.additionalAuthorizationHandler){let e;try{e=n.additionalAuthorizationHandler(t.authData)}catch(t){console.log("["+this.displayName+"] Additional authorization handler has thrown an error when checking authData: "+t.stack),e=!1}if(!e)return{status:_e.INSUFFICIENT_AUTHORIZATION}}return n.props.perms.includes(Zr.TIMED_WRITE)&&r!==zr.TIMED_WRITE_AUTHENTICATED?(jr("[%s] Tried writing to a timed write only Characteristic without properly preparing (iid of %s and aid of %s)",this.displayName,t.aid,t.iid),{status:_e.INVALID_VALUE_IN_REQUEST}):n.handleSetRequest(t.value,e).then((e=>(jr('[%s] Setting Characteristic "%s" to value %s',this.displayName,n.displayName,t.value),{value:t.r&&e?kr(e,n.props):void 0,ev:i})),(e=>(jr('[%s] Error setting Characteristic "%s" to value %s: ',this.displayName,n.displayName,t.value,_e[e]),{status:e})))}return{ev:i}}handleResource(e,t){if(e["resource-type"]===g.IMAGE){const r=e.aid;let n,i;return r?(n=this.getAccessoryByAID(r),n&&n.activeCameraController&&(i=n.activeCameraController)):this.activeCameraController&&(n=this,i=this.activeCameraController),i?void i.handleSnapshotRequest(e["image-height"],e["image-width"],n?.displayName,e.reason).then((e=>{t(void 0,e)}),(e=>{t({httpCode:Re.OK,status:e})})):(jr("[%s] received snapshot request though no camera controller was associated!"),void t({httpCode:Re.NOT_FOUND,status:_e.RESOURCE_DOES_NOT_EXIST}))}jr("[%s] received request for unsupported image type: "+e["resource-type"],this._accessoryInfo?.username),t({httpCode:Re.NOT_FOUND,status:_e.RESOURCE_DOES_NOT_EXIST})}handleHAPConnectionClosed(e){this.activeCameraController&&this.activeCameraController.handleCloseConnection(e.sessionID);for(const t of e.getRegisteredEvents()){const e=t.split("."),r=parseInt(e[0],10),n=parseInt(e[1],10),i=this.findCharacteristic(r,n);i&&i.unsubscribe()}e.clearRegisteredEvents()}handleServiceConfigurationChangeEvent(e){e.isPrimaryService||e!==this.primaryService?e.isPrimaryService&&e!==this.primaryService&&(void 0!==this.primaryService&&(this.primaryService.isPrimaryService=!1),this.primaryService=e):this.primaryService=void 0,this.bridged?this.emit($r.SERVICE_CONFIGURATION_CHANGE,{service:e}):this.enqueueConfigurationUpdate()}handleCharacteristicChangeEvent(e,t,r){if(this.bridged)this.emit($r.SERVICE_CHARACTERISTIC_CHANGE,{...r,service:t});else{if(!this._server)return;if(null==e.aid||null==r.characteristic.iid)return void jr("[%s] Muting event notification for %s as ids aren't yet assigned!",e.displayName,r.characteristic.displayName);if(null!=r.context&&"object"==typeof r.context&&r.context.omitEventUpdate)return void jr("[%s] Omitting event updates for %s as specified in the context object!",e.displayName,r.characteristic.displayName);if(r.reason!==tn.EVENT&&r.oldValue===r.newValue&&r.characteristic.UUID!==sn.ProgrammableSwitchEvent.UUID&&r.characteristic.UUID!==sn.ButtonEvent.UUID)return;const t=r.characteristic.UUID,n=t===sn.ButtonEvent.UUID||t===sn.ProgrammableSwitchEvent.UUID||t===sn.MotionDetected.UUID||t===sn.ContactSensorState.UUID,i=kr(r.newValue,r.characteristic.props);this._server.sendEventNotifications(e.aid,r.characteristic.iid,i,r.originator,n)}}sendCharacteristicWarning(e,t,r){this.handleCharacteristicWarning({characteristic:e,type:t,message:r,originatorChain:[e.displayName],stack:(new Error).stack})}handleCharacteristicWarning(e){e.originatorChain=[this.displayName,...e.originatorChain];if(!this.emit($r.CHARACTERISTIC_WARNING,e)){let t=`[${e.originatorChain.join("@")}] ${e.message}`;e.type===qr.ERROR_MESSAGE||e.type===qr.TIMEOUT_READ||e.type===qr.TIMEOUT_WRITE?console.error(t):console.warn(t),jr("[%s] Above characteristic warning was thrown at: %s",this.displayName,e.stack??"unknown")}}setupServiceEventHandlers(e){e.on(Be.SERVICE_CONFIGURATION_CHANGE,this.handleServiceConfigurationChangeEvent.bind(this,e)),e.on(Be.CHARACTERISTIC_CHANGE,this.handleCharacteristicChangeEvent.bind(this,this,e)),e.on(Be.CHARACTERISTIC_WARNING,this.handleCharacteristicWarning.bind(this))}_sideloadServices(e){for(const t of e)this.setupServiceEventHandlers(t);this.services=e.slice(),this.getService(xe.AccessoryInformation).getCharacteristic(sn.Identify).on(rn.SET,((e,t)=>{if(e){const e=!0;this.identificationRequest(e,t)}}))}static _generateSetupID(){const e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",t=e.length;let r="";for(let n=0;n<4;n++){const n=Math.floor(Math.random()*t);r+=e.charAt(n)}return r}static serialize(e){const t={displayName:e.displayName,UUID:e.UUID,lastKnownUsername:e._accessoryInfo?e._accessoryInfo.username:void 0,category:e.category,services:[]},r={};let n=!1;e.services.forEach((e=>{t.services.push(xe.serialize(e));const i=[];e.linkedServices.forEach((e=>{i.push(e.getServiceId())})),i.length>0&&(r[e.getServiceId()]=i,n=!0)})),n&&(t.linkedServices=r);const i=[];return Object.values(e.controllers).forEach((e=>{i.push({type:e.controller.controllerId(),services:Wr.serializeServiceMap(e.serviceMap)})})),e.serializedControllers&&Object.entries(e.serializedControllers).forEach((([e,t])=>{i.push({type:e,services:Wr.serializeServiceMap(t)})})),i.length>0&&(t.controllers=i),t}static deserialize(e){const t=new Wr(e.displayName,e.UUID);t.lastKnownUsername=e.lastKnownUsername,t.category=e.category;const r=[],n={};if(e.services.forEach((e=>{const t=xe.deserialize(e);r.push(t),n[t.getServiceId()]=t})),e.linkedServices)for(const[t,r]of Object.entries(e.linkedServices)){const e=n[t];e&&r.forEach((t=>{const r=n[t];r&&e.addLinkedService(r)}))}return e.controllers&&(t.serializedControllers={},e.controllers.forEach((e=>{t.serializedControllers[e.type]=Wr.deserializeServiceMap(e.services,n)}))),t._sideloadServices(r),t}static cleanupAccessoryData(e){Mr.remove(e),Pr.remove(e),xr.remove(e)}static serializeServiceMap(e){const t={};return Object.entries(e).forEach((([e,r])=>{r&&(t[e]=r.getServiceId())})),t}static deserializeServiceMap(e,t){const r={};return Object.entries(e).forEach((([e,n])=>{const i=t[n];i&&(r[e]=i)})),r}static parseBindOption(e){let t,r,n=!1;if(e.bind){const i=new Set(Array.isArray(e.bind)?e.bind:[e.bind]);if(i.has("::"))r="::",i.delete("::"),i.size&&(t=Array.from(i));else if(i.has("0.0.0.0"))n=!0,r="0.0.0.0",i.delete("0.0.0.0"),i.size&&(t=Array.from(i));else if(1===i.size){t=Array.from(i);const e=i.values().next().value,n=m().isIP(e);r=n&&4===n?"0.0.0.0":"::"}else if(i.size>1){t=Array.from(i);let e=!1;for(const t of i){const r=m().isIP(t);if(0===r||6===r){e=!0;break}}r=e?"::":"0.0.0.0"}}return{advertiserAddress:t,serviceRestrictedAddress:t,serviceDisableIpv6:n,serverAddress:r}}}class Yr extends Error{constructor(e){super("HAP Status Error: "+e),Object.setPrototypeOf(this,Yr.prototype),De(e)?this.hapStatus=e:this.hapStatus=_e.SERVICE_COMMUNICATION_FAILURE}}const Qr=d()("HAP-NodeJS:Characteristic");let Jr,Xr,Zr,en,tn,rn;!function(e){e.BOOL="bool",e.INT="int",e.FLOAT="float",e.STRING="string",e.UINT8="uint8",e.UINT16="uint16",e.UINT32="uint32",e.UINT64="uint64",e.DATA="data",e.TLV8="tlv8",e.ARRAY="array",e.DICTIONARY="dict"}(Jr||(Jr={})),function(e){e.CELSIUS="celsius",e.PERCENTAGE="percentage",e.ARC_DEGREE="arcdegrees",e.LUX="lux",e.SECONDS="seconds"}(Xr||(Xr={})),function(e){e.READ="pr",e.WRITE="pw",e.PAIRED_READ="pr",e.PAIRED_WRITE="pw",e.NOTIFY="ev",e.EVENTS="ev",e.ADDITIONAL_AUTHORIZATION="aa",e.TIMED_WRITE="tw",e.HIDDEN="hd",e.WRITE_RESPONSE="wr"}(Zr||(Zr={})),function(e){e[e.READ=0]="READ",e[e.WRITE=1]="WRITE",e[e.NOTIFY=2]="NOTIFY"}(en||(en={})),function(e){e.WRITE="write",e.UPDATE="update",e.READ="read",e.EVENT="event"}(tn||(tn={})),function(e){e.GET="get",e.SET="set",e.CHANGE="change",e.SUBSCRIBE="subscribe",e.UNSUBSCRIBE="unsubscribe",e.CHARACTERISTIC_WARNING="characteristic-warning"}(rn||(rn={}));class nn{constructor(e){u()(Fr(e.format),"Cannot instantiate valid values iterable when format is not numeric. Found "+e.format),this.props=e}*[Symbol.iterator](){if(this.props.validValues)for(const e of this.props.validValues)yield e;else{let e,t=0,r=1;if(this.props.validValueRanges)t=this.props.validValueRanges[0],e=this.props.validValueRanges[1];else if(null!=this.props.minValue&&null!=this.props.maxValue)t=this.props.minValue,e=this.props.maxValue,null!=this.props.minStep&&(r=this.props.minStep);else{if(!function(e){switch(e){case Jr.UINT8:case Jr.UINT16:case Jr.UINT32:case Jr.UINT64:return!0;default:return!1}}(this.props.format))throw new Error("Could not find valid iterator strategy for props: "+JSON.stringify(this.props));e=Hr(this.props.format)}for(let n=t;n<=e;n+=r)yield n}}}class sn extends l.EventEmitter{static Formats=Jr;static Units=Xr;static Perms=Zr;iid=null;value=null;status=null;statusCode=_e.SUCCESS;subscriptions=0;constructor(e,t,r){super(),this.displayName=e,this.UUID=t,this.props={format:Jr.INT,perms:[Zr.NOTIFY]},this.setProps(r||{})}onGet(e){return"function"!=typeof e?(this.characteristicWarning(".onGet handler must be a function"),this):(this.getHandler=e,this)}removeOnGet(){return this.getHandler=void 0,this}onSet(e){return"function"!=typeof e?(this.characteristicWarning(".onSet handler must be a function"),this):(this.setHandler=e,this)}removeOnSet(){return this.setHandler=void 0,this}setProps(e){if(u()(e,"props cannot be undefined when setting props"),e.format&&(this.props.format=e.format),e.perms&&(u()(e.perms.length>0,"characteristic prop perms cannot be empty array"),this.props.perms=e.perms),void 0!==e.unit&&(this.props.unit=null!=e.unit?e.unit:void 0),void 0!==e.description&&(this.props.description=null!=e.description?e.description:void 0),void 0!==e.minValue&&(null===e.minValue?e.minValue=void 0:Fr(this.props.format)?"number"==typeof e.minValue&&Number.isFinite(e.minValue)?e.minValue<Vr(this.props.format)?(this.characteristicWarning("Characteristic Property 'minValue' was set to "+e.minValue+", but for numeric format "+this.props.format+" minimum possible is "+Vr(this.props.format),qr.ERROR_MESSAGE),e.minValue=Vr(this.props.format)):e.minValue>Hr(this.props.format)&&(this.characteristicWarning("Characteristic Property 'minValue' was set to "+e.minValue+", but for numeric format "+this.props.format+" maximum possible is "+Hr(this.props.format),qr.ERROR_MESSAGE),e.minValue=Vr(this.props.format)):(this.characteristicWarning(`Characteristic Property 'minValue' must be a finite number, received "${e.minValue}" (${typeof e.minValue})`,qr.ERROR_MESSAGE),e.minValue=void 0):(this.characteristicWarning("Characteristic Property 'minValue' can only be set for characteristics with numeric format, but not for "+this.props.format,qr.ERROR_MESSAGE),e.minValue=void 0),this.props.minValue=e.minValue),void 0!==e.maxValue&&(null===e.maxValue?e.maxValue=void 0:Fr(this.props.format)?"number"==typeof e.maxValue&&Number.isFinite(e.maxValue)?e.maxValue>Hr(this.props.format)?(this.characteristicWarning("Characteristic Property 'maxValue' was set to "+e.maxValue+", but for numeric format "+this.props.format+" maximum possible is "+Hr(this.props.format),qr.ERROR_MESSAGE),e.maxValue=Hr(this.props.format)):e.maxValue<Vr(this.props.format)&&(this.characteristicWarning("Characteristic Property 'maxValue' was set to "+e.maxValue+", but for numeric format "+this.props.format+" minimum possible is "+Vr(this.props.format),qr.ERROR_MESSAGE),e.maxValue=Hr(this.props.format)):(this.characteristicWarning(`Characteristic Property 'maxValue' must be a finite number, received "${e.maxValue}" (${typeof e.maxValue})`,qr.ERROR_MESSAGE),e.maxValue=void 0):(this.characteristicWarning("Characteristic Property 'maxValue' can only be set for characteristics with numeric format, but not for "+this.props.format,qr.ERROR_MESSAGE),e.maxValue=void 0),this.props.maxValue=e.maxValue),void 0!==e.minStep&&(null===e.minStep?this.props.minStep=void 0:Fr(this.props.format)?(e.minStep<1&&function(e){switch(e){case Jr.INT:case Jr.UINT8:case Jr.UINT16:case Jr.UINT32:case Jr.UINT64:return!0;default:return!1}}(this.props.format)&&this.characteristicWarning("Characteristic Property `minStep` was set to a value lower than 1, this will have no effect on format `"+this.props.format),this.props.minStep=e.minStep):this.characteristicWarning("Characteristic Property `minStep` can only be set for characteristics with numeric format, but not for "+this.props.format,qr.ERROR_MESSAGE)),void 0!==e.maxLen&&(null===e.maxLen?this.props.maxLen=void 0:this.props.format!==Jr.STRING?this.characteristicWarning("Characteristic Property `maxLen` can only be set for characteristics with format `STRING`, but not for "+this.props.format,qr.ERROR_MESSAGE):(e.maxLen>256&&(this.characteristicWarning("Characteristic Property string `maxLen` cannot be bigger than 256"),e.maxLen=256),this.props.maxLen=e.maxLen)),void 0!==e.maxDataLen&&(null===e.maxDataLen?this.props.maxDataLen=void 0:this.props.format!==Jr.DATA?this.characteristicWarning("Characteristic Property `maxDataLen` can only be set for characteristics with format `DATA`, but not for "+this.props.format,qr.ERROR_MESSAGE):this.props.maxDataLen=e.maxDataLen),void 0!==e.validValues&&(null===e.validValues?this.props.validValues=void 0:Fr(this.props.format)?(u()(e.validValues.length,"characteristic prop validValues cannot be empty array"),this.props.validValues=e.validValues):this.characteristicWarning("Characteristic Property `validValues` was supplied for non numeric format "+this.props.format)),void 0!==e.validValueRanges&&(null===e.validValueRanges?this.props.validValueRanges=void 0:Fr(this.props.format)?(u()(2===e.validValueRanges.length,"characteristic prop validValueRanges must have a length of 2"),this.props.validValueRanges=e.validValueRanges):this.characteristicWarning("Characteristic Property `validValueRanges` was supplied for non numeric format "+this.props.format)),void 0!==e.adminOnlyAccess&&(this.props.adminOnlyAccess=null!=e.adminOnlyAccess?e.adminOnlyAccess:void 0),null!=this.props.minValue&&null!=this.props.maxValue&&this.props.minValue>this.props.maxValue)throw this.props.minValue=void 0,this.props.maxValue=void 0,new Error("Error setting CharacteristicsProps for '"+this.displayName+"': 'minValue' cannot be greater or equal the 'maxValue'!");return this}validValuesIterator(){return new nn(this.props)}setupAdditionalAuthorization(e){this.props.perms.includes(Zr.ADDITIONAL_AUTHORIZATION)||this.props.perms.push(Zr.ADDITIONAL_AUTHORIZATION),this.additionalAuthorizationHandler=e}getValue(e,t){this.handleGetRequest(void 0,t).then((t=>{e&&e(null,t)}),(t=>{e&&e(t)}))}setValue(e,t,r){if(e instanceof Error)return this.statusCode=e instanceof Yr?e.hapStatus:an(e),this.status=e,t&&t(),this;t&&!r&&"function"!=typeof t&&(r=t,t=void 0);try{e=this.validateUserInput(e)}catch(e){return this.characteristicWarning(e?.message+"",qr.ERROR_MESSAGE,e?.stack),t&&t(e),this}return this.handleSetRequest(e,void 0,r).then((e=>{t&&(e?t(null,e):t(null))}),(e=>{t&&t(e)})),this}updateValue(e,t,r){if(e instanceof Error)return this.statusCode=e instanceof Yr?e.hapStatus:an(e),this.status=e,t&&t(),this;t&&!r&&"function"!=typeof t&&(r=t,t=void 0);try{e=this.validateUserInput(e)}catch(e){return this.characteristicWarning(e?.message+"",qr.ERROR_MESSAGE,e?.stack),t&&t(),this}this.statusCode=_e.SUCCESS,this.status=null;const n=this.value;return this.value=e,t&&t(),this.emit(rn.CHANGE,{originator:void 0,oldValue:n,newValue:e,reason:tn.UPDATE,context:r}),this}sendEventNotification(e,t){this.statusCode=_e.SUCCESS,this.status=null,e=this.validateUserInput(e);const r=this.value;return this.value=e,this.emit(rn.CHANGE,{originator:void 0,oldValue:r,newValue:e,reason:tn.EVENT,context:t}),this}async handleGetRequest(e,t){if(!this.props.perms.includes(Zr.PAIRED_READ))throw _e.WRITE_ONLY_CHARACTERISTIC;if(this.UUID===sn.ProgrammableSwitchEvent.UUID)return null;if(this.getHandler){this.listeners(rn.GET).length>0&&this.characteristicWarning("Ignoring on('get') handler as onGet handler was defined instead");try{let r=await this.getHandler(t,e);this.statusCode=_e.SUCCESS,this.status=null;try{r=this.validateUserInput(r)}catch(e){return this.characteristicWarning(`An illegal value was supplied by the read handler for characteristic: ${e?.message}`,qr.WARN_MESSAGE,e?.stack),this.statusCode=_e.SERVICE_COMMUNICATION_FAILURE,this.status=e,Promise.reject(_e.SERVICE_COMMUNICATION_FAILURE)}const n=this.value;return this.value=r,n!==r&&this.emit(rn.CHANGE,{originator:e,oldValue:n,newValue:r,reason:tn.READ,context:t}),r}catch(e){if("number"==typeof e){const t=new Yr(e);this.statusCode=t.hapStatus,this.status=t}else e instanceof Yr?(this.statusCode=e.hapStatus,this.status=e):(this.characteristicWarning(`Unhandled error thrown inside read handler for characteristic: ${e?.message}`,qr.ERROR_MESSAGE,e?.stack),this.statusCode=_e.SERVICE_COMMUNICATION_FAILURE,this.status=e);throw this.statusCode}}if(0===this.listeners(rn.GET).length){if(this.statusCode)throw this.statusCode;try{return this.validateUserInput(this.value)}catch(e){return this.characteristicWarning(`An illegal value was supplied by setting \`value\` for characteristic: ${e?.message}`,qr.WARN_MESSAGE,e?.stack),Promise.reject(_e.SERVICE_COMMUNICATION_FAILURE)}}return new Promise(((r,n)=>{try{this.emit(rn.GET,K(((i,s)=>{if(i){if("number"==typeof i){const e=new Yr(i);this.statusCode=e.hapStatus,this.status=e}else i instanceof Yr?(this.statusCode=i.hapStatus,this.status=i):(Qr("[%s] Received error from get handler %s",this.displayName,i.stack),this.statusCode=an(i),this.status=i);return void n(this.statusCode)}this.statusCode=_e.SUCCESS,this.status=null,s=this.validateUserInput(s);const o=this.value;this.value=s,r(s),o!==s&&this.emit(rn.CHANGE,{originator:e,oldValue:o,newValue:s,reason:tn.READ,context:t})})),t,e)}catch(e){this.characteristicWarning(`Unhandled error thrown inside read handler for characteristic: ${e?.message}`,qr.ERROR_MESSAGE,e?.stack),this.statusCode=_e.SERVICE_COMMUNICATION_FAILURE,this.status=e,n(_e.SERVICE_COMMUNICATION_FAILURE)}}))}async handleSetRequest(e,t,r){if(this.statusCode=_e.SUCCESS,this.status=null,void 0!==t)try{e=this.validateClientSuppliedValue(e)}catch(e){return Qr(`[${this.displayName}]`,e.message),Promise.reject(_e.INVALID_VALUE_IN_REQUEST)}const n=this.value;if(this.setHandler){this.listeners(rn.SET).length>0&&this.characteristicWarning("Ignoring on('set') handler as onSet handler was defined instead");try{const i=await this.setHandler(e,r,t);return this.statusCode=_e.SUCCESS,this.status=null,null!=i&&this.props.perms.includes(Zr.WRITE_RESPONSE)?(this.value=this.validateUserInput(i),this.value):(null!=i&&this.characteristicWarning("SET handler returned write response value, though the characteristic doesn't support write response",qr.DEBUG_MESSAGE),this.value=e,void this.emit(rn.CHANGE,{originator:t,oldValue:n,newValue:e,reason:tn.WRITE,context:r}))}catch(e){if("number"==typeof e){const t=new Yr(e);this.statusCode=t.hapStatus,this.status=t}else e instanceof Yr?(this.statusCode=e.hapStatus,this.status=e):(this.characteristicWarning(`Unhandled error thrown inside write handler for characteristic: ${e?.message}`,qr.ERROR_MESSAGE,e?.stack),this.statusCode=_e.SERVICE_COMMUNICATION_FAILURE,this.status=e);throw this.statusCode}}return 0===this.listeners(rn.SET).length?(this.value=e,this.emit(rn.CHANGE,{originator:t,oldValue:n,newValue:e,reason:tn.WRITE,context:r}),Promise.resolve()):new Promise(((i,s)=>{try{this.emit(rn.SET,e,K(((o,a)=>{if(o){if("number"==typeof o){const e=new Yr(o);this.statusCode=e.hapStatus,this.status=e}else o instanceof Yr?(this.statusCode=o.hapStatus,this.status=o):(Qr("[%s] Received error from set handler %s",this.displayName,o.stack),this.statusCode=an(o),this.status=o);s(this.statusCode)}else this.statusCode=_e.SUCCESS,this.status=null,null!=a&&this.props.perms.includes(Zr.WRITE_RESPONSE)?(this.value=this.validateUserInput(a),i(this.value)):(null!=a&&this.characteristicWarning("SET handler returned write response value, though the characteristic doesn't support write response",qr.DEBUG_MESSAGE),this.value=e,i(),this.emit(rn.CHANGE,{originator:t,oldValue:n,newValue:e,reason:tn.WRITE,context:r}))})),r,t)}catch(e){this.characteristicWarning(`Unhandled error thrown inside write handler for characteristic: ${e?.message}`,qr.ERROR_MESSAGE,e?.stack),this.statusCode=_e.SERVICE_COMMUNICATION_FAILURE,this.status=e,s(_e.SERVICE_COMMUNICATION_FAILURE)}}))}subscribe(){0===this.subscriptions&&this.emit(rn.SUBSCRIBE),this.subscriptions++}unsubscribe(){const e=1===this.subscriptions;this.subscriptions--,this.subscriptions=Math.max(this.subscriptions,0),e&&this.emit(rn.UNSUBSCRIBE)}getDefaultValue(){switch(this.props.format){case Jr.BOOL:return!1;case Jr.STRING:switch(this.UUID){case sn.Manufacturer.UUID:return"Default-Manufacturer";case sn.Model.UUID:return"Default-Model";case sn.SerialNumber.UUID:return"Default-SerialNumber";case sn.FirmwareRevision.UUID:return"0.0.0";default:return""}case Jr.DATA:case Jr.TLV8:return null;case Jr.DICTIONARY:return{};case Jr.ARRAY:return[];case Jr.INT:case Jr.FLOAT:case Jr.UINT8:case Jr.UINT16:case Jr.UINT32:case Jr.UINT64:return this.UUID===sn.CurrentTemperature.UUID?0:this.props.validValues?.length&&"number"==typeof this.props.validValues[0]?this.props.validValues[0]:"number"==typeof this.props.minValue&&Number.isFinite(this.props.minValue)?this.props.minValue:0;default:return 0}}validateClientSuppliedValue(e){if(null==e)throw new Error(`Client supplied invalid value for ${this.props.format}: undefined`);switch(this.props.format){case Jr.BOOL:if("boolean"==typeof e)return e;if("number"==typeof e&&(1===e||0===e))return Boolean(e);throw new Error(`Client supplied invalid type for ${this.props.format}: "${e}" (${typeof e})`);case Jr.INT:case Jr.FLOAT:case Jr.UINT8:case Jr.UINT16:case Jr.UINT32:case Jr.UINT64:{if("boolean"==typeof e&&(e=e?1:0),"number"!=typeof e||!Number.isFinite(e))throw new Error(`Client supplied invalid type for ${this.props.format}: "${e}" (${typeof e})`);const t=cn(this.props.minValue,Vr(this.props.format)),r=un(this.props.maxValue,Hr(this.props.format));if("number"==typeof t&&e<t)throw new Error(`Client supplied value of ${e} is less than the minimum allowed value of ${t}`);if("number"==typeof r&&e>r)throw new Error(`Client supplied value of ${e} is greater than the maximum allowed value of ${r}`);if(this.props.validValues&&!this.props.validValues.includes(e))throw new Error(`Client supplied value of ${e} is not in ${this.props.validValues.toString()}`);if(this.props.validValueRanges&&2===this.props.validValueRanges.length){if(e<this.props.validValueRanges[0])throw new Error(`Client supplied value of ${e} is less than the minimum allowed value of ${this.props.validValueRanges[0]}`);if(e>this.props.validValueRanges[1])throw new Error(`Client supplied value of ${e} is greater than the maximum allowed value of ${this.props.validValueRanges[1]}`)}return e}case Jr.STRING:{if("string"!=typeof e)throw new Error(`Client supplied invalid type for ${this.props.format}: "${e}" (${typeof e})`);const t=null!=this.props.maxLen?this.props.maxLen:64;if(e.length>t)throw new Error(`Client supplied value length of ${e.length} exceeds maximum length allowed of ${t}`);return e}case Jr.DATA:{if("string"!=typeof e)throw new Error(`Client supplied invalid type for ${this.props.format}: "${e}" (${typeof e})`);const t=null!=this.props.maxDataLen?this.props.maxDataLen:2097152;if(e.length>t)throw new Error(`Client supplied value length of ${e.length} exceeds maximum length allowed of ${t}`);return e}case Jr.TLV8:if("string"!=typeof e)throw new Error(`Client supplied invalid type for ${this.props.format}: "${e}" (${typeof e})`);return e}return e}validateUserInput(e){if(null===e){if(this.UUID===sn.Model.UUID||this.UUID===sn.SerialNumber.UUID)return this.characteristicWarning("characteristic must have a non null value otherwise HomeKit will reject this accessory, ignoring new value",qr.ERROR_MESSAGE),this.value;if(null===this.getDefaultValue())return e;if(!this.UUID.endsWith(x))return e;if(this.UUID===ks.UUID)return e;if(this.characteristicWarning("characteristic was supplied illegal value: null! Home App will reject null for Apple defined characteristics"),null!==this.value)return this.value}switch(this.props.format){case Jr.BOOL:return"boolean"==typeof e?e:"number"==typeof e?1===e:"string"==typeof e?"1"===e||"true"===e:(this.characteristicWarning("characteristic value expected boolean and received "+typeof e),!1);case Jr.INT:case Jr.FLOAT:case Jr.UINT8:case Jr.UINT16:case Jr.UINT32:case Jr.UINT64:{"boolean"==typeof e&&(e=e?1:0),"string"==typeof e&&(e=this.props.format===Jr.FLOAT?parseFloat(e):parseInt(e,10)),"number"==typeof e&&Number.isFinite(e)||(this.characteristicWarning(`characteristic value expected valid finite number and received "${e}" (${typeof e})`),e="number"==typeof this.value?this.value:this.props.minValue||0);const t=cn(this.props.minValue,Vr(this.props.format)),r=un(this.props.maxValue,Hr(this.props.format));let n;return n=this.props.format===Jr.FLOAT?this.props.minStep:cn(this.props.minStep,1),null!=t&&e<t&&(this.characteristicWarning(`characteristic was supplied illegal value: number ${e} exceeded minimum of ${t}`),e=t),null!=r&&e>r&&(this.characteristicWarning(`characteristic was supplied illegal value: number ${e} exceeded maximum of ${r}`),e=r),this.props.validValues&&!this.props.validValues.includes(e)?(this.characteristicWarning(`characteristic value ${e} is not contained in valid values array`),this.props.validValues.includes(this.value)?this.value:this.props.validValues[0]||0):(this.props.validValueRanges&&2===this.props.validValueRanges.length&&(e<this.props.validValueRanges[0]?(this.characteristicWarning(`characteristic was supplied illegal value: number ${e} not contained in valid value range of ${this.props.validValueRanges}, supplying illegal values will throw errors in the future`),e=this.props.validValueRanges[0]):e>this.props.validValueRanges[1]&&(this.characteristicWarning(`characteristic was supplied illegal value: number ${e} not contained in valid value range of ${this.props.validValueRanges}, supplying illegal values will throw errors in the future`),e=this.props.validValueRanges[1])),null!=n&&(1===n?e=Math.round(e):n>1&&(e=Math.round(e),e-=e%n)),e)}case Jr.STRING:{if("number"==typeof e&&(this.characteristicWarning("characteristic was supplied illegal value: number instead of string, supplying illegal values will throw errors in the future"),e=String(e)),"string"!=typeof e&&(this.characteristicWarning("characteristic value expected string and received "+typeof e),e="string"==typeof this.value?this.value:e+""),e.length<=1&&(this.UUID===sn.Model.UUID||this.UUID===sn.SerialNumber.UUID))return this.characteristicWarning(`[${this.displayName}] characteristic must have a length of more than 1 character otherwise HomeKit will reject this accessory, ignoring new value`),this.value;const t=this.props.maxLen??64;return e.length>t&&(this.characteristicWarning(`characteristic was supplied illegal value: string '${e}' exceeded max length of ${t}`),e=e.substring(0,t)),e}case Jr.DATA:if("string"!=typeof e)throw new Error("characteristic with DATA format must have string value");if(null!=this.props.maxDataLen&&e.length>this.props.maxDataLen)throw new Error("characteristic with DATA format exceeds specified maxDataLen");return e;case Jr.TLV8:return void 0===e?(this.characteristicWarning("characteristic was supplied illegal value: undefined"),this.value):e}return void 0===e?(this.characteristicWarning("characteristic was supplied illegal value: undefined",qr.ERROR_MESSAGE),this.value):e}_assignID(e,t,r,n){this.iid=e.getIID(t,r,n,this.UUID)}characteristicWarning(e,t=qr.WARN_MESSAGE,r=(new Error).stack){this.emit(rn.CHARACTERISTIC_WARNING,t,e,r)}removeAllListeners(e){return e||(this.removeOnGet(),this.removeOnSet()),super.removeAllListeners(e)}replaceBy(e){this.props=e.props,this.updateValue(e.value);const t=e.listeners(rn.GET);t.length&&(this.removeAllListeners(rn.GET),t.forEach((e=>this.addListener(rn.GET,e)))),this.removeOnGet(),e.getHandler&&this.onGet(e.getHandler);const r=e.listeners(rn.SET);r.length&&(this.removeAllListeners(rn.SET),r.forEach((e=>this.addListener(rn.SET,e)))),this.removeOnSet(),e.setHandler&&this.onSet(e.setHandler)}async toHAP(e,t=!0){const r=this.internalHAPRepresentation();if(this.props.perms.includes(Zr.PAIRED_READ))if(this.UUID===sn.ProgrammableSwitchEvent.UUID)r.value=null;else{const n=t?await this.handleGetRequest(e).catch((()=>(Qr("[%s] Error getting value for characteristic on /accessories request. Returning cached value instead: %s",this.displayName,`${this.value}`),this.value))):this.value;r.value=kr(n,this.props)}else r.value=void 0;return r}internalHAPRepresentation(){return u()(this.iid,"iid cannot be undefined for characteristic '"+this.displayName+"'"),{type:j(this.UUID),iid:this.iid,value:null,perms:this.props.perms,description:this.props.description||this.displayName,format:this.props.format,unit:this.props.unit,minValue:this.props.minValue,maxValue:this.props.maxValue,minStep:this.props.minStep,maxLen:this.props.maxLen,maxDataLen:this.props.maxDataLen,"valid-values":this.props.validValues,"valid-values-range":this.props.validValueRanges}}static serialize(e){let t;return"Characteristic"!==e.constructor.name&&(t=e.constructor.name),{displayName:e.displayName,UUID:e.UUID,eventOnlyCharacteristic:e.UUID===sn.ProgrammableSwitchEvent.UUID,constructorName:t,value:e.value,props:Lr({},e.props)}}static deserialize(e){let t;if(e.constructorName&&e.constructorName.charAt(0).toUpperCase()===e.constructorName.charAt(0)&&sn[e.constructorName]){t=new(0,sn[e.constructorName]),t.displayName=e.displayName,t.setProps(e.props)}else t=new sn(e.displayName,e.UUID,e.props);return t.value=e.value,t}}const on=/^-?\d+$/;function an(e){let t=_e.SERVICE_COMMUNICATION_FAILURE;if(on.test(e.message)){const r=parseInt(e.message,10);De(r)&&(t=r)}return t}function cn(e,t){return void 0===e?t:void 0===t?e:Math.max(e,t)}function un(e,t){return void 0===e?t:void 0===t?e:Math.min(e,t)}class hn extends sn{static UUID="00000262-0000-1000-8000-0026BB765291";constructor(){super("Access Code Control Point",hn.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.AccessCodeControlPoint=hn;class dn extends sn{static UUID="00000261-0000-1000-8000-0026BB765291";constructor(){super("Access Code Supported Configuration",dn.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.AccessCodeSupportedConfiguration=dn;class ln extends sn{static UUID="000000E5-0000-1000-8000-0026BB765291";constructor(){super("Access Control Level",ln.UUID,{format:Jr.UINT16,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:2,minStep:1}),this.value=this.getDefaultValue()}}sn.AccessControlLevel=ln;class fn extends sn{static UUID="000000A6-0000-1000-8000-0026BB765291";static REQUIRES_ADDITIONAL_SETUP_BIT_MASK=1;constructor(){super("Accessory Flags",fn.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.AccessoryFlags=fn;class pn extends sn{static UUID="00000057-0000-1000-8000-0026BB765291";constructor(){super("Accessory Identifier",pn.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.AccessoryIdentifier=pn;class yn extends sn{static UUID="000000B0-0000-1000-8000-0026BB765291";static INACTIVE=0;static ACTIVE=1;constructor(){super("Active",yn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.Active=yn;class mn extends sn{static UUID="000000E7-0000-1000-8000-0026BB765291";constructor(){super("Active Identifier",mn.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.ActiveIdentifier=mn;class gn extends sn{static UUID="0000023B-0000-1000-8000-0026BB765291";constructor(){super("Activity Interval",gn.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,minStep:1}),this.value=this.getDefaultValue()}}sn.ActivityInterval=gn;class vn extends sn{static UUID="00000001-0000-1000-8000-0026BB765291";constructor(){super("Administrator Only Access",vn.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.AdministratorOnlyAccess=vn;class bn extends sn{static UUID="00000064-0000-1000-8000-0026BB765291";constructor(){super("Air Particulate Density",bn.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e3}),this.value=this.getDefaultValue()}}sn.AirParticulateDensity=bn;class En extends sn{static UUID="00000065-0000-1000-8000-0026BB765291";static _2_5_M=0;static _10_M=1;constructor(){super("Air Particulate Size",En.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.AirParticulateSize=En;class Sn extends sn{static UUID="0000025B-0000-1000-8000-0026BB765291";constructor(){super("AirPlay Enable",Sn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1}),this.value=this.getDefaultValue()}}sn.AirPlayEnable=Sn;class An extends sn{static UUID="00000095-0000-1000-8000-0026BB765291";static UNKNOWN=0;static EXCELLENT=1;static GOOD=2;static FAIR=3;static INFERIOR=4;static POOR=5;constructor(){super("Air Quality",An.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:5,minStep:1,validValues:[0,1,2,3,4,5]}),this.value=this.getDefaultValue()}}sn.AirQuality=An;class In extends sn{static UUID="000000A4-0000-1000-8000-0026BB765291";constructor(){super("App Matching Identifier",In.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.AppMatchingIdentifier=In;class wn extends sn{static UUID="00000269-0000-1000-8000-0026BB765291";constructor(){super("Asset Update Readiness",wn.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.AssetUpdateReadiness=wn;class Tn extends sn{static UUID="00000005-0000-1000-8000-0026BB765291";constructor(){super("Audio Feedback",Tn.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.AudioFeedback=Tn;class Cn extends sn{static UUID="00000068-0000-1000-8000-0026BB765291";constructor(){super("Battery Level",Cn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.BatteryLevel=Cn;class _n extends sn{static UUID="00000008-0000-1000-8000-0026BB765291";constructor(){super("Brightness",_n.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.Brightness=_n;class Dn extends sn{static UUID="00000126-0000-1000-8000-0026BB765291";constructor(){super("Button Event",Dn.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],adminOnlyAccess:[en.NOTIFY]}),this.value=this.getDefaultValue()}}sn.ButtonEvent=Dn;class Rn extends sn{static UUID="0000021D-0000-1000-8000-0026BB765291";constructor(){super("Camera Operating Mode Indicator",Rn.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.TIMED_WRITE]}),this.value=this.getDefaultValue()}}sn.CameraOperatingModeIndicator=Rn;class Nn extends sn{static UUID="00000092-0000-1000-8000-0026BB765291";static CO2_LEVELS_NORMAL=0;static CO2_LEVELS_ABNORMAL=1;constructor(){super("Carbon Dioxide Detected",Nn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.CarbonDioxideDetected=Nn;class On extends sn{static UUID="00000093-0000-1000-8000-0026BB765291";constructor(){super("Carbon Dioxide Level",On.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e5,minStep:1}),this.value=this.getDefaultValue()}}sn.CarbonDioxideLevel=On;class Un extends sn{static UUID="00000094-0000-1000-8000-0026BB765291";constructor(){super("Carbon Dioxide Peak Level",Un.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e5,minStep:1}),this.value=this.getDefaultValue()}}sn.CarbonDioxidePeakLevel=Un;class Pn extends sn{static UUID="00000069-0000-1000-8000-0026BB765291";static CO_LEVELS_NORMAL=0;static CO_LEVELS_ABNORMAL=1;constructor(){super("Carbon Monoxide Detected",Pn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.CarbonMonoxideDetected=Pn;class Bn extends sn{static UUID="00000090-0000-1000-8000-0026BB765291";constructor(){super("Carbon Monoxide Level",Bn.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.CarbonMonoxideLevel=Bn;class xn extends sn{static UUID="00000091-0000-1000-8000-0026BB765291";constructor(){super("Carbon Monoxide Peak Level",xn.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.CarbonMonoxidePeakLevel=xn;class Mn extends sn{static UUID="000000A3-0000-1000-8000-0026BB765291";constructor(){super("Category",Mn.UUID,{format:Jr.UINT16,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:1,maxValue:16}),this.value=this.getDefaultValue()}}sn.Category=Mn;class Ln extends sn{static UUID="00000246-0000-1000-8000-0026BB765291";constructor(){super("CCA Energy Detect Threshold",Ln.UUID,{format:Jr.INT,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.CCAEnergyDetectThreshold=Ln;class kn extends sn{static UUID="00000245-0000-1000-8000-0026BB765291";constructor(){super("CCA Signal Detect Threshold",kn.UUID,{format:Jr.INT,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.CCASignalDetectThreshold=kn;class Fn extends sn{static UUID="0000024B-0000-1000-8000-0026BB765291";constructor(){super("Characteristic Value Active Transition Count",Fn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.CharacteristicValueActiveTransitionCount=Fn;class Vn extends sn{static UUID="00000143-0000-1000-8000-0026BB765291";constructor(){super("Characteristic Value Transition Control",Vn.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.CharacteristicValueTransitionControl=Vn;class Hn extends sn{static UUID="0000008F-0000-1000-8000-0026BB765291";static NOT_CHARGING=0;static CHARGING=1;static NOT_CHARGEABLE=2;constructor(){super("Charging State",Hn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.ChargingState=Hn;class jn extends sn{static UUID="000000DD-0000-1000-8000-0026BB765291";static DISABLED=0;static ENABLED=1;constructor(){super("Closed Captions",jn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.ClosedCaptions=jn;class Kn extends sn{static UUID="000000CE-0000-1000-8000-0026BB765291";constructor(){super("Color Temperature",Kn.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:140,maxValue:500,minStep:1}),this.value=this.getDefaultValue()}}sn.ColorTemperature=Kn;class qn extends sn{static UUID="00000263-0000-1000-8000-0026BB765291";constructor(){super("Configuration State",qn.UUID,{format:Jr.UINT16,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.ConfigurationState=qn;class Gn extends sn{static UUID="000000A0-0000-1000-8000-0026BB765291";constructor(){super("Configure Bridged Accessory",Gn.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.ConfigureBridgedAccessory=Gn;class zn extends sn{static UUID="0000009D-0000-1000-8000-0026BB765291";constructor(){super("Configure Bridged Accessory Status",zn.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.ConfigureBridgedAccessoryStatus=zn;class $n extends sn{static UUID="000000E3-0000-1000-8000-0026BB765291";constructor(){super("Configured Name",$n.UUID,{format:Jr.STRING,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.ConfiguredName=$n;class Wn extends sn{static UUID="0000006A-0000-1000-8000-0026BB765291";static CONTACT_DETECTED=0;static CONTACT_NOT_DETECTED=1;constructor(){super("Contact Sensor State",Wn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.ContactSensorState=Wn;class Yn extends sn{static UUID="0000000D-0000-1000-8000-0026BB765291";constructor(){super("Cooling Threshold Temperature",Yn.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.CELSIUS,minValue:10,maxValue:35,minStep:.1}),this.value=this.getDefaultValue()}}sn.CoolingThresholdTemperature=Yn;class Qn extends sn{static UUID="000000A9-0000-1000-8000-0026BB765291";static INACTIVE=0;static IDLE=1;static PURIFYING_AIR=2;constructor(){super("Current Air Purifier State",Qn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.CurrentAirPurifierState=Qn;class Jn extends sn{static UUID="0000006B-0000-1000-8000-0026BB765291";constructor(){super("Current Ambient Light Level",Jn.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.LUX,minValue:1e-4,maxValue:1e5}),this.value=this.getDefaultValue()}}sn.CurrentAmbientLightLevel=Jn;class Xn extends sn{static UUID="0000000E-0000-1000-8000-0026BB765291";static OPEN=0;static CLOSED=1;static OPENING=2;static CLOSING=3;static STOPPED=4;constructor(){super("Current Door State",Xn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:4,minStep:1,validValues:[0,1,2,3,4]}),this.value=this.getDefaultValue()}}sn.CurrentDoorState=Xn;class Zn extends sn{static UUID="000000AF-0000-1000-8000-0026BB765291";static INACTIVE=0;static IDLE=1;static BLOWING_AIR=2;constructor(){super("Current Fan State",Zn.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.CurrentFanState=Zn;class ei extends sn{static UUID="000000B1-0000-1000-8000-0026BB765291";static INACTIVE=0;static IDLE=1;static HEATING=2;static COOLING=3;constructor(){super("Current Heater-Cooler State",ei.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]}),this.value=this.getDefaultValue()}}sn.CurrentHeaterCoolerState=ei;class ti extends sn{static UUID="0000000F-0000-1000-8000-0026BB765291";static OFF=0;static HEAT=1;static COOL=2;constructor(){super("Current Heating Cooling State",ti.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.CurrentHeatingCoolingState=ti;class ri extends sn{static UUID="0000006C-0000-1000-8000-0026BB765291";constructor(){super("Current Horizontal Tilt Angle",ri.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.ARC_DEGREE,minValue:-90,maxValue:90,minStep:1}),this.value=this.getDefaultValue()}}sn.CurrentHorizontalTiltAngle=ri;class ni extends sn{static UUID="000000B3-0000-1000-8000-0026BB765291";static INACTIVE=0;static IDLE=1;static HUMIDIFYING=2;static DEHUMIDIFYING=3;constructor(){super("Current Humidifier-Dehumidifier State",ni.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]}),this.value=this.getDefaultValue()}}sn.CurrentHumidifierDehumidifierState=ni;class ii extends sn{static UUID="000000E0-0000-1000-8000-0026BB765291";static PLAY=0;static PAUSE=1;static STOP=2;static LOADING=4;static INTERRUPTED=5;constructor(){super("Current Media State",ii.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:5,minStep:1,validValues:[0,1,2,4,5]}),this.value=this.getDefaultValue()}}sn.CurrentMediaState=ii;class si extends sn{static UUID="0000006D-0000-1000-8000-0026BB765291";constructor(){super("Current Position",si.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.CurrentPosition=si;class oi extends sn{static UUID="00000010-0000-1000-8000-0026BB765291";constructor(){super("Current Relative Humidity",oi.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.CurrentRelativeHumidity=oi;class ai extends sn{static UUID="000000AA-0000-1000-8000-0026BB765291";static FIXED=0;static JAMMED=1;static SWINGING=2;constructor(){super("Current Slat State",ai.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.CurrentSlatState=ai;class ci extends sn{static UUID="00000011-0000-1000-8000-0026BB765291";constructor(){super("Current Temperature",ci.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.CELSIUS,minValue:-270,maxValue:100,minStep:.1}),this.value=this.getDefaultValue()}}sn.CurrentTemperature=ci;class ui extends sn{static UUID="000000C1-0000-1000-8000-0026BB765291";constructor(){super("Current Tilt Angle",ui.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.ARC_DEGREE,minValue:-90,maxValue:90,minStep:1}),this.value=this.getDefaultValue()}}sn.CurrentTiltAngle=ui;class hi extends sn{static UUID="0000009B-0000-1000-8000-0026BB765291";constructor(){super("Current Time",hi.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.CurrentTime=hi;class di extends sn{static UUID="0000022B-0000-1000-8000-0026BB765291";constructor(){super("Current Transport",di.UUID,{format:Jr.BOOL,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.CurrentTransport=di;class li extends sn{static UUID="0000006E-0000-1000-8000-0026BB765291";constructor(){super("Current Vertical Tilt Angle",li.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.ARC_DEGREE,minValue:-90,maxValue:90,minStep:1}),this.value=this.getDefaultValue()}}sn.CurrentVerticalTiltAngle=li;class fi extends sn{static UUID="00000135-0000-1000-8000-0026BB765291";static SHOWN=0;static HIDDEN=1;constructor(){super("Current Visibility State",fi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.CurrentVisibilityState=fi;class pi extends sn{static UUID="00000138-0000-1000-8000-0026BB765291";constructor(){super("Data Stream HAP Transport",pi.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.DataStreamHAPTransport=pi;class yi extends sn{static UUID="00000139-0000-1000-8000-0026BB765291";constructor(){super("Data Stream HAP Transport Interrupt",yi.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.DataStreamHAPTransportInterrupt=yi;class mi extends sn{static UUID="00000098-0000-1000-8000-0026BB765291";constructor(){super("Day of the Week",mi.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:1,maxValue:7}),this.value=this.getDefaultValue()}}sn.DayoftheWeek=mi;class gi extends sn{static UUID="00000224-0000-1000-8000-0026BB765291";constructor(){super("Diagonal Field Of View",gi.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.ARC_DEGREE,minValue:0,maxValue:360}),this.value=this.getDefaultValue()}}sn.DiagonalFieldOfView=gi;class vi extends sn{static UUID="0000011D-0000-1000-8000-0026BB765291";constructor(){super("Digital Zoom",vi.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minStep:.1}),this.value=this.getDefaultValue()}}sn.DigitalZoom=vi;class bi extends sn{static UUID="0000009E-0000-1000-8000-0026BB765291";constructor(){super("Discover Bridged Accessories",bi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.DiscoverBridgedAccessories=bi;class Ei extends sn{static UUID="0000009F-0000-1000-8000-0026BB765291";constructor(){super("Discovered Bridged Accessories",Ei.UUID,{format:Jr.UINT16,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.DiscoveredBridgedAccessories=Ei;class Si extends sn{static UUID="00000136-0000-1000-8000-0026BB765291";constructor(){super("Display Order",Si.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.DisplayOrder=Si;class Ai extends sn{static UUID="0000023D-0000-1000-8000-0026BB765291";constructor(){super("Event Retransmission Maximum",Ai.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.EventRetransmissionMaximum=Ai;class Ii extends sn{static UUID="00000223-0000-1000-8000-0026BB765291";constructor(){super("Event Snapshots Active",Ii.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1}),this.value=this.getDefaultValue()}}sn.EventSnapshotsActive=Ii;class wi extends sn{static UUID="0000023E-0000-1000-8000-0026BB765291";constructor(){super("Event Transmission Counters",wi.UUID,{format:Jr.UINT32,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.EventTransmissionCounters=wi;class Ti extends sn{static UUID="000000AC-0000-1000-8000-0026BB765291";static FILTER_OK=0;static CHANGE_FILTER=1;constructor(){super("Filter Change Indication",Ti.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.FilterChangeIndication=Ti;class Ci extends sn{static UUID="000000AB-0000-1000-8000-0026BB765291";constructor(){super("Filter Life Level",Ci.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.FilterLifeLevel=Ci;class _i extends sn{static UUID="00000052-0000-1000-8000-0026BB765291";constructor(){super("Firmware Revision",_i.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.FirmwareRevision=_i;class Di extends sn{static UUID="00000234-0000-1000-8000-0026BB765291";constructor(){super("Firmware Update Readiness",Di.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.FirmwareUpdateReadiness=Di;class Ri extends sn{static UUID="00000235-0000-1000-8000-0026BB765291";constructor(){super("Firmware Update Status",Ri.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.FirmwareUpdateStatus=Ri;class Ni extends sn{static UUID="0000026C-0000-1000-8000-0026BB765291";constructor(){super("Hardware Finish",Ni.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.HardwareFinish=Ni;class Oi extends sn{static UUID="00000053-0000-1000-8000-0026BB765291";constructor(){super("Hardware Revision",Oi.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.HardwareRevision=Oi;class Ui extends sn{static UUID="0000024A-0000-1000-8000-0026BB765291";constructor(){super("Heart Beat",Ui.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.HeartBeat=Ui;class Pi extends sn{static UUID="00000012-0000-1000-8000-0026BB765291";constructor(){super("Heating Threshold Temperature",Pi.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.CELSIUS,minValue:0,maxValue:25,minStep:.1}),this.value=this.getDefaultValue()}}sn.HeatingThresholdTemperature=Pi;class Bi extends sn{static UUID="0000006F-0000-1000-8000-0026BB765291";constructor(){super("Hold Position",Bi.UUID,{format:Jr.BOOL,perms:[Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.HoldPosition=Bi;class xi extends sn{static UUID="0000021B-0000-1000-8000-0026BB765291";constructor(){super("HomeKit Camera Active",xi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1}),this.value=this.getDefaultValue()}}sn.HomeKitCameraActive=xi;class Mi extends sn{static UUID="00000013-0000-1000-8000-0026BB765291";constructor(){super("Hue",Mi.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.ARC_DEGREE,minValue:0,maxValue:360,minStep:1}),this.value=this.getDefaultValue()}}sn.Hue=Mi;class Li extends sn{static UUID="000000E6-0000-1000-8000-0026BB765291";constructor(){super("Identifier",Li.UUID,{format:Jr.UINT32,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.Identifier=Li;class ki extends sn{static UUID="00000014-0000-1000-8000-0026BB765291";constructor(){super("Identify",ki.UUID,{format:Jr.BOOL,perms:[Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.Identify=ki;class Fi extends sn{static UUID="0000011F-0000-1000-8000-0026BB765291";constructor(){super("Image Mirroring",Fi.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.ImageMirroring=Fi;class Vi extends sn{static UUID="0000011E-0000-1000-8000-0026BB765291";constructor(){super("Image Rotation",Vi.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.ARC_DEGREE,minValue:0,maxValue:360,minStep:1}),this.value=this.getDefaultValue()}}sn.ImageRotation=Vi;class Hi extends sn{static UUID="000000DC-0000-1000-8000-0026BB765291";static OTHER=0;static TV=1;static RECORDING=2;static TUNER=3;static PLAYBACK=4;static AUDIO_SYSTEM=5;constructor(){super("Input Device Type",Hi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:6,minStep:1,validValues:[0,1,2,3,4,5,6]}),this.value=this.getDefaultValue()}}sn.InputDeviceType=Hi;class ji extends sn{static UUID="000000DB-0000-1000-8000-0026BB765291";static OTHER=0;static HOME_SCREEN=1;static TUNER=2;static HDMI=3;static COMPOSITE_VIDEO=4;static S_VIDEO=5;static COMPONENT_VIDEO=6;static DVI=7;static AIRPLAY=8;static USB=9;static APPLICATION=10;constructor(){super("Input Source Type",ji.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:10,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10]}),this.value=this.getDefaultValue()}}sn.InputSourceType=ji;class Ki extends sn{static UUID="000000D2-0000-1000-8000-0026BB765291";static NOT_IN_USE=0;static IN_USE=1;constructor(){super("In Use",Ki.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.InUse=Ki;class qi extends sn{static UUID="000000D6-0000-1000-8000-0026BB765291";static NOT_CONFIGURED=0;static CONFIGURED=1;constructor(){super("Is Configured",qi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.IsConfigured=qi;class Gi extends sn{static UUID="00000070-0000-1000-8000-0026BB765291";static LEAK_NOT_DETECTED=0;static LEAK_DETECTED=1;constructor(){super("Leak Detected",Gi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.LeakDetected=Gi;class zi extends sn{static UUID="0000009C-0000-1000-8000-0026BB765291";constructor(){super("Link Quality",zi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:1,maxValue:4}),this.value=this.getDefaultValue()}}sn.LinkQuality=zi;class $i extends sn{static UUID="00000050-0000-1000-8000-0026BB765291";constructor(){super("List Pairings",$i.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.ListPairings=$i;class Wi extends sn{static UUID="00000019-0000-1000-8000-0026BB765291";constructor(){super("Lock Control Point",Wi.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.LockControlPoint=Wi;class Yi extends sn{static UUID="0000001D-0000-1000-8000-0026BB765291";static UNSECURED=0;static SECURED=1;static JAMMED=2;static UNKNOWN=3;constructor(){super("Lock Current State",Yi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]}),this.value=this.getDefaultValue()}}sn.LockCurrentState=Yi;class Qi extends sn{static UUID="0000001C-0000-1000-8000-0026BB765291";static SECURED_PHYSICALLY_INTERIOR=0;static UNSECURED_PHYSICALLY_INTERIOR=1;static SECURED_PHYSICALLY_EXTERIOR=2;static UNSECURED_PHYSICALLY_EXTERIOR=3;static SECURED_BY_KEYPAD=4;static UNSECURED_BY_KEYPAD=5;static SECURED_REMOTELY=6;static UNSECURED_REMOTELY=7;static SECURED_BY_AUTO_SECURE_TIMEOUT=8;static SECURED_PHYSICALLY=9;static UNSECURED_PHYSICALLY=10;constructor(){super("Lock Last Known Action",Qi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:10,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10]}),this.value=this.getDefaultValue()}}sn.LockLastKnownAction=Qi;class Ji extends sn{static UUID="0000001A-0000-1000-8000-0026BB765291";constructor(){super("Lock Management Auto Security Timeout",Ji.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.SECONDS}),this.value=this.getDefaultValue()}}sn.LockManagementAutoSecurityTimeout=Ji;class Xi extends sn{static UUID="000000A7-0000-1000-8000-0026BB765291";static CONTROL_LOCK_DISABLED=0;static CONTROL_LOCK_ENABLED=1;constructor(){super("Lock Physical Controls",Xi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.LockPhysicalControls=Xi;class Zi extends sn{static UUID="0000001E-0000-1000-8000-0026BB765291";static UNSECURED=0;static SECURED=1;constructor(){super("Lock Target State",Zi.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.LockTargetState=Zi;class es extends sn{static UUID="0000001F-0000-1000-8000-0026BB765291";constructor(){super("Logs",es.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.Logs=es;class ts extends sn{static UUID="00000247-0000-1000-8000-0026BB765291";constructor(){super("MAC Retransmission Maximum",ts.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.MACRetransmissionMaximum=ts;class rs extends sn{static UUID="00000248-0000-1000-8000-0026BB765291";constructor(){super("MAC Transmission Counters",rs.UUID,{format:Jr.DATA,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.MACTransmissionCounters=rs;class ns extends sn{static UUID="00000215-0000-1000-8000-0026BB765291";static DISABLED=0;static ENABLED=1;constructor(){super("Managed Network Enable",ns.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.TIMED_WRITE],minValue:0,maxValue:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.ManagedNetworkEnable=ns;class is extends sn{static UUID="00000227-0000-1000-8000-0026BB765291";static ENABLED=0;static DISABLED=1;constructor(){super("Manually Disabled",is.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ],validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.ManuallyDisabled=is;class ss extends sn{static UUID="00000020-0000-1000-8000-0026BB765291";constructor(){super("Manufacturer",ss.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ],maxLen:64}),this.value=this.getDefaultValue()}}sn.Manufacturer=ss;class os extends sn{static UUID="00000243-0000-1000-8000-0026BB765291";constructor(){super("Maximum Transmit Power",os.UUID,{format:Jr.INT,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.MaximumTransmitPower=os;class as extends sn{static UUID="00000021-0000-1000-8000-0026BB765291";constructor(){super("Model",as.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ],maxLen:64}),this.value=this.getDefaultValue()}}sn.Model=as;class cs extends sn{static UUID="00000022-0000-1000-8000-0026BB765291";constructor(){super("Motion Detected",cs.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.MotionDetected=cs;class us extends sn{static UUID="0000026B-0000-1000-8000-0026BB765291";constructor(){super("Multifunction Button",us.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1}),this.value=this.getDefaultValue()}}sn.MultifunctionButton=us;class hs extends sn{static UUID="0000011A-0000-1000-8000-0026BB765291";constructor(){super("Mute",hs.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.Mute=hs;class ds extends sn{static UUID="00000023-0000-1000-8000-0026BB765291";constructor(){super("Name",ds.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ],maxLen:64}),this.value=this.getDefaultValue()}}sn.Name=ds;class ls extends sn{static UUID="0000021F-0000-1000-8000-0026BB765291";constructor(){super("Network Access Violation Control",ls.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.TIMED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.NetworkAccessViolationControl=ls;class fs extends sn{static UUID="0000020C-0000-1000-8000-0026BB765291";constructor(){super("Network Client Profile Control",fs.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.TIMED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.NetworkClientProfileControl=fs;class ps extends sn{static UUID="0000020D-0000-1000-8000-0026BB765291";constructor(){super("Network Client Status Control",ps.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.NetworkClientStatusControl=ps;class ys extends sn{static UUID="00000264-0000-1000-8000-0026BB765291";constructor(){super("NFC Access Control Point",ys.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.NFCAccessControlPoint=ys;class ms extends sn{static UUID="00000265-0000-1000-8000-0026BB765291";constructor(){super("NFC Access Supported Configuration",ms.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.NFCAccessSupportedConfiguration=ms;class gs extends sn{static UUID="0000011B-0000-1000-8000-0026BB765291";constructor(){super("Night Vision",gs.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.TIMED_WRITE]}),this.value=this.getDefaultValue()}}sn.NightVision=gs;class vs extends sn{static UUID="000000C4-0000-1000-8000-0026BB765291";constructor(){super("Nitrogen Dioxide Density",vs.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e3,minStep:1}),this.value=this.getDefaultValue()}}sn.NitrogenDioxideDensity=vs;class bs extends sn{static UUID="00000024-0000-1000-8000-0026BB765291";constructor(){super("Obstruction Detected",bs.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.ObstructionDetected=bs;class Es extends sn{static UUID="00000071-0000-1000-8000-0026BB765291";static OCCUPANCY_NOT_DETECTED=0;static OCCUPANCY_DETECTED=1;constructor(){super("Occupancy Detected",Es.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.OccupancyDetected=Es;class Ss extends sn{static UUID="00000025-0000-1000-8000-0026BB765291";constructor(){super("On",Ss.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.On=Ss;class As extends sn{static UUID="00000232-0000-1000-8000-0026BB765291";constructor(){super("Operating State Response",As.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.OperatingStateResponse=As;class Is extends sn{static UUID="0000011C-0000-1000-8000-0026BB765291";constructor(){super("Optical Zoom",Is.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minStep:.1}),this.value=this.getDefaultValue()}}sn.OpticalZoom=Is;class ws extends sn{static UUID="00000026-0000-1000-8000-0026BB765291";constructor(){super("Outlet In Use",ws.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.OutletInUse=ws;class Ts extends sn{static UUID="000000C3-0000-1000-8000-0026BB765291";constructor(){super("Ozone Density",Ts.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e3,minStep:1}),this.value=this.getDefaultValue()}}sn.OzoneDensity=Ts;class Cs extends sn{static UUID="0000004F-0000-1000-8000-0026BB765291";constructor(){super("Pairing Features",Cs.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.PairingFeatures=Cs;class _s extends sn{static UUID="0000004C-0000-1000-8000-0026BB765291";constructor(){super("Pair Setup",_s.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.PairSetup=_s;class Ds extends sn{static UUID="0000004E-0000-1000-8000-0026BB765291";constructor(){super("Pair Verify",Ds.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.PairVerify=Ds;class Rs extends sn{static UUID="000000E4-0000-1000-8000-0026BB765291";constructor(){super("Password Setting",Rs.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.PasswordSetting=Rs;class Ns extends sn{static UUID="00000225-0000-1000-8000-0026BB765291";constructor(){super("Periodic Snapshots Active",Ns.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.PeriodicSnapshotsActive=Ns;class Os extends sn{static UUID="000000E2-0000-1000-8000-0026BB765291";static OTHER=0;static STANDARD=1;static CALIBRATED=2;static CALIBRATED_DARK=3;static VIVID=4;static GAME=5;static COMPUTER=6;static CUSTOM=7;constructor(){super("Picture Mode",Os.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:13,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13]}),this.value=this.getDefaultValue()}}sn.PictureMode=Os;class Us extends sn{static UUID="0000023C-0000-1000-8000-0026BB765291";constructor(){super("Ping",Us.UUID,{format:Jr.DATA,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.Ping=Us;class Ps extends sn{static UUID="000000C7-0000-1000-8000-0026BB765291";constructor(){super("PM10 Density",Ps.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e3,minStep:1}),this.value=this.getDefaultValue()}}sn.PM10Density=Ps;class Bs extends sn{static UUID="000000C6-0000-1000-8000-0026BB765291";constructor(){super("PM2.5 Density",Bs.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e3,minStep:1}),this.value=this.getDefaultValue()}}sn.PM2_5Density=Bs;class xs extends sn{static UUID="00000072-0000-1000-8000-0026BB765291";static DECREASING=0;static INCREASING=1;static STOPPED=2;constructor(){super("Position State",xs.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.PositionState=xs;class Ms extends sn{static UUID="000000DF-0000-1000-8000-0026BB765291";static SHOW=0;static HIDE=1;constructor(){super("Power Mode Selection",Ms.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.PowerModeSelection=Ms;class Ls extends sn{static UUID="00000220-0000-1000-8000-0026BB765291";constructor(){super("Product Data",Ls.UUID,{format:Jr.DATA,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.ProductData=Ls;class ks extends sn{static UUID="00000073-0000-1000-8000-0026BB765291";static SINGLE_PRESS=0;static DOUBLE_PRESS=1;static LONG_PRESS=2;constructor(){super("Programmable Switch Event",ks.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.ProgrammableSwitchEvent=ks;class Fs extends sn{static UUID="00000074-0000-1000-8000-0026BB765291";constructor(){super("Programmable Switch Output State",Fs.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1}),this.value=this.getDefaultValue()}}sn.ProgrammableSwitchOutputState=Fs;class Vs extends sn{static UUID="000000D1-0000-1000-8000-0026BB765291";static NO_PROGRAM_SCHEDULED=0;static PROGRAM_SCHEDULED=1;static PROGRAM_SCHEDULED_MANUAL_MODE_=2;constructor(){super("Program Mode",Vs.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.ProgramMode=Vs;class Hs extends sn{static UUID="00000063-0000-1000-8000-0026BB765291";constructor(){super("Reachable",Hs.UUID,{format:Jr.BOOL,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.Reachable=Hs;class js extends sn{static UUID="0000023F-0000-1000-8000-0026BB765291";constructor(){super("Received Signal Strength Indication",js.UUID,{format:Jr.INT,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.ReceivedSignalStrengthIndication=js;class Ks extends sn{static UUID="00000244-0000-1000-8000-0026BB765291";constructor(){super("Receiver Sensitivity",Ks.UUID,{format:Jr.INT,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.ReceiverSensitivity=Ks;class qs extends sn{static UUID="00000226-0000-1000-8000-0026BB765291";static DISABLE=0;static ENABLE=1;constructor(){super("Recording Audio Active",qs.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.TIMED_WRITE],validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.RecordingAudioActive=qs;class Gs extends sn{static UUID="000000C9-0000-1000-8000-0026BB765291";constructor(){super("Relative Humidity Dehumidifier Threshold",Gs.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.RelativeHumidityDehumidifierThreshold=Gs;class zs extends sn{static UUID="000000CA-0000-1000-8000-0026BB765291";constructor(){super("Relative Humidity Humidifier Threshold",zs.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.RelativeHumidityHumidifierThreshold=zs;class $s extends sn{static UUID="0000005E-0000-1000-8000-0026BB765291";constructor(){super("Relay Control Point",$s.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.RelayControlPoint=$s;class Ws extends sn{static UUID="0000005B-0000-1000-8000-0026BB765291";constructor(){super("Relay Enabled",Ws.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.RelayEnabled=Ws;class Ys extends sn{static UUID="0000005C-0000-1000-8000-0026BB765291";constructor(){super("Relay State",Ys.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:5,minStep:1}),this.value=this.getDefaultValue()}}sn.RelayState=Ys;class Qs extends sn{static UUID="000000D4-0000-1000-8000-0026BB765291";constructor(){super("Remaining Duration",Qs.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.SECONDS,minValue:0,maxValue:3600,minStep:1}),this.value=this.getDefaultValue()}}sn.RemainingDuration=Qs;class Js extends sn{static UUID="000000E1-0000-1000-8000-0026BB765291";static REWIND=0;static FAST_FORWARD=1;static NEXT_TRACK=2;static PREVIOUS_TRACK=3;static ARROW_UP=4;static ARROW_DOWN=5;static ARROW_LEFT=6;static ARROW_RIGHT=7;static SELECT=8;static BACK=9;static EXIT=10;static PLAY_PAUSE=11;static INFORMATION=15;constructor(){super("Remote Key",Js.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_WRITE],minValue:0,maxValue:16,minStep:1,validValues:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]}),this.value=this.getDefaultValue()}}sn.RemoteKey=Js;class Xs extends sn{static UUID="000000AD-0000-1000-8000-0026BB765291";constructor(){super("Reset Filter Indication",Xs.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_WRITE],minValue:1,maxValue:1,minStep:1}),this.value=this.getDefaultValue()}}sn.ResetFilterIndication=Xs;class Zs extends sn{static UUID="00000028-0000-1000-8000-0026BB765291";static CLOCKWISE=0;static COUNTER_CLOCKWISE=1;constructor(){super("Rotation Direction",Zs.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.RotationDirection=Zs;class eo extends sn{static UUID="00000029-0000-1000-8000-0026BB765291";constructor(){super("Rotation Speed",eo.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.RotationSpeed=eo;class to extends sn{static UUID="0000020E-0000-1000-8000-0026BB765291";static READY=0;static NOT_READY=1;constructor(){super("Router Status",to.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.RouterStatus=to;class ro extends sn{static UUID="0000002F-0000-1000-8000-0026BB765291";constructor(){super("Saturation",ro.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.Saturation=ro;class no extends sn{static UUID="0000008E-0000-1000-8000-0026BB765291";constructor(){super("Security System Alarm Type",no.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1}),this.value=this.getDefaultValue()}}sn.SecuritySystemAlarmType=no;class io extends sn{static UUID="00000066-0000-1000-8000-0026BB765291";static STAY_ARM=0;static AWAY_ARM=1;static NIGHT_ARM=2;static DISARMED=3;static ALARM_TRIGGERED=4;constructor(){super("Security System Current State",io.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:4,minStep:1,validValues:[0,1,2,3,4]}),this.value=this.getDefaultValue()}}sn.SecuritySystemCurrentState=io;class so extends sn{static UUID="00000067-0000-1000-8000-0026BB765291";static STAY_ARM=0;static AWAY_ARM=1;static NIGHT_ARM=2;static DISARM=3;constructor(){super("Security System Target State",so.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]}),this.value=this.getDefaultValue()}}sn.SecuritySystemTargetState=so;class oo extends sn{static UUID="00000128-0000-1000-8000-0026BB765291";constructor(){super("Selected Audio Stream Configuration",oo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.SelectedAudioStreamConfiguration=oo;class ao extends sn{static UUID="00000209-0000-1000-8000-0026BB765291";constructor(){super("Selected Camera Recording Configuration",ao.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.SelectedCameraRecordingConfiguration=ao;class co extends sn{static UUID="0000024D-0000-1000-8000-0026BB765291";constructor(){super("Selected Diagnostics Modes",co.UUID,{format:Jr.UINT32,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.SelectedDiagnosticsModes=co;class uo extends sn{static UUID="00000117-0000-1000-8000-0026BB765291";constructor(){super("Selected RTP Stream Configuration",uo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.SelectedRTPStreamConfiguration=uo;class ho extends sn{static UUID="00000030-0000-1000-8000-0026BB765291";constructor(){super("Serial Number",ho.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ],maxLen:64}),this.value=this.getDefaultValue()}}sn.SerialNumber=ho;class lo extends sn{static UUID="000000CB-0000-1000-8000-0026BB765291";constructor(){super("Service Label Index",lo.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_READ],minValue:1,maxValue:255,minStep:1}),this.value=this.getDefaultValue()}}sn.ServiceLabelIndex=lo;class fo extends sn{static UUID="000000CD-0000-1000-8000-0026BB765291";static DOTS=0;static ARABIC_NUMERALS=1;constructor(){super("Service Label Namespace",fo.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.ServiceLabelNamespace=fo;class po extends sn{static UUID="000000D3-0000-1000-8000-0026BB765291";constructor(){super("Set Duration",po.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.SECONDS,minValue:0,maxValue:3600,minStep:1}),this.value=this.getDefaultValue()}}sn.SetDuration=po;class yo extends sn{static UUID="00000131-0000-1000-8000-0026BB765291";constructor(){super("Setup Data Stream Transport",yo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.SetupDataStreamTransport=yo;class mo extends sn{static UUID="00000118-0000-1000-8000-0026BB765291";constructor(){super("Setup Endpoints",mo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.SetupEndpoints=mo;class go extends sn{static UUID="00000201-0000-1000-8000-0026BB765291";constructor(){super("Setup Transfer Transport",go.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.SetupTransferTransport=go;class vo extends sn{static UUID="00000241-0000-1000-8000-0026BB765291";constructor(){super("Signal To Noise Ratio",vo.UUID,{format:Jr.INT,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SignalToNoiseRatio=vo;class bo extends sn{static UUID="00000255-0000-1000-8000-0026BB765291";constructor(){super("Siri Enable",bo.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1}),this.value=this.getDefaultValue()}}sn.SiriEnable=bo;class Eo extends sn{static UUID="00000254-0000-1000-8000-0026BB765291";constructor(){super("Siri Endpoint Session Status",Eo.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SiriEndpointSessionStatus=Eo;class So extends sn{static UUID="0000025A-0000-1000-8000-0026BB765291";constructor(){super("Siri Engine Version",So.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SiriEngineVersion=So;class Ao extends sn{static UUID="00000132-0000-1000-8000-0026BB765291";static PUSH_BUTTON_TRIGGERED_APPLE_TV=0;constructor(){super("Siri Input Type",Ao.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_READ],minValue:0,maxValue:0,validValues:[0]}),this.value=this.getDefaultValue()}}sn.SiriInputType=Ao;class Io extends sn{static UUID="00000258-0000-1000-8000-0026BB765291";constructor(){super("Siri Light On Use",Io.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1}),this.value=this.getDefaultValue()}}sn.SiriLightOnUse=Io;class wo extends sn{static UUID="00000256-0000-1000-8000-0026BB765291";constructor(){super("Siri Listening",wo.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1}),this.value=this.getDefaultValue()}}sn.SiriListening=wo;class To extends sn{static UUID="00000257-0000-1000-8000-0026BB765291";constructor(){super("Siri Touch To Use",To.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1}),this.value=this.getDefaultValue()}}sn.SiriTouchToUse=To;class Co extends sn{static UUID="000000C0-0000-1000-8000-0026BB765291";static HORIZONTAL=0;static VERTICAL=1;constructor(){super("Slat Type",Co.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.SlatType=Co;class _o extends sn{static UUID="000000E8-0000-1000-8000-0026BB765291";static NOT_DISCOVERABLE=0;static ALWAYS_DISCOVERABLE=1;constructor(){super("Sleep Discovery Mode",_o.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.SleepDiscoveryMode=_o;class Do extends sn{static UUID="0000023A-0000-1000-8000-0026BB765291";constructor(){super("Sleep Interval",Do.UUID,{format:Jr.UINT32,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,minStep:1}),this.value=this.getDefaultValue()}}sn.SleepInterval=Do;class Ro extends sn{static UUID="00000076-0000-1000-8000-0026BB765291";static SMOKE_NOT_DETECTED=0;static SMOKE_DETECTED=1;constructor(){super("Smoke Detected",Ro.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.SmokeDetected=Ro;class No extends sn{static UUID="00000054-0000-1000-8000-0026BB765291";constructor(){super("Software Revision",No.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SoftwareRevision=No;class Oo extends sn{static UUID="00000249-0000-1000-8000-0026BB765291";constructor(){super("Staged Firmware Version",Oo.UUID,{format:Jr.STRING,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.StagedFirmwareVersion=Oo;class Uo extends sn{static UUID="00000075-0000-1000-8000-0026BB765291";constructor(){super("Status Active",Uo.UUID,{format:Jr.BOOL,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.StatusActive=Uo;class Po extends sn{static UUID="00000077-0000-1000-8000-0026BB765291";static NO_FAULT=0;static GENERAL_FAULT=1;constructor(){super("Status Fault",Po.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.StatusFault=Po;class Bo extends sn{static UUID="00000078-0000-1000-8000-0026BB765291";static NOT_JAMMED=0;static JAMMED=1;constructor(){super("Status Jammed",Bo.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.StatusJammed=Bo;class xo extends sn{static UUID="00000079-0000-1000-8000-0026BB765291";static BATTERY_LEVEL_NORMAL=0;static BATTERY_LEVEL_LOW=1;constructor(){super("Status Low Battery",xo.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.StatusLowBattery=xo;class Mo extends sn{static UUID="0000007A-0000-1000-8000-0026BB765291";static NOT_TAMPERED=0;static TAMPERED=1;constructor(){super("Status Tampered",Mo.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.StatusTampered=Mo;class Lo extends sn{static UUID="00000120-0000-1000-8000-0026BB765291";constructor(){super("Streaming Status",Lo.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.StreamingStatus=Lo;class ko extends sn{static UUID="000000C5-0000-1000-8000-0026BB765291";constructor(){super("Sulphur Dioxide Density",ko.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e3,minStep:1}),this.value=this.getDefaultValue()}}sn.SulphurDioxideDensity=ko;class Fo extends sn{static UUID="00000268-0000-1000-8000-0026BB765291";constructor(){super("Supported Asset Types",Fo.UUID,{format:Jr.UINT32,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedAssetTypes=Fo;class Vo extends sn{static UUID="00000207-0000-1000-8000-0026BB765291";constructor(){super("Supported Audio Recording Configuration",Vo.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedAudioRecordingConfiguration=Vo;class Ho extends sn{static UUID="00000115-0000-1000-8000-0026BB765291";constructor(){super("Supported Audio Stream Configuration",Ho.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedAudioStreamConfiguration=Ho;class jo extends sn{static UUID="00000205-0000-1000-8000-0026BB765291";constructor(){super("Supported Camera Recording Configuration",jo.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedCameraRecordingConfiguration=jo;class Ko extends sn{static UUID="00000144-0000-1000-8000-0026BB765291";constructor(){super("Supported Characteristic Value Transition Configuration",Ko.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedCharacteristicValueTransitionConfiguration=Ko;class qo extends sn{static UUID="00000130-0000-1000-8000-0026BB765291";constructor(){super("Supported Data Stream Transport Configuration",qo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedDataStreamTransportConfiguration=qo;class Go extends sn{static UUID="0000024C-0000-1000-8000-0026BB765291";constructor(){super("Supported Diagnostics Modes",Go.UUID,{format:Jr.UINT32,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedDiagnosticsModes=Go;class zo extends sn{static UUID="00000238-0000-1000-8000-0026BB765291";constructor(){super("Supported Diagnostics Snapshot",zo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedDiagnosticsSnapshot=zo;class $o extends sn{static UUID="00000233-0000-1000-8000-0026BB765291";constructor(){super("Supported Firmware Update Configuration",$o.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedFirmwareUpdateConfiguration=$o;class Wo extends sn{static UUID="00000210-0000-1000-8000-0026BB765291";constructor(){super("Supported Router Configuration",Wo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedRouterConfiguration=Wo;class Yo extends sn{static UUID="00000116-0000-1000-8000-0026BB765291";constructor(){super("Supported RTP Configuration",Yo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedRTPConfiguration=Yo;class Qo extends sn{static UUID="00000202-0000-1000-8000-0026BB765291";constructor(){super("Supported Transfer Transport Configuration",Qo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedTransferTransportConfiguration=Qo;class Jo extends sn{static UUID="00000206-0000-1000-8000-0026BB765291";constructor(){super("Supported Video Recording Configuration",Jo.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedVideoRecordingConfiguration=Jo;class Xo extends sn{static UUID="00000114-0000-1000-8000-0026BB765291";constructor(){super("Supported Video Stream Configuration",Xo.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.SupportedVideoStreamConfiguration=Xo;class Zo extends sn{static UUID="000000B6-0000-1000-8000-0026BB765291";static SWING_DISABLED=0;static SWING_ENABLED=1;constructor(){super("Swing Mode",Zo.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.SwingMode=Zo;class ea extends sn{static UUID="000000A8-0000-1000-8000-0026BB765291";static MANUAL=0;static AUTO=1;constructor(){super("Target Air Purifier State",ea.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.TargetAirPurifierState=ea;class ta extends sn{static UUID="000000AE-0000-1000-8000-0026BB765291";static EXCELLENT=0;static GOOD=1;static FAIR=2;constructor(){super("Target Air Quality",ta.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:2,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.TargetAirQuality=ta;class ra extends sn{static UUID="00000124-0000-1000-8000-0026BB765291";constructor(){super("Target Control List",ra.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.WRITE_RESPONSE],adminOnlyAccess:[en.READ,en.WRITE]}),this.value=this.getDefaultValue()}}sn.TargetControlList=ra;class na extends sn{static UUID="00000123-0000-1000-8000-0026BB765291";constructor(){super("Target Control Supported Configuration",na.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.TargetControlSupportedConfiguration=na;class ia extends sn{static UUID="00000032-0000-1000-8000-0026BB765291";static OPEN=0;static CLOSED=1;constructor(){super("Target Door State",ia.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.TargetDoorState=ia;class sa extends sn{static UUID="000000BF-0000-1000-8000-0026BB765291";static MANUAL=0;static AUTO=1;constructor(){super("Target Fan State",sa.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.TargetFanState=sa;class oa extends sn{static UUID="000000B2-0000-1000-8000-0026BB765291";static AUTO=0;static HEAT=1;static COOL=2;constructor(){super("Target Heater-Cooler State",oa.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.TargetHeaterCoolerState=oa;class aa extends sn{static UUID="00000033-0000-1000-8000-0026BB765291";static OFF=0;static HEAT=1;static COOL=2;static AUTO=3;constructor(){super("Target Heating Cooling State",aa.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]}),this.value=this.getDefaultValue()}}sn.TargetHeatingCoolingState=aa;class ca extends sn{static UUID="0000007B-0000-1000-8000-0026BB765291";constructor(){super("Target Horizontal Tilt Angle",ca.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.ARC_DEGREE,minValue:-90,maxValue:90,minStep:1}),this.value=this.getDefaultValue()}}sn.TargetHorizontalTiltAngle=ca;class ua extends sn{static UUID="000000B4-0000-1000-8000-0026BB765291";static AUTO=0;static HUMIDIFIER_OR_DEHUMIDIFIER=0;static HUMIDIFIER=1;static DEHUMIDIFIER=2;constructor(){super("Target Humidifier-Dehumidifier State",ua.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.TargetHumidifierDehumidifierState=ua;class ha extends sn{static UUID="00000137-0000-1000-8000-0026BB765291";static PLAY=0;static PAUSE=1;static STOP=2;constructor(){super("Target Media State",ha.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:2,minStep:1,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.TargetMediaState=ha;class da extends sn{static UUID="0000007C-0000-1000-8000-0026BB765291";constructor(){super("Target Position",da.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.TargetPosition=da;class la extends sn{static UUID="00000034-0000-1000-8000-0026BB765291";constructor(){super("Target Relative Humidity",la.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.TargetRelativeHumidity=la;class fa extends sn{static UUID="000000BE-0000-1000-8000-0026BB765291";static MANUAL=0;static AUTO=1;constructor(){super("Target Slat State",fa.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.TargetSlatState=fa;class pa extends sn{static UUID="00000035-0000-1000-8000-0026BB765291";constructor(){super("Target Temperature",pa.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.CELSIUS,minValue:10,maxValue:38,minStep:.1}),this.value=this.getDefaultValue()}}sn.TargetTemperature=pa;class ya extends sn{static UUID="000000C2-0000-1000-8000-0026BB765291";constructor(){super("Target Tilt Angle",ya.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.ARC_DEGREE,minValue:-90,maxValue:90,minStep:1}),this.value=this.getDefaultValue()}}sn.TargetTiltAngle=ya;class ma extends sn{static UUID="0000007D-0000-1000-8000-0026BB765291";constructor(){super("Target Vertical Tilt Angle",ma.UUID,{format:Jr.INT,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.ARC_DEGREE,minValue:-90,maxValue:90,minStep:1}),this.value=this.getDefaultValue()}}sn.TargetVerticalTiltAngle=ma;class ga extends sn{static UUID="00000134-0000-1000-8000-0026BB765291";static SHOWN=0;static HIDDEN=1;constructor(){super("Target Visibility State",ga.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.TargetVisibilityState=ga;class va extends sn{static UUID="00000036-0000-1000-8000-0026BB765291";static CELSIUS=0;static FAHRENHEIT=1;constructor(){super("Temperature Display Units",va.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.TemperatureDisplayUnits=va;class ba extends sn{static UUID="0000021C-0000-1000-8000-0026BB765291";constructor(){super("Third Party Camera Active",ba.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.ThirdPartyCameraActive=ba;class Ea extends sn{static UUID="00000704-0000-1000-8000-0026BB765291";constructor(){super("Thread Control Point",Ea.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.ThreadControlPoint=Ea;class Sa extends sn{static UUID="00000702-0000-1000-8000-0026BB765291";constructor(){super("Thread Node Capabilities",Sa.UUID,{format:Jr.UINT16,perms:[Zr.PAIRED_READ],minValue:0,maxValue:31,minStep:1}),this.value=this.getDefaultValue()}}sn.ThreadNodeCapabilities=Sa;class Aa extends sn{static UUID="00000706-0000-1000-8000-0026BB765291";constructor(){super("Thread OpenThread Version",Aa.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.ThreadOpenThreadVersion=Aa;class Ia extends sn{static UUID="00000703-0000-1000-8000-0026BB765291";constructor(){super("Thread Status",Ia.UUID,{format:Jr.UINT16,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:6,minStep:1}),this.value=this.getDefaultValue()}}sn.ThreadStatus=Ia;class wa extends sn{static UUID="0000009A-0000-1000-8000-0026BB765291";constructor(){super("Time Update",wa.UUID,{format:Jr.BOOL,perms:[Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.TimeUpdate=wa;class Ta extends sn{static UUID="00000242-0000-1000-8000-0026BB765291";constructor(){super("Transmit Power",Ta.UUID,{format:Jr.INT,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.TransmitPower=Ta;class Ca extends sn{static UUID="000000D5-0000-1000-8000-0026BB765291";static GENERIC_VALVE=0;static IRRIGATION=1;static SHOWER_HEAD=2;static WATER_FAUCET=3;constructor(){super("Valve Type",Ca.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]}),this.value=this.getDefaultValue()}}sn.ValveType=Ca;class _a extends sn{static UUID="00000037-0000-1000-8000-0026BB765291";constructor(){super("Version",_a.UUID,{format:Jr.STRING,perms:[Zr.PAIRED_READ],maxLen:64}),this.value=this.getDefaultValue()}}sn.Version=_a;class Da extends sn{static UUID="00000229-0000-1000-8000-0026BB765291";constructor(){super("Video Analysis Active",Da.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE]}),this.value=this.getDefaultValue()}}sn.VideoAnalysisActive=Da;class Ra extends sn{static UUID="000000C8-0000-1000-8000-0026BB765291";constructor(){super("VOC Density",Ra.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:1e3,minStep:1}),this.value=this.getDefaultValue()}}sn.VOCDensity=Ra;class Na extends sn{static UUID="00000119-0000-1000-8000-0026BB765291";constructor(){super("Volume",Na.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.Volume=Na;class Oa extends sn{static UUID="000000E9-0000-1000-8000-0026BB765291";static NONE=0;static RELATIVE=1;static RELATIVE_WITH_CURRENT=2;static ABSOLUTE=3;constructor(){super("Volume Control Type",Oa.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:3,minStep:1,validValues:[0,1,2,3]}),this.value=this.getDefaultValue()}}sn.VolumeControlType=Oa;class Ua extends sn{static UUID="000000EA-0000-1000-8000-0026BB765291";static INCREMENT=0;static DECREMENT=1;constructor(){super("Volume Selector",Ua.UUID,{format:Jr.UINT8,perms:[Zr.PAIRED_WRITE],minValue:0,maxValue:1,minStep:1,validValues:[0,1]}),this.value=this.getDefaultValue()}}sn.VolumeSelector=Ua;class Pa extends sn{static UUID="00000222-0000-1000-8000-0026BB765291";constructor(){super("Wake Configuration",Pa.UUID,{format:Jr.TLV8,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.WakeConfiguration=Pa;class Ba extends sn{static UUID="00000211-0000-1000-8000-0026BB765291";constructor(){super("WAN Configuration List",Ba.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.WANConfigurationList=Ba;class xa extends sn{static UUID="00000212-0000-1000-8000-0026BB765291";constructor(){super("WAN Status List",xa.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.WANStatusList=xa;class Ma extends sn{static UUID="000000B5-0000-1000-8000-0026BB765291";constructor(){super("Water Level",Ma.UUID,{format:Jr.FLOAT,perms:[Zr.NOTIFY,Zr.PAIRED_READ],unit:Xr.PERCENTAGE,minValue:0,maxValue:100,minStep:1}),this.value=this.getDefaultValue()}}sn.WaterLevel=Ma;class La extends sn{static UUID="0000022C-0000-1000-8000-0026BB765291";constructor(){super("Wi-Fi Capabilities",La.UUID,{format:Jr.UINT32,perms:[Zr.PAIRED_READ]}),this.value=this.getDefaultValue()}}sn.WiFiCapabilities=La;class ka extends sn{static UUID="0000022D-0000-1000-8000-0026BB765291";constructor(){super("Wi-Fi Configuration Control",ka.UUID,{format:Jr.TLV8,perms:[Zr.NOTIFY,Zr.PAIRED_READ,Zr.PAIRED_WRITE,Zr.TIMED_WRITE,Zr.WRITE_RESPONSE]}),this.value=this.getDefaultValue()}}sn.WiFiConfigurationControl=ka;class Fa extends sn{static UUID="0000021E-0000-1000-8000-0026BB765291";static UNKNOWN=0;static CONNECTED=1;static NOT_CONNECTED=2;constructor(){super("Wi-Fi Satellite Status",Fa.UUID,{format:Jr.UINT8,perms:[Zr.NOTIFY,Zr.PAIRED_READ],minValue:0,maxValue:2,validValues:[0,1,2]}),this.value=this.getDefaultValue()}}sn.WiFiSatelliteStatus=Fa;class Va extends xe{static UUID="00000260-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Va.UUID,t),this.addCharacteristic(sn.AccessCodeControlPoint),this.addCharacteristic(sn.AccessCodeSupportedConfiguration),this.addCharacteristic(sn.ConfigurationState)}}xe.AccessCode=Va;class Ha extends xe{static UUID="000000DA-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Ha.UUID,t),this.addCharacteristic(sn.AccessControlLevel),this.addOptionalCharacteristic(sn.PasswordSetting)}}xe.AccessControl=Ha;class ja extends xe{static UUID="0000003E-0000-1000-8000-0026BB765291";constructor(e,t){super(e,ja.UUID,t),this.addCharacteristic(sn.Identify),this.addCharacteristic(sn.Manufacturer),this.addCharacteristic(sn.Model),this.testCharacteristic(sn.Name)||this.addCharacteristic(sn.Name).updateValue("Unnamed Service"),this.addCharacteristic(sn.SerialNumber),this.addCharacteristic(sn.FirmwareRevision),this.addOptionalCharacteristic(sn.AccessoryFlags),this.addOptionalCharacteristic(sn.AppMatchingIdentifier),this.addOptionalCharacteristic(sn.ConfiguredName),this.addOptionalCharacteristic(sn.HardwareFinish),this.addOptionalCharacteristic(sn.HardwareRevision),this.addOptionalCharacteristic(sn.ProductData),this.addOptionalCharacteristic(sn.SoftwareRevision)}}xe.AccessoryInformation=ja;class Ka extends xe{static UUID="00000270-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Ka.UUID,t),this.addCharacteristic(sn.Active)}}xe.AccessoryMetrics=Ka;class qa extends xe{static UUID="00000239-0000-1000-8000-0026BB765291";constructor(e,t){super(e,qa.UUID,t),this.addCharacteristic(sn.Ping),this.addOptionalCharacteristic(sn.ActivityInterval),this.addOptionalCharacteristic(sn.HeartBeat),this.addOptionalCharacteristic(sn.SleepInterval)}}xe.AccessoryRuntimeInformation=qa;class Ga extends xe{static UUID="000000BB-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Ga.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.CurrentAirPurifierState),this.addCharacteristic(sn.TargetAirPurifierState),this.addOptionalCharacteristic(sn.LockPhysicalControls),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.RotationSpeed),this.addOptionalCharacteristic(sn.SwingMode)}}xe.AirPurifier=Ga;class za extends xe{static UUID="0000008D-0000-1000-8000-0026BB765291";constructor(e,t){super(e,za.UUID,t),this.addCharacteristic(sn.AirQuality),this.addOptionalCharacteristic(sn.NitrogenDioxideDensity),this.addOptionalCharacteristic(sn.OzoneDensity),this.addOptionalCharacteristic(sn.PM10Density),this.addOptionalCharacteristic(sn.PM2_5Density),this.addOptionalCharacteristic(sn.SulphurDioxideDensity),this.addOptionalCharacteristic(sn.VOCDensity),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.AirQualitySensor=za;class $a extends xe{static UUID="00000267-0000-1000-8000-0026BB765291";constructor(e,t){super(e,$a.UUID,t),this.addCharacteristic(sn.AssetUpdateReadiness),this.addCharacteristic(sn.SupportedAssetTypes)}}xe.AssetUpdate=$a;class Wa extends xe{static UUID="0000026A-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Wa.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.Identifier),this.testCharacteristic(sn.Name)||this.addCharacteristic(sn.Name).updateValue("Unnamed Service")}}xe.Assistant=Wa;class Ya extends xe{static UUID="00000127-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Ya.UUID,t),this.addCharacteristic(sn.SupportedAudioStreamConfiguration),this.addCharacteristic(sn.SelectedAudioStreamConfiguration)}}xe.AudioStreamManagement=Ya;class Qa extends xe{static UUID="00000096-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Qa.UUID,t),this.addCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.BatteryLevel),this.addOptionalCharacteristic(sn.ChargingState),this.addOptionalCharacteristic(sn.Name)}}xe.BatteryService=Qa,xe.Battery=Qa;class Ja extends xe{static UUID="0000021A-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Ja.UUID,t),this.addCharacteristic(sn.EventSnapshotsActive),this.addCharacteristic(sn.HomeKitCameraActive),this.addOptionalCharacteristic(sn.CameraOperatingModeIndicator),this.addOptionalCharacteristic(sn.ManuallyDisabled),this.addOptionalCharacteristic(sn.NightVision),this.addOptionalCharacteristic(sn.PeriodicSnapshotsActive),this.addOptionalCharacteristic(sn.ThirdPartyCameraActive),this.addOptionalCharacteristic(sn.DiagonalFieldOfView)}}xe.CameraOperatingMode=Ja;class Xa extends xe{static UUID="00000204-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Xa.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.SupportedCameraRecordingConfiguration),this.addCharacteristic(sn.SupportedVideoRecordingConfiguration),this.addCharacteristic(sn.SupportedAudioRecordingConfiguration),this.addCharacteristic(sn.SelectedCameraRecordingConfiguration),this.addOptionalCharacteristic(sn.RecordingAudioActive)}}xe.CameraEventRecordingManagement=Xa,xe.CameraRecordingManagement=Xa;class Za extends xe{static UUID="00000110-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Za.UUID,t),this.addCharacteristic(sn.SelectedRTPStreamConfiguration),this.addCharacteristic(sn.SetupEndpoints),this.addCharacteristic(sn.StreamingStatus),this.addCharacteristic(sn.SupportedAudioStreamConfiguration),this.addCharacteristic(sn.SupportedRTPConfiguration),this.addCharacteristic(sn.SupportedVideoStreamConfiguration),this.addOptionalCharacteristic(sn.Active)}}xe.CameraRTPStreamManagement=Za;class ec extends xe{static UUID="00000097-0000-1000-8000-0026BB765291";constructor(e,t){super(e,ec.UUID,t),this.addCharacteristic(sn.CarbonDioxideDetected),this.addOptionalCharacteristic(sn.CarbonDioxideLevel),this.addOptionalCharacteristic(sn.CarbonDioxidePeakLevel),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.CarbonDioxideSensor=ec;class tc extends xe{static UUID="0000007F-0000-1000-8000-0026BB765291";constructor(e,t){super(e,tc.UUID,t),this.addCharacteristic(sn.CarbonMonoxideDetected),this.addOptionalCharacteristic(sn.CarbonMonoxideLevel),this.addOptionalCharacteristic(sn.CarbonMonoxidePeakLevel),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.CarbonMonoxideSensor=tc;class rc extends xe{static UUID="0000005A-0000-1000-8000-0026BB765291";constructor(e,t){super(e,rc.UUID,t),this.addCharacteristic(sn.RelayControlPoint),this.addCharacteristic(sn.RelayState),this.addCharacteristic(sn.RelayEnabled)}}xe.Relay=rc,xe.CloudRelay=rc;class nc extends xe{static UUID="00000080-0000-1000-8000-0026BB765291";constructor(e,t){super(e,nc.UUID,t),this.addCharacteristic(sn.ContactSensorState),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.ContactSensor=nc;class ic extends xe{static UUID="00000129-0000-1000-8000-0026BB765291";constructor(e,t){super(e,ic.UUID,t),this.addCharacteristic(sn.SetupDataStreamTransport),this.addCharacteristic(sn.SupportedDataStreamTransportConfiguration),this.addCharacteristic(sn.Version)}}xe.DataStreamTransportManagement=ic;class sc extends xe{static UUID="00000237-0000-1000-8000-0026BB765291";constructor(e,t){super(e,sc.UUID,t),this.addCharacteristic(sn.SupportedDiagnosticsSnapshot),this.addOptionalCharacteristic(sn.SelectedDiagnosticsModes),this.addOptionalCharacteristic(sn.SupportedDiagnosticsModes)}}xe.Diagnostics=sc;class oc extends xe{static UUID="00000081-0000-1000-8000-0026BB765291";constructor(e,t){super(e,oc.UUID,t),this.addCharacteristic(sn.CurrentPosition),this.addCharacteristic(sn.PositionState),this.addCharacteristic(sn.TargetPosition),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.ObstructionDetected),this.addOptionalCharacteristic(sn.HoldPosition)}}xe.Door=oc;class ac extends xe{static UUID="00000121-0000-1000-8000-0026BB765291";constructor(e,t){super(e,ac.UUID,t),this.addCharacteristic(sn.ProgrammableSwitchEvent),this.addOptionalCharacteristic(sn.Brightness),this.addOptionalCharacteristic(sn.Mute),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.OperatingStateResponse),this.addOptionalCharacteristic(sn.Volume)}}xe.Doorbell=ac;class cc extends xe{static UUID="00000040-0000-1000-8000-0026BB765291";constructor(e,t){super(e,cc.UUID,t),this.addCharacteristic(sn.On),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.RotationDirection),this.addOptionalCharacteristic(sn.RotationSpeed)}}xe.Fan=cc;class uc extends xe{static UUID="000000B7-0000-1000-8000-0026BB765291";constructor(e,t){super(e,uc.UUID,t),this.addCharacteristic(sn.Active),this.addOptionalCharacteristic(sn.CurrentFanState),this.addOptionalCharacteristic(sn.TargetFanState),this.addOptionalCharacteristic(sn.LockPhysicalControls),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.RotationDirection),this.addOptionalCharacteristic(sn.RotationSpeed),this.addOptionalCharacteristic(sn.SwingMode)}}xe.Fanv2=uc;class hc extends xe{static UUID="000000D7-0000-1000-8000-0026BB765291";constructor(e,t){super(e,hc.UUID,t),this.addCharacteristic(sn.Active),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusFault)}}xe.Faucet=hc;class dc extends xe{static UUID="000000BA-0000-1000-8000-0026BB765291";constructor(e,t){super(e,dc.UUID,t),this.addCharacteristic(sn.FilterChangeIndication),this.addOptionalCharacteristic(sn.FilterLifeLevel),this.addOptionalCharacteristic(sn.ResetFilterIndication),this.addOptionalCharacteristic(sn.Name)}}xe.FilterMaintenance=dc;class lc extends xe{static UUID="00000041-0000-1000-8000-0026BB765291";constructor(e,t){super(e,lc.UUID,t),this.addCharacteristic(sn.CurrentDoorState),this.addCharacteristic(sn.TargetDoorState),this.addCharacteristic(sn.ObstructionDetected),this.addOptionalCharacteristic(sn.LockCurrentState),this.addOptionalCharacteristic(sn.LockTargetState),this.addOptionalCharacteristic(sn.Name)}}xe.GarageDoorOpener=lc;class fc extends xe{static UUID="000000BC-0000-1000-8000-0026BB765291";constructor(e,t){super(e,fc.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.CurrentHeaterCoolerState),this.addCharacteristic(sn.TargetHeaterCoolerState),this.addCharacteristic(sn.CurrentTemperature),this.addOptionalCharacteristic(sn.LockPhysicalControls),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.RotationSpeed),this.addOptionalCharacteristic(sn.SwingMode),this.addOptionalCharacteristic(sn.CoolingThresholdTemperature),this.addOptionalCharacteristic(sn.HeatingThresholdTemperature),this.addOptionalCharacteristic(sn.TemperatureDisplayUnits)}}xe.HeaterCooler=fc;class pc extends xe{static UUID="000000BD-0000-1000-8000-0026BB765291";constructor(e,t){super(e,pc.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.CurrentHumidifierDehumidifierState),this.addCharacteristic(sn.TargetHumidifierDehumidifierState),this.addCharacteristic(sn.CurrentRelativeHumidity),this.addOptionalCharacteristic(sn.LockPhysicalControls),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.RelativeHumidityDehumidifierThreshold),this.addOptionalCharacteristic(sn.RelativeHumidityHumidifierThreshold),this.addOptionalCharacteristic(sn.RotationSpeed),this.addOptionalCharacteristic(sn.SwingMode),this.addOptionalCharacteristic(sn.WaterLevel)}}xe.HumidifierDehumidifier=pc;class yc extends xe{static UUID="00000082-0000-1000-8000-0026BB765291";constructor(e,t){super(e,yc.UUID,t),this.addCharacteristic(sn.CurrentRelativeHumidity),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.HumiditySensor=yc;class mc extends xe{static UUID="000000D9-0000-1000-8000-0026BB765291";constructor(e,t){super(e,mc.UUID,t),this.addCharacteristic(sn.ConfiguredName),this.addCharacteristic(sn.InputSourceType),this.addCharacteristic(sn.IsConfigured),this.testCharacteristic(sn.Name)||this.addCharacteristic(sn.Name).updateValue("Unnamed Service"),this.addCharacteristic(sn.CurrentVisibilityState),this.addOptionalCharacteristic(sn.Identifier),this.addOptionalCharacteristic(sn.InputDeviceType),this.addOptionalCharacteristic(sn.TargetVisibilityState)}}xe.InputSource=mc;class gc extends xe{static UUID="000000CF-0000-1000-8000-0026BB765291";constructor(e,t){super(e,gc.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.ProgramMode),this.addCharacteristic(sn.InUse),this.addOptionalCharacteristic(sn.RemainingDuration),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusFault)}}xe.IrrigationSystem=gc;class vc extends xe{static UUID="00000083-0000-1000-8000-0026BB765291";constructor(e,t){super(e,vc.UUID,t),this.addCharacteristic(sn.LeakDetected),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.LeakSensor=vc;class bc extends xe{static UUID="00000043-0000-1000-8000-0026BB765291";constructor(e,t){super(e,bc.UUID,t),this.addCharacteristic(sn.On),this.addOptionalCharacteristic(sn.Brightness),this.addOptionalCharacteristic(sn.CharacteristicValueActiveTransitionCount),this.addOptionalCharacteristic(sn.CharacteristicValueTransitionControl),this.addOptionalCharacteristic(sn.ColorTemperature),this.addOptionalCharacteristic(sn.Hue),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.Saturation),this.addOptionalCharacteristic(sn.SupportedCharacteristicValueTransitionConfiguration)}}xe.Lightbulb=bc;class Ec extends xe{static UUID="00000084-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Ec.UUID,t),this.addCharacteristic(sn.CurrentAmbientLightLevel),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.LightSensor=Ec;class Sc extends xe{static UUID="00000044-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Sc.UUID,t),this.addCharacteristic(sn.LockControlPoint),this.addCharacteristic(sn.Version),this.addOptionalCharacteristic(sn.AdministratorOnlyAccess),this.addOptionalCharacteristic(sn.AudioFeedback),this.addOptionalCharacteristic(sn.CurrentDoorState),this.addOptionalCharacteristic(sn.LockManagementAutoSecurityTimeout),this.addOptionalCharacteristic(sn.LockLastKnownAction),this.addOptionalCharacteristic(sn.Logs),this.addOptionalCharacteristic(sn.MotionDetected)}}xe.LockManagement=Sc;class Ac extends xe{static UUID="00000045-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Ac.UUID,t),this.addCharacteristic(sn.LockCurrentState),this.addCharacteristic(sn.LockTargetState),this.addOptionalCharacteristic(sn.Name)}}xe.LockMechanism=Ac;class Ic extends xe{static UUID="00000112-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Ic.UUID,t),this.addCharacteristic(sn.Mute),this.addOptionalCharacteristic(sn.Volume)}}xe.Microphone=Ic;class wc extends xe{static UUID="00000085-0000-1000-8000-0026BB765291";constructor(e,t){super(e,wc.UUID,t),this.addCharacteristic(sn.MotionDetected),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.MotionSensor=wc;class Tc extends xe{static UUID="00000266-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Tc.UUID,t),this.addCharacteristic(sn.ConfigurationState),this.addCharacteristic(sn.NFCAccessControlPoint),this.addCharacteristic(sn.NFCAccessSupportedConfiguration)}}xe.NFCAccess=Tc;class Cc extends xe{static UUID="00000086-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Cc.UUID,t),this.addCharacteristic(sn.OccupancyDetected),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.OccupancySensor=Cc;class _c extends xe{static UUID="00000047-0000-1000-8000-0026BB765291";constructor(e,t){super(e,_c.UUID,t),this.addCharacteristic(sn.On),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.OutletInUse)}}xe.Outlet=_c;class Dc extends xe{static UUID="00000055-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Dc.UUID,t),this.addCharacteristic(sn.ListPairings),this.addCharacteristic(sn.PairSetup),this.addCharacteristic(sn.PairVerify),this.addCharacteristic(sn.PairingFeatures)}}xe.Pairing=Dc;class Rc extends xe{static UUID="00000221-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Rc.UUID,t),this.addCharacteristic(sn.WakeConfiguration)}}xe.PowerManagement=Rc;class Nc extends xe{static UUID="000000A2-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Nc.UUID,t),this.addCharacteristic(sn.Version)}}xe.ProtocolInformation=Nc;class Oc extends xe{static UUID="0000007E-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Oc.UUID,t),this.addCharacteristic(sn.SecuritySystemCurrentState),this.addCharacteristic(sn.SecuritySystemTargetState),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.SecuritySystemAlarmType),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.SecuritySystem=Oc;class Uc extends xe{static UUID="000000CC-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Uc.UUID,t),this.addCharacteristic(sn.ServiceLabelNamespace)}}xe.ServiceLabel=Uc;class Pc extends xe{static UUID="00000133-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Pc.UUID,t),this.addCharacteristic(sn.SiriInputType),this.addOptionalCharacteristic(sn.MultifunctionButton),this.addOptionalCharacteristic(sn.SiriEnable),this.addOptionalCharacteristic(sn.SiriEngineVersion),this.addOptionalCharacteristic(sn.SiriLightOnUse),this.addOptionalCharacteristic(sn.SiriListening),this.addOptionalCharacteristic(sn.SiriTouchToUse)}}xe.Siri=Pc;class Bc extends xe{static UUID="00000253-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Bc.UUID,t),this.addCharacteristic(sn.SiriEndpointSessionStatus),this.addCharacteristic(sn.Version),this.addOptionalCharacteristic(sn.ActiveIdentifier),this.addOptionalCharacteristic(sn.ManuallyDisabled)}}xe.SiriEndpoint=Bc;class xc extends xe{static UUID="000000B9-0000-1000-8000-0026BB765291";constructor(e,t){super(e,xc.UUID,t),this.addCharacteristic(sn.CurrentSlatState),this.addCharacteristic(sn.SlatType),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.SwingMode),this.addOptionalCharacteristic(sn.CurrentTiltAngle),this.addOptionalCharacteristic(sn.TargetTiltAngle)}}xe.Slat=xc,xe.Slats=xc;class Mc extends xe{static UUID="00000228-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Mc.UUID,t),this.addCharacteristic(sn.CurrentMediaState),this.addCharacteristic(sn.TargetMediaState),this.addOptionalCharacteristic(sn.AirPlayEnable),this.addOptionalCharacteristic(sn.ConfiguredName),this.addOptionalCharacteristic(sn.Mute),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.Volume)}}xe.SmartSpeaker=Mc;class Lc extends xe{static UUID="00000087-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Lc.UUID,t),this.addCharacteristic(sn.SmokeDetected),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.SmokeSensor=Lc;class kc extends xe{static UUID="00000113-0000-1000-8000-0026BB765291";constructor(e,t){super(e,kc.UUID,t),this.addCharacteristic(sn.Mute),this.addOptionalCharacteristic(sn.Active),this.addOptionalCharacteristic(sn.Volume)}}xe.Speaker=kc;class Fc extends xe{static UUID="00000088-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Fc.UUID,t),this.addCharacteristic(sn.ProgrammableSwitchEvent),this.addCharacteristic(sn.ProgrammableSwitchOutputState),this.addOptionalCharacteristic(sn.Name)}}xe.StatefulProgrammableSwitch=Fc;class Vc extends xe{static UUID="00000089-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Vc.UUID,t),this.addCharacteristic(sn.ProgrammableSwitchEvent),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.ServiceLabelIndex)}}xe.StatelessProgrammableSwitch=Vc;class Hc extends xe{static UUID="00000049-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Hc.UUID,t),this.addCharacteristic(sn.On),this.addOptionalCharacteristic(sn.Name)}}xe.Switch=Hc;class jc extends xe{static UUID="00000125-0000-1000-8000-0026BB765291";constructor(e,t){super(e,jc.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.ActiveIdentifier),this.addCharacteristic(sn.ButtonEvent),this.addOptionalCharacteristic(sn.Name)}}xe.TargetControl=jc;class Kc extends xe{static UUID="00000122-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Kc.UUID,t),this.addCharacteristic(sn.TargetControlSupportedConfiguration),this.addCharacteristic(sn.TargetControlList)}}xe.TargetControlManagement=Kc;class qc extends xe{static UUID="000000D8-0000-1000-8000-0026BB765291";constructor(e,t){super(e,qc.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.ActiveIdentifier),this.addCharacteristic(sn.ConfiguredName),this.addCharacteristic(sn.RemoteKey),this.addCharacteristic(sn.SleepDiscoveryMode),this.addOptionalCharacteristic(sn.Brightness),this.addOptionalCharacteristic(sn.ClosedCaptions),this.addOptionalCharacteristic(sn.DisplayOrder),this.addOptionalCharacteristic(sn.CurrentMediaState),this.addOptionalCharacteristic(sn.TargetMediaState),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.PictureMode),this.addOptionalCharacteristic(sn.PowerModeSelection)}}xe.Television=qc;class Gc extends xe{static UUID="00000113-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Gc.UUID,t),this.addCharacteristic(sn.Mute),this.addOptionalCharacteristic(sn.Active),this.addOptionalCharacteristic(sn.Volume),this.addOptionalCharacteristic(sn.VolumeControlType),this.addOptionalCharacteristic(sn.VolumeSelector)}}xe.TelevisionSpeaker=Gc;class zc extends xe{static UUID="0000008A-0000-1000-8000-0026BB765291";constructor(e,t){super(e,zc.UUID,t),this.addCharacteristic(sn.CurrentTemperature),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.StatusActive),this.addOptionalCharacteristic(sn.StatusFault),this.addOptionalCharacteristic(sn.StatusLowBattery),this.addOptionalCharacteristic(sn.StatusTampered)}}xe.TemperatureSensor=zc;class $c extends xe{static UUID="0000004A-0000-1000-8000-0026BB765291";constructor(e,t){super(e,$c.UUID,t),this.addCharacteristic(sn.CurrentHeatingCoolingState),this.addCharacteristic(sn.TargetHeatingCoolingState),this.addCharacteristic(sn.CurrentTemperature),this.addCharacteristic(sn.TargetTemperature),this.addCharacteristic(sn.TemperatureDisplayUnits),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.CurrentRelativeHumidity),this.addOptionalCharacteristic(sn.TargetRelativeHumidity),this.addOptionalCharacteristic(sn.CoolingThresholdTemperature),this.addOptionalCharacteristic(sn.HeatingThresholdTemperature)}}xe.Thermostat=$c;class Wc extends xe{static UUID="00000701-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Wc.UUID,t),this.addCharacteristic(sn.CurrentTransport),this.addCharacteristic(sn.ThreadControlPoint),this.addCharacteristic(sn.ThreadNodeCapabilities),this.addCharacteristic(sn.ThreadStatus),this.addOptionalCharacteristic(sn.CCAEnergyDetectThreshold),this.addOptionalCharacteristic(sn.CCASignalDetectThreshold),this.addOptionalCharacteristic(sn.EventRetransmissionMaximum),this.addOptionalCharacteristic(sn.EventTransmissionCounters),this.addOptionalCharacteristic(sn.MACRetransmissionMaximum),this.addOptionalCharacteristic(sn.MACTransmissionCounters),this.addOptionalCharacteristic(sn.ReceiverSensitivity),this.addOptionalCharacteristic(sn.ReceivedSignalStrengthIndication),this.addOptionalCharacteristic(sn.SignalToNoiseRatio),this.addOptionalCharacteristic(sn.ThreadOpenThreadVersion),this.addOptionalCharacteristic(sn.TransmitPower),this.addOptionalCharacteristic(sn.MaximumTransmitPower)}}xe.ThreadTransport=Wc;class Yc extends xe{static UUID="00000203-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Yc.UUID,t),this.addCharacteristic(sn.SupportedTransferTransportConfiguration),this.addCharacteristic(sn.SetupTransferTransport)}}xe.TransferTransportManagement=Yc;class Qc extends xe{static UUID="000000D0-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Qc.UUID,t),this.addCharacteristic(sn.Active),this.addCharacteristic(sn.InUse),this.addCharacteristic(sn.ValveType),this.addOptionalCharacteristic(sn.IsConfigured),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.RemainingDuration),this.addOptionalCharacteristic(sn.ServiceLabelIndex),this.addOptionalCharacteristic(sn.SetDuration),this.addOptionalCharacteristic(sn.StatusFault)}}xe.Valve=Qc;class Jc extends xe{static UUID="0000020A-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Jc.UUID,t),this.addCharacteristic(sn.ConfiguredName),this.addCharacteristic(sn.ManagedNetworkEnable),this.addCharacteristic(sn.NetworkAccessViolationControl),this.addCharacteristic(sn.NetworkClientProfileControl),this.addCharacteristic(sn.NetworkClientStatusControl),this.addCharacteristic(sn.RouterStatus),this.addCharacteristic(sn.SupportedRouterConfiguration),this.addCharacteristic(sn.WANConfigurationList),this.addCharacteristic(sn.WANStatusList)}}xe.WiFiRouter=Jc;class Xc extends xe{static UUID="0000020F-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Xc.UUID,t),this.addCharacteristic(sn.WiFiSatelliteStatus)}}xe.WiFiSatellite=Xc;class Zc extends xe{static UUID="0000022A-0000-1000-8000-0026BB765291";constructor(e,t){super(e,Zc.UUID,t),this.addCharacteristic(sn.CurrentTransport),this.addCharacteristic(sn.WiFiCapabilities),this.addOptionalCharacteristic(sn.WiFiConfigurationControl)}}xe.WiFiTransport=Zc;class eu extends xe{static UUID="0000008B-0000-1000-8000-0026BB765291";constructor(e,t){super(e,eu.UUID,t),this.addCharacteristic(sn.CurrentPosition),this.addCharacteristic(sn.PositionState),this.addCharacteristic(sn.TargetPosition),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.ObstructionDetected),this.addOptionalCharacteristic(sn.HoldPosition)}}xe.Window=eu;class tu extends xe{static UUID="0000008C-0000-1000-8000-0026BB765291";constructor(e,t){super(e,tu.UUID,t),this.addCharacteristic(sn.CurrentPosition),this.addCharacteristic(sn.PositionState),this.addCharacteristic(sn.TargetPosition),this.addOptionalCharacteristic(sn.CurrentHorizontalTiltAngle),this.addOptionalCharacteristic(sn.TargetHorizontalTiltAngle),this.addOptionalCharacteristic(sn.Name),this.addOptionalCharacteristic(sn.ObstructionDetected),this.addOptionalCharacteristic(sn.HoldPosition),this.addOptionalCharacteristic(sn.CurrentVerticalTiltAngle),this.addOptionalCharacteristic(sn.TargetVerticalTiltAngle)}}xe.WindowCovering=tu;class ru extends Wr{constructor(e,t){super(e,t),this._isBridge=!0}}const nu={};function iu(e){nu[e.type]=e}function su(e,r,n,i,s,o){return n.updateCharacteristic(i,s()),n.getCharacteristic(i).on(rn.GET,(n=>{try{e.interfaces.includes(t.ScryptedInterface.Refresh)&&e.refresh(r,!1),n(null,s())}catch(e){n(e)}})),e.listen({event:r,watch:!o},((e,t,r)=>n.updateCharacteristic(i,s(e,t,r))))}function ou(e,r){if(!e.interfaces.includes(t.ScryptedInterface.Battery))return;const n=new Qa;su(e,t.ScryptedInterface.Battery,n,sn.BatteryLevel,(()=>Math.min(Math.max(0,e.batteryLevel),100)||0)),su(e,t.ScryptedInterface.Battery,n,sn.StatusLowBattery,(()=>e.batteryLevel>=20?xo.BATTERY_LEVEL_NORMAL:xo.BATTERY_LEVEL_LOW)),r.addService(n)}const{deviceManager:au}=i();class cu extends t.MixinDeviceBase{constructor(e){super(e),this.settingsGroup=e.group,this.settingsGroupKey=e.groupKey,process.nextTick((()=>au.onMixinEvent(this.id,this,t.ScryptedInterface.Settings,null)))}async getSettings(){const e=this.mixinDeviceInterfaces.includes(t.ScryptedInterface.Settings)?this.mixinDevice.getSettings():void 0,r=this.getMixinSettings(),n=[];try{const t=await e||[];n.push(...t)}catch(e){const t=this.name,r=`${t} Extension settings failed to load.`;this.console.error(r,e),n.push({key:Math.random().toString(),title:t,value:"Settings Error",group:"Errors",description:r,readonly:!0})}try{const e=await r||[];for(const t of e)t.group=t.group||this.settingsGroup,t.key=this.settingsGroupKey+":"+t.key;n.push(...e)}catch(e){const t=au.getDeviceState(this.mixinProviderNativeId).name,r=`${t} Extension settings failed to load.`;this.console.error(r,e),n.push({key:Math.random().toString(),title:t,value:"Settings Error",group:"Errors",description:r,readonly:!0})}return n}async putSetting(e,r){const n=this.settingsGroupKey+":";if(!e?.startsWith(n))return this.mixinDevice.putSetting(e,r);await this.putMixinSetting(e.substring(n.length),r)||au.onMixinEvent(this.id,this,t.ScryptedInterface.Settings,null)}async release(){await au.onMixinEvent(this.id,this,t.ScryptedInterface.Settings,null)}}async function uu(){const e=new(m().Server),t=await async function(e){return e.listen(0),await(0,l.once)(e,"listening"),e.address().port}(e),r=new Promise(((t,r)=>{const n=setTimeout((()=>{e.close(),r(new Error("timeout waiting for client"))}),3e4);e.on("connection",(r=>{e.close(),clearTimeout(n),t(r)}))}));return r.catch((()=>{})),{server:e,url:`tcp://127.0.0.1:${t}`,host:"127.0.0.1",port:t,clientPromise:r}}async function hu(e){if(e)try{await new Promise(((t,r)=>{try{e.close(t)}catch(e){r(e)}}))}catch(e){}}async function du(e,t,r){e.bind(t,r),await(0,l.once)(e,"listening");const n=e.address().port;return{port:n,url:`udp://127.0.0.1:${n}`}}async function lu(e){return fu(0,e)}async function fu(e,t){const r=P().createSocket(t||"udp4"),{port:n,url:i}=await du(r,e);return{server:r,port:n,url:i}}function pu(){return Math.round(1e5*Math.random())%10}function yu(){return`${pu()}${pu()}${pu()}-${pu()}${pu()}-${pu()}${pu()}${pu()}`}function mu(e,t,r="unfilteredRecording"){const n=e.findIndex((e=>"-filter_complex"===e));void 0!==n&&-1!==n?e[n+1]=e[n+1]+`[${r}] ; [${r}] ${t}`:e.push("-filter_complex",t)}var gu=r(2081),vu=r.n(gu);const bu=require("process");var Eu=r.n(bu);const Su=["decode_slice_header error","no frame!","non-existing PPS"];function Au(e){if(e){try{e.stdin.write("q\n")}catch(e){}setTimeout((()=>{e.kill(),setTimeout((()=>{e.kill("SIGKILL")}),2e3)}),2e3)}}function Iu(e,t,r,n){if(!e)return;const i=!!Eu().env.SCRYPTED_FFMPEG_NOISY||!!n?.getItem("SCRYPTED_FFMPEG_NOISY");function s(e){const n=s=>{const o=s.toString();for(const e of Su)if(-1!==o.indexOf(e))return;if(!(i||r||-1===o.indexOf("frame=")&&-1===o.indexOf("size=")))return e(o),e("video/audio detected, discarding further input"),t.stdout.removeListener("data",n),void t.stderr.removeListener("data",n);e(o)};return n}t.stdout?.on("data",s(e.log)),t.stderr?.on("data",s(e.error)),t.on("exit",(()=>e.log("ffmpeg exited")))}function wu(e,t){if(!e)return;const r=[];let n=!1;for(const e of t){try{if(n){const t=new URL(e);r.push(`${t.protocol}[REDACTED]`)}else r.push(e)}catch(t){r.push(e)}n="-i"===e}e.log(r.join(" "))}class Tu extends Error{constructor(){super()}}async function Cu(e,t){if(e.readableEnded||e.destroyed)throw new Error("stream ended");if(!t)return Buffer.alloc(0);{const r=e.read(t);if(r)return r}return new Promise(((r,n)=>{const i=()=>{const i=e.read(t);if(i)return o(),void r(i);(e.readableEnded||e.destroyed)&&n(new Error("stream ended during read"))},s=()=>{o(),n(new Tu)},o=()=>{e.removeListener("readable",i),e.removeListener("end",s)};e.on("readable",i),e.on("end",s)}))}const _u="\n".charCodeAt(0);async function Du(e){return async function(e,t){const r=[];let n=0;for(;;){const i=await Cu(e,1);if(!i)throw new Error("end of stream");if(i[0]===t)break;r[n++]=i[0]}return Buffer.from(r).toString()}(e,_u)}const{mediaManager:Ru}=i();async function*Nu(e){for(;;){const t=await Cu(e,8),r=t.readInt32BE(0)-8,n=t.slice(4).toString(),i=await Cu(e,r);yield{header:t,length:r,type:n,data:i}}}const Ou=["-movflags","frag_keyframe+empty_moov+default_base_moof+skip_sidx+skip_trailer","-f","mp4"];class Uu extends Error{constructor(e){super("Operation Timed Out"),this.promise=e}}function Pu(e,t){return new Promise(((r,n)=>{const i=setTimeout((()=>n(new Uu(t))),e);t.then((e=>{clearTimeout(i),r(e)})).catch((e=>{clearTimeout(i),n(e)}))}))}var Bu=r(7147),xu=r.n(Bu),Mu=r(7446),Lu=r.n(Mu),ku=r(1017),Fu=r.n(ku);const{mediaManager:Vu}=i(),Hu="save-video-clips";async function ju(){const e=Fu().join(await Vu.getFilesPath(),"hksv");return await Lu()(e),e}async function Ku(e,t){const r=await ju(),n=(await xu().promises.readdir(r)).filter((e=>e.endsWith(".json")));let i=n;t&&(i=n.filter((e=>e.startsWith(`${t}-`))));let s=[];for(const e of i)try{const t=Fu().join(r,e),n=JSON.parse((await xu().promises.readFile(t)).toString());s.push(n)}catch(e){}if(s=s.sort(((e,t)=>e.startTime-t.startTime)),e?.startTime){if(-1===s.findIndex((t=>t.startTime>e.startTime)))return[]}if(e?.endTime&&(s=s.filter((t=>t.startTime+t.duration<e.endTime))),e?.reverseOrder&&(s=s.reverse()),e?.startId){const t=s.findIndex((t=>t.id===e.startId));if(-1===t)throw new Error("startIndex not found");s=s.slice(t)}return e?.count&&(s=s.slice(0,e.count)),s}async function qu(e,t){const r=await ju(),n=`${e}-${t}`,i=`${n}.mp4`;return{clipId:n,savePath:r,metadataPath:Fu().join(r,`${n}.json`),mp4Name:i,mp4Path:Fu().join(r,i),thumbnailPath:Fu().join(r,`${n}.jpg`)}}function Gu(e){const[t,r]=e.split("-");return{id:t,startTime:parseInt(r)}}async function zu(e){try{const{id:t,startTime:r}=Gu(e),{mp4Path:n,thumbnailPath:i,metadataPath:s}=await qu(t,r);await async function(...e){for(const t of e)try{await xu().promises.unlink(t)}catch(e){}}(n,i,s)}catch(e){}}const{log:$u}=i();const Wu=()=>{const e=(performance.timeOrigin+performance.now()-Date.UTC(1900,0,1))/1e3,[t,r]=e.toString().split(".").map(Number),n=function(e,t){const r=e.reduce(((e,t)=>e+t),0),n=Buffer.alloc(r);let i=0;return t.forEach(((t,r)=>{const s=e[r];8===s?n.writeBigUInt64BE(t,i):n.writeUIntBE(t,i,s),i+=s})),n}([4,4],[t,r]);return n.readBigUInt64BE()};function Yu(){console.warn("================================================================================="),console.warn("Transcoding Debug Mode is enabled on this camera."),console.warn("This setting is used to diagnose camera issues, and should not be used long term."),console.warn("The HomeKit Readme contains proper camera configuration to avoid transcoding."),console.warn("More robust transcoding options are available within the Rebroadcast Plugin."),console.warn("=================================================================================")}function Qu(e,t,r){if(!r)return e.warn("============================================================================="),e.warn("No video codec reported. This stream may fail. Enable the Rebroadcast Plugin."),e.warn("Stream compatibility can be diagnosed by enabling Transcoding Debug Mode."),void e.warn("=============================================================================");if(r&&-1===r.toLowerCase().indexOf("h264")){e.error("=============================================================================");e.error(`${t.name} video codec must be h264 but is ${r}.`),e.error("This stream may fail. Read the instructions in the HomeKit Plugin"),e.error("to properly configure your camera codec."),e.error("Stream compatibility can be diagnosed by enabling Transcoding Debug Mode."),e.error("============================================================================="),$u.a(`${t.name} video codec must be h264 but is ${r}. This stream may fail. Read the instructions in the HomeKit Plugin to properly configure your camera codec.`)}}function Ju(e,t){if(t===e)return 0;const r=t-e;let n;return n=t>e?e+65536-t:t+65536-e,Math.abs(r)<Math.abs(n)?r:n}function Xu(e,t=1){return(e+t+65536)%65536}function Zu(e,t){return Xu(e)===t}class eh{pending=[];constructor(e,t){this.console=e,this.jitterSize=t}flushPending(e,t){if(!this.pending)return t;const r=Xu(e);for(let e=0;e<this.jitterSize;e++){const n=(r+e)%this.jitterSize,i=this.pending[n];if(!i)continue;const{sequenceNumber:s}=i.header,o=Ju(this.lastSequenceNumber,s);o<=0?(this.console.log("jitter buffer purged packet:",s),this.pending[n]=void 0,t.push(i)):1===o&&(this.pending[n]=void 0,this.lastSequenceNumber=s,t.push(i))}return t}queue(e){if(void 0===this.lastSequenceNumber||Zu(this.lastSequenceNumber,e.header.sequenceNumber))return this.lastSequenceNumber=e.header.sequenceNumber,this.flushPending(this.lastSequenceNumber,[e]);const{sequenceNumber:t}=e.header,r=Ju(this.lastSequenceNumber,t);if(r<=0)return[];const n=[];if(r>this.jitterSize){this.console.log("jitter buffer skipped packets:",r);const{lastSequenceNumber:e}=this;this.lastSequenceNumber=t-this.jitterSize,this.flushPending(e,n)}return this.pending[e.header.sequenceNumber%this.jitterSize]=e,this.flushPending(this.lastSequenceNumber,n)}}class th{extraPackets=0;seenStapASps=!1;constructor(e,t,r,n=new eh(e,4)){this.console=e,this.maxPacketSize=t,this.codecInfo=r,this.jitterBuffer=n,this.fuaMax=t-2,this.fuaMin=Math.round(.8*t)}ensureCodecInfo(){this.codecInfo||(this.codecInfo={sps:void 0,pps:void 0})}updateSps(e){this.ensureCodecInfo(),this.codecInfo.sps=e}updatePps(e){this.ensureCodecInfo(),this.codecInfo.pps=e}shouldFilter(e){return!1}packetizeFuA(e,t,r){if(28===(31&e[0])){const n=224&e[0],i=31&e[1],s=!!(128&e[1]),o=!!(64&e[1]),a=!s&&!o,c=Buffer.from([n|i]);e=Buffer.concat([c,e.subarray(2)]),s?r=!0:o?t=!0:a&&(t=!0,r=!0)}const n=224&e[0],i=31&e[0],s=28|n,o=Buffer.from([s,i]),a=t?o:Buffer.from([s,128|i]),c=r?o:Buffer.from([s,64|i]);let u=a;const h=[];let d=1;for(;d<e.length;){let t;const r=Math.min(this.fuaMax,e.length-d);t=e.subarray(d,d+r),d+=r,d===e.length&&(u=c),h.push(Buffer.concat([u,t])),u=o}return h}packetizeOneStapA(e){const t=[];if(!e.length)throw new Error("packetizeOneStapA requires at least one NAL");let r=0,n=this.maxPacketSize-3;for(;e.length&&e[0].length+2<=n&&r<9;){const i=e.shift();n-=2+i.length,r+=1;const s=Buffer.alloc(2);s.writeUInt16BE(i.length,0),t.push(s,i)}return 0===r?(this.console.warn("stap a packet is too large. this may be a bug."),e.shift()):(t.unshift(Buffer.from([24])),Buffer.concat(t))}packetizeStapA(e){const t=[];for(;e.length;)t.push(this.packetizeOneStapA(e));return t}createPacket(e,t,r){const n=e.clone();return n.header.sequenceNumber=(e.header.sequenceNumber+this.extraPackets+65536)%65536,n.header.marker=r,n.header.padding=!1,n.payload=t,t.length>this.maxPacketSize&&this.console.warn("packet exceeded max packet size. this may a bug."),n}flushPendingFuA(e){if(!this.pendingFuA)return;const t=this.pendingFuA[0],r=this.pendingFuA[this.pendingFuA.length-1],n=31&t.payload[1],i=!!(128&t.payload[1]),s=!!(64&r.payload[1]),o=224&t.payload[0],a=Buffer.from([o|n]),c=()=>{const e=this.pendingFuA.map((e=>e.payload.subarray(2)));e.unshift(a);return Buffer.concat(e)};if(7===n){const n=function(e){const t=[];let r=0,n=0;const i=()=>{const i=e.subarray(r,n);i.length&&t.push(i),n+=4,r=n};for(;n<e.length-4;)1===e.readUInt32BE(n)?i():n++;return n=e.length,i(),t}(c());for(;n.length;){const o=n.shift(),a=31&o[0];7===a?this.updateSps(o):8===a?this.updatePps(o):(5===a&&this.maybeSendSpsPps(t,e),this.fragment(t,e,{payload:o,noStart:!i,noEnd:!s,marker:r.header.marker}))}}else{for(;this.pendingFuA.length;){const t=this.pendingFuA[0];if(t.payload.length>this.maxPacketSize||t.payload.length<this.fuaMin)break;this.pendingFuA.shift(),e.push(this.createPacket(t,t.payload,t.header.marker))}if(!this.pendingFuA.length)return void(this.pendingFuA=void 0);const t=this.pendingFuA[0],r=this.pendingFuA[this.pendingFuA.length-1],n=!!(128&t.payload[1]),i=!!(64&r.payload[1]),s=c();this.fragment(t,e,{payload:s,noStart:!n,noEnd:!i,marker:r.header.marker})}this.extraPackets-=this.pendingFuA.length-1,this.pendingFuA=void 0}createRtpPackets(e,t,r,n=e.header.marker){t.forEach(((i,s)=>{0!==s&&this.extraPackets++;const o=n&&s===t.length-1;r.push(this.createPacket(e,i,o))}))}maybeSendSpsPps(e,t){if(!this.codecInfo?.sps||!this.codecInfo?.pps)return;const r=this.packetizeStapA([this.codecInfo.sps,this.codecInfo.pps]);1===r.length?(this.createRtpPackets(e,r,t),this.extraPackets++):this.console.error("expected only 1 packet for sps/pps stapa")}fragment(e,t,r={payload:e.payload,noStart:!1,noEnd:!1,marker:e.header.marker}){const{payload:n,noStart:i,noEnd:s,marker:o}=r;if(n.length>this.maxPacketSize||i||s){const r=this.packetizeFuA(n,i,s);this.createRtpPackets(e,r,t,o)}else t.push(this.createPacket(e,n,o))}repacketize(e){const t=[];for(const r of this.jitterBuffer.queue(e))this.repacketizeOne(r,t);return t}repacketizeOne(e,t){if(!e.payload.length)return this.flushPendingFuA(t),void this.extraPackets--;const r=31&e.payload[0];if(this.pendingFuA&&this.pendingFuA[0].header.timestamp!==e.header.timestamp&&this.flushPendingFuA(t),28===r){const r=e.payload,n=31&r[1];if(this.shouldFilter(n))return void this.extraPackets--;const i=!!(128&r[1]),s=!!(64&e.payload[1]);if(i)this.pendingFuA&&this.console.error("fua restarted. skipping refragmentation of previous fua.",n),this.pendingFuA=void 0,5!==n||this.seenStapASps||this.maybeSendSpsPps(e,t);else if(this.pendingFuA){if(!Zu(this.pendingFuA[this.pendingFuA.length-1].header.sequenceNumber,e.header.sequenceNumber))return void this.console.error("fua packet missing. skipping refragmentation.",n)}if(this.pendingFuA||(this.pendingFuA=[]),this.pendingFuA.push(e),s)this.flushPendingFuA(t);else if(this.pendingFuA.reduce(((e,t)=>e+t.payload.length-2),1)>this.maxPacketSize){const e=this.pendingFuA[this.pendingFuA.length-1].clone(),r=[];this.flushPendingFuA(r);const n=r.pop();e.payload=n.payload,this.pendingFuA=[e],t.push(...r)}}else if(24===r){this.flushPendingFuA(t);const r=function(e){const t=[];let r,n=1;for(;n<e.length;){void 0!==r&&t.push(e.subarray(r,n));const i=e.readUInt16BE(n);n+=2,r=n,n+=i}return t.push(e.subarray(r)),t}(e.payload).filter((e=>{const t=31&e[0];return this.seenStapASps=this.seenStapASps||7===t,!this.shouldFilter(t)}));if(0===r.length)return void this.extraPackets--;const n=this.packetizeStapA(r);this.createRtpPackets(e,n,t)}else if(r>=1&&r<24){if(this.flushPendingFuA(t),this.shouldFilter(r))return void this.extraPackets--;if(7===r)return this.extraPackets--,void this.updateSps(e.payload);if(8===r)return this.extraPackets--,void this.updatePps(e.payload);if(this.shouldFilter(r))return void this.extraPackets--;5!==r||this.seenStapASps||this.maybeSendSpsPps(e,t),this.fragment(e,t)}else this.console.error("unknown nal unit type "+r),this.extraPackets--}}function rh(e){let t=[];try{t=JSON.parse(e.getItem("debugMode"))}catch(e){}return Array.isArray(t)||(t=[]),{recording:t.includes("Save Recordings"),video:t.includes("Transcode Video"),audio:t.includes("Transcode Audio"),value:t}}const{log:nh,mediaManager:ih,deviceManager:sh}=i(),oh=[24,7,8,6,9];async function ah(e,t){const r=vu().spawn(await ih.getFFmpegPath(),["-hide_banner","-f","mp4","-i","pipe:3","-vcodec","copy","-f","h264","pipe:4"],{stdio:["pipe","pipe","pipe","pipe","pipe"]});Iu(e,r);const n=r.stdio[3];n.write(t),n.end();const i=r.stdio[4],s=[];i.on("data",(e=>s.push(e)));try{await Pu(1e3,new Promise((e=>r.on("exit",e))));const t=Buffer.concat(s);let n=0;for(;n<t.length-6;){if(1!==t.readInt32BE(n)){n++;continue}n+=4;let r=31&t.readUInt8(n);if(28===r&&(n++,r=31&t.readUInt8(n)),5===r)return!0;if(!oh.includes(r))return e.warn("skipping mp4 fragment: non idr frame",r),!1;n++}return e.warn("skipping mp4 fragment: no idr frame found"),!1}catch(t){return e.warn("skipping mp4 fragment: error",t),!1}}async function*ch(e,r,n,i,s){s.storageSettings.values.lastKnownHomeHub=e.remoteAddress,i.log(r.name,"recording session starting",e.remoteAddress,n);const o=rh(sh.getMixinStorage(r.id,void 0)),a=o.recording,c=2.5*n.mediaContainerConfiguration.prebufferLength,u=await r.getVideoStream({destination:"remote-recorder",video:{codec:"h264"},audio:{codec:"aac"},prebuffer:c,container:"mp4"}),h=JSON.parse((await ih.convertMediaObjectToBuffer(u,t.ScryptedMimeTypes.FFmpegInput)).toString());h.mediaStreamOptions?.prebuffer||nh.a(`${r.name} is not prebuffered. Please install and enable the Rebroadcast plugin.`);const d=h.mediaStreamOptions&&null===h.mediaStreamOptions.audio,l=h.mediaStreamOptions?.audio?.codec,f=h.mediaStreamOptions?.video?.codec,p=!l||-1===l.toLowerCase().indexOf("aac"),y=!!h.h264EncoderArguments?.length||!!h.h264FilterArguments?.length,g=o.video||o.video||!h.url.startsWith("tcp://")||y||"mp4"!==h.container||d;let v;if((o.video||o.video)&&Yu(),g){const e=[],t={video:{width:n.videoCodec.resolution[0],height:n.videoCodec.resolution[1],fps:n.videoCodec.resolution[2],max_bit_rate:n.videoCodec.bitrate}};if(h.videoDecoderArguments?.length&&e.push(...h.videoDecoderArguments),e.push(...h.inputArguments),d){i.log(r.name,"adding dummy audio track");const t=Fu().resolve(process.env.SCRYPTED_PLUGIN_VOLUME,"zip/unzipped/fs/silence.mp4");e.push("-stream_loop","-1","-i",t)}let s;if(y||p||o.audio){y||o.audio||i.warn("Recording audio is not explicitly AAC, forcing transcoding. Setting audio output to AAC is recommended.",l);let e="aac";true||(e="libfdk_aac"),s=[...n.audioCodec.type===gr.AAC_LC?["-acodec",e,"-profile:a","aac_low"]:["-acodec","libfdk_aac","-profile:a","aac_eld"],"-ar",`${br[n.audioCodec.samplerate]}k`,"-b:a",`${n.audioCodec.bitrate}k`,"-ac",`${n.audioCodec.audioChannels}`]}else s=["-acodec","copy","-bsf:a","aac_adtstoasc"];const a=h.h264FilterArguments?.slice()||[];if(o.video||y){o.video||!h.h264EncoderArguments?a.push("-c:v","libx264","-pix_fmt","yuvj420p","-preset","ultrafast","-bf","0"):a.push(...h.h264EncoderArguments);mu(a,`scale=w='min(${n.videoCodec.resolution[0]},iw)':h=-2`),a.push("-b:v",`${n.videoCodec.bitrate}k`,"-bufsize",(2*t.video.max_bit_rate).toString()+"k","-maxrate",t.video.max_bit_rate.toString()+"k","-g",""+4*t.video.fps,"-r",`${t.video.fps}`)}else Qu(i,r,f),a.push("-vcodec","copy");i.log("motion recording starting"),v=await async function(e,t,r,n){const i=e.slice();i.push(...r,...t,...Ou,"pipe:3"),i.unshift("-hide_banner"),wu(n,i);const s=vu().spawn(await Ru.getFFmpegPath(),i,{stdio:["pipe","pipe","pipe","pipe"]});return Iu(n,s),{cp:s,generator:Nu(s.stdio[3])}}(e,s,a,i)}else{i.log("prebuffer is tcp/mp4/h264/aac compatible. using direct tcp.");const e=new URL(h.url),t=m().connect(parseInt(e.port),e.hostname);v={socket:t,cp:void 0,generator:Nu(t)}}const b=Date.now();let E;const S=async(e,t)=>{if(a)try{const n=Date.now()-b,{clipId:i,savePath:s,metadataPath:o,mp4Path:a}=await qu(r.id,b);await Lu()(s),E||(E=xu().createWriteStream(a)),E.write(t);const c={id:i,startTime:b,duration:n,fragments:e+1};await xu().promises.writeFile(o,Buffer.from(JSON.stringify(c)))}catch(e){i.error("error saving hksv fragment",e)}},A=()=>{I?.destroy(),Au(w)};i.log("motion recording started");const{socket:I,cp:w,generator:T}=v,C=setTimeout((()=>{i.error("homekit secure video max duration reached"),A()}),18e4);let _=[];try{let e,n,o=0,c="mp4"!==h.container,u=!0;for await(const t of T){const{header:r,type:s,data:a}=t;if(c&&!e&&"ftyp"===s&&(e=[r,a]),c&&!n&&"moov"===s&&(n=[r,a]),"mdat"===s&&c){c=!1;try{if(!await ah(i,Buffer.concat([...e,...n,..._,r,a]))){u=!1,_=[];continue}}finally{e=void 0,n=void 0}}if(_.push(r,a),"moov"===s||"mdat"===s){if("mdat"===s&&u){_=[],u=!1;continue}const e=Buffer.concat(_);S(o,e),_=[],i.log(`motion fragment #${++o} sent. size:`,e.length),yield e}}i.log("motion recording finished")}catch(e){i.log(`motion recording completed ${e}`)}finally{clearTimeout(C),A(),E?.end(),E?.destroy(),a&&(s.cameraMixins.get(r.id)?.onDeviceEvent(t.ScryptedInterface.VideoClips,void 0),sh.onDeviceEvent(Hu,t.ScryptedInterface.VideoClips,void 0))}}r(4300);var uh=r(8493);class hh{value=0;constructor(e){this.bitLength=e}set(e,t,r){return r&=(1<<e)-1,this.value|=r<<this.bitLength-e-t,this}get buffer(){const e=Math.ceil(this.bitLength/8),t=Buffer.alloc(e);return t.writeUIntBE(this.value,0,e),t}}class dh{_value=0n;offset=0n;constructor(e){if(this.bitLength=e,e>32)throw new Error}set(e,t=1){let r=BigInt(e);const n=BigInt(t);return r&=(1n<<n)-1n,this._value|=r<<BigInt(this.bitLength)-n-this.offset,this.offset+=n,this}get value(){return Number(this._value)}get buffer(){const e=Math.ceil(this.bitLength/8),t=Buffer.alloc(e);return t.writeUIntBE(this.value,0,e),t}}function lh(e,t,r=1){let n=e.toString(2).split("");n=[...Array(8-n.length).fill("0"),...n];const i=n.slice(t,t+r).join("");return parseInt(i,2)}function fh(e,t){return ph(e)(t)}function ph(e,t){const r=e.reduce(((e,t)=>e+t),0),n=t?Buffer.alloc(r):void 0;return t=>{const i=n||Buffer.alloc(r);let s=0;return t.forEach(((t,r)=>{const n=e[r];8===n?i.writeBigUInt64BE(t,s):i.writeUIntBE(t,s,n),s+=n})),i}}function yh(e,t){let r=0;return t.map((t=>{let n;return n=8===t?e.readBigUInt64BE(r):e.readUIntBE(r,t),r+=t,n}))}r(3458);class mh extends Error{constructor(e){super(e.message)}toJSON(){return{message:this.message,payload:JSON.parse(JSON.stringify(this.payload)),path:this.path}}}r(5069);var gh=r(1905),vh=r.n(gh);(0,gh.debug)("werift-rtp : packages/rtp/src/codec/av1.ts");const bh={0:"Reserved",1:"OBU_SEQUENCE_HEADER",2:"OBU_TEMPORAL_DELIMITER",3:"OBU_FRAME_HEADER",4:"OBU_TILE_GROUP",5:"OBU_METADATA",6:"OBU_FRAME",7:"OBU_REDUNDANT_FRAME_HEADER",8:"OBU_TILE_LIST",15:"OBU_PADDING"};Object.entries(bh).reduce(((e,[t,r])=>(e[r]=Number(t),e)),{});Buffer.from([0,0,0,1]);r(2275);vh()("werift-rtp : packages/rtp/src/processor/depacketizer.ts");require("stream/web");vh()("werift-rtp : packages/rtp/src/processor/jitterBuffer.ts");Number((0x01n<<32n)-1n),vh()("werift-rtp : packages/rtp/src/processor/ntpTime.ts");const Eh=48862,Sh=4096;class Ah{version=2;padding=!1;paddingSize=0;extension=!1;marker=!1;payloadOffset=0;payloadType=0;sequenceNumber=0;timestamp=0;ssrc=0;csrcLength=0;csrc=[];extensionProfile=Eh;extensions=[];constructor(e={}){Object.assign(this,e)}static deSerialize(e){const t=new Ah;let r=0;const n=e[r++];t.version=lh(n,0,2),t.padding=lh(n,2)>0,t.extension=lh(n,3)>0,t.csrcLength=lh(n,4,4),t.csrc=[...Array(t.csrcLength)].map((()=>{const t=e.readUInt32BE(r);return r+=4,t})),r+=11;const i=e[1];t.marker=lh(i,0)>0,t.payloadType=lh(i,1,7),t.sequenceNumber=e.readUInt16BE(2),t.timestamp=e.readUInt32BE(4),t.ssrc=e.readUInt32BE(8);for(let r=0;r<t.csrc.length;r++){const n=12+4*r;t.csrc[r]=e.subarray(n).readUInt32BE()}if(t.extension){t.extensionProfile=e.subarray(r).readUInt16BE(),r+=2;const n=4*e.subarray(r).readUInt16BE();switch(t.extensionLength=n,r+=2,t.extensionProfile){case Eh:{const i=r+n;for(;r<i;){if(0===e[r]){r++;continue}const n=e[r]>>4,i=1+(e[r]&(240^e[r]));if(r++,15===n)break;const s={id:n,payload:e.subarray(r,r+i)};t.extensions=[...t.extensions,s],r+=i}}break;case Sh:{const i=r+n;for(;r<i;){if(0===e[r]){r++;continue}const n=e[r];r++;const i=e[r];r++;const s={id:n,payload:e.subarray(r,r+i)};t.extensions=[...t.extensions,s],r+=i}}break;default:{const i={id:0,payload:e.subarray(r,r+n)};t.extensions=[...t.extensions,i],r+=t.extensions[0].payload.length}}}return t.payloadOffset=r,t.padding&&(t.paddingSize=e[e.length-1]),t}get serializeSize(){const{csrc:e,extensionProfile:t,extensions:r}=this;let n=12+4*e.length;if(r.length>0||!0===this.extension){let e=4;switch(t){case Eh:for(const t of r)e+=1+t.payload.length;break;case Sh:for(const t of r)e+=2+t.payload.length;break;default:e+=r[0].payload.length}n+=4*Math.floor((e+3)/4)}return n}serialize(e){const t=Buffer.alloc(e);let r=0;const n=new hh(8);n.set(2,0,this.version),this.padding&&n.set(1,2,1),this.extensions.length>0&&(this.extension=!0),this.extension&&n.set(1,3,1),n.set(4,4,this.csrc.length),t.writeUInt8(n.value,r++);const i=new hh(8);this.marker&&i.set(1,0,1),i.set(7,1,this.payloadType),t.writeUInt8(i.value,r++),t.writeUInt16BE(this.sequenceNumber,2),r+=2,t.writeUInt32BE(this.timestamp,4),r+=4,t.writeUInt32BE(this.ssrc,8),r+=4;for(const e of this.csrc)t.writeUInt32BE(e,r),r+=4;if(this.extension){const e=r;t.writeUInt16BE(this.extensionProfile,r),r+=4;const n=r;switch(this.extensionProfile){case Eh:for(const e of this.extensions)t.writeUInt8(e.id<<4|e.payload.length-1,r++),e.payload.copy(t,r),r+=e.payload.length;break;case Sh:for(const e of this.extensions)t.writeUInt8(e.id,r++),t.writeUInt8(e.payload.length,r++),e.payload.copy(t,r),r+=e.payload.length;break;default:const e=this.extensions[0].payload.length;if(e%4!=0)throw new Error;this.extensions[0].payload.copy(t,r),r+=e}const i=r-n,s=4*Math.trunc((i+3)/4);t.writeUInt16BE(Math.trunc(s/4),e+2);for(let e=0;e<s-i;e++)t.writeUInt8(0,r),r++}return this.payloadOffset=r,t}}class Ih{constructor(e,t){this.header=e,this.payload=t}get serializeSize(){return this.header.serializeSize+this.payload.length}clone(){return new Ih(new Ah({...this.header}),this.payload)}serialize(){let e=this.header.serialize(this.header.serializeSize+this.payload.length);const{payloadOffset:t}=this.header;if(this.payload.copy(e,t),this.header.padding){const t=Buffer.alloc(this.header.paddingSize);t.writeUInt8(this.header.paddingSize,this.header.paddingSize-1),e=Buffer.concat([e,t])}return e}static deSerialize(e){const t=Ah.deSerialize(e);return new Ih(t,e.subarray(t.payloadOffset,e.length-t.paddingSize))}clear(){this.payload=null}}var wh=r(2816),Th=r.n(wh);const Ch=(e,t=function(e){if(e<0)throw new Error("EBML.typedArrayUtils.getNumberByteLength: negative number not implemented");if(e<256)return 1;if(e<65536)return 2;if(e<16777216)return 3;if(e<4294967296)return 4;if(e<1099511627776)return 5;if(e<281474976710656)return 6;if(e<0x20000000000000n)return 7;throw new Error("EBML.typedArrayUtils.getNumberByteLength: number exceeds Number.MAX_SAFE_INTEGER")}(e))=>{let r;if(1===t)r=new DataView(new ArrayBuffer(1)),r.setUint8(0,e);else if(2===t)r=new DataView(new ArrayBuffer(2)),r.setUint16(0,e);else if(3===t)r=new DataView(new ArrayBuffer(3)),r.setUint8(0,e>>16),r.setUint16(1,65535&e);else if(4===t)r=new DataView(new ArrayBuffer(4)),r.setUint32(0,e);else if(e<4294967295)r=new DataView(new ArrayBuffer(5)),r.setUint32(1,e);else if(5===t)r=new DataView(new ArrayBuffer(5)),r.setUint8(0,e/4294967296|0),r.setUint32(1,e%4294967296);else if(6===t)r=new DataView(new ArrayBuffer(6)),r.setUint16(0,e/4294967296|0),r.setUint32(2,e%4294967296);else if(7===t)r=new DataView(new ArrayBuffer(7)),r.setUint8(0,e/281474976710656|0),r.setUint16(1,e/4294967296&65535),r.setUint32(3,e%4294967296);else{if(8!==t)throw new Error("EBML.typedArrayUtils.numberToByteArray: byte length must be less than or equal to 8");r=new DataView(new ArrayBuffer(8)),r.setUint32(0,e/4294967296|0),r.setUint32(4,e%4294967296)}return new Uint8Array(r.buffer)},_h=Th()((e=>Uint8Array.from(Array.from(e).map((e=>e.codePointAt(0))))));Th()((e=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,e),new Uint8Array(t)}));const Dh=Th()((e=>{const t=new ArrayBuffer(4);return new DataView(t).setFloat32(0,e),new Uint8Array(t)}));class Rh{constructor(e){this.bytes=e}write(e,t){return e.set(this.bytes,t),t+this.bytes.length}countSize(){return this.bytes.length}}const Nh=Th()((e=>new Rh(e))),Oh=(Th()((e=>Nh(Ch(e)))),Th()((e=>Nh(Dh(e)))),Th()((e=>Nh(Uh(Ch(e,Oh(e)))))),Th()((e=>Nh(_h(e)))),e=>{if(e<127)return 1;if(e<16383)return 2;if(e<2097151)return 3;if(e<268435455)return 4;if(e<34359738367)return 5;if(e<4398046511103)return 6;if(e<562949953421311)return 7;if(e<0x20000000000000n)return 8;throw e<0xffffffffffffffn?new Error("EBMLgetEBMLByteLength: number exceeds Number.MAX_SAFE_INTEGER"):new Error("EBMLgetEBMLByteLength: data size must be less than or equal to "+(Math.pow(2,56)-2))}),Uh=(new Uint8Array([1,255,255,255,255,255,255,255]),e=>(e[0]=Ph(e.length)|e[0],e)),Ph=e=>128>>e-1;Uint8Array.of(26,69,223,163),Uint8Array.of(66,134),Uint8Array.of(66,247),Uint8Array.of(66,242),Uint8Array.of(66,243),Uint8Array.of(66,130),Uint8Array.of(66,135),Uint8Array.of(66,133),Uint8Array.of(236),Uint8Array.of(191),Uint8Array.of(24,83,128,103),Uint8Array.of(17,77,155,116),Uint8Array.of(77,187),Uint8Array.of(83,171),Uint8Array.of(83,172),Uint8Array.of(21,73,169,102),Uint8Array.of(115,164),Uint8Array.of(115,132),Uint8Array.of(60,185,35),Uint8Array.of(60,131,171),Uint8Array.of(62,185,35),Uint8Array.of(62,131,187),Uint8Array.of(68,68),Uint8Array.of(105,36),Uint8Array.of(105,252),Uint8Array.of(105,191),Uint8Array.of(105,165),Uint8Array.of(42,215,177),Uint8Array.of(68,137),Uint8Array.of(68,97),Uint8Array.of(123,169),Uint8Array.of(77,128),Uint8Array.of(87,65),Uint8Array.of(31,67,182,117),Uint8Array.of(231),Uint8Array.of(88,84),Uint8Array.of(88,215),Uint8Array.of(167),Uint8Array.of(171),Uint8Array.of(163),Uint8Array.of(160),Uint8Array.of(161),Uint8Array.of(117,161),Uint8Array.of(166),Uint8Array.of(238),Uint8Array.of(165),Uint8Array.of(155),Uint8Array.of(250),Uint8Array.of(251),Uint8Array.of(164),Uint8Array.of(117,162),Uint8Array.of(142),Uint8Array.of(232),Uint8Array.of(204),Uint8Array.of(22,84,174,107),Uint8Array.of(174),Uint8Array.of(215),Uint8Array.of(115,197),Uint8Array.of(131),Uint8Array.of(185),Uint8Array.of(136),Uint8Array.of(85,170),Uint8Array.of(156),Uint8Array.of(109,231),Uint8Array.of(109,248),Uint8Array.of(35,227,131),Uint8Array.of(35,78,122),Uint8Array.of(85,238),Uint8Array.of(83,110),Uint8Array.of(34,181,156),Uint8Array.of(134),Uint8Array.of(99,162),Uint8Array.of(37,134,136),Uint8Array.of(116,70),Uint8Array.of(170),Uint8Array.of(111,171),Uint8Array.of(86,170),Uint8Array.of(86,187),Uint8Array.of(102,36),Uint8Array.of(102,252),Uint8Array.of(102,191),Uint8Array.of(102,165),Uint8Array.of(224),Uint8Array.of(154),Uint8Array.of(157),Uint8Array.of(83,184),Uint8Array.of(83,192),Uint8Array.of(176),Uint8Array.of(186),Uint8Array.of(84,170),Uint8Array.of(84,187),Uint8Array.of(84,204),Uint8Array.of(84,221),Uint8Array.of(84,176),Uint8Array.of(84,186),Uint8Array.of(84,178),Uint8Array.of(84,179),Uint8Array.of(46,181,36),Uint8Array.of(85,176),Uint8Array.of(85,177),Uint8Array.of(85,178),Uint8Array.of(85,179),Uint8Array.of(85,180),Uint8Array.of(85,181),Uint8Array.of(85,182),Uint8Array.of(85,183),Uint8Array.of(85,184),Uint8Array.of(85,185),Uint8Array.of(85,186),Uint8Array.of(85,187),Uint8Array.of(85,188),Uint8Array.of(85,189),Uint8Array.of(85,208),Uint8Array.of(85,209),Uint8Array.of(85,210),Uint8Array.of(85,211),Uint8Array.of(85,212),Uint8Array.of(85,213),Uint8Array.of(85,214),Uint8Array.of(85,215),Uint8Array.of(85,216),Uint8Array.of(85,217),Uint8Array.of(85,218),Uint8Array.of(225),Uint8Array.of(181),Uint8Array.of(120,181),Uint8Array.of(159),Uint8Array.of(98,100),Uint8Array.of(226),Uint8Array.of(227),Uint8Array.of(228),Uint8Array.of(229),Uint8Array.of(230),Uint8Array.of(233),Uint8Array.of(237),Uint8Array.of(109,128),Uint8Array.of(98,64),Uint8Array.of(80,49),Uint8Array.of(80,50),Uint8Array.of(80,51),Uint8Array.of(80,52),Uint8Array.of(66,84),Uint8Array.of(66,85),Uint8Array.of(80,53),Uint8Array.of(71,225),Uint8Array.of(71,226),Uint8Array.of(71,227),Uint8Array.of(71,228),Uint8Array.of(71,229),Uint8Array.of(71,230),Uint8Array.of(28,83,187,107),Uint8Array.of(187),Uint8Array.of(179),Uint8Array.of(183),Uint8Array.of(247),Uint8Array.of(241),Uint8Array.of(240),Uint8Array.of(178),Uint8Array.of(83,120),Uint8Array.of(234),Uint8Array.of(219),Uint8Array.of(150),Uint8Array.of(25,65,164,105),Uint8Array.of(97,167),Uint8Array.of(70,126),Uint8Array.of(70,110),Uint8Array.of(70,96),Uint8Array.of(70,92),Uint8Array.of(70,174),Uint8Array.of(16,67,167,112),Uint8Array.of(69,185),Uint8Array.of(69,188),Uint8Array.of(69,189),Uint8Array.of(69,219),Uint8Array.of(69,221),Uint8Array.of(71,225),Uint8Array.of(71,226),Uint8Array.of(71,231),Uint8Array.of(71,232),Uint8Array.of(182),Uint8Array.of(115,196),Uint8Array.of(86,84),Uint8Array.of(145),Uint8Array.of(146),Uint8Array.of(152),Uint8Array.of(69,152),Uint8Array.of(110,103),Uint8Array.of(110,188),Uint8Array.of(99,195),Uint8Array.of(143),Uint8Array.of(137),Uint8Array.of(128),Uint8Array.of(133),Uint8Array.of(67,124),Uint8Array.of(67,126),Uint8Array.of(105,68),Uint8Array.of(105,85),Uint8Array.of(69,13),Uint8Array.of(105,17),Uint8Array.of(105,34),Uint8Array.of(105,51),Uint8Array.of(18,84,195,103),Uint8Array.of(115,115),Uint8Array.of(99,192),Uint8Array.of(104,202),Uint8Array.of(99,202),Uint8Array.of(99,197),Uint8Array.of(99,201),Uint8Array.of(99,196),Uint8Array.of(99,198),Uint8Array.of(103,200),Uint8Array.of(69,163),Uint8Array.of(68,122),Uint8Array.of(68,132),Uint8Array.of(68,135),Uint8Array.of(68,133);vh()("werift-rtp : packages/rtp/src/processor/webm.ts");Number(0x01n<<32n);require("fs/promises");class Bh{version=2;padding=!1;count=0;type=0;length=0;constructor(e={}){Object.assign(this,e)}serialize(){const e=new hh(8);e.set(2,0,this.version),this.padding&&e.set(1,2,1),e.set(5,3,this.count);return fh([1,1,2],[e.value,this.type,this.length])}static deSerialize(e){const[t,r,n]=yh(e,[1,1,2]),i=lh(t,0,2),s=lh(t,2,1)>0,o=lh(t,3,5);return new Bh({version:i,padding:s,count:o,type:r,length:n})}}var xh=r(8862),Mh=r.n(xh);class Lh{ssrc=0;reports=[];static type=201;type=Lh.type;constructor(e={}){Object.assign(this,e)}serialize(){let e=fh([4],[this.ssrc]);return e=Buffer.concat([e,...this.reports.map((e=>e.serialize()))]),nd.serialize(Lh.type,this.reports.length,e,Math.floor(e.length/4))}static deSerialize(e,t){const[r]=yh(e,[4]);let n=4;const i=[];return Mh()(t).forEach((()=>{i.push(kh.deSerialize(e.slice(n,n+24))),n+=24})),new Lh({ssrc:r,reports:i})}}class kh{constructor(e={}){Object.assign(this,e)}serialize(){return fh([4,1,3,4,4,4,4],[this.ssrc,this.fractionLost,this.packetsLost,this.highestSequence,this.jitter,this.lsr,this.dlsr])}static deSerialize(e){const[t,r,n,i,s,o,a]=yh(e,[4,1,3,4,4,4,4]);return new kh({ssrc:t,fractionLost:r,packetsLost:n,highestSequence:i,jitter:s,lsr:o,dlsr:a})}}class Fh{static count=1;count=Fh.count;lost=[];toJSON(){return{lost:this.lost,senderSsrc:this.senderSsrc,mediaSourceSsrc:this.mediaSourceSsrc}}constructor(e={}){Object.assign(this,e),this.header||(this.header=new Bh({type:Yh.type,count:this.count,version:2}))}static deSerialize(e,t){const[r,n]=yh(e,[4,4]),i=Mh()(8,e.length,4).map((t=>{const r=[],[n,i]=yh(e.subarray(t),[2,2]);return r.push(n),Mh()(0,16).forEach((e=>{i>>e&1&&r.push(n+e+1)})),r})).flatMap((e=>e));return new Fh({header:t,senderSsrc:r,mediaSourceSsrc:n,lost:i})}serialize(){const e=fh([4,4],[this.senderSsrc,this.mediaSourceSsrc]),t=[];if(this.lost.length>0){let e=this.lost[0],r=0;this.lost.slice(1).forEach((n=>{const i=n-e-1;i>=0&&i<16?r|=1<<i:(t.push(fh([2,2],[e,r])),e=n,r=0)})),t.push(fh([2,2],[e,r]))}const r=Buffer.concat([e,Buffer.concat(t)]);return this.header.length=r.length/4,Buffer.concat([this.header.serialize(),r])}}const Vh=vh()("werift/rtp/rtcp/rtpfb/twcc");class Hh{static count=15;count=Hh.count;length=2;packetChunks=[];recvDeltas=[];constructor(e={}){Object.assign(this,e),this.header||(this.header=new Bh({type:205,count:this.count,version:2}))}static deSerialize(e,t){const[r,n,i,s,o,a]=yh(e,[4,4,2,2,3,1]),c=[],u=[];let h=16;for(let t=0;t<s;){let r;switch(lh(e.slice(h,h+1)[0],0,1)){case Gh.TypeTCCRunLengthChunk:{const n=jh.deSerialize(e.slice(h,h+2));r=n;const i=Math.min(s-t,n.runLength);n.packetStatus!==zh.TypeTCCPacketReceivedSmallDelta&&n.packetStatus!==zh.TypeTCCPacketReceivedLargeDelta||Mh()(i).forEach((()=>{u.push(new qh({type:n.packetStatus}))})),t+=i}break;case Gh.TypeTCCStatusVectorChunk:{const n=Kh.deSerialize(e.slice(h,h+2));r=n,0===n.symbolSize&&n.symbolList.forEach((e=>{e===zh.TypeTCCPacketReceivedSmallDelta&&u.push(new qh({type:zh.TypeTCCPacketReceivedSmallDelta}))})),1===n.symbolSize&&n.symbolList.forEach((e=>{e!==zh.TypeTCCPacketReceivedSmallDelta&&e!==zh.TypeTCCPacketReceivedLargeDelta||u.push(new qh({type:e}))})),t+=n.symbolList.length}}if(!r)throw new Error;h+=2,c.push(r)}let d=h;return u.forEach((t=>{t.type===zh.TypeTCCPacketReceivedSmallDelta&&(t.deSerialize(e.slice(d,d+1)),d++),t.type===zh.TypeTCCPacketReceivedLargeDelta&&(t.deSerialize(e.slice(d,d+2)),d+=2)})),new Hh({senderSsrc:r,mediaSourceSsrc:n,baseSequenceNumber:i,packetStatusCount:s,referenceTime:o,fbPktCount:a,recvDeltas:u,packetChunks:c,header:t})}serialize(){const e=fh([4,4,2,2,3,1],[this.senderSsrc,this.mediaSourceSsrc,this.baseSequenceNumber,this.packetStatusCount,this.referenceTime,this.fbPktCount]),t=Buffer.concat(this.packetChunks.map((e=>e.serialize()))),r=Buffer.concat(this.recvDeltas.map((e=>{try{return e.serialize()}catch(e){return void Vh(e?.message)}})).filter((e=>e))),n=Buffer.concat([e,t,r]);if(this.header.padding&&n.length%4!=0){const e=4-n.length%4,t=Buffer.alloc(e);return t[t.length-1]=t.length,this.header.length=Math.floor((n.length+t.length)/4),Buffer.concat([this.header.serialize(),n,t])}return this.header.length=Math.floor(n.length/4),Buffer.concat([this.header.serialize(),n])}get packetResults(){const e=this.baseSequenceNumber-1,t=this.packetChunks.filter((e=>e instanceof jh)).map((t=>t.results(e))).flatMap((e=>e));let r=0;let n=64n*BigInt(this.referenceTime);for(const e of t){const t=this.recvDeltas[r];e.received&&t&&(n+=BigInt(t.delta)/1000n,e.delta=t.delta,e.receivedAtMs=Number(n),r++)}return t}}class jh{constructor(e={}){Object.assign(this,e),this.type=Gh.TypeTCCRunLengthChunk}static deSerialize(e){const t=lh(e[0],1,2),r=(lh(e[0],3,5)<<8)+e[1];return new jh({type:0,packetStatus:t,runLength:r})}serialize(){return new dh(16).set(0).set(this.packetStatus,2).set(this.runLength,13).buffer}results(e){const t=this.packetStatus===zh.TypeTCCPacketReceivedSmallDelta||this.packetStatus===zh.TypeTCCPacketReceivedLargeDelta,r=[];for(let n=0;n<=this.runLength;++n)r.push(new $h({sequenceNumber:++e,received:t}));return r}}class Kh{symbolList=[];constructor(e={}){Object.assign(this,e)}static deSerialize(e){const t=Gh.TypeTCCStatusVectorChunk;let r=lh(e[0],1,1);const n=[];switch(r){case 0:Mh()(6).forEach(((t,r)=>n.push(lh(e[0],2+r,1)))),Mh()(8).forEach(((t,r)=>n.push(lh(e[1],r,1))));break;case 1:Mh()(3).forEach((t=>n.push(lh(e[0],2+2*t,2)))),Mh()(4).forEach((t=>n.push(lh(e[1],2*t,2))));break;default:r=(lh(e[0],2,6)<<8)+e[1]}return new Kh({type:t,symbolSize:r,symbolList:n})}serialize(){const e=Buffer.alloc(2),t=new dh(16).set(1).set(this.symbolSize),r=0===this.symbolSize?1:2;return this.symbolList.forEach((e=>{t.set(e,r)})),e.writeUInt16BE(t.value),e}}class qh{constructor(e={}){Object.assign(this,e)}static deSerialize(e){let t,r;if(1===e.length?(t=zh.TypeTCCPacketReceivedSmallDelta,r=250*e[0]):2===e.length&&(t=zh.TypeTCCPacketReceivedLargeDelta,r=250*e.readInt16BE()),void 0===t||void 0===r)throw new Error;return new qh({type:t,delta:r})}deSerialize(e){const t=qh.deSerialize(e);this.delta=t.delta}parsed=!1;parseDelta(){this.delta=Math.floor(this.delta/250),this.delta<0||this.delta>255?(this.delta>32767&&(this.delta=32767),this.delta<-32768&&(this.delta=-32768),this.type||(this.type=zh.TypeTCCPacketReceivedLargeDelta)):this.type||(this.type=zh.TypeTCCPacketReceivedSmallDelta),this.parsed=!0}serialize(){if(this.parsed||this.parseDelta(),this.type===zh.TypeTCCPacketReceivedSmallDelta){const e=Buffer.alloc(1);return e.writeUInt8(this.delta),e}if(this.type===zh.TypeTCCPacketReceivedLargeDelta){const e=Buffer.alloc(2);return e.writeInt16BE(this.delta),e}throw new Error("errDeltaExceedLimit "+this.delta+" "+this.type)}}let Gh,zh;!function(e){e[e.TypeTCCRunLengthChunk=0]="TypeTCCRunLengthChunk",e[e.TypeTCCStatusVectorChunk=1]="TypeTCCStatusVectorChunk",e[e.packetStatusChunkLength=2]="packetStatusChunkLength"}(Gh||(Gh={})),function(e){e[e.TypeTCCPacketNotReceived=0]="TypeTCCPacketNotReceived",e[e.TypeTCCPacketReceivedSmallDelta=1]="TypeTCCPacketReceivedSmallDelta",e[e.TypeTCCPacketReceivedLargeDelta=2]="TypeTCCPacketReceivedLargeDelta",e[e.TypeTCCPacketReceivedWithoutDelta=3]="TypeTCCPacketReceivedWithoutDelta"}(zh||(zh={}));class $h{sequenceNumber=0;delta=0;received=!1;receivedAtMs=0;constructor(e){Object.assign(this,e)}}const Wh=vh()("werift-rtp:packages/rtp/rtcp/rtpfb/index");class Yh{static type=205;type=Yh.type;constructor(e={}){Object.assign(this,e)}serialize(){return this.feedback.serialize()}static deSerialize(e,t){let r;switch(t.count){case Fh.count:r=Fh.deSerialize(e,t);break;case Hh.count:r=Hh.deSerialize(e,t);break;default:Wh("unknown rtpfb packet",t.count)}return new Yh({feedback:r,header:t})}}class Qh{static type=202;type=Qh.type;chunks=[];constructor(e){Object.assign(this,e)}get length(){let e=0;return this.chunks.forEach((t=>e+=t.length)),e}serialize(){let e=Buffer.concat(this.chunks.map((e=>e.serialize())));for(;e.length%4;)e=Buffer.concat([e,Buffer.from([0])]);return nd.serialize(this.type,this.chunks.length,e,e.length/4)}static deSerialize(e,t){const r=[];for(let t=0;t<e.length;){const n=Jh.deSerialize(e.slice(t));r.push(n),t+=n.length}return new Qh({chunks:r})}}class Jh{items=[];constructor(e={}){Object.assign(this,e)}get length(){let e=4;return this.items.forEach((t=>e+=t.length)),e+=1,e+=Zh(e),e}serialize(){const e=Buffer.concat([fh([4],[this.source]),Buffer.concat(this.items.map((e=>e.serialize())))]);return Buffer.concat([e,Buffer.alloc(Zh(e.length))])}static deSerialize(e){const t=e.readUInt32BE(),r=[];for(let t=4;t<e.length;){if(0===e[t])break;const n=Xh.deSerialize(e.slice(t));r.push(n),t+=n.length}return new Jh({source:t,items:r})}}class Xh{constructor(e){Object.assign(this,e)}get length(){return 2+Buffer.from(this.text).length}serialize(){const e=Buffer.from(this.text);return Buffer.concat([fh([1,1],[this.type,e.length]),e])}static deSerialize(e){const t=e[0],r=e[1],n=e.slice(2,2+r).toString();return new Xh({type:t,text:n})}}function Zh(e){return e%4==0?0:4-e%4}class ed{ssrc=0;reports=[];static type=200;type=ed.type;constructor(e){Object.assign(this,e)}serialize(){let e=Buffer.alloc(4);return e.writeUInt32BE(this.ssrc),e=Buffer.concat([e,this.senderInfo.serialize()]),e=Buffer.concat([e,...this.reports.map((e=>e.serialize()))]),nd.serialize(ed.type,this.reports.length,e,Math.floor(e.length/4))}static deSerialize(e,t){const r=e.readUInt32BE(),n=td.deSerialize(e.slice(4,24));let i=24;const s=[];for(const r of Mh()(t))s.push(kh.deSerialize(e.slice(i,i+24))),i+=24;return new ed({ssrc:r,senderInfo:n,reports:s})}}class td{constructor(e={}){Object.assign(this,e)}serialize(){return fh([8,4,4,4],[this.ntpTimestamp,this.rtpTimestamp,this.packetCount,this.octetCount])}static deSerialize(e){const[t,r,n,i]=yh(e,[8,4,4,4]);return new td({ntpTimestamp:t,rtpTimestamp:r,packetCount:n,octetCount:i})}}const rd=vh()("werift-rtp:packages/rtp/src/rtcp/rtcp.ts");class nd{static serialize(e,t,r,n){const i=new Bh({type:e,count:t,version:2,length:n}).serialize();return Buffer.concat([i,r])}static deSerialize(e){let t=0;const r=[];for(;t<e.length;){const n=Bh.deSerialize(e.subarray(t,t+4));t+=4;let i=e.subarray(t);t+=4*n.length,n.padding&&(i=i.subarray(0,i.length-i.subarray(-1)[0]));try{switch(n.type){case ed.type:r.push(ed.deSerialize(i,n.count));break;case Lh.type:r.push(Lh.deSerialize(i,n.count));break;case Qh.type:r.push(Qh.deSerialize(i,n));break;case Yh.type:r.push(Yh.deSerialize(i,n));break;case cd.type:r.push(cd.deSerialize(i,n))}}catch(e){rd("deSerialize RTCP",e)}}return r}}class id{static count=4;count=id.count;fir=[];constructor(e={}){Object.assign(this,e)}get length(){return Math.floor(this.serialize().length/4-1)}static deSerialize(e){const[t,r]=yh(e,[4,4]),n=[];for(let t=8;t<e.length;t+=8)n.push({ssrc:e.readUInt32BE(t),sequenceNumber:e[t+4]});return new id({senderSsrc:t,mediaSsrc:r,fir:n})}serialize(){const e=fh([4,4],[this.senderSsrc,this.mediaSsrc]),t=Buffer.alloc(8*this.fir.length);return this.fir.forEach((({ssrc:e,sequenceNumber:r},n)=>{t.writeUInt32BE(e,8*n),t[8*n+4]=r})),Buffer.concat([e,t])}}class sd{static count=1;count=sd.count;length=2;constructor(e={}){Object.assign(this,e)}static deSerialize(e){const[t,r]=yh(e,[4,4]);return new sd({senderSsrc:t,mediaSsrc:r})}serialize(){return fh([4,4],[this.senderSsrc,this.mediaSsrc])}}class od{static count=15;count=od.count;uniqueID="REMB";ssrcNum=0;ssrcFeedbacks=[];constructor(e={}){Object.assign(this,e)}static deSerialize(e){const[t,r,n,i,s]=yh(e,[4,4,4,1,1]),o=lh(s,0,6),a=(lh(s,6,2)<<16)+(e[14]<<8)+e[15],c=o>46?18446744073709551615n:BigInt(a)<<BigInt(o),u=[];for(let t=16;t<e.length;t+=4){const r=e.slice(t).readUIntBE(0,4);u.push(r)}return new od({senderSsrc:t,mediaSsrc:r,uniqueID:fh([4],[n]).toString(),ssrcNum:i,brExp:o,brMantissa:a,ssrcFeedbacks:u,bitrate:c})}serialize(){const e=Buffer.concat([fh([4,4],[this.senderSsrc,this.mediaSsrc]),Buffer.from(this.uniqueID),fh([1],[this.ssrcNum])]),t=new hh(24);t.set(6,0,this.brExp).set(18,6,this.brMantissa);const r=Buffer.concat(this.ssrcFeedbacks.map((e=>fh([4],[e])))),n=Buffer.concat([e,fh([3],[t.value]),r]);return this.length=n.length/4,n}}const ad=vh()("werift/rtp/rtcp/psfb/index");class cd{static type=206;type=cd.type;constructor(e={}){Object.assign(this,e)}serialize(){const e=this.feedback.serialize();return nd.serialize(this.type,this.feedback.count,e,this.feedback.length)}static deSerialize(e,t){let r;switch(t.count){case id.count:r=id.deSerialize(e);break;case sd.count:r=sd.deSerialize(e);break;case od.count:r=od.deSerialize(e);break;default:ad("unknown psfb packet",t.count)}return new cd({feedback:r})}}(0,gh.debug)("packages/rtp/src/rtp/red/packet.ts");var ud=r(243);class hd{constructor(e,t,r,n){this.srtpSessionKey=e,this.srtpSessionSalt=t,this.srtcpSessionKey=r,this.srtcpSessionSalt=n}encryptRtp(e,t,r){return Buffer.from([])}decryptRtp(e,t){return[]}encryptRTCP(e,t){return Buffer.from([])}decryptRTCP(e){return[]}}class dd extends hd{authTagLength=10;constructor(e,t,r,n,i,s){super(e,t,r,n),this.srtpSessionAuthTag=i,this.srtcpSessionAuthTag=s}encryptRtp(e,t,r){const n=e.serialize(e.serializeSize),i=this.generateCounter(e.sequenceNumber,r,e.ssrc,this.srtpSessionSalt),s=(0,f.createCipheriv)("aes-128-ctr",this.srtpSessionKey,i).update(t),o=this.generateSrtpAuthTag(r,n,s);return Buffer.concat([n,s,o])}decryptRtp(e,t){const r=Ah.deSerialize(e),n=e.length-this.authTagLength;e=e.subarray(0,e.length-this.authTagLength);const i=this.generateCounter(r.sequenceNumber,t,r.ssrc,this.srtpSessionSalt),s=(0,f.createDecipheriv)("aes-128-ctr",this.srtpSessionKey,i),o=e.subarray(r.payloadOffset),a=s.update(o);return[Buffer.concat([e.subarray(0,r.payloadOffset),a,Buffer.alloc(n-r.payloadOffset-a.length)]),r]}encryptRTCP(e,t){let r=Buffer.from(e);const n=r.readUInt32BE(4),i=this.generateCounter(65535&t,t>>16,n,this.srtcpSessionSalt);(0,f.createCipheriv)("aes-128-ctr",this.srtcpSessionKey,i).update(r.slice(8)).copy(r,8),r=Buffer.concat([r,Buffer.alloc(4)]),r.writeUInt32BE(t,r.length-4),r[r.length-4]|=128;const s=this.generateSrtcpAuthTag(r);return r=Buffer.concat([r,s]),r}decryptRTCP(e){const t=Bh.deSerialize(e),r=e.length-(this.authTagLength+ld),n=Buffer.from(e).slice(0,r);if(0===e[r]>>7)return[n,t];let i=e.readUInt32BE(r);i&=~(1<<31);const s=e.readUInt32BE(4),o=(e.subarray(e.length-10),this.generateCounter(65535&i,i>>16,s,this.srtcpSessionSalt));return(0,f.createDecipheriv)("aes-128-ctr",this.srtcpSessionKey,o).update(n.subarray(8)).copy(n,8),[n,t]}generateSrtcpAuthTag(e){return(0,f.createHmac)("sha1",this.srtcpSessionAuthTag).update(e).digest().slice(0,10)}generateCounter(e,t,r,n){const i=Buffer.alloc(16);i.writeUInt32BE(r,4),i.writeUInt32BE(t,8),i.writeUInt32BE(Number(BigInt(e)<<16n),12);for(let e=0;e<n.length;e++)i[e]^=n[e];return i}generateSrtpAuthTag(e,...t){const r=(0,f.createHmac)("sha1",this.srtpSessionAuthTag),n=Buffer.alloc(4);n.writeUInt32BE(e);for(const e of t)r.update(e);return r.update(n).digest().subarray(0,10)}}const ld=4;function fd(e,t){const r=Buffer.alloc(t);return e.copy(r),r}class pd extends hd{aeadAuthTagLen=16;rtpIvWriter=ph([2,4,4,2],!0);rtcpIvWriter=ph([2,4,2,4],!0);aadWriter=ph([4],!0);constructor(e,t,r,n){super(e,t,r,n)}encryptRtp(e,t,r){const n=e.serialize(e.serializeSize),i=this.rtpInitializationVector(e,r),s=(0,f.createCipheriv)("aes-128-gcm",this.srtpSessionKey,i);s.setAAD(n);const o=s.update(t);s.final();const a=s.getAuthTag();return Buffer.concat([n,o,a])}decryptRtp(e,t){const r=Ah.deSerialize(e);let n=Buffer.from([]);n=fd(n,e.length-this.aeadAuthTagLen),e.slice(0,r.payloadOffset).copy(n);const i=this.rtpInitializationVector(r,t),s=e.slice(r.payloadOffset,e.length-this.aeadAuthTagLen);return(0,f.createDecipheriv)("aes-128-gcm",this.srtpSessionKey,i).update(s).copy(n,r.payloadOffset),[n,r]}encryptRTCP(e,t){const r=e.readUInt32BE(4),n=e.length+this.aeadAuthTagLen;let i=Buffer.from([]);i=fd(i,n+yd),e.slice(0,8).copy(i);const s=this.rtcpInitializationVector(r,t),o=this.rtcpAdditionalAuthenticatedData(e,t),a=(0,f.createCipheriv)("aes-128-gcm",this.srtcpSessionKey,s);a.setAAD(o);const c=a.update(e.slice(8));a.final(),c.copy(i,8);return a.getAuthTag().copy(i,8+c.length),o.slice(8,12).copy(i,n),i}decryptRTCP(e){const t=Bh.deSerialize(e),r=e.length-yd,n=Buffer.alloc(r-this.aeadAuthTagLen);e.slice(0,8).copy(n);const i=e.readUInt32BE(4);let s=e.readUInt32BE(e.length-4);s&=~(md<<24);const o=this.rtcpInitializationVector(i,s),a=this.rtcpAdditionalAuthenticatedData(e,s),c=(0,f.createDecipheriv)("aes-128-gcm",this.srtcpSessionKey,o);c.setAAD(a);return c.update(e.slice(8,r)).copy(n,8),[n,t]}rtpInitializationVector(e,t){const r=this.rtpIvWriter([0,e.ssrc,t,e.sequenceNumber]);for(let e=0;e<r.length;e++)r[e]^=this.srtpSessionSalt[e];return r}rtcpInitializationVector(e,t){const r=this.rtcpIvWriter([0,e,0,t]);for(let e=0;e<r.length;e++)r[e]^=this.srtcpSessionSalt[e];return r}rtcpAdditionalAuthenticatedData(e,t){const r=Buffer.concat([e.subarray(0,8),this.aadWriter([t])]);return r[8]|=md,r}}const yd=4,md=128;class gd{srtpSSRCStates={};srtcpSSRCStates={};constructor(e,t,r){this.masterKey=e,this.masterSalt=t,this.profile=r;{const e=14-t.length;e>0&&(this.masterSalt=Buffer.concat([t,Buffer.alloc(e)]))}switch(this.srtpSessionKey=this.generateSessionKey(0),this.srtpSessionSalt=this.generateSessionSalt(2),this.srtpSessionAuthTag=this.generateSessionAuthTag(1),this.srtpSessionAuth=(0,f.createHmac)("sha1",this.srtpSessionAuthTag),this.srtcpSessionKey=this.generateSessionKey(3),this.srtcpSessionSalt=this.generateSessionSalt(5),this.srtcpSessionAuthTag=this.generateSessionAuthTag(4),this.srtcpSessionAuth=(0,f.createHmac)("sha1",this.srtcpSessionAuthTag),r){case 1:this.cipher=new dd(this.srtpSessionKey,this.srtpSessionSalt,this.srtcpSessionKey,this.srtcpSessionSalt,this.srtpSessionAuthTag,this.srtcpSessionAuthTag);break;case 7:this.cipher=new pd(this.srtpSessionKey,this.srtpSessionSalt,this.srtcpSessionKey,this.srtcpSessionSalt)}}generateSessionKey(e){let t=Buffer.from(this.masterSalt);const r=Buffer.from([e,0,0,0,0,0,0]);for(let e=r.length-1,n=t.length-1;e>=0;e--,n--)t[n]=t[n]^r[e];t=Buffer.concat([t,Buffer.from([0,0])]);const n=new ud.AES(this.masterKey);return Buffer.from(n.encrypt(t))}generateSessionSalt(e){let t=Buffer.from(this.masterSalt);const r=Buffer.from([e,0,0,0,0,0,0]);for(let e=r.length-1,n=t.length-1;e>=0;e--,n--)t[n]=t[n]^r[e];t=Buffer.concat([t,Buffer.from([0,0])]);const n=new ud.AES(this.masterKey);return t=Buffer.from(n.encrypt(t)),t.slice(0,14)}generateSessionAuthTag(e){const t=Buffer.from(this.masterSalt),r=Buffer.from([e,0,0,0,0,0,0]);for(let e=r.length-1,n=t.length-1;e>=0;e--,n--)t[n]=t[n]^r[e];let n=Buffer.concat([t,Buffer.from([0,0])]),i=Buffer.concat([t,Buffer.from([0,1])]);const s=new ud.AES(this.masterKey);return n=Buffer.from(s.encrypt(n)),i=Buffer.from(s.encrypt(i)),Buffer.concat([n,i.slice(0,4)])}getSrtpSsrcState(e){let t=this.srtpSSRCStates[e];return t||(t={ssrc:e,rolloverCounter:0,lastSequenceNumber:0},this.srtpSSRCStates[e]=t,t)}getSrtcpSsrcState(e){let t=this.srtcpSSRCStates[e];return t||(t={srtcpIndex:0,ssrc:e},this.srtcpSSRCStates[e]=t,t)}updateRolloverCount(e,t){t.rolloverHasProcessed?0===e?t.lastSequenceNumber>vd&&t.rolloverCounter++:t.lastSequenceNumber<vd&&e>bd-vd?t.rolloverCounter>0&&t.rolloverCounter--:e<vd&&t.lastSequenceNumber>bd-vd&&t.rolloverCounter++:t.rolloverHasProcessed=!0,t.lastSequenceNumber=e}generateSrtpAuthTag(e,t){this.srtpSessionAuth=(0,f.createHmac)("sha1",this.srtpSessionAuthTag);const r=Buffer.alloc(4);return r.writeUInt32BE(t),this.srtpSessionAuth.update(e).update(r).digest().slice(0,10)}index(e){const t=this.srtcpSSRCStates[e];return t?t.srtcpIndex:0}setIndex(e,t){this.getSrtcpSsrcState(e).srtcpIndex=t%2147483647}}const vd=100,bd=65535;class Ed extends gd{constructor(e,t,r){super(e,t,r)}encryptRTCP(e){const t=e.readUInt32BE(4),r=this.getSrtcpSsrcState(t);r.srtcpIndex++,r.srtcpIndex>>Sd&&(r.srtcpIndex=0);return this.cipher.encryptRTCP(e,r.srtcpIndex)}decryptRTCP(e){return this.cipher.decryptRTCP(e)}}const Sd=2147483647;class Ad{constructor(e){this.ContextCls=e}start(e,t,r,n,i){this.localContext=new this.ContextCls(e,t,i),this.remoteContext=new this.ContextCls(r,n,i)}}class Id extends Ad{constructor(e){super(Ed),this.config=e,this.start(e.keys.localMasterKey,e.keys.localMasterSalt,e.keys.remoteMasterKey,e.keys.remoteMasterSalt,e.profile)}decrypt=e=>{const[t]=this.remoteContext.decryptRTCP(e);return t};encrypt(e){return this.localContext.encryptRTCP(e)}}class wd extends gd{constructor(e,t,r){super(e,t,r)}encryptRtp(e,t){const r=this.getSrtpSsrcState(t.ssrc);this.updateRolloverCount(t.sequenceNumber,r);return this.cipher.encryptRtp(t,e,r.rolloverCounter)}decryptRtp(e){const t=Ah.deSerialize(e),r=this.getSrtpSsrcState(t.ssrc);this.updateRolloverCount(t.sequenceNumber,r);return this.cipher.decryptRtp(e,r.rolloverCounter)}}class Td extends Ad{constructor(e){super(wd),this.config=e,this.start(e.keys.localMasterKey,e.keys.localMasterSalt,e.keys.remoteMasterKey,e.keys.remoteMasterSalt,e.profile)}decrypt=e=>{const[t]=this.remoteContext.decryptRtp(e);return t};encrypt(e,t){return this.localContext.encryptRtp(e,t)}}var Cd=r(5747),_d=r(7761);const Dd=require("tls");var Rd=r.n(Dd);class Nd{finished=!1;promise=new Promise(((e,t)=>{this.resolve=t=>{this.finished=!0,e(t)},this.reject=e=>{this.finished=!0,t(e)}}))}function Od(e){let t=e.split("\n").map((e=>e.trim()));t=t.filter((e=>!e.includes("a=control:")));let r=0;for(let e=0;e<t.length;e++){t[e].startsWith("m=")&&(t.splice(e+1,0,"a=control:trackID="+r),r++)}return t.join("\r\n")}function Ud(e){const t=[];for(const r of e.split(" ").slice(3)||[])t.push(parseInt(r));return t}function Pd(e){return e.filter((e=>e.startsWith("a=fmtp"))).map((e=>{const t=e.indexOf(" ");if(-1===t)return;const r=e.substring(0,t),n=e.substring(t+1),i=parseInt(r.split(":")[1]);if(!r||!n||Number.isNaN(i))return;const s={};return n.split(";").map((e=>e.trim())).forEach((e=>{const[t,...r]=e.split("=");s[t]=r.join("=")})),{payloadType:i,parameters:s}})).filter((e=>!!e))}function Bd(e,t){const r=t?.match(/a=rtpmap:([\d]+) (.*?)\/([\d]+)/);let n;return t=t?.toLowerCase(),t?.includes("mpeg4")?n="aac":t?.includes("opus")?n="opus":t?.includes("pcma")?n="pcm_alaw":t?.includes("pcmu")?n="pcm_ulaw":t?.includes("pcm")?n="pcm":t?.includes("h264")?n="h264":t?.includes("h265")?n="h265":t||"audio"!==e||(n="pcm_alaw"),{line:t,codec:n,rawCodec:r?.[2],clock:parseInt(r?.[3]),payloadType:parseInt(r?.[1])}}const xd="a=control:",Md="a=rtpmap:";function Ld(e){const t=e.find((e=>e.startsWith(xd)))?.substring(xd.length),r=e.find((e=>e.startsWith(Md))),n=function(e){const t=e.split(" ");return{type:t[0].substring(2),port:parseInt(t[1]),protocol:t[2],payloadTypes:Ud(e)}}(e[0]);let i=Bd(n.type,r).codec;const s=e.filter((e=>e.startsWith(Md))).map((e=>Bd(n.type,e)));let o;for(const t of["sendonly","sendrecv","recvonly","inactive"]){if(e.find((e=>e==="a="+t))){o=t;break}}const a={...n,fmtp:Pd(e),lines:e,rtpmaps:s,contents:e.join("\r\n"),control:t,codec:i,direction:o,toSdp:()=>a.lines.join("\r\n")};return a}function kd(e){const t=e.split("\n").map((e=>e.trim())),r=[],n=[];let i;for(const e of t)e.startsWith("m=")&&(i&&n.push(i),i=[]),i?i.push(e):r.push(e);i&&n.push(i);const s={header:{lines:r,contents:r.join("\r\n")},msections:n.map(Ld),toSdp:()=>[...s.header.lines,...s.msections.map((e=>e.lines)).flat()].join("\r\n")};return s}const Fd=["realm","nonce"];function Vd(e,t=!1,r=!1){const n=new Set,i=31&e[0];if(24===i){n.add(24);let t=1;for(;t<e.length;){const r=e.readUInt16BE(t);t+=2;const i=31&e[t];n.add(i),t+=r}}else if(28===i){n.add(28);const i=31&e[1];if(t){!!(128&e[1])&&n.add(i)}else if(r){!!(64&e[1])&&n.add(i)}else n.add(i)}else n.add(i);return n}function Hd(e){const t={};for(const r of e.slice(1)){const e=r.indexOf(":");let n="";-1!==e&&(n=r.substring(e+1).trim());t[r.substring(0,e).toLowerCase()]=n}return t}class jd extends Error{constructor(e){super(`RTSP Error: ${e.line}`),this.status=e}}class Kd extends class{constructor(){}write(e,t,r){let n=`${e}\r\n`;r&&(t["Content-Length"]=r.length.toString());for(const[e,r]of Object.entries(t))n+=`${e}: ${r}\r\n`;n+="\r\n",this.client.write(n),this.console?.log("rtsp outgoing message\n",n),this.console?.log(),r&&this.client.write(r)}async readMessage(){const e=await async function(e){let t=[];for(;;){let r=await Du(e);if(r=r.trim(),!r)return t;t.push(r)}}(this.client);return this.console?.log("rtsp incoming message\n",e.join("\n")),this.console?.log(),e}}{cseq=0;needKeepAlive=!1;setupOptions=new Map;issuedTeardown=!1;hasGetParameter=!0;constructor(e){super(),this.url=e;const t=new URL(e),r=parseInt(t.port)||554;e.startsWith("rtsps")?this.client=Rd().connect({rejectUnauthorized:!1,port:r,host:t.hostname}):this.client=m().connect(r,t.hostname),this.client.on("error",(e=>{this.console?.log("client error",e)}))}async safeTeardown(){if(!this.issuedTeardown){this.issuedTeardown=!0;try{this.writeTeardown(),await async function(e){await new Promise((t=>setTimeout(t,e)))}(500)}catch(e){}finally{this.client.destroy()}}}writeRequest(e,t,r,n){t=t||{};let i=this.url;r&&(r.includes("rtsp://")||r.includes("rtsps://")?i=r:i+=(i.endsWith("/")?"":"/")+r);const s=new URL(i);s.username="",s.password="";const o=`${e} ${s} RTSP/1.0`,a=this.cseq++;t.CSeq=a.toString(),t["User-Agent"]="Scrypted",this.wwwAuthenticate&&(t.Authorization=this.createAuthorizationHeader(e,new URL(i))),this.session&&(t.Session=this.session),this.write(o,t,n)}async handleDataPayload(e){if(36!==e[0])throw new Error("RTSP Client received invalid frame magic. This may be a bug in your camera firmware. If this error persists, switch your RTSP Parser to FFmpeg or Scrypted (UDP): "+e.toString());const t=e.readUInt8(1),r=e.readUInt16BE(2),n=await Cu(this.client,r);this.setupOptions.get(t)?.onRtp?.(e,n)}async readDataPayload(){const e=await Cu(this.client,4);return this.handleDataPayload(e)}createBadHeader(e){return new Error("RTSP Client received invalid frame magic. This may be a bug in your camera firmware. If this error persists, switch your RTSP Parser to FFmpeg or Scrypted (UDP): "+e.toString())}async readLoopLegacy(){try{for(;;)this.needKeepAlive&&(this.needKeepAlive=!1,this.hasGetParameter?await this.getParameter():await this.options()),await this.readDataPayload()}catch(e){throw this.client.destroy(e),e}}async readLoop(){const e=new Nd;let t,r,n;const i=async()=>{this.needKeepAlive&&(this.needKeepAlive=!1,this.hasGetParameter?this.writeGetParameter():this.writeOptions());try{for(;;){if(!t){if(t=this.client.read(4),!t)return;if(36!==t[0]){if("RTSP"!==t.toString())throw this.createBadHeader(t);this.client.unshift(t),t=void 0,this.client.removeListener("readable",i);const e=await super.readMessage();await this.readBody(Hd(e));this.client.on("readable",i);continue}r=t.readUInt8(1),n=t.readUInt16BE(2)}const e=this.client.read(n);if(!e)return;const s=t;t=void 0;this.setupOptions.get(r)?.onRtp?.(s,e)}}catch(t){e.reject(t),this.client.destroy()}};i(),this.client.on("readable",i),await Promise.all([(0,l.once)(this.client,"end")])}async readMessage(){for(;;){const e=await Cu(this.client,4);if(36!==e[0]){if("RTSP"===e.toString()){this.client.unshift(e);return await super.readMessage()}throw this.createBadHeader(e)}await this.handleDataPayload(e)}}createAuthorizationHeader(e,t){if(!this.wwwAuthenticate)throw new Error("no WWW-Authenticate found");if(this.wwwAuthenticate.includes("Basic")){return`Basic ${Cd.rh.computeHash(t)}`}const r=(0,_d.parseHTTPHeadersQuotedKeyValueSet)(this.wwwAuthenticate,{indexOf:()=>0},Fd),n=new URL(this.url),i=decodeURIComponent(n.username),s=decodeURIComponent(n.password),o=new URL(t);o.username="",o.password="";const a=p().createHash("md5").update(`${i}:${r.realm}:${s}`).digest("hex"),c=p().createHash("md5").update(`${e}:${o}`).digest("hex"),u=p().createHash("md5").update(`${a}:${r.nonce}:${c}`).digest("hex"),h={username:i,realm:r.realm,nonce:r.nonce,uri:o.toString(),algorithm:"MD5",response:u};return`Digest ${Object.entries(h).map((([e,t])=>{return`${e}=${t&&(r=t,`"${r.replace(/"/g,'\\"')}"`)}`;var r})).join(", ")}`}async readBody(e){const t=parseInt(e["content-length"]);if(t)return Cu(this.client,t)}async request(e,t,r,n,i){this.writeRequest(e,t,r,n);const s=this.requestTimeout?await Pu(this.requestTimeout,this.readMessage()):await this.readMessage(),o=s[0],[a,c,u]=o.split(" ",3),h=parseInt(c),d=Hd(s),l={line:o,code:h,version:a,reason:u};if(200!==h&&!d["www-authenticate"])throw new jd(l);const f=function(e){for(const t of e.slice(1)){const e=t.indexOf(":");let r="";if(-1!==e&&(r=t.substring(e+1).trim()),"www-authenticate"===t.substring(0,e).toLowerCase())return r}}(s)||d["www-authenticate"];if(f){if(i)throw new Error("auth failed");return this.wwwAuthenticate=f,this.request(e,t,r,n,!0)}return{headers:d,body:await this.readBody(d),status:l}}async options(){const e=await this.request("OPTIONS",{}),t=e.headers.public;return t&&(this.hasGetParameter=t.toLowerCase().includes("get_parameter")),e}writeOptions(){return this.writeRequest("OPTIONS")}async getParameter(){return this.request("GET_PARAMETER")}writeGetParameter(){return this.writeRequest("GET_PARAMETER")}async describe(e){return this.request("DESCRIBE",{...e||{},Accept:"application/sdp"})}async setup(e){const t="udp"===e.type?"":"/TCP",r="udp"===e.type?"client_port":"interleaved";let n;if("tcp"===e.type)n=e.port;else{if(!e.dgram){const t=await lu();e.dgram=t.server,this.client.on("close",(()=>hu(t.server)))}n=e.dgram.address().port,e.dgram.on("message",(t=>e.onRtp(void 0,t)))}const i={Transport:`RTP/AVP${t};unicast;${r}=${n}-${n+1}`},s=await this.request("SETUP",i,e.path);let o;if(s.headers.session){const e=function(e){const t={};for(const r of e.split(";")){const[e,n]=r.split("=",2);t[e]=n}return t}(s.headers.session);let t=parseInt(e.timeout);if(t){let e=setInterval((()=>this.needKeepAlive=!0),1e3*(t-5));this.client.once("close",(()=>clearInterval(e)))}this.session=s.headers.session.split(";")[0]}if(s.headers.transport){const e=s.headers.transport.match(/.*?interleaved=([0-9]+)-([0-9]+)/);if(e){const[t,r,n]=e;r&&n&&(o={begin:parseInt(r),end:parseInt(n)})}}return"tcp"===e.type&&this.setupOptions.set(o?o.begin:n,e),Object.assign({interleaved:o,options:e},s)}async play(e={},t="0.000"){return e.Range=`npt=${t}-`,this.request("PLAY",e)}writePlay(e="0.000"){const t={Range:`npt=${e}-`};return this.writeRequest("PLAY",t)}writeRtpPayload(e,t){return this.client.write(e),this.client.write(Buffer.from(t))}send(e,t){const r=Buffer.alloc(4);return r.writeUInt8(36,0),r.writeUInt8(t,1),r.writeUInt16BE(e.length,2),this.writeRtpPayload(r,e)}async pause(){return this.request("PAUSE")}async teardown(){try{return await this.request("TEARDOWN")}finally{this.client.destroy()}}writeTeardown(){this.writeRequest("TEARDOWN")}}class qd{setupTracks={};constructor(e,t,r,n){this.client=e,this.sdp=t,this.udp=r,this.checkRequest=n,this.session=(0,f.randomBytes)(4).toString("hex"),t&&(t=t.trim()),e instanceof m().Socket&&e.setNoDelay(!0)}async handleSetup(e=["play","record","teardown"]){let t=[];for(;;){let r=await Du(this.client);if(r=r.trim(),r)t.push(r);else{const r=await this.headers(t);if(e.includes(r))return r;t=[]}}}async handlePlayback(){return this.handleSetup()}async handleTeardown(){return this.handleSetup()}async*handleRecord(){for(;;){const e=await Cu(this.client,4);if(36!==e[0])throw new Error("RTSP Server expected frame magic but received: "+e.toString());const t=e.readUInt16BE(2),r=await Cu(this.client,t),n=e.readUInt8(1),i=n-n%2,s=Object.values(this.setupTracks).find((e=>e.destination===i));if(!s)throw new Error("RSTP Server received unknown channel: "+n);yield{type:s.codec,rtcp:n%2==1,header:e,packet:r}}}writeRtpPayload(e,t){return this.client.write(e),this.client.write(Buffer.from(t))}send(e,t){const r=Buffer.alloc(4);return r.writeUInt8(36,0),r.writeUInt8(t,1),r.writeUInt16BE(e.length,2),this.writeRtpPayload(r,e)}sendUdp(e,t,r){e.send(r,t,"127.0.0.1")}sendTrack(e,t,r){const n=this.setupTracks[e];return n?"udp"===n.protocol?(this.udp?this.sendUdp(r?n.rtcp:n.rtp,n.destination,t):this.console?.warn("RTSP Server UDP socket not available."),!0):this.send(t,r?n.destination+1:n.destination):(this.console?.warn("RTSP Server track not found:",e),!0)}availableOptions=["DESCRIBE","OPTIONS","PAUSE","PLAY","SETUP","TEARDOWN","ANNOUNCE","RECORD","GET_PARAMETER"];options(e,t){const r={};r.Public=this.availableOptions.join(", "),this.respond(200,"OK",t,r)}async get_parameter(e,t){this.respond(200,"OK",t,{})}describe(e,t){const r={};r["Content-Base"]=e,r["Content-Type"]="application/sdp",this.respond(200,"OK",t,r,Buffer.from(this.sdp))}setupInterleaved(e,t,r){this.setupTracks[e.control]={control:e.control,protocol:"tcp",destination:t,codec:e.codec}}async setup(e,t){const r={};let n=t.transport;r.Session=this.session;const i=kd(this.sdp).msections.find((t=>e.endsWith(t.control)));if(i){if(n.includes("TCP"))if(this.resolveInterleaved){const[e,t]=this.resolveInterleaved(i);this.setupInterleaved(i,e,t),n=`RTP/AVP/TCP;unicast;interleaved=${e}-${t}`}else{const e=n.match(/.*?interleaved=([0-9]+)-([0-9]+)/);if(e){const t=parseInt(e[1]),r=parseInt(e[2]);this.setupInterleaved(i,t,r)}}else{if(!this.udp)return void this.respond(461,"Unsupported Transport",t,{});const e=n.match(/.*?client_port=([0-9]+)-([0-9]+)/),[r,s,o]=e,a=await lu(),c=await fu(a.port+1);this.client.on("close",(()=>hu(a.server))),this.client.on("close",(()=>hu(c.server))),this.setupTracks[i.control]={control:i.control,protocol:"udp",destination:parseInt(s),codec:i.codec,rtp:a.server,rtcp:c.server},n=n.replace("RTP/AVP/UDP","RTP/AVP").replace("RTP/AVP","RTP/AVP/UDP"),n+=`;server_port=${a.port}-${c.port}`}r.Transport=n,this.respond(200,"OK",t,r)}else this.respond(404,"Not Found",t,r)}play(e,t){const r={},n=Object.values(this.setupTracks).map((t=>`url=${e}/${t.control}`)).join(",");r["RTP-Info"]=n,r.Range="npt=now-",r.Session=this.session,this.respond(200,"OK",t,r)}async announce(e,t){const r=parseInt(t["content-length"]),n=await Cu(this.client,r);this.sdp=n.toString();const i={};i.Session=this.session,this.respond(200,"OK",t,i)}async record(e,t){const r={};r.Session=this.session,this.respond(200,"OK",t,r)}async teardown(e,t){const r={};r.Session=this.session,this.respond(200,"OK",t,r),this.client.destroy()}async headers(e){this.console?.log("request headers",e.join("\n"));let[t,r]=e[0].split(" ",2);t=t.toLowerCase();const n=Hd(e);if(this.checkRequest){let i;try{i=await this.checkRequest(t,r,n,e)}catch(e){this.console?.error("error checking request",e)}if(!i)throw this.respond(400,"Bad Request",n,{}),this.client.destroy(),new Error("check request failed")}if(this[t]&&this.availableOptions.includes(t.toUpperCase()))return await this[t](r,n),t;this.respond(400,"Bad Request",n,{})}respond(e,t,r,n,i){let s=`RTSP/1.0 ${e} ${t}\r\n`;r.cseq&&(n.CSeq=r.cseq),i&&(n["Content-Length"]=i.length.toString());for(const[e,t]of Object.entries(n))s+=`${e}: ${t}\r\n`;this.console?.log("response headers",s),s+="\r\n",this.client.write(s),i&&(this.client.write(i),this.console?.log("response body",i.toString()))}destroy(){this.client.destroy();for(const e of Object.values(this.setupTracks))hu(e.rtp),hu(e.rtcp)}}var Gd=r(2499),zd=r.n(Gd);const{systemManager:$d,mediaManager:Wd}=i();function Yd(e,r,n,i){let s;const o=r=>s||(s=e.interfaces.includes(t.ScryptedInterface.Camera)?e.takePicture({picture:{width:r.width,height:r.height}}).then((e=>Wd.convertMediaObjectToBuffer(e,"image/jpeg"))):Promise.reject(new Error("Camera does not provide native snapshots. Please install the Snapshot Plugin.")),s.finally((()=>{s=void 0})),s),a=zd()(o,9e3,{leading:!0,trailing:!0});function c(e){for(const t of n.snapshotThrottles.values())t(e)}return n.snapshotThrottles.set(e.id,o),async function(t,r){try{if(t.reason)return i.log("snapshot requested for reason:",t.reason),void r(null,await o(t));c(t),c(t),r(null,await a(t))}catch(t){i.error("snapshot error",t),function(e,t,r){$d.getDeviceByName("@scrypted/snapshot")||(e.log(r),t.a(r))}(i,n.log,`${e.name} encountered an error while retrieving a new snapshot. Consider installing the Snapshot Plugin to show the most recent snapshot. origin:/#/component/plugin/install/@scrypted/snapshot}`),r(t)}}}Object.values({TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_49195:49195,TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256_49199:49199});const Qd={x25519_29:29,secp256r1_23:23};Object.values(Qd);var Jd=r(5498),Xd=r(2751);r(8679),r(3211);require("timers/promises"),require("worker_threads");vh()("werift-ice:packages/ice/src/helper.ts");const Zd=554869826;let el,tl;!function(e){e[e.REQUEST=0]="REQUEST",e[e.INDICATION=16]="INDICATION",e[e.RESPONSE=256]="RESPONSE",e[e.ERROR=272]="ERROR"}(el||(el={})),function(e){e[e.BINDING=1]="BINDING",e[e.SHARED_SECRET=2]="SHARED_SECRET",e[e.ALLOCATE=3]="ALLOCATE",e[e.REFRESH=4]="REFRESH",e[e.SEND=6]="SEND",e[e.DATA=7]="DATA",e[e.CREATE_PERMISSION=8]="CREATE_PERMISSION",e[e.CHANNEL_BIND=9]="CHANNEL_BIND"}(tl||(tl={}));r(5177);function rl(e){const[t]=e,r=Xd.isV4Format(t)?1:2;return Buffer.concat([Buffer.from(uh.T.Pack("!BBH",[0,r,e[1]])),Xd.toBuffer(t)])}function nl(e){if(e.length<4)throw new Error("STUN address length is less than 4 bytes");const[,t,r]=uh.T.Unpack("!BBH",e.slice(0,4)),n=e.slice(4);switch(t){case 1:if(4!=n.length)throw new Error("STUN address has invalid length for IPv4");return[Xd.toString(n),r];case 2:if(16!=n.length)throw new Error("STUN address has invalid length for IPv6");return[Xd.toString(n),r];default:throw new Error("STUN address has unknown protocol")}}function il(e,t){const r=[...uh.T.Pack("!HI",[8466,Zd]),...t];let n=e.slice(0,2);for(const t of Mh()(2,e.length)){const i=e[t]^r[t-2],s=Buffer.alloc(1);s.writeUIntBE(i,0,1),n=Buffer.concat([n,s])}return n}function sl(e,t){return nl(il(e,t))}function ol(e,t){return il(rl(e),t)}const al=e=>Buffer.from(uh.T.Pack("!I",[e])),cl=e=>uh.T.Unpack("!I",e)[0],ul=e=>new Jd.Int64BE(e.toString()).toBuffer(),hl=e=>{const t=new Jd.Int64BE(e);return BigInt(t.toString())},dl=e=>Buffer.from(e,"utf8"),ll=e=>e.toString("utf8"),fl=e=>e,pl=e=>e,yl=[[1,"MAPPED-ADDRESS",rl,nl],[3,"CHANGE-REQUEST",al,cl],[4,"SOURCE-ADDRESS",rl,nl],[5,"CHANGED-ADDRESS",rl,nl],[6,"USERNAME",dl,ll],[8,"MESSAGE-INTEGRITY",fl,pl],[9,"ERROR-CODE",function(e){const t=Buffer.from(uh.T.Pack("!HBB",[0,Math.floor(e[0]/100),e[0]%100])),r=Buffer.from(e[1],"utf8");return Buffer.concat([t,r])},function(e){if(e.length<4)throw new Error("STUN error code is less than 4 bytes");const[,t,r]=uh.T.Unpack("!HBB",e.slice(0,4));return[100*t+r,e.slice(4).toString("utf8")]}],[12,"CHANNEL-NUMBER",e=>Buffer.concat([Buffer.from(uh.T.Pack("!H",[e])),Buffer.from("\0\0")]),e=>uh.T.Unpack("!H",e.slice(0,2))[0]],[13,"LIFETIME",al,cl],[18,"XOR-PEER-ADDRESS",ol,sl],[19,"DATA",fl,pl],[20,"REALM",dl,ll],[21,"NONCE",fl,pl],[22,"XOR-RELAYED-ADDRESS",ol,sl],[25,"REQUESTED-TRANSPORT",al,cl],[32,"XOR-MAPPED-ADDRESS",ol,sl],[36,"PRIORITY",al,cl],[37,"USE-CANDIDATE",e=>Buffer.from([]),e=>null],[32802,"SOFTWARE",dl,ll],[32808,"FINGERPRINT",al,cl],[32809,"ICE-CONTROLLED",ul,hl],[32810,"ICE-CONTROLLING",ul,hl],[32811,"RESPONSE-ORIGIN",rl,nl],[32812,"OTHER-ADDRESS",rl,nl]];yl.reduce(((e,t)=>(e[t[0]]=t,e)),{}),yl.reduce(((e,t)=>(e[t[1]]=t,e)),{});vh()("werift-ice:packages/ice/src/transport.ts");class ml extends Error{}vh()("werift-ice:packages/ice/src/stun/transaction.ts");vh()("packages/ice/src/stun/protocol.ts");vh()("werift-ice:packages/ice/src/turn/protocol.ts");vh()("werift-ice : packages/ice/src/ice.ts : log");let gl;!function(e){e[e.FROZEN=0]="FROZEN",e[e.WAITING=1]="WAITING",e[e.IN_PROGRESS=2]="IN_PROGRESS",e[e.SUCCEEDED=3]="SUCCEEDED",e[e.FAILED=4]="FAILED"}(gl||(gl={}));vh()("werift:packages/webrtc/src/dataChannel.ts");const vl={auto:"actpass",client:"active",server:"passive"};Object.keys(vl).reduce(((e,t)=>(e[vl[t]]=t,e)),{});r(5075);class bl{rtcpFeedback=[];direction="all";constructor(e){Object.assign(this,e)}get name(){return this.mimeType.split("/")[1]}get contentType(){return this.mimeType.split("/")[0]}get str(){let e=`${this.name}/${this.clockRate}`;return 2===this.channels&&(e+="/2"),e}}require("perf_hooks");r(7219);class El{static isArrayBuffer(e){return"[object ArrayBuffer]"===Object.prototype.toString.call(e)}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e).slice().buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,t){if(e.constructor===t)return e;if(this.isArrayBuffer(e))return new t(e);if(this.isArrayBufferView(e))return new t(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,t){const r=El.toUint8Array(e),n=El.toUint8Array(t);if(r.length!==n.byteLength)return!1;for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}static concat(...e){if(Array.isArray(e[0])){const t=e[0];let r=0;for(const e of t)r+=e.byteLength;const n=new Uint8Array(r);let i=0;for(const e of t){const t=this.toUint8Array(e);n.set(t,i),i+=t.length}return e[1]?this.toView(n,e[1]):n.buffer}return this.concat(e)}}class Sl{static fromString(e){const t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r.buffer}static toString(e){const t=El.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return decodeURIComponent(escape(r))}}class Al{static toString(e,t=!1){const r=El.toArrayBuffer(e),n=new DataView(r);let i="";for(let e=0;e<r.byteLength;e+=2){const r=n.getUint16(e,t);i+=String.fromCharCode(r)}return i}static fromString(e,t=!1){const r=new ArrayBuffer(2*e.length),n=new DataView(r);for(let r=0;r<e.length;r++)n.setUint16(2*r,e.charCodeAt(r),t);return r}}class Il{static isHex(e){return"string"==typeof e&&/^[a-z0-9]+$/i.test(e)}static isBase64(e){return"string"==typeof e&&/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}static isBase64Url(e){return"string"==typeof e&&/^[a-zA-Z0-9-_]+$/i.test(e)}static ToString(e,t="utf8"){const r=El.toUint8Array(e);switch(t.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return Al.toString(r,!0);case"utf16":case"utf16be":return Al.toString(r);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromString(e,t="utf8"){if(!e)return new ArrayBuffer(0);switch(t.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return Al.fromString(e,!0);case"utf16":case"utf16be":return Al.fromString(e);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToBase64(e){const t=El.toUint8Array(e);if("undefined"!=typeof btoa){const e=this.ToString(t,"binary");return btoa(e)}return Buffer.from(t).toString("base64")}static FromBase64(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Il.isBase64(t))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return"undefined"!=typeof atob?this.FromBinary(atob(t)):new Uint8Array(Buffer.from(t,"base64")).buffer}static FromBase64Url(e){const t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Il.isBase64Url(t))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(t.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,t=Il.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.FromBinary(e);case"utf8":return Sl.fromString(e);case"utf16":case"utf16be":return Al.fromString(e);case"utf16le":case"usc2":return Al.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static ToUtf8String(e,t=Il.DEFAULT_UTF8_ENCODING){switch(t){case"ascii":return this.ToBinary(e);case"utf8":return Sl.toString(e);case"utf16":case"utf16be":return Al.toString(e);case"utf16le":case"usc2":return Al.toString(e,!0);default:throw new Error(`Unknown type of encoding '${t}'`)}}static FromBinary(e){const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r.buffer}static ToBinary(e){const t=El.toUint8Array(e);let r="";for(let e=0;e<t.length;e++)r+=String.fromCharCode(t[e]);return r}static ToHex(e){const t=El.toUint8Array(e),r=[],n=t.length;for(let e=0;e<n;e++){const n=t[e].toString(16).padStart(2,"0");r.push(n)}return r.join("")}static FromHex(e){let t=this.formatString(e);if(!t)return new ArrayBuffer(0);if(!Il.isHex(t))throw new TypeError("Argument 'hexString' is not HEX encoded");t.length%2&&(t=`0${t}`);const r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2){const n=t.slice(e,e+2);r[e/2]=parseInt(n,16)}return r.buffer}static ToUtf16String(e,t=!1){return Al.toString(e,t)}static FromUtf16String(e,t=!1){return Al.fromString(e,t)}static Base64Padding(e){const t=4-e.length%4;if(t<4)for(let r=0;r<t;r++)e+="=";return e}static formatString(e){return(null==e?void 0:e.replace(/[\n\r\t ]/g,""))||""}}function wl(...e){const t=e.map((e=>e.byteLength)).reduce(((e,t)=>e+t)),r=new Uint8Array(t);let n=0;return e.map((e=>new Uint8Array(e))).forEach((e=>{for(const t of e)r[n++]=t})),r.buffer}function Tl(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}function Cl(e,t){let r=0;if(1===e.length)return e[0];for(let n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function _l(e,t,r=-1){const n=r;let i=e,s=0,o=Math.pow(2,t);for(let r=1;r<8;r++){if(e<o){let e;if(n<0)e=new ArrayBuffer(r),s=r;else{if(n<r)return new ArrayBuffer(0);e=new ArrayBuffer(n),s=n}const o=new Uint8Array(e);for(let e=r-1;e>=0;e--){const r=Math.pow(2,e*t);o[s-e-1]=Math.floor(i/r),i-=o[s-e-1]*r}return e}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function Dl(...e){let t=0,r=0;for(const r of e)t+=r.length;const n=new ArrayBuffer(t),i=new Uint8Array(n);for(const t of e)i.set(t,r),r+=t.length;return i}function Rl(){const e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}const t=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(t);for(let e=0;e<this.valueHex.byteLength;e++)r[e]=0;r[0]=128&e[0];const n=Cl(r,8),i=new ArrayBuffer(this.valueHex.byteLength),s=new Uint8Array(i);for(let t=0;t<this.valueHex.byteLength;t++)s[t]=e[t];s[0]&=127;return Cl(s,8)-n}function Nl(e,t){const r=e.toString(10);if(t<r.length)return"";const n=t-r.length,i=new Array(n);for(let e=0;e<n;e++)i[e]="0";return i.join("").concat(r)}Il.DEFAULT_UTF8_ENCODING="utf8";Math.log(2);function Ol(){if("undefined"==typeof BigInt)throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function Ul(e){let t=0,r=0;for(let r=0;r<e.length;r++){t+=e[r].byteLength}const n=new Uint8Array(t);for(let t=0;t<e.length;t++){const i=e[t];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function Pl(e,t,r,n){return t instanceof Uint8Array?t.byteLength?r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0)||(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):(e.error="Wrong parameter: inputBuffer has zero length",!1):(e.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class Bl{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return Ul(this.items)}}const xl=[new Uint8Array([1])],Ml="0123456789",Ll="name",kl="valueHexView",Fl="",Vl=new ArrayBuffer(0),Hl=new Uint8Array(0),jl="EndOfContent",Kl="OCTET STRING",ql="BIT STRING";function Gl(e){var t;return(t=class extends e{constructor(...e){var t;super(...e);const r=e[0]||{};this.isHexOnly=null!==(t=r.isHexOnly)&&void 0!==t&&t,this.valueHexView=r.valueHex?El.toUint8Array(r.valueHex):Hl}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(e){this.valueHexView=new Uint8Array(e)}fromBER(e,t,r){const n=e instanceof ArrayBuffer?new Uint8Array(e):e;if(!Pl(this,n,t,r))return-1;const i=t+r;return this.valueHexView=n.subarray(t,i),this.valueHexView.length?(this.blockLength=r,i):(this.warnings.push("Zero buffer length"),t)}toBER(e=!1){return this.isHexOnly?e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",Vl)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:Il.ToHex(this.valueHexView)}}}).NAME="hexBlock",t}class zl{constructor({blockLength:e=0,error:t="",warnings:r=[],valueBeforeDecode:n=Hl}={}){this.blockLength=e,this.error=t,this.warnings=r,this.valueBeforeDecodeView=El.toUint8Array(n)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:Il.ToHex(this.valueBeforeDecodeView)}}}zl.NAME="baseBlock";class $l extends zl{fromBER(e,t,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,t){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}$l.NAME="valueBlock";class Wl extends(Gl(zl)){constructor({idBlock:e={}}={}){var t,r,n,i;super(),e?(this.isHexOnly=null!==(t=e.isHexOnly)&&void 0!==t&&t,this.valueHexView=e.valueHex?El.toUint8Array(e.valueHex):Hl,this.tagClass=null!==(r=e.tagClass)&&void 0!==r?r:-1,this.tagNumber=null!==(n=e.tagNumber)&&void 0!==n?n:-1,this.isConstructed=null!==(i=e.isConstructed)&&void 0!==i&&i):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let t=0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",Vl}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){const r=new Uint8Array(1);if(!e){let e=this.tagNumber;e&=31,t|=e,r[0]=t}return r.buffer}if(!this.isHexOnly){const r=_l(this.tagNumber,7),n=new Uint8Array(r),i=r.byteLength,s=new Uint8Array(i+1);if(s[0]=31|t,!e){for(let e=0;e<i-1;e++)s[e+1]=128|n[e];s[i]=n[i-1]}return s.buffer}const r=new Uint8Array(this.valueHexView.byteLength+1);if(r[0]=31|t,!e){const e=this.valueHexView;for(let t=0;t<e.length-1;t++)r[t+1]=128|e[t];r[this.valueHexView.byteLength]=e[e.length-1]}return r.buffer}fromBER(e,t,r){const n=El.toUint8Array(e);if(!Pl(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;switch(192&i[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&i[0]),this.isHexOnly=!1;const s=31&i[0];if(31!==s)this.tagNumber=s,this.blockLength=1;else{let e=1,t=this.valueHexView=new Uint8Array(255),r=255;for(;128&i[e];){if(t[e-1]=127&i[e],e++,e>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(e===r){r+=255;const e=new Uint8Array(r);for(let r=0;r<t.length;r++)e[r]=t[r];t=this.valueHexView=new Uint8Array(r)}}this.blockLength=e+1,t[e-1]=127&i[e];const n=new Uint8Array(e);for(let r=0;r<e;r++)n[r]=t[r];t=this.valueHexView=new Uint8Array(e),t.set(n),this.blockLength<=9?this.tagNumber=Cl(t,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}Wl.NAME="identificationBlock";class Yl extends zl{constructor({lenBlock:e={}}={}){var t,r,n;super(),this.isIndefiniteForm=null!==(t=e.isIndefiniteForm)&&void 0!==t&&t,this.longFormUsed=null!==(r=e.longFormUsed)&&void 0!==r&&r,this.length=null!==(n=e.length)&&void 0!==n?n:0}fromBER(e,t,r){const n=El.toUint8Array(e);if(!Pl(this,n,t,r))return-1;const i=n.subarray(t,t+r);if(0===i.length)return this.error="Zero buffer length",-1;if(255===i[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===i[0],this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&i[0]),!1===this.longFormUsed)return this.length=i[0],this.blockLength=1,t+this.blockLength;const s=127&i[0];if(s>8)return this.error="Too big integer",-1;if(s+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const o=t+1,a=n.subarray(o,o+s);return 0===a[s-1]&&this.warnings.push("Needlessly long encoded length"),this.length=Cl(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=s+1,t+this.blockLength}toBER(e=!1){let t,r;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=128),t;if(this.longFormUsed){const n=_l(this.length,8);if(n.byteLength>127)return this.error="Too big length",Vl;if(t=new ArrayBuffer(n.byteLength+1),e)return t;const i=new Uint8Array(n);r=new Uint8Array(t),r[0]=128|n.byteLength;for(let e=0;e<n.byteLength;e++)r[e+1]=i[e];return t}return t=new ArrayBuffer(1),!1===e&&(r=new Uint8Array(t),r[0]=this.length),t}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}Yl.NAME="lengthBlock";const Ql={};class Jl extends zl{constructor({name:e="",optional:t=!1,primitiveSchema:r,...n}={},i){super(n),this.name=e,this.optional=t,r&&(this.primitiveSchema=r),this.idBlock=new Wl(n),this.lenBlock=new Yl(n),this.valueBlock=i?new i(n):new $l(n)}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}toBER(e,t){const r=t||new Bl;t||Xl(this);const n=this.idBlock.toBER(e);if(r.write(n),this.lenBlock.isIndefiniteForm)r.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,r),r.write(new ArrayBuffer(2));else{const t=this.valueBlock.toBER(e);this.lenBlock.length=t.byteLength;const n=this.lenBlock.toBER(e);r.write(n),r.write(t)}return t?Vl:r.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return"ascii"===e?this.onAsciiEncoding():Il.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${Il.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;return function(e,t){if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}(this.toBER(),e.toBER())}}function Xl(e){if(e instanceof Ql.Constructed)for(const t of e.valueBlock.value)Xl(t)&&(e.lenBlock.isIndefiniteForm=!0);return!!e.lenBlock.isIndefiniteForm}Jl.NAME="BaseBlock";class Zl extends Jl{constructor({value:e="",...t}={},r){super(t,r),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,t,r){const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}Zl.NAME="BaseStringBlock";class ef extends(Gl($l)){constructor({isHexOnly:e=!0,...t}={}){super(t),this.isHexOnly=e}}var tf,rf,nf,sf,of,af,cf,uf,hf,df,lf,ff,pf,yf,mf,gf,vf,bf,Ef,Sf,Af,If,wf,Tf,Cf,_f,Df,Rf,Nf,Of,Uf,Pf,Bf,xf,Mf;ef.NAME="PrimitiveValueBlock";class Lf extends Jl{constructor(e={}){super(e,ef),this.idBlock.isConstructed=!1}}function kf(e,t=0,r=e.length){const n=t;let i=new Jl({},$l);const s=new zl;if(!Pl(s,e,t,r))return i.error=s.error,{offset:-1,result:i};if(!e.subarray(t,t+r).length)return i.error="Zero buffer length",{offset:-1,result:i};let o=i.idBlock.fromBER(e,t,r);if(i.idBlock.warnings.length&&i.warnings.concat(i.idBlock.warnings),-1===o)return i.error=i.idBlock.error,{offset:-1,result:i};if(t=o,r-=i.idBlock.blockLength,o=i.lenBlock.fromBER(e,t,r),i.lenBlock.warnings.length&&i.warnings.concat(i.lenBlock.warnings),-1===o)return i.error=i.lenBlock.error,{offset:-1,result:i};if(t=o,r-=i.lenBlock.blockLength,!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm)return i.error="Indefinite length form used for primitive encoding form",{offset:-1,result:i};let a=Jl;if(1===i.idBlock.tagClass){if(i.idBlock.tagNumber>=37&&!1===i.idBlock.isHexOnly)return i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:i};switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0)return i.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:i};a=Ql.EndOfContent;break;case 1:a=Ql.Boolean;break;case 2:a=Ql.Integer;break;case 3:a=Ql.BitString;break;case 4:a=Ql.OctetString;break;case 5:a=Ql.Null;break;case 6:a=Ql.ObjectIdentifier;break;case 10:a=Ql.Enumerated;break;case 12:a=Ql.Utf8String;break;case 13:a=Ql.RelativeObjectIdentifier;break;case 14:a=Ql.TIME;break;case 15:return i.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:i};case 16:a=Ql.Sequence;break;case 17:a=Ql.Set;break;case 18:a=Ql.NumericString;break;case 19:a=Ql.PrintableString;break;case 20:a=Ql.TeletexString;break;case 21:a=Ql.VideotexString;break;case 22:a=Ql.IA5String;break;case 23:a=Ql.UTCTime;break;case 24:a=Ql.GeneralizedTime;break;case 25:a=Ql.GraphicString;break;case 26:a=Ql.VisibleString;break;case 27:a=Ql.GeneralString;break;case 28:a=Ql.UniversalString;break;case 29:a=Ql.CharacterString;break;case 30:a=Ql.BmpString;break;case 31:a=Ql.DATE;break;case 32:a=Ql.TimeOfDay;break;case 33:a=Ql.DateTime;break;case 34:a=Ql.Duration;break;default:{const e=i.idBlock.isConstructed?new Ql.Constructed:new Ql.Primitive;e.idBlock=i.idBlock,e.lenBlock=i.lenBlock,e.warnings=i.warnings,i=e}}}else a=i.idBlock.isConstructed?Ql.Constructed:Ql.Primitive;return i=function(e,t){if(e instanceof t)return e;const r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecodeView=e.valueBeforeDecodeView,r}(i,a),o=i.fromBER(e,t,i.lenBlock.isIndefiniteForm?r:i.lenBlock.length),i.valueBeforeDecodeView=e.subarray(n,n+i.blockLength),{offset:o,result:i}}function Ff(e){if(!e.byteLength){const e=new Jl({},$l);return e.error="Input buffer has zero length",{offset:-1,result:e}}return kf(El.toUint8Array(e).slice(),0,e.byteLength)}tf=Lf,Ql.Primitive=tf,Lf.NAME="PRIMITIVE";class Vf extends $l{constructor({value:e=[],isIndefiniteForm:t=!1,...r}={}){super(r),this.value=e,this.isIndefiniteForm=t}fromBER(e,t,r){const n=El.toUint8Array(e);if(!Pl(this,n,t,r))return-1;if(this.valueBeforeDecodeView=n.subarray(t,t+r),0===this.valueBeforeDecodeView.length)return this.warnings.push("Zero buffer length"),t;let i=t;for(;s=this.isIndefiniteForm,o=r,(s?1:o)>0;){const e=kf(n,i,r);if(-1===e.offset)return this.error=e.result.error,this.warnings.concat(e.result.warnings),-1;if(i=e.offset,this.blockLength+=e.result.blockLength,r-=e.result.blockLength,this.value.push(e.result),this.isIndefiniteForm&&e.result.constructor.NAME===jl)break}var s,o;return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===jl?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,t){const r=t||new Bl;for(let t=0;t<this.value.length;t++)this.value[t].toBER(e,r);return t?Vl:r.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const t of this.value)e.value.push(t.toJSON());return e}}Vf.NAME="ConstructedValueBlock";class Hf extends Jl{constructor(e={}){super(e,Vf),this.idBlock.isConstructed=!0}fromBER(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),n)}onAsciiEncoding(){const e=[];for(const t of this.valueBlock.value)e.push(t.toString("ascii").split("\n").map((e=>`  ${e}`)).join("\n"));const t=3===this.idBlock.tagClass?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${t} :\n${e.join("\n")}`:`${t} :`}}rf=Hf,Ql.Constructed=rf,Hf.NAME="CONSTRUCTED";class jf extends $l{fromBER(e,t,r){return t}toBER(e){return Vl}}jf.override="EndOfContentValueBlock";class Kf extends Jl{constructor(e={}){super(e,jf),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}nf=Kf,Ql.EndOfContent=nf,Kf.NAME=jl;class qf extends Jl{constructor(e={}){super(e,$l),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):t+r}toBER(e,t){const r=new ArrayBuffer(2);if(!e){const e=new Uint8Array(r);e[0]=5,e[1]=0}return t&&t.write(r),r}onAsciiEncoding(){return`${this.constructor.NAME}`}}sf=qf,Ql.Null=sf,qf.NAME="NULL";class Gf extends(Gl($l)){constructor({value:e,...t}={}){super(t),t.valueHex?this.valueHexView=El.toUint8Array(t.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,t,r){const n=El.toUint8Array(e);return Pl(this,n,t,r)?(this.valueHexView=n.subarray(t,t+r),r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Rl.call(this),this.blockLength=r,t+r):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}Gf.NAME="BooleanValueBlock";class zf extends Jl{constructor(e={}){super(e,Gf),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}of=zf,Ql.Boolean=of,zf.NAME="BOOLEAN";class $f extends(Gl(Vf)){constructor({isConstructed:e=!1,...t}={}){super(t),this.isConstructed=e}fromBER(e,t,r){let n=0;if(this.isConstructed){if(this.isHexOnly=!1,n=Vf.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(let e=0;e<this.value.length;e++){const t=this.value[e].constructor.NAME;if(t===jl){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(t!==Kl)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,n=super.fromBER(e,t,r),this.blockLength=r;return n}toBER(e,t){return this.isConstructed?Vf.prototype.toBER.call(this,e,t):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}$f.NAME="OctetStringValueBlock";class Wf extends Jl{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},$f),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,t,r){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===r)return 0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),t;if(!this.valueBlock.isConstructed){const n=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(t,t+r);try{if(n.byteLength){const e=kf(n,0,n.byteLength);-1!==e.offset&&e.offset===r&&(this.valueBlock.value=[e.result])}}catch(e){}}return super.fromBER(e,t,r)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Hf.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${Il.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const t of this.valueBlock.value)t instanceof Wf&&e.push(t.valueBlock.valueHexView);return El.concat(e)}}af=Wf,Ql.OctetString=af,Wf.NAME=Kl;class Yf extends(Gl(Vf)){constructor({unusedBits:e=0,isConstructed:t=!1,...r}={}){super(r),this.unusedBits=e,this.isConstructed=t,this.blockLength=this.valueHexView.byteLength}fromBER(e,t,r){if(!r)return t;let n=-1;if(this.isConstructed){if(n=Vf.prototype.fromBER.call(this,e,t,r),-1===n)return n;for(const e of this.value){const t=e.constructor.NAME;if(t===jl){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(t!==ql)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const r=e.valueBlock;if(this.unusedBits>0&&r.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=r.unusedBits}return n}const i=El.toUint8Array(e);if(!Pl(this,i,t,r))return-1;const s=i.subarray(t,t+r);if(this.unusedBits=s[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const e=s.subarray(1);try{if(e.byteLength){const t=kf(e,0,e.byteLength);-1!==t.offset&&t.offset===r-1&&(this.value=[t.result])}}catch(e){}}return this.valueHexView=s.subarray(1),this.blockLength=s.length,t+r}toBER(e,t){if(this.isConstructed)return Vf.prototype.toBER.call(this,e,t);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return Vl;const r=new Uint8Array(this.valueHexView.length+1);return r[0]=this.unusedBits,r.set(this.valueHexView,1),r.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}Yf.NAME="BitStringValueBlock";class Qf extends Jl{constructor({idBlock:e={},lenBlock:t={},...r}={}){var n,i;null!==(n=r.isConstructed)&&void 0!==n||(r.isConstructed=!!(null===(i=r.value)||void 0===i?void 0:i.length)),super({idBlock:{isConstructed:r.isConstructed,...e},lenBlock:{...t,isIndefiniteForm:!!r.isIndefiniteForm},...r},Yf),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,t,r){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,t,r)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Hf.prototype.onAsciiEncoding.call(this);{const e=[],t=this.valueBlock.valueHexView;for(const r of t)e.push(r.toString(2).padStart(8,"0"));const r=e.join("");return`${this.constructor.NAME} : ${r.substring(0,r.length-this.valueBlock.unusedBits)}`}}}function Jf(e,t){const r=new Uint8Array([0]),n=new Uint8Array(e),i=new Uint8Array(t);let s=n.slice(0);const o=s.length-1,a=i.slice(0),c=a.length-1;let u=0;let h=0;for(let e=c<o?o:c;e>=0;e--,h++){if(!0==h<a.length)u=s[o-h]+a[c-h]+r[0];else u=s[o-h]+r[0];if(r[0]=u/10,!0==h>=s.length)s=Dl(new Uint8Array([u%10]),s);else s[o-h]=u%10}return r[0]>0&&(s=Dl(r,s)),s}function Xf(e){if(e>=xl.length)for(let t=xl.length;t<=e;t++){const e=new Uint8Array([0]);let r=xl[t-1].slice(0);for(let t=r.length-1;t>=0;t--){const n=new Uint8Array([(r[t]<<1)+e[0]]);e[0]=n[0]/10,r[t]=n[0]%10}e[0]>0&&(r=Dl(e,r)),xl.push(r)}return xl[e]}function Zf(e,t){let r=0;const n=new Uint8Array(e),i=new Uint8Array(t),s=n.slice(0),o=s.length-1,a=i.slice(0),c=a.length-1;let u,h=0;for(let e=c;e>=0;e--,h++)if(u=s[o-h]-a[c-h]-r,!0==u<0)r=1,s[o-h]=u+10;else r=0,s[o-h]=u;if(r>0)for(let e=o-c+1;e>=0;e--,h++){if(u=s[o-h]-r,!(u<0)){r=0,s[o-h]=u;break}r=1,s[o-h]=u+10}return s.slice()}cf=Qf,Ql.BitString=cf,Qf.NAME=ql;class ep extends(Gl($l)){constructor({value:e,...t}={}){super(t),this._valueDec=0,t.valueHex&&this.setValueHex(),void 0!==e&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Rl.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(function(e){const t=e<0?-1*e:e;let r=128;for(let n=1;n<8;n++){if(t<=r){if(e<0){const e=_l(r-t,8,n);return new Uint8Array(e)[0]|=128,e}let i=_l(t,8,n),s=new Uint8Array(i);if(128&s[0]){const e=i.slice(0),t=new Uint8Array(e);i=new ArrayBuffer(i.byteLength+1),s=new Uint8Array(i);for(let r=0;r<e.byteLength;r++)s[r+1]=t[r];s[0]=0}return i}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e))}get valueDec(){return this._valueDec}fromDER(e,t,r,n=0){const i=this.fromBER(e,t,r);if(-1===i)return i;const s=this.valueHexView;return 0===s[0]&&0!=(128&s[1])?this.valueHexView=s.subarray(1):0!==n&&s.length<n&&(n-s.length>1&&(n=s.length+1),this.valueHexView=s.subarray(n-s.length)),i}toDER(e=!1){const t=this.valueHexView;switch(!0){case 0!=(128&t[0]):{const e=new Uint8Array(this.valueHexView.length+1);e[0]=0,e.set(t,1),this.valueHexView=e}break;case 0===t[0]&&0==(128&t[1]):this.valueHexView=this.valueHexView.subarray(1)}return this.toBER(e)}fromBER(e,t,r){const n=super.fromBER(e,t,r);return-1===n||this.setValueHex(),n}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=8*this.valueHexView.length-1;let t,r=new Uint8Array(8*this.valueHexView.length/3),n=0;const i=this.valueHexView;let s="",o=!1;for(let o=i.byteLength-1;o>=0;o--){t=i[o];for(let i=0;i<8;i++){if(1==(1&t))if(n===e)r=Zf(Xf(n),r),s="-";else r=Jf(r,Xf(n));n++,t>>=1}}for(let e=0;e<r.length;e++)r[e]&&(o=!0),o&&(s+=Ml.charAt(r[e]));return!1===o&&(s+=Ml.charAt(0)),s}}uf=ep,ep.NAME="IntegerValueBlock",Object.defineProperty(uf.prototype,"valueHex",{set:function(e){this.valueHexView=new Uint8Array(e),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});class tp extends Jl{constructor(e={}){super(e,ep),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return Ol(),BigInt(this.valueBlock.toString())}static fromBigInt(e){Ol();const t=BigInt(e),r=new Bl,n=t.toString(16).replace(/^-/,""),i=new Uint8Array(Il.FromHex(n));if(t<0){const e=new Uint8Array(i.length+(128&i[0]?1:0));e[0]|=128;const n=BigInt(`0x${Il.ToHex(e)}`)+t,s=El.toUint8Array(Il.FromHex(n.toString(16)));s[0]|=128,r.write(s)}else 128&i[0]&&r.write(new Uint8Array([0])),r.write(i);return new tp({valueHex:r.final()})}convertToDER(){const e=new tp({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new tp({valueHex:0===this.valueBlock.valueHexView[0]?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}hf=tp,Ql.Integer=hf,tp.NAME="INTEGER";class rp extends tp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}df=rp,Ql.Enumerated=df,rp.NAME="ENUMERATED";class np extends(Gl($l)){constructor({valueDec:e=-1,isFirstSid:t=!1,...r}={}){super(r),this.valueDec=e,this.isFirstSid=t}fromBER(e,t,r){if(!r)return t;const n=El.toUint8Array(e);if(!Pl(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,0!=(128&i[e]));e++);const s=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)s[e]=this.valueHexView[e];return this.valueHexView=s,0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Cl(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}set valueBigInt(e){Ol();let t=BigInt(e).toString(2);for(;t.length%7;)t="0"+t;const r=new Uint8Array(t.length/7);for(let e=0;e<r.length;e++)r[e]=parseInt(t.slice(7*e,7*e+7),2)+(e+1<r.length?128:0);this.fromBER(r.buffer,0,r.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=_l(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Vl;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r}toString(){let e="";if(this.isHexOnly)e=Il.ToHex(this.valueHexView);else if(this.isFirstSid){let t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}np.NAME="sidBlock";class ip extends $l{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new np;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;0===this.value.length&&(t.isFirstSid=!0),this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e){const t=[];for(let r=0;r<this.value.length;r++){const n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,Vl;t.push(n)}return Ul(t)}fromString(e){this.value=[];let t=0,r=0,n="",i=!1;do{if(r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1,i){const e=this.value[0];let t=0;switch(e.valueDec){case 0:break;case 1:t=40;break;case 2:t=80;break;default:return void(this.value=[])}const r=parseInt(n,10);if(isNaN(r))return;e.valueDec=r+t,i=!1}else{const e=new np;if(n>Number.MAX_SAFE_INTEGER){Ol();const t=BigInt(n);e.valueBigInt=t}else if(e.valueDec=parseInt(n,10),isNaN(e.valueDec))return;this.value.length||(e.isFirstSid=!0,i=!0),this.value.push(e)}}while(-1!==r)}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,this.value[r].isFirstSid?e=`2.{${n} - 80}`:e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}ip.NAME="ObjectIdentifierValueBlock";class sp extends Jl{constructor(e={}){super(e,ip),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}lf=sp,Ql.ObjectIdentifier=lf,sp.NAME="OBJECT IDENTIFIER";class op extends(Gl(zl)){constructor({valueDec:e=0,...t}={}){super(t),this.valueDec=e}fromBER(e,t,r){if(0===r)return t;const n=El.toUint8Array(e);if(!Pl(this,n,t,r))return-1;const i=n.subarray(t,t+r);this.valueHexView=new Uint8Array(r);for(let e=0;e<r&&(this.valueHexView[e]=127&i[e],this.blockLength++,0!=(128&i[e]));e++);const s=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength;e++)s[e]=this.valueHexView[e];return this.valueHexView=s,0!=(128&i[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===this.valueHexView[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=Cl(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const t=this.valueHexView,r=new Uint8Array(this.blockLength);for(let e=0;e<this.blockLength-1;e++)r[e]=128|t[e];return r[this.blockLength-1]=t[this.blockLength-1],r.buffer}const t=_l(this.valueDec,7);if(0===t.byteLength)return this.error="Error during encoding SID value",Vl;const r=new Uint8Array(t.byteLength);if(!e){const e=new Uint8Array(t),n=t.byteLength-1;for(let t=0;t<n;t++)r[t]=128|e[t];r[n]=e[n]}return r.buffer}toString(){let e="";return e=this.isHexOnly?Il.ToHex(this.valueHexView):this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}op.NAME="relativeSidBlock";class ap extends $l{constructor({value:e="",...t}={}){super(t),this.value=[],e&&this.fromString(e)}fromBER(e,t,r){let n=t;for(;r>0;){const t=new op;if(n=t.fromBER(e,n,r),-1===n)return this.blockLength=0,this.error=t.error,n;this.blockLength+=t.blockLength,r-=t.blockLength,this.value.push(t)}return n}toBER(e,t){const r=[];for(let t=0;t<this.value.length;t++){const n=this.value[t].toBER(e);if(0===n.byteLength)return this.error=this.value[t].error,Vl;r.push(n)}return Ul(r)}fromString(e){this.value=[];let t=0,r=0,n="";do{r=e.indexOf(".",t),n=-1===r?e.substring(t):e.substring(t,r),t=r+1;const i=new op;if(i.valueDec=parseInt(n,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(-1!==r);return!0}toString(){let e="",t=!1;for(let r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;let n=this.value[r].toString();0!==r&&(e=`${e}.`),t?(n=`{${n}}`,e+=n):e+=n}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}ap.NAME="RelativeObjectIdentifierValueBlock";class cp extends Jl{constructor(e={}){super(e,ap),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}ff=cp,Ql.RelativeObjectIdentifier=ff,cp.NAME="RelativeObjectIdentifier";class up extends Hf{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}pf=up,Ql.Sequence=pf,up.NAME="SEQUENCE";class hp extends Hf{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}}yf=hp,Ql.Set=yf,hp.NAME="SET";class dp extends(Gl($l)){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=Fl}toJSON(){return{...super.toJSON(),value:this.value}}}dp.NAME="StringValueBlock";class lp extends dp{}lp.NAME="SimpleStringValueBlock";class fp extends Zl{constructor({...e}={}){super(e,lp)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,El.toUint8Array(e))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}fp.NAME="SIMPLE STRING";class pp extends fp{fromBuffer(e){this.valueBlock.valueHexView=El.toUint8Array(e);try{this.valueBlock.value=Il.ToUtf8String(e)}catch(t){this.warnings.push(`Error during "decodeURIComponent": ${t}, using raw string`),this.valueBlock.value=Il.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(Il.FromUtf8String(e)),this.valueBlock.value=e}}pp.NAME="Utf8StringValueBlock";class yp extends pp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}mf=yp,Ql.Utf8String=mf,yp.NAME="UTF8String";class mp extends fp{fromBuffer(e){this.valueBlock.value=Il.ToUtf16String(e),this.valueBlock.valueHexView=El.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(Il.FromUtf16String(e))}}mp.NAME="BmpStringValueBlock";class gp extends mp{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}gf=gp,Ql.BmpString=gf,gp.NAME="BMPString";class vp extends fp{fromBuffer(e){const t=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),r=new Uint8Array(t);for(let e=0;e<r.length;e+=4)r[e]=r[e+3],r[e+1]=r[e+2],r[e+2]=0,r[e+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}fromString(e){const t=e.length,r=this.valueBlock.valueHexView=new Uint8Array(4*t);for(let n=0;n<t;n++){const t=_l(e.charCodeAt(n),8),i=new Uint8Array(t);if(i.length>4)continue;const s=4-i.length;for(let e=i.length-1;e>=0;e--)r[4*n+e+s]=i[e]}this.valueBlock.value=e}}vp.NAME="UniversalStringValueBlock";class bp extends vp{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}vf=bp,Ql.UniversalString=vf,bp.NAME="UniversalString";class Ep extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}bf=Ep,Ql.NumericString=bf,Ep.NAME="NumericString";class Sp extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}Ef=Sp,Ql.PrintableString=Ef,Sp.NAME="PrintableString";class Ap extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Sf=Ap,Ql.TeletexString=Sf,Ap.NAME="TeletexString";class Ip extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Af=Ip,Ql.VideotexString=Af,Ip.NAME="VideotexString";class wp extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}If=wp,Ql.IA5String=If,wp.NAME="IA5String";class Tp extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}wf=Tp,Ql.GraphicString=wf,Tp.NAME="GraphicString";class Cp extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Tf=Cp,Ql.VisibleString=Tf,Cp.NAME="VisibleString";class _p extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}Cf=_p,Ql.GeneralString=Cf,_p.NAME="GeneralString";class Dp extends fp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}_f=Dp,Ql.CharacterString=_f,Dp.NAME="CharacterString";class Rp extends Cp{constructor({value:e,valueDate:t,...r}={}){if(super(r),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let t=0;t<e.length;t++)this.valueBlock.valueHexView[t]=e.charCodeAt(t)}t&&(this.fromDate(t),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,El.toUint8Array(e)))}toBuffer(){const e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t);for(let t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return t}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null===t)return void(this.error="Wrong input string for conversion");const r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}toString(e="iso"){if("iso"===e){const e=new Array(7);return e[0]=Nl(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=Nl(this.month,2),e[2]=Nl(this.day,2),e[3]=Nl(this.hour,2),e[4]=Nl(this.minute,2),e[5]=Nl(this.second,2),e[6]="Z",e.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}Df=Rp,Ql.UTCTime=Df,Rp.NAME="UTCTime";class Np extends Rp{constructor(e={}){var t;super(e),null!==(t=this.millisecond)&&void 0!==t||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let t,r=!1,n="",i="",s=0,o=0,a=0;if("Z"===e[e.length-1])n=e.substring(0,e.length-1),r=!0;else{const t=new Number(e[e.length-1]);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(-1!==n.indexOf("+"))throw new Error("Wrong input string for conversion");if(-1!==n.indexOf("-"))throw new Error("Wrong input string for conversion")}else{let e=1,t=n.indexOf("+"),r="";if(-1===t&&(t=n.indexOf("-"),e=-1),-1!==t){if(r=n.substring(t+1),n=n.substring(0,t),2!==r.length&&4!==r.length)throw new Error("Wrong input string for conversion");let i=parseInt(r.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");if(o=e*i,4===r.length){if(i=parseInt(r.substring(2,4),10),isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");a=e*i}}}let c=n.indexOf(".");if(-1===c&&(c=n.indexOf(",")),-1!==c){const e=new Number(`0${n.substring(c)}`);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");s=e.valueOf(),i=n.substring(0,c)}else i=n;switch(!0){case 8===i.length:if(t=/(\d{4})(\d{2})(\d{2})/gi,-1!==c)throw new Error("Wrong input string for conversion");break;case 10===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.minute=Math.floor(e),e=60*(e-this.minute),this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 12===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){let e=60*s;this.second=Math.floor(e),e=1e3*(e-this.second),this.millisecond=Math.floor(e)}break;case 14===i.length:if(t=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==c){const e=1e3*s;this.millisecond=Math.floor(e)}break;default:throw new Error("Wrong input string for conversion")}const u=t.exec(i);if(null===u)throw new Error("Wrong input string for conversion");for(let e=1;e<u.length;e++)switch(e){case 1:this.year=parseInt(u[e],10);break;case 2:this.month=parseInt(u[e],10);break;case 3:this.day=parseInt(u[e],10);break;case 4:this.hour=parseInt(u[e],10)+o;break;case 5:this.minute=parseInt(u[e],10)+a;break;case 6:this.second=parseInt(u[e],10);break;default:throw new Error("Wrong input string for conversion")}if(!1===r){const e=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=e.getUTCFullYear(),this.month=e.getUTCMonth(),this.day=e.getUTCDay(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}}toString(e="iso"){if("iso"===e){const e=[];return e.push(Nl(this.year,4)),e.push(Nl(this.month,2)),e.push(Nl(this.day,2)),e.push(Nl(this.hour,2)),e.push(Nl(this.minute,2)),e.push(Nl(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(Nl(this.millisecond,3))),e.push("Z"),e.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}Rf=Np,Ql.GeneralizedTime=Rf,Np.NAME="GeneralizedTime";class Op extends yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}Nf=Op,Ql.DATE=Nf,Op.NAME="DATE";class Up extends yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}Of=Up,Ql.TimeOfDay=Of,Up.NAME="TimeOfDay";class Pp extends yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}Uf=Pp,Ql.DateTime=Uf,Pp.NAME="DateTime";class Bp extends yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}Pf=Bp,Ql.Duration=Pf,Bp.NAME="Duration";class xp extends yp{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}Bf=xp,Ql.TIME=Bf,xp.NAME="TIME";class Mp{constructor({name:e="",optional:t=!1}={}){this.name=e,this.optional=t}}class Lp extends Mp{constructor({value:e=[],...t}={}){super(t),this.value=e}}class kp extends Mp{constructor({value:e=new Mp,local:t=!1,...r}={}){super(r),this.value=e,this.local=t}}class Fp{constructor({data:e=Hl}={}){this.dataView=El.toUint8Array(e)}get data(){return this.dataView.slice().buffer}set data(e){this.dataView=El.toUint8Array(e)}fromBER(e,t,r){const n=t+r;return this.dataView=El.toUint8Array(e).subarray(t,n),n}toBER(e){return this.dataView.slice().buffer}}function Vp(e,t,r){if(r instanceof Lp){for(let n=0;n<r.value.length;n++){if(Vp(e,t,r.value[n]).verified)return{verified:!0,result:e}}{const e={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty(Ll)&&(e.name=r.name),e}}if(r instanceof Mp)return r.hasOwnProperty(Ll)&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==!1)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.toBER(!1);if(0===n.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(n,0,n.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if(!("isHexOnly"in r.idBlock))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(r.idBlock.isHexOnly){if(kl in r.idBlock==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};const n=r.idBlock.valueHexView,i=t.idBlock.valueHexView;if(n.length!==i.length)return{verified:!1,result:e};for(let t=0;t<n.length;t++)if(n[t]!==i[1])return{verified:!1,result:e}}if(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Fl),r.name&&(e[r.name]=t)),r instanceof Ql.Constructed){let n=0,i={verified:!1,result:{error:"Unknown error"}},s=r.valueBlock.value.length;if(s>0&&r.valueBlock.value[0]instanceof kp&&(s=t.valueBlock.value.length),0===s)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){let t=!0;for(let e=0;e<r.valueBlock.value.length;e++)t=t&&(r.valueBlock.value[e].optional||!1);return t?{verified:!0,result:e}:(r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Fl),r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(let o=0;o<s;o++)if(o-n>=t.valueBlock.value.length){if(!1===r.valueBlock.value[o].optional){const t={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Fl),r.name&&(delete e[r.name],t.name=r.name)),t}}else if(r.valueBlock.value[0]instanceof kp){if(i=Vp(e,t.valueBlock.value[o],r.valueBlock.value[0].value),!1===i.verified){if(!r.valueBlock.value[0].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Fl),r.name&&delete e[r.name]),i;n++}if(Ll in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){let n={};n="local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local?t:e,void 0===n[r.valueBlock.value[0].name]&&(n[r.valueBlock.value[0].name]=[]),n[r.valueBlock.value[0].name].push(t.valueBlock.value[o])}}else if(i=Vp(e,t.valueBlock.value[o-n],r.valueBlock.value[o]),!1===i.verified){if(!r.valueBlock.value[o].optional)return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Fl),r.name&&delete e[r.name]),i;n++}if(!1===i.verified){const t={verified:!1,result:e};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Fl),r.name&&(delete e[r.name],t.name=r.name)),t}return{verified:!0,result:e}}if(r.primitiveSchema&&kl in t.valueBlock){const n=kf(t.valueBlock.valueHexView);if(-1===n.offset){const t={verified:!1,result:n.result};return r.name&&(r.name=r.name.replace(/^\s+|\s+$/g,Fl),r.name&&(delete e[r.name],t.name=r.name)),t}return Vp(e,n.result,r.primitiveSchema)}return{verified:!0,result:e}}function Hp(e,t){if(t instanceof Object==!1)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};const r=kf(El.toUint8Array(e));return-1===r.offset?{verified:!1,result:r.result}:Vp(r.result,r.result,t)}!function(e){e[e.Sequence=0]="Sequence",e[e.Set=1]="Set",e[e.Choice=2]="Choice"}(xf||(xf={})),function(e){e[e.Any=1]="Any",e[e.Boolean=2]="Boolean",e[e.OctetString=3]="OctetString",e[e.BitString=4]="BitString",e[e.Integer=5]="Integer",e[e.Enumerated=6]="Enumerated",e[e.ObjectIdentifier=7]="ObjectIdentifier",e[e.Utf8String=8]="Utf8String",e[e.BmpString=9]="BmpString",e[e.UniversalString=10]="UniversalString",e[e.NumericString=11]="NumericString",e[e.PrintableString=12]="PrintableString",e[e.TeletexString=13]="TeletexString",e[e.VideotexString=14]="VideotexString",e[e.IA5String=15]="IA5String",e[e.GraphicString=16]="GraphicString",e[e.VisibleString=17]="VisibleString",e[e.GeneralString=18]="GeneralString",e[e.CharacterString=19]="CharacterString",e[e.UTCTime=20]="UTCTime",e[e.GeneralizedTime=21]="GeneralizedTime",e[e.DATE=22]="DATE",e[e.TimeOfDay=23]="TimeOfDay",e[e.DateTime=24]="DateTime",e[e.Duration=25]="Duration",e[e.TIME=26]="TIME",e[e.Null=27]="Null"}(Mf||(Mf={}));class jp{constructor(e,t=0){if(this.unusedBits=0,this.value=new ArrayBuffer(0),e)if("number"==typeof e)this.fromNumber(e);else{if(!El.isBufferSource(e))throw TypeError("Unsupported type of 'params' argument for BitString");this.unusedBits=t,this.value=El.toArrayBuffer(e)}}fromASN(e){if(!(e instanceof Qf))throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString");return this.unusedBits=e.valueBlock.unusedBits,this.value=e.valueBlock.valueHex,this}toASN(){return new Qf({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(e){return new Qf({name:e})}toNumber(){let e="";const t=new Uint8Array(this.value);for(const r of t)e+=r.toString(2).padStart(8,"0");return e=e.split("").reverse().join(""),this.unusedBits&&(e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")),parseInt(e,2)}fromNumber(e){let t=e.toString(2);const r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;const n=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");let i=0;for(;i<r;)n[i]=parseInt(t.slice(i<<3,8+(i<<3)),2),i++;this.value=n.buffer}}class Kp{constructor(e){"number"==typeof e?this.buffer=new ArrayBuffer(e):El.isBufferSource(e)?this.buffer=El.toArrayBuffer(e):Array.isArray(e)?this.buffer=new Uint8Array(e):this.buffer=new ArrayBuffer(0)}get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}fromASN(e){if(!(e instanceof Wf))throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString");return this.buffer=e.valueBlock.valueHex,this}toASN(){return new Wf({valueHex:this.buffer})}toSchema(e){return new Wf({name:e})}}const qp={fromASN:e=>e instanceof qf?null:e.valueBeforeDecodeView,toASN:e=>{if(null===e)return new qf;const t=Ff(e);if(t.result.error)throw new Error(t.result.error);return t.result}},Gp={fromASN:e=>e.valueBlock.valueHexView.byteLength>=4?e.valueBlock.toString():e.valueBlock.valueDec,toASN:e=>new tp({value:+e})},zp={fromASN:e=>e.valueBlock.valueDec,toASN:e=>new rp({value:e})},$p={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new tp({valueHex:e})},Wp={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Qf({valueHex:e})},Yp={fromASN:e=>e.valueBlock.toString(),toASN:e=>new sp({value:e})},Qp={fromASN:e=>e.valueBlock.value,toASN:e=>new zf({value:e})},Jp={fromASN:e=>e.valueBlock.valueHexView,toASN:e=>new Wf({valueHex:e})},Xp={fromASN:e=>new Kp(e.getValue()),toASN:e=>e.toASN()};function Zp(e){return{fromASN:e=>e.valueBlock.value,toASN:t=>new e({value:t})}}const ey=Zp(yp),ty=Zp(gp),ry=Zp(bp),ny=Zp(Ep),iy=Zp(Sp),sy=Zp(Ap),oy=Zp(Ip),ay=Zp(wp),cy=Zp(Tp),uy=Zp(Cp),hy=Zp(_p),dy=Zp(Dp),ly={fromASN:e=>e.toDate(),toASN:e=>new Rp({valueDate:e})},fy={fromASN:e=>e.toDate(),toASN:e=>new Np({valueDate:e})},py={fromASN:()=>null,toASN:()=>new qf};function yy(e){switch(e){case Mf.Any:return qp;case Mf.BitString:return Wp;case Mf.BmpString:return ty;case Mf.Boolean:return Qp;case Mf.CharacterString:return dy;case Mf.Enumerated:return zp;case Mf.GeneralString:return hy;case Mf.GeneralizedTime:return fy;case Mf.GraphicString:return cy;case Mf.IA5String:return ay;case Mf.Integer:return Gp;case Mf.Null:return py;case Mf.NumericString:return ny;case Mf.ObjectIdentifier:return Yp;case Mf.OctetString:return Jp;case Mf.PrintableString:return iy;case Mf.TeletexString:return sy;case Mf.UTCTime:return ly;case Mf.UniversalString:return ry;case Mf.Utf8String:return ey;case Mf.VideotexString:return oy;case Mf.VisibleString:return uy;default:return null}}function my(e){return"function"==typeof e&&e.prototype?!(!e.prototype.toASN||!e.prototype.fromASN)||my(e.prototype):!!(e&&"object"==typeof e&&"toASN"in e&&"fromASN"in e)}function gy(e){var t;if(e){const r=Object.getPrototypeOf(e);return(null===(t=null==r?void 0:r.prototype)||void 0===t?void 0:t.constructor)===Array||gy(r)}return!1}function vy(e,t){if(!e||!t)return!1;if(e.byteLength!==t.byteLength)return!1;const r=new Uint8Array(e),n=new Uint8Array(t);for(let t=0;t<e.byteLength;t++)if(r[t]!==n[t])return!1;return!0}const by=new class{constructor(){this.items=new WeakMap}has(e){return this.items.has(e)}get(e,t=!1){const r=this.items.get(e);if(!r)throw new Error(`Cannot get schema for '${e.prototype.constructor.name}' target`);if(t&&!r.schema)throw new Error(`Schema '${e.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);return r}cache(e){const t=this.get(e);t.schema||(t.schema=this.create(e,!0))}createDefault(e){const t={type:xf.Sequence,items:{}},r=this.findParentSchema(e);return r&&(Object.assign(t,r),t.items=Object.assign({},t.items,r.items)),t}create(t,r){const n=this.items.get(t)||this.createDefault(t),i=[];for(const t in n.items){const s=n.items[t],o=r?t:"";let a;if("number"==typeof s.type){const t=Mf[s.type],r=e[t];if(!r)throw new Error(`Cannot get ASN1 class by name '${t}'`);a=new r({name:o})}else if(my(s.type)){a=(new s.type).toSchema(o)}else if(s.optional){this.get(s.type).type===xf.Choice?a=new Mp({name:o}):(a=this.create(s.type,!1),a.name=o)}else a=new Mp({name:o});const c=!!s.optional||void 0!==s.defaultValue;if(s.repeated){a.name="";a=new("set"===s.repeated?hp:up)({name:"",value:[new kp({name:o,value:a})]})}if(null!==s.context&&void 0!==s.context)if(s.implicit)if("number"==typeof s.type||my(s.type)){const e=s.repeated?Hf:Lf;i.push(new e({name:o,optional:c,idBlock:{tagClass:3,tagNumber:s.context}}))}else{this.cache(s.type);const e=!!s.repeated;let t=e?a:this.get(s.type,!0).schema;t="valueBlock"in t?t.valueBlock.value:t.value,i.push(new Hf({name:e?"":o,optional:c,idBlock:{tagClass:3,tagNumber:s.context},value:t}))}else i.push(new Hf({optional:c,idBlock:{tagClass:3,tagNumber:s.context},value:[a]}));else a.optional=c,i.push(a)}switch(n.type){case xf.Sequence:return new up({value:i,name:""});case xf.Set:return new hp({value:i,name:""});case xf.Choice:return new Lp({value:i,name:""});default:throw new Error("Unsupported ASN1 type in use")}}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=Object.getPrototypeOf(e);if(t){return this.items.get(t)||this.findParentSchema(t)}return null}},Ey=e=>t=>{let r;by.has(t)?r=by.get(t):(r=by.createDefault(t),by.set(t,r)),Object.assign(r,e)},Sy=e=>(t,r)=>{let n;by.has(t.constructor)?n=by.get(t.constructor):(n=by.createDefault(t.constructor),by.set(t.constructor,n));const i=Object.assign({},e);if("number"==typeof i.type&&!i.converter){const n=yy(e.type);if(!n)throw new Error(`Cannot get default converter for property '${r}' of ${t.constructor.name}`);i.converter=n}n.items[r]=i};class Ay extends Error{constructor(){super(...arguments),this.schemas=[]}}class Iy{static parse(e,t){const r=Ff(e);if(r.result.error)throw new Error(r.result.error);return this.fromASN(r.result,t)}static fromASN(t,r){var n;try{if(my(r)){return(new r).fromASN(t)}const i=by.get(r);by.cache(r);let s=i.schema;if(t.constructor===Hf&&i.type!==xf.Choice){s=new Hf({idBlock:{tagClass:3,tagNumber:t.idBlock.tagNumber},value:i.schema.valueBlock.value});for(const e in i.items)delete t[e]}const o=Vp({},t,s);if(!o.verified)throw new Ay(`Data does not match to ${r.name} ASN1 schema. ${o.result.error}`);const a=new r;if(gy(r)){if(!("value"in t.valueBlock)||!Array.isArray(t.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const e=i.itemType;if("number"==typeof e){const n=yy(e);if(!n)throw new Error(`Cannot get default converter for array item of ${r.name} ASN1 schema`);return r.from(t.valueBlock.value,(e=>n.fromASN(e)))}return r.from(t.valueBlock.value,(t=>this.fromASN(t,e)))}for(const t in i.items){const r=o.result[t];if(!r)continue;const s=i.items[t],c=s.type;if("number"==typeof c||my(c)){const i=null!==(n=s.converter)&&void 0!==n?n:my(c)?new c:null;if(!i)throw new Error("Converter is empty");if(s.repeated)if(s.implicit){const e=new("sequence"===s.repeated?up:hp);e.valueBlock=r.valueBlock;const n=Ff(e.toBER(!1));if(-1===n.offset)throw new Error(`Cannot parse the child item. ${n.result.error}`);if(!("value"in n.result.valueBlock)||!Array.isArray(n.result.valueBlock.value))throw new Error("Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.");const o=n.result.valueBlock.value;a[t]=Array.from(o,(e=>i.fromASN(e)))}else a[t]=Array.from(r,(e=>i.fromASN(e)));else{let n=r;if(s.implicit){let t;if(my(c))t=(new c).toSchema("");else{const r=Mf[c],n=e[r];if(!n)throw new Error(`Cannot get '${r}' class from asn1js module`);t=new n}t.valueBlock=n.valueBlock,n=Ff(t.toBER(!1)).result}a[t]=i.fromASN(n)}}else if(s.repeated){if(!Array.isArray(r))throw new Error("Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.");a[t]=Array.from(r,(e=>this.fromASN(e,c)))}else a[t]=this.fromASN(r,c)}return a}catch(e){throw e instanceof Ay&&e.schemas.push(r.name),e}}}class wy{static serialize(e){return e instanceof Jl?e.toBER(!1):this.toASN(e).toBER(!1)}static toASN(e){if(e&&"object"==typeof e&&my(e))return e.toASN();if(!e||"object"!=typeof e)throw new TypeError("Parameter 1 should be type of Object.");const t=e.constructor,r=by.get(t);by.cache(t);let n,i=[];if(r.itemType){if(!Array.isArray(e))throw new TypeError("Parameter 1 should be type of Array.");if("number"==typeof r.itemType){const n=yy(r.itemType);if(!n)throw new Error(`Cannot get default converter for array item of ${t.name} ASN1 schema`);i=e.map((e=>n.toASN(e)))}else i=e.map((e=>this.toAsnItem({type:r.itemType},"[]",t,e)))}else for(const n in r.items){const s=r.items[n],o=e[n];if(void 0===o||s.defaultValue===o||"object"==typeof s.defaultValue&&"object"==typeof o&&vy(this.serialize(s.defaultValue),this.serialize(o)))continue;const a=wy.toAsnItem(s,n,t,o);if("number"==typeof s.context)if(s.implicit)if(s.repeated||"number"!=typeof s.type&&!my(s.type))i.push(new Hf({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:a.valueBlock.value}));else{const e={};e.valueHex=a instanceof qf?a.valueBeforeDecodeView:a.valueBlock.toBER(),i.push(new Lf({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},...e}))}else i.push(new Hf({optional:s.optional,idBlock:{tagClass:3,tagNumber:s.context},value:[a]}));else s.repeated?i=i.concat(a):i.push(a)}switch(r.type){case xf.Sequence:n=new up({value:i});break;case xf.Set:n=new hp({value:i});break;case xf.Choice:if(!i[0])throw new Error(`Schema '${t.name}' has wrong data. Choice cannot be empty.`);n=i[0]}return n}static toAsnItem(e,t,r,n){let i;if("number"==typeof e.type){const s=e.converter;if(!s)throw new Error(`Property '${t}' doesn't have converter for type ${Mf[e.type]} in schema '${r.name}'`);if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(n,(e=>s.toASN(e)));i=new("sequence"===e.repeated?up:hp)({value:t})}else i=s.toASN(n)}else if(e.repeated){if(!Array.isArray(n))throw new TypeError("Parameter 'objProp' should be type of Array.");const t=Array.from(n,(e=>this.toASN(e)));i=new("sequence"===e.repeated?up:hp)({value:t})}else i=this.toASN(n);return i}}class Ty extends Array{constructor(e=[]){if("number"==typeof e)super(e);else{super();for(const t of e)this.push(t)}}}class Cy{static serialize(e){return wy.serialize(e)}static parse(e,t){return Iy.parse(e,t)}static toString(e){const t=Ff(El.isBufferSource(e)?El.toArrayBuffer(e):Cy.serialize(e));if(-1===t.offset)throw new Error(`Cannot decode ASN.1 data. ${t.result.error}`);return t.result.toString()}}var _y,Dy=r(1424);class Ry extends Error{constructor(e,t){super(t?`${e}. See the inner exception for more details.`:e),this.message=e,this.innerError=t}}class Ny extends Ry{constructor(e,t,r){super(t,r),this.schema=e}}class Oy extends Ny{constructor(e,t,r){super(e,`JSON doesn't match to '${e.target.name}' schema. ${t}`,r)}}class Uy extends Ry{}class Py extends Ry{constructor(e,t,r){super(`Cannot serialize by '${e}' schema. ${t}`,r),this.schemaName=e}}class By extends Oy{constructor(e,t,r={}){super(e,"Some keys doesn't match to schema"),this.keys=t,this.errors=r}}function xy(e,t){if(!function(e,t){switch(t){case _y.Boolean:return"boolean"==typeof e;case _y.Number:return"number"==typeof e;case _y.String:return"string"==typeof e}return!0}(e,t))throw new TypeError(`Value must be ${_y[t]}`)}function My(e){return e&&e.prototype?!(!e.prototype.toJSON||!e.prototype.fromJSON)||My(e.prototype):!!(e&&e.toJSON&&e.fromJSON)}!function(e){e[e.Any=0]="Any",e[e.Boolean=1]="Boolean",e[e.Number=2]="Number",e[e.String=3]="String"}(_y||(_y={}));const Ly="default",ky=new class{constructor(){this.items=new Map}has(e){return this.items.has(e)||!!this.findParentSchema(e)}get(e){const t=this.items.get(e)||this.findParentSchema(e);if(!t)throw new Error("Cannot get schema for current target");return t}create(e){const t={names:{}},r=this.findParentSchema(e);if(r){Object.assign(t,r),t.names={};for(const e in r.names)t.names[e]=Object.assign({},r.names[e])}return t.target=e,t}set(e,t){return this.items.set(e,t),this}findParentSchema(e){const t=e.__proto__;if(t){return this.items.get(t)||this.findParentSchema(t)}return null}};class Fy{constructor(e){this.pattern=new RegExp(e)}validate(e){const t=new RegExp(this.pattern.source,this.pattern.flags);if("string"!=typeof e)throw new Uy("Incoming value must be string");if(!t.exec(e))throw new Uy(`Value doesn't match to pattern '${t.toString()}'`)}}class Vy{constructor(e=Number.MIN_VALUE,t=Number.MAX_VALUE){this.min=e,this.max=t}validate(e){if(xy(e,_y.Number),!(this.min<=e&&e<=this.max)){const e=this.min===Number.MIN_VALUE?"MIN":this.min,t=this.max===Number.MAX_VALUE?"MAX":this.max;throw new Uy(`Value doesn't match to diapason [${e},${t}]`)}}}class Hy{constructor(e=Number.MIN_VALUE,t=Number.MAX_VALUE){this.min=e,this.max=t}validate(e){if(xy(e,_y.Number),!(this.min<e&&e<this.max)){const e=this.min===Number.MIN_VALUE?"MIN":this.min,t=this.max===Number.MAX_VALUE?"MAX":this.max;throw new Uy(`Value doesn't match to diapason (${e},${t})`)}}}class jy{constructor(e,t,r){this.length=e,this.minLength=t,this.maxLength=r}validate(e){if(void 0===this.length){if(void 0!==this.minLength&&e.length<this.minLength)throw new Uy(`Value length must be more than ${this.minLength}.`);if(void 0!==this.maxLength&&e.length>this.maxLength)throw new Uy(`Value length must be less than ${this.maxLength}.`)}else if(e.length!==this.length)throw new Uy(`Value length must be exactly ${this.length}.`)}}class Ky{constructor(e){this.enumeration=e}validate(e){if(xy(e,_y.String),!this.enumeration.includes(e))throw new Uy(`Value must be one of ${this.enumeration.map((e=>`'${e}'`)).join(", ")}`)}}class qy{static checkValues(e,t){const r=Array.isArray(e)?e:[e];for(const n of r)for(const r of t.validations)r instanceof jy&&t.repeated?r.validate(e):r.validate(n)}static checkTypes(e,t){if(t.repeated&&!Array.isArray(e))throw new TypeError("Value must be Array");if("number"==typeof t.type){const r=Array.isArray(e)?e:[e];for(const e of r)xy(e,t.type)}}static getSchemaByName(e,t="default"){return{...e.names.default,...e.names[t]}}}class Gy extends qy{static serialize(e,t,r,n){const i=this.toJSON(e,t);return JSON.stringify(i,r,n)}static toJSON(e,t={}){let r,n=t.targetSchema;const i=t.schemaName||Ly;if(My(e))return e.toJSON();if(Array.isArray(e)){r=[];for(const n of e)r.push(this.toJSON(n,t))}else if("object"==typeof e){if(n&&!ky.has(n))throw new Ry("Cannot get schema for `targetSchema` param");if(n=n||e.constructor,ky.has(n)){const t=ky.get(n);r={};const s=this.getSchemaByName(t,i);for(const o in s)try{const t=s[o],a=e[o];let c;if(t.optional&&void 0===a||void 0!==t.defaultValue&&a===t.defaultValue)continue;if(!t.optional&&void 0===a)throw new Py(n.name,`Property '${o}' is required.`);c="number"==typeof t.type?t.converter?t.repeated?a.map((r=>t.converter.toJSON(r,e))):t.converter.toJSON(a,e):a:t.repeated?a.map((e=>this.toJSON(e,{schemaName:i}))):this.toJSON(a,{schemaName:i}),this.checkTypes(c,t),this.checkValues(c,t),r[t.name||o]=c}catch(e){throw e instanceof Py?e:new Py(t.target.name,`Property '${o}' is wrong. ${e.message}`,e)}}else{r={};for(const t in e)r[t]=this.toJSON(e[t],{schemaName:i})}}else r=e;return r}}class zy extends qy{static parse(e,t){const r=JSON.parse(e);return this.fromJSON(r,t)}static fromJSON(e,t){const r=t.targetSchema,n=t.schemaName||Ly,i=new r;if(My(i))return i.fromJSON(e);const s=ky.get(r),o=this.getSchemaByName(s,n),a={};t.strictProperty&&!Array.isArray(e)&&zy.checkStrictProperty(e,o,s);for(const r in o)try{const a=o[r],c=a.name||r,u=e[c];if(void 0===u&&(a.optional||void 0!==a.defaultValue))continue;if(!a.optional&&void 0===u)throw new Oy(s,`Property '${c}' is required.`);if(this.checkTypes(u,a),this.checkValues(u,a),"number"==typeof a.type)a.converter?a.repeated?i[r]=u.map((e=>a.converter.fromJSON(e,i))):i[r]=a.converter.fromJSON(u,i):i[r]=u;else{const e={...t,targetSchema:a.type,schemaName:n};a.repeated?i[r]=u.map((t=>this.fromJSON(t,e))):i[r]=this.fromJSON(u,e)}}catch(e){if(e instanceof Oy||(e=new Oy(s,`Property '${r}' is wrong. ${e.message}`,e)),!t.strictAllKeys)throw e;a[r]=e}const c=Object.keys(a);if(c.length)throw new By(s,c,a);return i}static checkStrictProperty(e,t,r){const n=Object.keys(e),i=Object.keys(t),s=[];for(const e of n)-1===i.indexOf(e)&&s.push(e);if(s.length)throw new By(r,s)}}const $y=(e={})=>(t,r)=>{const n=`Cannot set type for ${r} property of ${t.constructor.name} schema`;let i;ky.has(t.constructor)?(i=ky.get(t.constructor),i.target!==t.constructor&&(i=ky.create(t.constructor),ky.set(t.constructor,i))):(i=ky.create(t.constructor),ky.set(t.constructor,i));const s={type:_y.Any,validations:[]},o=Object.assign(s,e);if(o.validations=function(e){const t=[];return e.pattern&&t.push(new Fy(e.pattern)),e.type!==_y.Number&&e.type!==_y.Any||(void 0===e.minInclusive&&void 0===e.maxInclusive||t.push(new Vy(e.minInclusive,e.maxInclusive)),void 0===e.minExclusive&&void 0===e.maxExclusive||t.push(new Hy(e.minExclusive,e.maxExclusive)),void 0!==e.enumeration&&t.push(new Ky(e.enumeration))),(e.type===_y.String||e.repeated||e.type===_y.Any)&&(void 0===e.length&&void 0===e.minLength&&void 0===e.maxLength||t.push(new jy(e.length,e.minLength,e.maxLength))),t}(o),"number"!=typeof o.type&&!ky.has(o.type)&&!My(o.type))throw new Error(`${n}. Assigning type doesn't have schema.`);let a;a=Array.isArray(e.schema)?e.schema:[e.schema||Ly];for(const e of a){i.names[e]||(i.names[e]={});i.names[e][r]=o}};class Wy extends Error{}class Yy extends Wy{}class Qy extends Wy{constructor(e){super("Unsupported operation: "+(e?`${e}`:""))}}class Jy extends Wy{}class Xy extends Wy{constructor(e){super(`${e}: Missing required property`)}}class Zy{async digest(...e){return this.checkDigest.apply(this,e),this.onDigest.apply(this,e)}checkDigest(e,t){this.checkAlgorithmName(e)}async onDigest(e,t){throw new Qy("digest")}async generateKey(...e){return this.checkGenerateKey.apply(this,e),this.onGenerateKey.apply(this,e)}checkGenerateKey(e,t,r,...n){if(this.checkAlgorithmName(e),this.checkGenerateKeyParams(e),!r||!r.length)throw new TypeError("Usages cannot be empty when creating a key.");let i;i=Array.isArray(this.usages)?this.usages:this.usages.privateKey.concat(this.usages.publicKey),this.checkKeyUsages(r,i)}checkGenerateKeyParams(e){}async onGenerateKey(e,t,r,...n){throw new Qy("generateKey")}async sign(...e){return this.checkSign.apply(this,e),this.onSign.apply(this,e)}checkSign(e,t,r,...n){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,"sign")}async onSign(e,t,r,...n){throw new Qy("sign")}async verify(...e){return this.checkVerify.apply(this,e),this.onVerify.apply(this,e)}checkVerify(e,t,r,n,...i){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,"verify")}async onVerify(e,t,r,n,...i){throw new Qy("verify")}async encrypt(...e){return this.checkEncrypt.apply(this,e),this.onEncrypt.apply(this,e)}checkEncrypt(e,t,r,n={},...i){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"encrypt":void 0)}async onEncrypt(e,t,r,...n){throw new Qy("encrypt")}async decrypt(...e){return this.checkDecrypt.apply(this,e),this.onDecrypt.apply(this,e)}checkDecrypt(e,t,r,n={},...i){this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"decrypt":void 0)}async onDecrypt(e,t,r,...n){throw new Qy("decrypt")}async deriveBits(...e){return this.checkDeriveBits.apply(this,e),this.onDeriveBits.apply(this,e)}checkDeriveBits(e,t,r,n={},...i){if(this.checkAlgorithmName(e),this.checkAlgorithmParams(e),this.checkCryptoKey(t,n.keyUsage?"deriveBits":void 0),r%8!=0)throw new Jy("length: Is not multiple of 8")}async onDeriveBits(e,t,r,...n){throw new Qy("deriveBits")}async exportKey(...e){return this.checkExportKey.apply(this,e),this.onExportKey.apply(this,e)}checkExportKey(e,t,...r){if(this.checkKeyFormat(e),this.checkCryptoKey(t),!t.extractable)throw new Wy("key: Is not extractable")}async onExportKey(e,t,...r){throw new Qy("exportKey")}async importKey(...e){return this.checkImportKey.apply(this,e),this.onImportKey.apply(this,e)}checkImportKey(e,t,r,n,i,...s){this.checkKeyFormat(e),this.checkKeyData(e,t),this.checkAlgorithmName(r),this.checkImportParams(r),Array.isArray(this.usages)&&this.checkKeyUsages(i,this.usages)}async onImportKey(e,t,r,n,i,...s){throw new Qy("importKey")}checkAlgorithmName(e){if(e.name.toLowerCase()!==this.name.toLowerCase())throw new Yy("Unrecognized name")}checkAlgorithmParams(e){}checkDerivedKeyParams(e){}checkKeyUsages(e,t){for(const r of e)if(-1===t.indexOf(r))throw new TypeError("Cannot create a key using the specified key usages")}checkCryptoKey(e,t){if(this.checkAlgorithmName(e.algorithm),t&&-1===e.usages.indexOf(t))throw new Wy("key does not match that of operation")}checkRequiredProperty(e,t){if(!(t in e))throw new Xy(t)}checkHashAlgorithm(e,t){for(const r of t)if(r.toLowerCase()===e.name.toLowerCase())return;throw new Jy(`hash: Must be one of ${t.join(", ")}`)}checkImportParams(e){}checkKeyFormat(e){switch(e){case"raw":case"pkcs8":case"spki":case"jwk":break;default:throw new TypeError("format: Is invalid value. Must be 'jwk', 'raw', 'spki', or 'pkcs8'")}}checkKeyData(e,t){if(!t)throw new TypeError("keyData: Cannot be empty on empty on key importing");if("jwk"===e){if("object"!=typeof(r=t)||!("kty"in r))throw new TypeError("keyData: Is not JsonWebToken")}else if(!El.isBufferSource(t))throw new TypeError("keyData: Is not ArrayBufferView or ArrayBuffer");var r}prepareData(e){return El.toArrayBuffer(e)}}class em extends Zy{checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw new TypeError("length: Is not of type Number");switch(e.length){case 128:case 192:case 256:break;default:throw new TypeError("length: Must be 128, 192, or 256")}}checkDerivedKeyParams(e){this.checkGenerateKeyParams(e)}}class tm extends em{constructor(){super(...arguments),this.name="AES-CBC",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==e.iv.byteLength)throw new TypeError("iv: Must have length 16 bytes")}}class rm extends em{constructor(){super(...arguments),this.name="AES-CMAC",this.usages=["sign","verify"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw new TypeError("length: Is not a Number");if(e.length<1)throw new Jy("length: Must be more than 0")}}class nm extends em{constructor(){super(...arguments),this.name="AES-CTR",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"counter"),!(e.counter instanceof ArrayBuffer||ArrayBuffer.isView(e.counter)))throw new TypeError("counter: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(16!==e.counter.byteLength)throw new TypeError("iv: Must have length 16 bytes");if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw new TypeError("length: Is not a Number");if(e.length<1)throw new Jy("length: Must be more than 0")}}class im extends em{constructor(){super(...arguments),this.name="AES-ECB",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}}class sm extends em{constructor(){super(...arguments),this.name="AES-GCM",this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(e.iv.byteLength<1)throw new Jy("iv: Must have length more than 0 and less than 2^64 - 1");switch("tagLength"in e||(e.tagLength=128),e.tagLength){case 32:case 64:case 96:case 104:case 112:case 120:case 128:break;default:throw new Jy("tagLength: Must be one of 32, 64, 96, 104, 112, 120 or 128")}}}class om extends em{constructor(){super(...arguments),this.name="AES-KW",this.usages=["wrapKey","unwrapKey"]}}class am extends Zy{constructor(){super(...arguments),this.usages=["encrypt","decrypt","wrapKey","unwrapKey"]}checkAlgorithmParams(e){if(this.ivSize){if(this.checkRequiredProperty(e,"iv"),!(e.iv instanceof ArrayBuffer||ArrayBuffer.isView(e.iv)))throw new TypeError("iv: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(e.iv.byteLength!==this.ivSize)throw new TypeError(`iv: Must have length ${this.ivSize} bytes`)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"length"),"number"!=typeof e.length)throw new TypeError("length: Is not of type Number");if(e.length!==this.keySizeBits)throw new Jy(`algorithm.length: Must be ${this.keySizeBits}`)}checkDerivedKeyParams(e){this.checkGenerateKeyParams(e)}}class cm extends Zy{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"]}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"publicExponent"),!(e.publicExponent&&e.publicExponent instanceof Uint8Array))throw new TypeError("publicExponent: Missing or not a Uint8Array");const t=Il.ToBase64(e.publicExponent);if("Aw=="!==t&&"AQAB"!==t)throw new TypeError("publicExponent: Must be [3] or [1,0,1]");if(this.checkRequiredProperty(e,"modulusLength"),e.modulusLength%8||e.modulusLength<256||e.modulusLength>16384)throw new TypeError("The modulus length must be a multiple of 8 bits and >= 256 and <= 16384")}checkImportParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}class um extends cm{constructor(){super(...arguments),this.name="RSASSA-PKCS1-v1_5",this.usages={privateKey:["sign"],publicKey:["verify"]}}}class hm extends cm{constructor(){super(...arguments),this.name="RSA-PSS",this.usages={privateKey:["sign"],publicKey:["verify"]}}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"saltLength"),"number"!=typeof e.saltLength)throw new TypeError("saltLength: Is not a Number");if(e.saltLength<0)throw new RangeError("saltLength: Must be positive number")}}class dm extends cm{constructor(){super(...arguments),this.name="RSA-OAEP",this.usages={privateKey:["decrypt","unwrapKey"],publicKey:["encrypt","wrapKey"]}}checkAlgorithmParams(e){if(e.label&&!(e.label instanceof ArrayBuffer||ArrayBuffer.isView(e.label)))throw new TypeError("label: Is not of type '(ArrayBuffer or ArrayBufferView)'")}}class lm extends Zy{checkGenerateKeyParams(e){this.checkRequiredProperty(e,"namedCurve"),this.checkNamedCurve(e.namedCurve)}checkNamedCurve(e){for(const t of this.namedCurves)if(t.toLowerCase()===e.toLowerCase())return;throw new Jy(`namedCurve: Must be one of ${this.namedCurves.join(", ")}`)}}class fm extends lm{constructor(){super(...arguments),this.name="ECDSA",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages={privateKey:["sign"],publicKey:["verify"]},this.namedCurves=["P-256","P-384","P-521","K-256"]}checkAlgorithmParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}const pm=["secret","private","public"];class ym{static create(e,t,r,n){const i=new this;return i.algorithm=e,i.type=t,i.extractable=r,i.usages=n,i}static isKeyType(e){return-1!==pm.indexOf(e)}get[Symbol.toStringTag](){return"CryptoKey"}}class mm extends lm{constructor(){super(...arguments),this.name="ECDH",this.usages={privateKey:["deriveBits","deriveKey"],publicKey:[]},this.namedCurves=["P-256","P-384","P-521","K-256"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"public"),!(e.public instanceof ym))throw new TypeError("public: Is not a CryptoKey");if("public"!==e.public.type)throw new Jy("public: Is not a public key");if(e.public.algorithm.name!==this.name)throw new Jy(`public: Is not ${this.name} key`)}}class gm extends mm{constructor(){super(...arguments),this.name="ECDH-ES",this.namedCurves=["X25519","X448"]}}class vm extends lm{constructor(){super(...arguments),this.name="EdDSA",this.usages={privateKey:["sign"],publicKey:["verify"]},this.namedCurves=["Ed25519","Ed448"]}}let bm=class{constructor(e){e&&(this.value=e)}};(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],bm.prototype,"value",void 0),bm=(0,Dy.__decorate)([Ey({type:xf.Choice})],bm);class Em{constructor(e){Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],Em.prototype,"algorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,optional:!0})],Em.prototype,"parameters",void 0);class Sm{constructor(){this.version=0,this.privateKeyAlgorithm=new Em,this.privateKey=new ArrayBuffer(0)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],Sm.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:Em})],Sm.prototype,"privateKeyAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.OctetString})],Sm.prototype,"privateKey",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,optional:!0})],Sm.prototype,"attributes",void 0);class Am{constructor(){this.publicKeyAlgorithm=new Em,this.publicKey=new ArrayBuffer(0)}}(0,Dy.__decorate)([Sy({type:Em})],Am.prototype,"publicKeyAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString})],Am.prototype,"publicKey",void 0);const Im={fromJSON:e=>Il.FromBase64Url(e),toJSON:e=>Il.ToBase64Url(new Uint8Array(e))},wm={fromASN:e=>{const t=e.valueBlock.valueHex;return new Uint8Array(t)[0]?e.valueBlock.valueHex:e.valueBlock.valueHex.slice(1)},toASN:e=>{const t=new Uint8Array(e)[0]>127?wl(new Uint8Array([0]).buffer,e):e;return new tp({valueHex:t})}};class Tm{constructor(){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0)}}(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:Gp})],Tm.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"n",converter:Im})],Tm.prototype,"modulus",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"e",converter:Im})],Tm.prototype,"publicExponent",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"d",converter:Im})],Tm.prototype,"privateExponent",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"p",converter:Im})],Tm.prototype,"prime1",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"q",converter:Im})],Tm.prototype,"prime2",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"dp",converter:Im})],Tm.prototype,"exponent1",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"dq",converter:Im})],Tm.prototype,"exponent2",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"qi",converter:Im})],Tm.prototype,"coefficient",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,optional:!0})],Tm.prototype,"otherPrimeInfos",void 0);class Cm{constructor(){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0)}}(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"n",converter:Im})],Cm.prototype,"modulus",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:wm}),$y({name:"e",converter:Im})],Cm.prototype,"publicExponent",void 0);let _m=class{constructor(e){this.value=new ArrayBuffer(0),e&&(this.value=e)}toJSON(){let e=new Uint8Array(this.value);if(4!==e[0])throw new Wy("Wrong ECPoint. Current version supports only Uncompressed (0x04) point");e=new Uint8Array(this.value.slice(1));const t=e.length/2;return{x:Il.ToBase64Url(e.buffer.slice(0,0+t)),y:Il.ToBase64Url(e.buffer.slice(0+t,0+t+t))}}fromJSON(e){if(!("x"in e))throw new Error("x: Missing required property");if(!("y"in e))throw new Error("y: Missing required property");const t=Il.FromBase64Url(e.x),r=Il.FromBase64Url(e.y),n=wl(new Uint8Array([4]).buffer,t,r);return this.value=new Uint8Array(n).buffer,this}};(0,Dy.__decorate)([Sy({type:Mf.OctetString})],_m.prototype,"value",void 0),_m=(0,Dy.__decorate)([Ey({type:xf.Choice})],_m);class Dm{constructor(){this.version=1,this.privateKey=new ArrayBuffer(0)}fromJSON(e){if(!("d"in e))throw new Error("d: Missing required property");if(this.privateKey=Il.FromBase64Url(e.d),"x"in e){const t=new _m;t.fromJSON(e),this.publicKey=wy.toASN(t).valueBlock.valueHex}return this}toJSON(){const e={};return e.d=Il.ToBase64Url(this.privateKey),this.publicKey&&Object.assign(e,new _m(this.publicKey).toJSON()),e}}(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:Gp})],Dm.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:Mf.OctetString})],Dm.prototype,"privateKey",void 0),(0,Dy.__decorate)([Sy({context:0,type:Mf.Any,optional:!0})],Dm.prototype,"parameters",void 0),(0,Dy.__decorate)([Sy({context:1,type:Mf.BitString,optional:!0})],Dm.prototype,"publicKey",void 0);const Rm={fromASN:e=>{const t=new Uint8Array(e.valueBlock.valueHex);return 0===t[0]?t.buffer.slice(1):t.buffer},toASN:e=>{const t=new Uint8Array(e);if(t[0]>127){const e=new Uint8Array(t.length+1);return e.set(t,1),new tp({valueHex:e.buffer})}return new tp({valueHex:e})}};var Nm=Object.freeze({__proto__:null,AsnIntegerWithoutPaddingConverter:Rm});class Om{static decodePoint(e,t){const r=El.toUint8Array(e);if(0===r.length||4!==r[0])throw new Error("Only uncompressed point format supported");const n=(r.length-1)/2;if(n!==Math.ceil(t/8))throw new Error("Point does not match field size");return{x:r.slice(1,n+1),y:r.slice(n+1,n+1+n)}}static encodePoint(e,t){const r=Math.ceil(t/8);if(e.x.byteLength!==r||e.y.byteLength!==r)throw new Error("X,Y coordinates don't match point size criteria");const n=El.toUint8Array(e.x),i=El.toUint8Array(e.y),s=new Uint8Array(2*r+1);return s[0]=4,s.set(n,1),s.set(i,r+1),s}static getSize(e){return Math.ceil(e/8)}static encodeSignature(e,t){const r=this.getSize(t),n=El.toUint8Array(e.r),i=El.toUint8Array(e.s),s=new Uint8Array(2*r);return s.set(this.padStart(n,r)),s.set(this.padStart(i,r),r),s}static decodeSignature(e,t){const r=this.getSize(t),n=El.toUint8Array(e);if(n.length!==2*r)throw new Error("Incorrect size of the signature");const i=n.slice(0,r),s=n.slice(r);return{r:this.trimStart(i),s:this.trimStart(s)}}static trimStart(e){let t=0;for(;t<e.length-1&&0===e[t];)t++;return 0===t?e:e.slice(t,e.length)}static padStart(e,t){if(t===e.length)return e;const r=new Uint8Array(t);return r.set(e,t-e.length),r}}class Um{constructor(){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0)}static fromWebCryptoSignature(e){const t=e.byteLength/2,r=Om.decodeSignature(e,8*t),n=new Um;return n.r=El.toArrayBuffer(r.r),n.s=El.toArrayBuffer(r.s),n}toWebCryptoSignature(e){null!=e||(e=8*Math.max(this.r.byteLength,this.s.byteLength));return Om.encodeSignature(this,e).buffer}}(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:Rm})],Um.prototype,"r",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:Rm})],Um.prototype,"s",void 0);class Pm extends Sm{}(0,Dy.__decorate)([Sy({context:1,implicit:!0,type:Mf.BitString,optional:!0})],Pm.prototype,"publicKey",void 0);let Bm=class{constructor(){this.value=new ArrayBuffer(0)}fromJSON(e){if(!e.d)throw new Error("d: Missing required property");return this.value=Il.FromBase64Url(e.d),this}toJSON(){return{d:Il.ToBase64Url(this.value)}}};(0,Dy.__decorate)([Sy({type:Mf.OctetString})],Bm.prototype,"value",void 0),Bm=(0,Dy.__decorate)([Ey({type:xf.Choice})],Bm);let xm=class{constructor(e){this.value=new ArrayBuffer(0),e&&(this.value=e)}toJSON(){return{x:Il.ToBase64Url(this.value)}}fromJSON(e){if(!("x"in e))throw new Error("x: Missing required property");return this.value=Il.FromBase64Url(e.x),this}};(0,Dy.__decorate)([Sy({type:Mf.BitString})],xm.prototype,"value",void 0),xm=(0,Dy.__decorate)([Ey({type:xf.Choice})],xm);let Mm=class{};(0,Dy.__decorate)([Sy({type:Mf.OctetString}),$y({type:_y.String,converter:Im})],Mm.prototype,"d",void 0),Mm=(0,Dy.__decorate)([Ey({type:xf.Choice})],Mm);const Lm="1.2.840.10045.3.1.7",km="1.3.132.0",Fm="1.3.132.0.34",Vm="1.3.132.0.35",Hm="1.3.132.0.10",jm="1.3.36.3.3.2.8.1.1",Km=`${jm}.1`,qm=`${jm}.2`,Gm=`${jm}.3`,zm=`${jm}.4`,$m=`${jm}.5`,Wm=`${jm}.6`,Ym=`${jm}.7`,Qm=`${jm}.8`,Jm=`${jm}.9`,Xm=`${jm}.10`,Zm=`${jm}.11`,eg=`${jm}.12`,tg=`${jm}.13`,rg=`${jm}.14`;var ng=Object.freeze({__proto__:null,converters:Nm,get ObjectIdentifier(){return bm},AlgorithmIdentifier:Em,PrivateKeyInfo:Sm,PublicKeyInfo:Am,RsaPrivateKey:Tm,RsaPublicKey:Cm,EcPrivateKey:Dm,get EcPublicKey(){return _m},EcDsaSignature:Um,OneAsymmetricKey:Pm,get EdPrivateKey(){return Bm},get EdPublicKey(){return xm},get CurvePrivateKey(){return Mm},idSecp256r1:Lm,idEllipticCurve:km,idSecp384r1:Fm,idSecp521r1:Vm,idSecp256k1:Hm,idVersionOne:jm,idBrainpoolP160r1:Km,idBrainpoolP160t1:qm,idBrainpoolP192r1:Gm,idBrainpoolP192t1:zm,idBrainpoolP224r1:$m,idBrainpoolP224t1:Wm,idBrainpoolP256r1:Ym,idBrainpoolP256t1:Qm,idBrainpoolP320r1:Jm,idBrainpoolP320t1:Xm,idBrainpoolP384r1:Zm,idBrainpoolP384t1:eg,idBrainpoolP512r1:tg,idBrainpoolP512t1:rg,idX25519:"1.3.101.110",idX448:"1.3.101.111",idEd25519:"1.3.101.112",idEd448:"1.3.101.113"});class ig{constructor(){}static register(e){const t=new bm;t.value=e.id;const r=Cy.serialize(t);this.items.push({...e,raw:r}),this.names.push(e.name)}static find(e){e=e.toUpperCase();for(const t of this.items)if(t.name.toUpperCase()===e||t.id.toUpperCase()===e)return t;return null}static get(e){const t=this.find(e);if(!t)throw new Error(`Unsupported EC named curve '${e}'`);return t}}ig.items=[],ig.names=[],ig.register({name:"P-256",id:Lm,size:256}),ig.register({name:"P-384",id:Fm,size:384}),ig.register({name:"P-521",id:Vm,size:521}),ig.register({name:"K-256",id:Hm,size:256}),ig.register({name:"brainpoolP160r1",id:Km,size:160}),ig.register({name:"brainpoolP160t1",id:qm,size:160}),ig.register({name:"brainpoolP192r1",id:Gm,size:192}),ig.register({name:"brainpoolP192t1",id:zm,size:192}),ig.register({name:"brainpoolP224r1",id:$m,size:224}),ig.register({name:"brainpoolP224t1",id:Wm,size:224}),ig.register({name:"brainpoolP256r1",id:Ym,size:256}),ig.register({name:"brainpoolP256t1",id:Qm,size:256}),ig.register({name:"brainpoolP320r1",id:Jm,size:320}),ig.register({name:"brainpoolP320t1",id:Xm,size:320}),ig.register({name:"brainpoolP384r1",id:Zm,size:384}),ig.register({name:"brainpoolP384t1",id:eg,size:384}),ig.register({name:"brainpoolP512r1",id:tg,size:512}),ig.register({name:"brainpoolP512t1",id:rg,size:512});class sg extends Zy{constructor(){super(...arguments),this.name="HMAC",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["sign","verify"]}getDefaultLength(e){switch(e.toUpperCase()){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":return 512;default:throw new Error(`Unknown algorithm name '${e}'`)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),"length"in e){if("number"!=typeof e.length)throw new TypeError("length: Is not a Number");if(e.length<1)throw new RangeError("length: Number is out of range")}}checkImportParams(e){this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms)}}class og extends Zy{constructor(){super(...arguments),this.name="PBKDF2",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["deriveBits","deriveKey"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"salt"),!(e.salt instanceof ArrayBuffer||ArrayBuffer.isView(e.salt)))throw new TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(this.checkRequiredProperty(e,"iterations"),"number"!=typeof e.iterations)throw new TypeError("iterations: Is not a Number");if(e.iterations<1)throw new TypeError("iterations: Is less than 1")}checkImportKey(e,t,r,n,i,...s){if(super.checkImportKey(e,t,r,n,i),n)throw new SyntaxError("extractable: Must be 'false'")}}class ag extends Zy{constructor(){super(...arguments),this.name="HKDF",this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512"],this.usages=["deriveKey","deriveBits"]}checkAlgorithmParams(e){if(this.checkRequiredProperty(e,"hash"),this.checkHashAlgorithm(e.hash,this.hashAlgorithms),this.checkRequiredProperty(e,"salt"),!El.isBufferSource(e.salt))throw new TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'");if(this.checkRequiredProperty(e,"info"),!El.isBufferSource(e.info))throw new TypeError("salt: Is not of type '(ArrayBuffer or ArrayBufferView)'")}checkImportKey(e,t,r,n,i,...s){if(super.checkImportKey(e,t,r,n,i),n)throw new SyntaxError("extractable: Must be 'false'")}}class cg extends Zy{constructor(){super(...arguments),this.usages=[],this.defaultLength=0}digest(...e){return e[0]={length:this.defaultLength,...e[0]},super.digest.apply(this,e)}checkDigest(e,t){super.checkDigest(e,t);const r=e.length||0;if("number"!=typeof r)throw new TypeError("length: Is not a Number");if(r<0)throw new TypeError("length: Is negative")}}class ug extends cg{constructor(){super(...arguments),this.name="shake128",this.defaultLength=16}}class hg extends cg{constructor(){super(...arguments),this.name="shake256",this.defaultLength=32}}class dg{get[Symbol.toStringTag](){return"Crypto"}randomUUID(){const e=this.getRandomValues(new Uint8Array(16));e[6]=15&e[6]|64,e[8]=63&e[8]|128;const t=Il.ToHex(e).toLowerCase();return`${t.substring(0,8)}-${t.substring(8,12)}-${t.substring(12,16)}-${t.substring(16)}`}}class lg{constructor(){this.items={}}get(e){return this.items[e.toLowerCase()]||null}set(e){this.items[e.name.toLowerCase()]=e}removeAt(e){const t=this.get(e.toLowerCase());return t&&delete this.items[e],t}has(e){return!!this.get(e)}get length(){return Object.keys(this.items).length}get algorithms(){const e=[];for(const t in this.items){const r=this.items[t];e.push(r.name)}return e.sort()}}class fg{constructor(){this.providers=new lg}static isHashedAlgorithm(e){return!!(e&&"object"==typeof e&&"name"in e&&"hash"in e)}get[Symbol.toStringTag](){return"SubtleCrypto"}async digest(...e){this.checkRequiredArguments(e,2,"digest");const[t,r,...n]=e,i=this.prepareAlgorithm(t),s=El.toArrayBuffer(r),o=this.getProvider(i.name);return await o.digest(i,s,...n)}async generateKey(...e){this.checkRequiredArguments(e,3,"generateKey");const[t,r,n,...i]=e,s=this.prepareAlgorithm(t),o=this.getProvider(s.name);return await o.generateKey({...s,name:o.name},r,n,...i)}async sign(...e){this.checkRequiredArguments(e,3,"sign");const[t,r,n,...i]=e;this.checkCryptoKey(r);const s=this.prepareAlgorithm(t),o=El.toArrayBuffer(n),a=this.getProvider(s.name);return await a.sign({...s,name:a.name},r,o,...i)}async verify(...e){this.checkRequiredArguments(e,4,"verify");const[t,r,n,i,...s]=e;this.checkCryptoKey(r);const o=this.prepareAlgorithm(t),a=El.toArrayBuffer(i),c=El.toArrayBuffer(n),u=this.getProvider(o.name);return await u.verify({...o,name:u.name},r,c,a,...s)}async encrypt(...e){this.checkRequiredArguments(e,3,"encrypt");const[t,r,n,...i]=e;this.checkCryptoKey(r);const s=this.prepareAlgorithm(t),o=El.toArrayBuffer(n),a=this.getProvider(s.name);return await a.encrypt({...s,name:a.name},r,o,{keyUsage:!0},...i)}async decrypt(...e){this.checkRequiredArguments(e,3,"decrypt");const[t,r,n,...i]=e;this.checkCryptoKey(r);const s=this.prepareAlgorithm(t),o=El.toArrayBuffer(n),a=this.getProvider(s.name);return await a.decrypt({...s,name:a.name},r,o,{keyUsage:!0},...i)}async deriveBits(...e){this.checkRequiredArguments(e,3,"deriveBits");const[t,r,n,...i]=e;this.checkCryptoKey(r);const s=this.prepareAlgorithm(t),o=this.getProvider(s.name);return await o.deriveBits({...s,name:o.name},r,n,{keyUsage:!0},...i)}async deriveKey(...e){this.checkRequiredArguments(e,5,"deriveKey");const[t,r,n,i,s,...o]=e,a=this.prepareAlgorithm(n);this.getProvider(a.name).checkDerivedKeyParams(a);const c=this.prepareAlgorithm(t),u=this.getProvider(c.name);u.checkCryptoKey(r,"deriveKey");const h=await u.deriveBits({...c,name:u.name},r,n.length||512,{keyUsage:!1},...o);return this.importKey("raw",h,n,i,s,...o)}async exportKey(...e){this.checkRequiredArguments(e,2,"exportKey");const[t,r,...n]=e;this.checkCryptoKey(r);const i=this.getProvider(r.algorithm.name);return await i.exportKey(t,r,...n)}async importKey(...e){this.checkRequiredArguments(e,5,"importKey");const[t,r,n,i,s,...o]=e,a=this.prepareAlgorithm(n),c=this.getProvider(a.name);if(-1!==["pkcs8","spki","raw"].indexOf(t)){const e=El.toArrayBuffer(r);return c.importKey(t,e,{...a,name:c.name},i,s,...o)}if(!r.kty)throw new TypeError("keyData: Is not JSON");return c.importKey(t,r,{...a,name:c.name},i,s,...o)}async wrapKey(e,t,r,n,...i){let s=await this.exportKey(e,t,...i);if("jwk"===e){const e=JSON.stringify(s);s=Il.FromUtf8String(e)}const o=this.prepareAlgorithm(n),a=El.toArrayBuffer(s),c=this.getProvider(o.name);return c.encrypt({...o,name:c.name},r,a,{keyUsage:!1},...i)}async unwrapKey(e,t,r,n,i,s,o,...a){const c=this.prepareAlgorithm(n),u=El.toArrayBuffer(t),h=this.getProvider(c.name);let d=await h.decrypt({...c,name:h.name},r,u,{keyUsage:!1},...a);if("jwk"===e)try{d=JSON.parse(Il.ToUtf8String(d))}catch(e){const t=new TypeError("wrappedKey: Is not a JSON");throw t.internal=e,t}return this.importKey(e,d,i,s,o,...a)}checkRequiredArguments(e,t,r){if(e.length<t)throw new TypeError(`Failed to execute '${r}' on 'SubtleCrypto': ${t} arguments required, but only ${e.length} present`)}prepareAlgorithm(e){if("string"==typeof e)return{name:e};if(fg.isHashedAlgorithm(e)){const t={...e};return t.hash=this.prepareAlgorithm(e.hash),t}return{...e}}getProvider(e){const t=this.providers.get(e);if(!t)throw new Yy("Unrecognized name");return t}checkCryptoKey(e){if(!(e instanceof ym))throw new TypeError("Key is not of type 'CryptoKey'")}}const pg={fromJSON:e=>Buffer.from(Il.FromBase64Url(e)),toJSON:e=>Il.ToBase64Url(e)};class yg extends ym{constructor(){super(...arguments),this.data=Buffer.alloc(0),this.algorithm={name:""},this.extractable=!1,this.type="secret",this.usages=[],this.kty="oct",this.alg=""}}(0,Dy.__decorate)([$y({name:"ext",type:_y.Boolean,optional:!0})],yg.prototype,"extractable",void 0),(0,Dy.__decorate)([$y({name:"key_ops",type:_y.String,repeated:!0,optional:!0})],yg.prototype,"usages",void 0),(0,Dy.__decorate)([$y({type:_y.String})],yg.prototype,"kty",void 0),(0,Dy.__decorate)([$y({type:_y.String,optional:!0})],yg.prototype,"alg",void 0);class mg extends yg{constructor(){super(...arguments),this.kty="oct",this.type="secret"}}class gg extends yg{}class vg extends mg{get alg(){switch(this.algorithm.name.toUpperCase()){case"AES-CBC":return`A${this.algorithm.length}CBC`;case"AES-CTR":return`A${this.algorithm.length}CTR`;case"AES-GCM":return`A${this.algorithm.length}GCM`;case"AES-KW":return`A${this.algorithm.length}KW`;case"AES-CMAC":return`A${this.algorithm.length}CMAC`;case"AES-ECB":return`A${this.algorithm.length}ECB`;default:throw new Yy("Unsupported algorithm name")}}set alg(e){}}(0,Dy.__decorate)([$y({name:"k",converter:pg})],vg.prototype,"data",void 0);const bg=new WeakMap;function Eg(e){const t=bg.get(e);if(!t)throw new Jy("Cannot get CryptoKey from secure storage");return t}function Sg(e){const t=ym.create(e.algorithm,e.type,e.extractable,e.usages);return Object.freeze(t),bg.set(t,e),t}class Ag{static async generateKey(e,t,r){const n=new vg;return n.algorithm=e,n.extractable=t,n.usages=r,n.data=p().randomBytes(e.length>>3),n}static async exportKey(e,t){if(!(t instanceof vg))throw new Error("key: Is not AesCryptoKey");switch(e.toLowerCase()){case"jwk":return Gy.toJSON(t);case"raw":return new Uint8Array(t.data).buffer;default:throw new Jy("format: Must be 'jwk' or 'raw'")}}static async importKey(e,t,r,n,i){let s;switch(e.toLowerCase()){case"jwk":s=zy.fromJSON(t,{targetSchema:vg});break;case"raw":s=new vg,s.data=Buffer.from(t);break;default:throw new Jy("format: Must be 'jwk' or 'raw'")}switch(s.algorithm=r,s.algorithm.length=s.data.length<<3,s.extractable=n,s.usages=i,s.algorithm.length){case 128:case 192:case 256:break;default:throw new Jy("keyData: Is wrong key length")}return s}static async encrypt(e,t,r){switch(e.name.toUpperCase()){case"AES-CBC":return this.encryptAesCBC(e,t,Buffer.from(r));case"AES-CTR":return this.encryptAesCTR(e,t,Buffer.from(r));case"AES-GCM":return this.encryptAesGCM(e,t,Buffer.from(r));case"AES-KW":return this.encryptAesKW(e,t,Buffer.from(r));case"AES-ECB":return this.encryptAesECB(e,t,Buffer.from(r));default:throw new Jy("algorithm: Is not recognized")}}static async decrypt(e,t,r){if(!(t instanceof vg))throw new Error("key: Is not AesCryptoKey");switch(e.name.toUpperCase()){case"AES-CBC":return this.decryptAesCBC(e,t,Buffer.from(r));case"AES-CTR":return this.decryptAesCTR(e,t,Buffer.from(r));case"AES-GCM":return this.decryptAesGCM(e,t,Buffer.from(r));case"AES-KW":return this.decryptAesKW(e,t,Buffer.from(r));case"AES-ECB":return this.decryptAesECB(e,t,Buffer.from(r));default:throw new Jy("algorithm: Is not recognized")}}static async encryptAesCBC(e,t,r){const n=p().createCipheriv(`aes-${t.algorithm.length}-cbc`,t.data,new Uint8Array(e.iv));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptAesCBC(e,t,r){const n=p().createDecipheriv(`aes-${t.algorithm.length}-cbc`,t.data,new Uint8Array(e.iv));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async encryptAesCTR(e,t,r){const n=p().createCipheriv(`aes-${t.algorithm.length}-ctr`,t.data,Buffer.from(e.counter));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptAesCTR(e,t,r){const n=p().createDecipheriv(`aes-${t.algorithm.length}-ctr`,t.data,new Uint8Array(e.counter));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async encryptAesGCM(e,t,r){const n=p().createCipheriv(`aes-${t.algorithm.length}-gcm`,t.data,Buffer.from(e.iv),{authTagLength:(e.tagLength||128)>>3});e.additionalData&&n.setAAD(Buffer.from(e.additionalData));let i=n.update(r);i=Buffer.concat([i,n.final(),n.getAuthTag()]);return new Uint8Array(i).buffer}static async decryptAesGCM(e,t,r){const n=p().createDecipheriv(`aes-${t.algorithm.length}-gcm`,t.data,new Uint8Array(e.iv)),i=(e.tagLength||128)>>3,s=r.slice(0,r.length-i),o=r.slice(r.length-i);e.additionalData&&n.setAAD(Buffer.from(e.additionalData)),n.setAuthTag(o);let a=n.update(s);return a=Buffer.concat([a,n.final()]),new Uint8Array(a).buffer}static async encryptAesKW(e,t,r){const n=p().createCipheriv(`id-aes${t.algorithm.length}-wrap`,t.data,this.AES_KW_IV);let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async decryptAesKW(e,t,r){const n=p().createDecipheriv(`id-aes${t.algorithm.length}-wrap`,t.data,this.AES_KW_IV);let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async encryptAesECB(e,t,r){const n=p().createCipheriv(`aes-${t.algorithm.length}-ecb`,t.data,new Uint8Array(0));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptAesECB(e,t,r){const n=p().createDecipheriv(`aes-${t.algorithm.length}-ecb`,t.data,new Uint8Array(0));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}}Ag.AES_KW_IV=Buffer.from("A6A6A6A6A6A6A6A6","hex");class Ig extends tm{async onGenerateKey(e,t,r){return Sg(await Ag.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return Ag.encrypt(e,Eg(t),new Uint8Array(r))}async onDecrypt(e,t,r){return Ag.decrypt(e,Eg(t),new Uint8Array(r))}async onExportKey(e,t){return Ag.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await Ag.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof vg))throw new TypeError("key: Is not a AesCryptoKey")}}const wg=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Tg=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,135]),Cg=16;function _g(e){const t=Buffer.alloc(e.length),r=e.length-1;for(let n=0;n<r;n++)t[n]=e[n]<<1,128&e[n+1]&&(t[n]+=1);return t[r]=e[r]<<1,t}function Dg(e,t){const r=Math.min(e.length,t.length),n=Buffer.alloc(r);for(let i=0;i<r;i++)n[i]=e[i]^t[i];return n}function Rg(e,t){const r=f.createCipheriv("aes"+(e.length<<3),e,wg),n=r.update(t);return r.final(),n}function Ng(e,t){const r=Buffer.alloc(Cg),n=t*Cg,i=n+Cg;return e.copy(r,0,n,i),r}function Og(e,t){const r=function(e){const t=Rg(e,wg);let r=_g(t);128&t[0]&&(r=Dg(r,Tg));let n=_g(r);return 128&r[0]&&(n=Dg(n,Tg)),{subkey1:r,subkey2:n}}(e);let n,i,s=Math.ceil(t.length/Cg);0===s?(s=1,n=!1):n=t.length%Cg==0;const o=s-1;i=n?Dg(Ng(t,o),r.subkey1):Dg(function(e,t){const r=Buffer.alloc(Cg),n=t*Cg,i=e.length;return r.fill(0),e.copy(r,0,n,i),r[i-n]=128,r}(t,o),r.subkey2);let a,c=wg;for(let r=0;r<o;r++)a=Dg(c,Ng(t,r)),c=Rg(e,a);return a=Dg(i,c),Rg(e,a)}class Ug extends rm{async onGenerateKey(e,t,r){return Sg(await Ag.generateKey({name:this.name,length:e.length},t,r))}async onSign(e,t,r){const n=Og(Eg(t).data,Buffer.from(r));return new Uint8Array(n).buffer}async onVerify(e,t,r,n){const i=await this.sign(e,t,n);return 0===Buffer.from(r).compare(Buffer.from(i))}async onExportKey(e,t){return Ag.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await Ag.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof vg))throw new TypeError("key: Is not a AesCryptoKey")}}class Pg extends nm{async onGenerateKey(e,t,r){return Sg(await Ag.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return Ag.encrypt(e,Eg(t),new Uint8Array(r))}async onDecrypt(e,t,r){return Ag.decrypt(e,Eg(t),new Uint8Array(r))}async onExportKey(e,t){return Ag.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await Ag.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof vg))throw new TypeError("key: Is not a AesCryptoKey")}}class Bg extends sm{async onGenerateKey(e,t,r){return Sg(await Ag.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return Ag.encrypt(e,Eg(t),new Uint8Array(r))}async onDecrypt(e,t,r){return Ag.decrypt(e,Eg(t),new Uint8Array(r))}async onExportKey(e,t){return Ag.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await Ag.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof vg))throw new TypeError("key: Is not a AesCryptoKey")}}class xg extends om{async onGenerateKey(e,t,r){return Sg(await Ag.generateKey({name:this.name,length:e.length},t,r))}async onExportKey(e,t){return Ag.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await Ag.importKey(e,t,{name:r.name},n,i))}async onEncrypt(e,t,r){return Ag.encrypt(e,Eg(t),new Uint8Array(r))}async onDecrypt(e,t,r){return Ag.decrypt(e,Eg(t),new Uint8Array(r))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof vg))throw new TypeError("key: Is not a AesCryptoKey")}}class Mg extends im{async onGenerateKey(e,t,r){return Sg(await Ag.generateKey({name:this.name,length:e.length},t,r))}async onEncrypt(e,t,r){return Ag.encrypt(e,Eg(t),new Uint8Array(r))}async onDecrypt(e,t,r){return Ag.decrypt(e,Eg(t),new Uint8Array(r))}async onExportKey(e,t){return Ag.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await Ag.importKey(e,t,{name:r.name},n,i))}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof vg))throw new TypeError("key: Is not a AesCryptoKey")}}class Lg extends mg{get alg(){switch(this.algorithm.name.toUpperCase()){case"DES-CBC":return"DES-CBC";case"DES-EDE3-CBC":return"3DES-CBC";default:throw new Yy("Unsupported algorithm name")}}set alg(e){}}(0,Dy.__decorate)([$y({name:"k",converter:pg})],Lg.prototype,"data",void 0);class kg{static async generateKey(e,t,r){const n=new Lg;return n.algorithm=e,n.extractable=t,n.usages=r,n.data=p().randomBytes(e.length>>3),n}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return Gy.toJSON(t);case"raw":return new Uint8Array(t.data).buffer;default:throw new Jy("format: Must be 'jwk' or 'raw'")}}static async importKey(e,t,r,n,i){let s;switch(e.toLowerCase()){case"jwk":s=zy.fromJSON(t,{targetSchema:Lg});break;case"raw":s=new Lg,s.data=Buffer.from(t);break;default:throw new Jy("format: Must be 'jwk' or 'raw'")}return s.algorithm=r,s.extractable=n,s.usages=i,s}static async encrypt(e,t,r){switch(e.name.toUpperCase()){case"DES-CBC":return this.encryptDesCBC(e,t,Buffer.from(r));case"DES-EDE3-CBC":return this.encryptDesEDE3CBC(e,t,Buffer.from(r));default:throw new Jy("algorithm: Is not recognized")}}static async decrypt(e,t,r){if(!(t instanceof Lg))throw new Error("key: Is not DesCryptoKey");switch(e.name.toUpperCase()){case"DES-CBC":return this.decryptDesCBC(e,t,Buffer.from(r));case"DES-EDE3-CBC":return this.decryptDesEDE3CBC(e,t,Buffer.from(r));default:throw new Jy("algorithm: Is not recognized")}}static async encryptDesCBC(e,t,r){const n=p().createCipheriv("des-cbc",t.data,new Uint8Array(e.iv));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptDesCBC(e,t,r){const n=p().createDecipheriv("des-cbc",t.data,new Uint8Array(e.iv));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}static async encryptDesEDE3CBC(e,t,r){const n=p().createCipheriv("des-ede3-cbc",t.data,Buffer.from(e.iv));let i=n.update(r);i=Buffer.concat([i,n.final()]);return new Uint8Array(i).buffer}static async decryptDesEDE3CBC(e,t,r){const n=p().createDecipheriv("des-ede3-cbc",t.data,new Uint8Array(e.iv));let i=n.update(r);return i=Buffer.concat([i,n.final()]),new Uint8Array(i).buffer}}class Fg extends am{constructor(){super(...arguments),this.keySizeBits=64,this.ivSize=8,this.name="DES-CBC"}async onGenerateKey(e,t,r){return Sg(await kg.generateKey({name:this.name,length:this.keySizeBits},t,r))}async onEncrypt(e,t,r){return kg.encrypt(e,Eg(t),new Uint8Array(r))}async onDecrypt(e,t,r){return kg.decrypt(e,Eg(t),new Uint8Array(r))}async onExportKey(e,t){return kg.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){const s=await kg.importKey(e,t,{name:this.name,length:this.keySizeBits},n,i);if(s.data.length!==this.keySizeBits>>3)throw new Jy("keyData: Wrong key size");return Sg(s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof Lg))throw new TypeError("key: Is not a DesCryptoKey")}}class Vg extends am{constructor(){super(...arguments),this.keySizeBits=192,this.ivSize=8,this.name="DES-EDE3-CBC"}async onGenerateKey(e,t,r){return Sg(await kg.generateKey({name:this.name,length:this.keySizeBits},t,r))}async onEncrypt(e,t,r){return kg.encrypt(e,Eg(t),new Uint8Array(r))}async onDecrypt(e,t,r){return kg.decrypt(e,Eg(t),new Uint8Array(r))}async onExportKey(e,t){return kg.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){const s=await kg.importKey(e,t,{name:this.name,length:this.keySizeBits},n,i);if(s.data.length!==this.keySizeBits>>3)throw new Jy("keyData: Wrong key size");return Sg(s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof Lg))throw new TypeError("key: Is not a DesCryptoKey")}}function Hg(e){switch(e.name.toUpperCase()){case"RSA-OAEP":{const t=/(\d+)$/.exec(e.hash.name)[1];return"RSA-OAEP"+("1"!==t?`-${t}`:"")}case"RSASSA-PKCS1-V1_5":return`RS${/(\d+)$/.exec(e.hash.name)[1]}`;case"RSA-PSS":return`PS${/(\d+)$/.exec(e.hash.name)[1]}`;case"RSA-PKCS1":return"RS1";default:throw new Jy("algorithm: Is not recognized")}}class jg extends gg{constructor(){super(...arguments),this.type="private"}getKey(){const e=Iy.parse(this.data,ng.PrivateKeyInfo);return Iy.parse(e.privateKey,ng.RsaPrivateKey)}toJSON(){const e=this.getKey(),t={kty:"RSA",alg:Hg(this.algorithm),key_ops:this.usages,ext:this.extractable};return Object.assign(t,Gy.toJSON(e))}fromJSON(e){const t=zy.fromJSON(e,{targetSchema:ng.RsaPrivateKey}),r=new ng.PrivateKeyInfo;r.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",r.privateKeyAlgorithm.parameters=null,r.privateKey=wy.serialize(t),this.data=Buffer.from(wy.serialize(r))}}class Kg extends gg{constructor(){super(...arguments),this.type="public"}getKey(){const e=Iy.parse(this.data,ng.PublicKeyInfo);return Iy.parse(e.publicKey,ng.RsaPublicKey)}toJSON(){const e=this.getKey(),t={kty:"RSA",alg:Hg(this.algorithm),key_ops:this.usages,ext:this.extractable};return Object.assign(t,Gy.toJSON(e))}fromJSON(e){const t=zy.fromJSON(e,{targetSchema:ng.RsaPublicKey}),r=new ng.PublicKeyInfo;r.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",r.publicKeyAlgorithm.parameters=null,r.publicKey=wy.serialize(t),this.data=Buffer.from(wy.serialize(r))}}class qg{static async generateKey(e,t,r){const n=new jg;n.algorithm=e,n.extractable=t,n.usages=r.filter((e=>-1!==this.privateKeyUsages.indexOf(e)));const i=new Kg;i.algorithm=e,i.extractable=!0,i.usages=r.filter((e=>-1!==this.publicKeyUsages.indexOf(e)));const s=Buffer.concat([Buffer.alloc(4-e.publicExponent.byteLength,0),Buffer.from(e.publicExponent)]).readInt32BE(0),o=p().generateKeyPairSync("rsa",{modulusLength:e.modulusLength,publicExponent:s,publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});n.data=o.privateKey,i.data=o.publicKey;return{privateKey:n,publicKey:i}}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return Gy.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;default:throw new Jy("format: Must be 'jwk', 'pkcs8' or 'spki'")}}static async importKey(e,t,r,n,i){switch(e.toLowerCase()){case"jwk":if(t.d){const e=zy.fromJSON(t,{targetSchema:ng.RsaPrivateKey});return this.importPrivateKey(e,r,n,i)}{const e=zy.fromJSON(t,{targetSchema:ng.RsaPublicKey});return this.importPublicKey(e,r,n,i)}case"spki":{const e=Iy.parse(new Uint8Array(t),ng.PublicKeyInfo),s=Iy.parse(e.publicKey,ng.RsaPublicKey);return this.importPublicKey(s,r,n,i)}case"pkcs8":{const e=Iy.parse(new Uint8Array(t),ng.PrivateKeyInfo),s=Iy.parse(e.privateKey,ng.RsaPrivateKey);return this.importPrivateKey(s,r,n,i)}default:throw new Jy("format: Must be 'jwk', 'pkcs8' or 'spki'")}}static async sign(e,t,r){switch(e.name.toUpperCase()){case"RSA-PSS":case"RSASSA-PKCS1-V1_5":return this.signRsa(e,t,r);default:throw new Jy("algorithm: Is not recognized")}}static async verify(e,t,r,n){switch(e.name.toUpperCase()){case"RSA-PSS":case"RSASSA-PKCS1-V1_5":return this.verifySSA(e,t,n,r);default:throw new Jy("algorithm: Is not recognized")}}static async encrypt(e,t,r){if("RSA-OAEP"===e.name.toUpperCase())return this.encryptOAEP(e,t,r);throw new Jy("algorithm: Is not recognized")}static async decrypt(e,t,r){if("RSA-OAEP"===e.name.toUpperCase())return this.decryptOAEP(e,t,r);throw new Jy("algorithm: Is not recognized")}static importPrivateKey(e,t,r,n){const i=new ng.PrivateKeyInfo;i.privateKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",i.privateKeyAlgorithm.parameters=null,i.privateKey=wy.serialize(e);const s=new jg;return s.data=Buffer.from(wy.serialize(i)),s.algorithm=Object.assign({},t),s.algorithm.publicExponent=new Uint8Array(e.publicExponent),s.algorithm.modulusLength=e.modulus.byteLength<<3,s.extractable=r,s.usages=n,s}static importPublicKey(e,t,r,n){const i=new ng.PublicKeyInfo;i.publicKeyAlgorithm.algorithm="1.2.840.113549.1.1.1",i.publicKeyAlgorithm.parameters=null,i.publicKey=wy.serialize(e);const s=new Kg;return s.data=Buffer.from(wy.serialize(i)),s.algorithm=Object.assign({},t),s.algorithm.publicExponent=new Uint8Array(e.publicExponent),s.algorithm.modulusLength=e.modulus.byteLength<<3,s.extractable=r,s.usages=n,s}static getCryptoAlgorithm(e){switch(e.hash.name.toUpperCase()){case"SHA-1":return"RSA-SHA1";case"SHA-256":return"RSA-SHA256";case"SHA-384":return"RSA-SHA384";case"SHA-512":return"RSA-SHA512";case"SHA3-256":return"RSA-SHA3-256";case"SHA3-384":return"RSA-SHA3-384";case"SHA3-512":return"RSA-SHA3-512";default:throw new Jy("algorithm.hash: Is not recognized")}}static signRsa(e,t,r){const n=this.getCryptoAlgorithm(t.algorithm),i=p().createSign(n);i.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----\n${t.data.toString("base64")}\n-----END PRIVATE KEY-----`);const s={key:t.pem};"RSA-PSS"===e.name.toUpperCase()&&(s.padding=p().constants.RSA_PKCS1_PSS_PADDING,s.saltLength=e.saltLength);const o=i.sign(s);return new Uint8Array(o).buffer}static verifySSA(e,t,r,n){const i=this.getCryptoAlgorithm(t.algorithm),s=p().createVerify(i);s.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----\n${t.data.toString("base64")}\n-----END PUBLIC KEY-----`);const o={key:t.pem};"RSA-PSS"===e.name.toUpperCase()&&(o.padding=p().constants.RSA_PKCS1_PSS_PADDING,o.saltLength=e.saltLength);return s.verify(o,n)}static encryptOAEP(e,t,r){const n={key:`-----BEGIN PUBLIC KEY-----\n${t.data.toString("base64")}\n-----END PUBLIC KEY-----`,padding:p().constants.RSA_PKCS1_OAEP_PADDING};return e.label,new Uint8Array(p().publicEncrypt(n,r)).buffer}static decryptOAEP(e,t,r){const n={key:`-----BEGIN PRIVATE KEY-----\n${t.data.toString("base64")}\n-----END PRIVATE KEY-----`,padding:p().constants.RSA_PKCS1_OAEP_PADDING};return e.label,new Uint8Array(p().privateDecrypt(n,r)).buffer}}qg.publicKeyUsages=["verify","encrypt","wrapKey"],qg.privateKeyUsages=["sign","decrypt","unwrapKey"];class Gg extends um{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){const n=await qg.generateKey({...e,name:this.name},t,r);return{privateKey:Sg(n.privateKey),publicKey:Sg(n.publicKey)}}async onSign(e,t,r){return qg.sign(e,Eg(t),new Uint8Array(r))}async onVerify(e,t,r,n){return qg.verify(e,Eg(t),new Uint8Array(r),new Uint8Array(n))}async onExportKey(e,t){return qg.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await qg.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=Eg(e);if(!(r instanceof jg||r instanceof Kg))throw new TypeError("key: Is not RSA CryptoKey")}}class zg extends hm{constructor(){super(...arguments),this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){const n=await qg.generateKey({...e,name:this.name},t,r);return{privateKey:Sg(n.privateKey),publicKey:Sg(n.publicKey)}}async onSign(e,t,r){return qg.sign(e,Eg(t),new Uint8Array(r))}async onVerify(e,t,r,n){return qg.verify(e,Eg(t),new Uint8Array(r),new Uint8Array(n))}async onExportKey(e,t){return qg.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await qg.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=Eg(e);if(!(r instanceof jg||r instanceof Kg))throw new TypeError("key: Is not RSA CryptoKey")}}class $g{static size(e){switch(e.name.toUpperCase()){case"SHA-1":return 160;case"SHA-256":case"SHA3-256":return 256;case"SHA-384":case"SHA3-384":return 384;case"SHA-512":case"SHA3-512":return 512;default:throw new Error("Unrecognized name")}}static getAlgorithmName(e){switch(e.name.toUpperCase()){case"SHA-1":return"sha1";case"SHA-256":return"sha256";case"SHA-384":return"sha384";case"SHA-512":return"sha512";case"SHA3-256":return"sha3-256";case"SHA3-384":return"sha3-384";case"SHA3-512":return"sha3-512";default:throw new Error("Unrecognized name")}}static digest(e,t){const r=this.getAlgorithmName(e),n=p().createHash(r).update(Buffer.from(t)).digest();return new Uint8Array(n).buffer}}class Wg extends dm{async onGenerateKey(e,t,r){const n=await qg.generateKey({...e,name:this.name},t,r);return{privateKey:Sg(n.privateKey),publicKey:Sg(n.publicKey)}}async onEncrypt(e,t,r){const n=Eg(t),i=new Uint8Array(r),s=Math.ceil(n.algorithm.modulusLength>>3),o=$g.size(n.algorithm.hash)>>3,a=i.byteLength,c=s-a-2*o-2;if(a>s-2*o-2)throw new Error("Data too large");const u=new Uint8Array(s),h=u.subarray(1,o+1),d=u.subarray(o+1);d.set(i,o+c+1);const l=p().createHash(n.algorithm.hash.name.replace("-","")).update(El.toUint8Array(e.label||new Uint8Array(0))).digest();d.set(l,0),d[o+c]=1,p().randomFillSync(h);const f=this.mgf1(n.algorithm.hash,h,d.length);for(let e=0;e<d.length;e++)d[e]^=f[e];const y=this.mgf1(n.algorithm.hash,d,h.length);for(let e=0;e<h.length;e++)h[e]^=y[e];n.pem||(n.pem=`-----BEGIN PUBLIC KEY-----\n${n.data.toString("base64")}\n-----END PUBLIC KEY-----`);const m=p().publicEncrypt({key:n.pem,padding:p().constants.RSA_NO_PADDING},Buffer.from(u));return new Uint8Array(m).buffer}async onDecrypt(e,t,r){const n=Eg(t),i=Math.ceil(n.algorithm.modulusLength>>3),s=$g.size(n.algorithm.hash)>>3;if(r.byteLength!==i)throw new Error("Bad data");n.pem||(n.pem=`-----BEGIN PRIVATE KEY-----\n${n.data.toString("base64")}\n-----END PRIVATE KEY-----`);let o=p().privateDecrypt({key:n.pem,padding:p().constants.RSA_NO_PADDING},Buffer.from(r));const a=o[0],c=o.subarray(1,s+1),u=o.subarray(s+1);if(0!==a)throw new Error("Decryption failed");const h=this.mgf1(n.algorithm.hash,u,c.length);for(let e=0;e<c.length;e++)c[e]^=h[e];const d=this.mgf1(n.algorithm.hash,c,u.length);for(let e=0;e<u.length;e++)u[e]^=d[e];const l=p().createHash(n.algorithm.hash.name.replace("-","")).update(El.toUint8Array(e.label||new Uint8Array(0))).digest();for(let e=0;e<s;e++)if(l[e]!==u[e])throw new Error("Decryption failed");let f=s;for(;f<u.length;f++){const e=u[f];if(1===e)break;if(0!==e)throw new Error("Decryption failed")}if(f===u.length)throw new Error("Decryption failed");return o=u.subarray(f+1),new Uint8Array(o).buffer}async onExportKey(e,t){return qg.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await qg.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=Eg(e);if(!(r instanceof jg||r instanceof Kg))throw new TypeError("key: Is not RSA CryptoKey")}mgf1(e,t,r=0){const n=$g.size(e)>>3,i=new Uint8Array(r),s=new Uint8Array(4),o=Math.ceil(r/n);for(let r=0;r<o;r++){s[0]=r>>>24,s[1]=r>>>16&255,s[2]=r>>>8&255,s[3]=255&r;const o=i.subarray(r*n);let a=p().createHash(e.name.replace("-","")).update(t).update(s).digest();a.length>o.length&&(a=a.subarray(0,o.length)),o.set(a)}return i}}class Yg extends Zy{constructor(){super(...arguments),this.name="RSAES-PKCS1-v1_5",this.usages={publicKey:["encrypt","wrapKey"],privateKey:["decrypt","unwrapKey"]}}async onGenerateKey(e,t,r){const n=await qg.generateKey({...e,name:this.name},t,r);return{privateKey:Sg(n.privateKey),publicKey:Sg(n.publicKey)}}checkGenerateKeyParams(e){if(this.checkRequiredProperty(e,"publicExponent"),!(e.publicExponent&&e.publicExponent instanceof Uint8Array))throw new TypeError("publicExponent: Missing or not a Uint8Array");const t=Il.ToBase64(e.publicExponent);if("Aw=="!==t&&"AQAB"!==t)throw new TypeError("publicExponent: Must be [3] or [1,0,1]");switch(this.checkRequiredProperty(e,"modulusLength"),e.modulusLength){case 1024:case 2048:case 4096:break;default:throw new TypeError("modulusLength: Must be 1024, 2048, or 4096")}}async onEncrypt(e,t,r){const n=this.toCryptoOptions(t),i=f.publicEncrypt(n,new Uint8Array(r));return new Uint8Array(i).buffer}async onDecrypt(e,t,r){const n=this.toCryptoOptions(t),i=f.privateDecrypt(n,new Uint8Array(r));return new Uint8Array(i).buffer}async onExportKey(e,t){return qg.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await qg.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=Eg(e);if(!(r instanceof jg||r instanceof Kg))throw new TypeError("key: Is not RSA CryptoKey")}toCryptoOptions(e){const t=e.type.toUpperCase();return{key:`-----BEGIN ${t} KEY-----\n${Eg(e).data.toString("base64")}\n-----END ${t} KEY-----`,padding:f.constants.RSA_PKCS1_PADDING}}}const Qg={"1.2.840.10045.3.1.7":"P-256","P-256":"1.2.840.10045.3.1.7","1.3.132.0.34":"P-384","P-384":"1.3.132.0.34","1.3.132.0.35":"P-521","P-521":"1.3.132.0.35","1.3.132.0.10":"K-256","K-256":"1.3.132.0.10",brainpoolP160r1:"1.3.36.3.3.2.8.1.1.1","1.3.36.3.3.2.8.1.1.1":"brainpoolP160r1",brainpoolP160t1:"1.3.36.3.3.2.8.1.1.2","1.3.36.3.3.2.8.1.1.2":"brainpoolP160t1",brainpoolP192r1:"1.3.36.3.3.2.8.1.1.3","1.3.36.3.3.2.8.1.1.3":"brainpoolP192r1",brainpoolP192t1:"1.3.36.3.3.2.8.1.1.4","1.3.36.3.3.2.8.1.1.4":"brainpoolP192t1",brainpoolP224r1:"1.3.36.3.3.2.8.1.1.5","1.3.36.3.3.2.8.1.1.5":"brainpoolP224r1",brainpoolP224t1:"1.3.36.3.3.2.8.1.1.6","1.3.36.3.3.2.8.1.1.6":"brainpoolP224t1",brainpoolP256r1:"1.3.36.3.3.2.8.1.1.7","1.3.36.3.3.2.8.1.1.7":"brainpoolP256r1",brainpoolP256t1:"1.3.36.3.3.2.8.1.1.8","1.3.36.3.3.2.8.1.1.8":"brainpoolP256t1",brainpoolP320r1:"1.3.36.3.3.2.8.1.1.9","1.3.36.3.3.2.8.1.1.9":"brainpoolP320r1",brainpoolP320t1:"1.3.36.3.3.2.8.1.1.10","1.3.36.3.3.2.8.1.1.10":"brainpoolP320t1",brainpoolP384r1:"1.3.36.3.3.2.8.1.1.11","1.3.36.3.3.2.8.1.1.11":"brainpoolP384r1",brainpoolP384t1:"1.3.36.3.3.2.8.1.1.12","1.3.36.3.3.2.8.1.1.12":"brainpoolP384t1",brainpoolP512r1:"1.3.36.3.3.2.8.1.1.13","1.3.36.3.3.2.8.1.1.13":"brainpoolP512r1",brainpoolP512t1:"1.3.36.3.3.2.8.1.1.14","1.3.36.3.3.2.8.1.1.14":"brainpoolP512t1"};function Jg(e){const t=Qg[e];if(!t)throw new Jy(`Cannot convert WebCrypto named curve '${e}' to OID`);return t}class Xg extends gg{constructor(){super(...arguments),this.type="private"}getKey(){const e=Iy.parse(this.data,ng.PrivateKeyInfo);return Iy.parse(e.privateKey,ng.EcPrivateKey)}toJSON(){const e=this.getKey(),t={kty:"EC",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(t,Gy.toJSON(e))}fromJSON(e){if(!e.crv)throw new Jy("Cannot get named curve from JWK. Property 'crv' is required");const t=new ng.PrivateKeyInfo;t.privateKeyAlgorithm.algorithm="1.2.840.10045.2.1",t.privateKeyAlgorithm.parameters=wy.serialize(new ng.ObjectIdentifier(Jg(e.crv)));const r=zy.fromJSON(e,{targetSchema:ng.EcPrivateKey});return t.privateKey=wy.serialize(r),this.data=Buffer.from(wy.serialize(t)),this}}class Zg extends gg{constructor(){super(...arguments),this.type="public"}getKey(){const e=Iy.parse(this.data,ng.PublicKeyInfo);return new ng.EcPublicKey(e.publicKey)}toJSON(){const e=this.getKey(),t={kty:"EC",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(t,Gy.toJSON(e))}fromJSON(e){if(!e.crv)throw new Jy("Cannot get named curve from JWK. Property 'crv' is required");const t=zy.fromJSON(e,{targetSchema:ng.EcPublicKey}),r=new ng.PublicKeyInfo;return r.publicKeyAlgorithm.algorithm="1.2.840.10045.2.1",r.publicKeyAlgorithm.parameters=wy.serialize(new ng.ObjectIdentifier(Jg(e.crv))),r.publicKey=wy.toASN(t).valueHex,this.data=Buffer.from(wy.serialize(r)),this}}class ev extends Zy{constructor(){super(...arguments),this.name="SHA-1",this.usages=[]}async onDigest(e,t){return $g.digest(e,t)}}class tv extends Zy{constructor(){super(...arguments),this.name="SHA-256",this.usages=[]}async onDigest(e,t){return $g.digest(e,t)}}class rv extends Zy{constructor(){super(...arguments),this.name="SHA-384",this.usages=[]}async onDigest(e,t){return $g.digest(e,t)}}class nv extends Zy{constructor(){super(...arguments),this.name="SHA-512",this.usages=[]}async onDigest(e,t){return $g.digest(e,t)}}class iv extends Zy{constructor(){super(...arguments),this.name="SHA3-256",this.usages=[]}async onDigest(e,t){return $g.digest(e,t)}}class sv extends Zy{constructor(){super(...arguments),this.name="SHA3-384",this.usages=[]}async onDigest(e,t){return $g.digest(e,t)}}class ov extends Zy{constructor(){super(...arguments),this.name="SHA3-512",this.usages=[]}async onDigest(e,t){return $g.digest(e,t)}}class av{static async generateKey(e,t,r){const n=new Xg;n.algorithm=e,n.extractable=t,n.usages=r.filter((e=>-1!==this.privateKeyUsages.indexOf(e)));const i=new Zg;i.algorithm=e,i.extractable=!0,i.usages=r.filter((e=>-1!==this.publicKeyUsages.indexOf(e)));const s=p().generateKeyPairSync("ec",{namedCurve:this.getOpenSSLNamedCurve(e.namedCurve),publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});n.data=s.privateKey,i.data=s.publicKey;return{privateKey:n,publicKey:i}}static async sign(e,t,r){const n=$g.getAlgorithmName(e.hash),i=p().createSign(n);i.update(Buffer.from(r)),t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----\n${t.data.toString("base64")}\n-----END PRIVATE KEY-----`);const s={key:t.pem},o=i.sign(s),a=Iy.parse(o,ng.EcDsaSignature);return Om.encodeSignature(a,ig.get(t.algorithm.namedCurve).size).buffer}static async verify(e,t,r,n){const i=$g.getAlgorithmName(e.hash),s=p().createVerify(i);s.update(Buffer.from(n)),t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----\n${t.data.toString("base64")}\n-----END PUBLIC KEY-----`);const o={key:t.pem},a=new ng.EcDsaSignature,c=ig.get(t.algorithm.namedCurve),u=Om.decodeSignature(r,c.size);a.r=El.toArrayBuffer(u.r),a.s=El.toArrayBuffer(u.s);const h=Buffer.from(wy.serialize(a));return s.verify(o,h)}static async deriveBits(e,t,r){const n=this.getOpenSSLNamedCurve(t.algorithm.namedCurve),i=p().createECDH(n),s=Iy.parse(t.data,ng.PrivateKeyInfo),o=Iy.parse(s.privateKey,ng.EcPrivateKey);i.setPrivateKey(Buffer.from(o.privateKey));const a=Iy.parse(e.public.data,ng.PublicKeyInfo),c=i.computeSecret(Buffer.from(a.publicKey));return null===r?c:new Uint8Array(c).buffer.slice(0,r>>3)}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return Gy.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;case"raw":return Iy.parse(t.data,ng.PublicKeyInfo).publicKey;default:throw new Jy("format: Must be 'jwk', 'raw', pkcs8' or 'spki'")}}static async importKey(e,t,r,n,i){switch(e.toLowerCase()){case"jwk":if(t.d){const e=zy.fromJSON(t,{targetSchema:ng.EcPrivateKey});return this.importPrivateKey(e,r,n,i)}{const e=zy.fromJSON(t,{targetSchema:ng.EcPublicKey});return this.importPublicKey(e,r,n,i)}case"raw":{const e=new ng.EcPublicKey(t);return this.importPublicKey(e,r,n,i)}case"spki":{const e=Iy.parse(new Uint8Array(t),ng.PublicKeyInfo),s=new ng.EcPublicKey(e.publicKey);return this.assertKeyParameters(e.publicKeyAlgorithm.parameters,r.namedCurve),this.importPublicKey(s,r,n,i)}case"pkcs8":{const e=Iy.parse(new Uint8Array(t),ng.PrivateKeyInfo),s=Iy.parse(e.privateKey,ng.EcPrivateKey);return this.assertKeyParameters(e.privateKeyAlgorithm.parameters,r.namedCurve),this.importPrivateKey(s,r,n,i)}default:throw new Jy("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'")}}static assertKeyParameters(e,t){if(!e)throw new Wy("Key info doesn't have required parameters");let r="";try{r=Iy.parse(e,ng.ObjectIdentifier).value}catch(e){throw new Wy("Cannot read key info parameters")}if(Jg(t)!==r)throw new Wy("Key info parameter doesn't match to named curve")}static async importPrivateKey(e,t,r,n){const i=new ng.PrivateKeyInfo;i.privateKeyAlgorithm.algorithm="1.2.840.10045.2.1",i.privateKeyAlgorithm.parameters=wy.serialize(new ng.ObjectIdentifier(Jg(t.namedCurve))),i.privateKey=wy.serialize(e);const s=new Xg;return s.data=Buffer.from(wy.serialize(i)),s.algorithm=Object.assign({},t),s.extractable=r,s.usages=n,s}static async importPublicKey(e,t,r,n){const i=new ng.PublicKeyInfo;i.publicKeyAlgorithm.algorithm="1.2.840.10045.2.1";const s=Jg(t.namedCurve);i.publicKeyAlgorithm.parameters=wy.serialize(new ng.ObjectIdentifier(s)),i.publicKey=e.value;const o=new Zg;return o.data=Buffer.from(wy.serialize(i)),o.algorithm=Object.assign({},t),o.extractable=r,o.usages=n,o}static getOpenSSLNamedCurve(e){switch(e.toUpperCase()){case"P-256":return"prime256v1";case"K-256":return"secp256k1";case"P-384":return"secp384r1";case"P-521":return"secp521r1";default:return e}}}av.publicKeyUsages=["verify"],av.privateKeyUsages=["sign","deriveKey","deriveBits"];class cv extends fm{constructor(){super(...arguments),this.namedCurves=ig.names,this.hashAlgorithms=["SHA-1","SHA-256","SHA-384","SHA-512","shake128","shake256","SHA3-256","SHA3-384","SHA3-512"]}async onGenerateKey(e,t,r){const n=await av.generateKey({...e,name:this.name},t,r);return{privateKey:Sg(n.privateKey),publicKey:Sg(n.publicKey)}}async onSign(e,t,r){return av.sign(e,Eg(t),new Uint8Array(r))}async onVerify(e,t,r,n){return av.verify(e,Eg(t),new Uint8Array(r),new Uint8Array(n))}async onExportKey(e,t){return av.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await av.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=Eg(e);if(!(r instanceof Xg||r instanceof Zg))throw new TypeError("key: Is not EC CryptoKey")}}class uv extends mm{constructor(){super(...arguments),this.namedCurves=ig.names}async onGenerateKey(e,t,r){const n=await av.generateKey({...e,name:this.name},t,r);return{privateKey:Sg(n.privateKey),publicKey:Sg(n.publicKey)}}async onExportKey(e,t){return av.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await av.importKey(e,t,{...r,name:this.name},n,i))}checkCryptoKey(e,t){super.checkCryptoKey(e,t);const r=Eg(e);if(!(r instanceof Xg||r instanceof Zg))throw new TypeError("key: Is not EC CryptoKey")}async onDeriveBits(e,t,r){return await av.deriveBits({...e,public:Eg(e.public)},Eg(t),r)}}const hv={[ng.idEd448]:"Ed448",ed448:ng.idEd448,[ng.idX448]:"X448",x448:ng.idX448,[ng.idEd25519]:"Ed25519",ed25519:ng.idEd25519,[ng.idX25519]:"X25519",x25519:ng.idX25519};function dv(e){const t=hv[e.toLowerCase()];if(!t)throw new Jy(`Cannot convert WebCrypto named curve '${e}' to OID`);return t}class lv extends gg{constructor(){super(...arguments),this.type="private"}getKey(){const e=Iy.parse(this.data,ng.PrivateKeyInfo);return Iy.parse(e.privateKey,ng.CurvePrivateKey)}toJSON(){const e=this.getKey(),t={kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(t,Gy.toJSON(e))}fromJSON(e){if(!e.crv)throw new Jy("Cannot get named curve from JWK. Property 'crv' is required");const t=new ng.PrivateKeyInfo;t.privateKeyAlgorithm.algorithm=dv(e.crv);const r=zy.fromJSON(e,{targetSchema:ng.CurvePrivateKey});return t.privateKey=wy.serialize(r),this.data=Buffer.from(wy.serialize(t)),this}}class fv extends gg{constructor(){super(...arguments),this.type="public"}getKey(){return Iy.parse(this.data,ng.PublicKeyInfo).publicKey}toJSON(){const e=this.getKey(),t={kty:"OKP",crv:this.algorithm.namedCurve,key_ops:this.usages,ext:this.extractable};return Object.assign(t,{x:Il.ToBase64Url(e)})}fromJSON(e){if(!e.crv)throw new Jy("Cannot get named curve from JWK. Property 'crv' is required");if(!e.x)throw new Jy("Cannot get property from JWK. Property 'x' is required");const t=new ng.PublicKeyInfo;return t.publicKeyAlgorithm.algorithm=dv(e.crv),t.publicKey=Il.FromBase64Url(e.x),this.data=Buffer.from(wy.serialize(t)),this}}class pv{static async generateKey(e,t,r){const n=new lv;n.algorithm=e,n.extractable=t,n.usages=r.filter((e=>-1!==this.privateKeyUsages.indexOf(e)));const i=new fv;i.algorithm=e,i.extractable=!0,i.usages=r.filter((e=>-1!==this.publicKeyUsages.indexOf(e)));const s=e.namedCurve.toLowerCase(),o=p().generateKeyPairSync(s,{publicKeyEncoding:{format:"der",type:"spki"},privateKeyEncoding:{format:"der",type:"pkcs8"}});n.data=o.privateKey,i.data=o.publicKey;return{privateKey:n,publicKey:i}}static async sign(e,t,r){t.pem||(t.pem=`-----BEGIN PRIVATE KEY-----\n${t.data.toString("base64")}\n-----END PRIVATE KEY-----`);const n={key:t.pem},i=p().sign(null,Buffer.from(r),n);return El.toArrayBuffer(i)}static async verify(e,t,r,n){t.pem||(t.pem=`-----BEGIN PUBLIC KEY-----\n${t.data.toString("base64")}\n-----END PUBLIC KEY-----`);const i={key:t.pem};return p().verify(null,Buffer.from(n),i,Buffer.from(r))}static async deriveBits(e,t,r){const n=p().createPublicKey({key:e.public.data,format:"der",type:"spki"}),i=p().createPrivateKey({key:t.data,format:"der",type:"pkcs8"}),s=p().diffieHellman({publicKey:n,privateKey:i});return new Uint8Array(s).buffer.slice(0,r>>3)}static async exportKey(e,t){switch(e.toLowerCase()){case"jwk":return Gy.toJSON(t);case"pkcs8":case"spki":return new Uint8Array(t.data).buffer;case"raw":return Iy.parse(t.data,ng.PublicKeyInfo).publicKey;default:throw new Jy("format: Must be 'jwk', 'raw', pkcs8' or 'spki'")}}static async importKey(e,t,r,n,i){switch(e.toLowerCase()){case"jwk":{const e=t;if(e.d){const e=zy.fromJSON(t,{targetSchema:ng.CurvePrivateKey});return this.importPrivateKey(e,r,n,i)}if(!e.x)throw new TypeError("keyData: Cannot get required 'x' filed");return this.importPublicKey(Il.FromBase64Url(e.x),r,n,i)}case"raw":return this.importPublicKey(t,r,n,i);case"spki":{const e=Iy.parse(new Uint8Array(t),ng.PublicKeyInfo);return this.importPublicKey(e.publicKey,r,n,i)}case"pkcs8":{const e=Iy.parse(new Uint8Array(t),ng.PrivateKeyInfo),s=Iy.parse(e.privateKey,ng.CurvePrivateKey);return this.importPrivateKey(s,r,n,i)}default:throw new Jy("format: Must be 'jwk', 'raw', 'pkcs8' or 'spki'")}}static importPrivateKey(e,t,r,n){const i=new lv;return i.fromJSON({crv:t.namedCurve,d:Il.ToBase64Url(e.d)}),i.algorithm=Object.assign({},t),i.extractable=r,i.usages=n,i}static async importPublicKey(e,t,r,n){const i=new fv;return i.fromJSON({crv:t.namedCurve,x:Il.ToBase64Url(e)}),i.algorithm=Object.assign({},t),i.extractable=r,i.usages=n,i}}pv.publicKeyUsages=["verify"],pv.privateKeyUsages=["sign","deriveKey","deriveBits"];class yv extends vm{async onGenerateKey(e,t,r){const n=await pv.generateKey({name:this.name,namedCurve:e.namedCurve.replace(/^ed/i,"Ed")},t,r);return{privateKey:Sg(n.privateKey),publicKey:Sg(n.publicKey)}}async onSign(e,t,r){return pv.sign(e,Eg(t),new Uint8Array(r))}async onVerify(e,t,r,n){return pv.verify(e,Eg(t),new Uint8Array(r),new Uint8Array(n))}async onExportKey(e,t){return pv.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await pv.importKey(e,t,{...r,name:this.name},n,i))}}class mv extends gm{async onGenerateKey(e,t,r){const n=await pv.generateKey({name:this.name,namedCurve:e.namedCurve.toUpperCase()},t,r);return{privateKey:Sg(n.privateKey),publicKey:Sg(n.publicKey)}}async onDeriveBits(e,t,r){return await pv.deriveBits({...e,public:Eg(e.public)},Eg(t),r)}async onExportKey(e,t){return pv.exportKey(e,Eg(t))}async onImportKey(e,t,r,n,i){return Sg(await pv.importKey(e,t,{...r,name:this.name},n,i))}}class gv extends yg{}class vv extends og{async onDeriveBits(e,t,r){return new Promise(((n,i)=>{const s=El.toArrayBuffer(e.salt),o=e.hash.name.replace("-","");p().pbkdf2(Eg(t).data,Buffer.from(s),e.iterations,r>>3,o,((e,t)=>{e?i(e):n(new Uint8Array(t).buffer)}))}))}async onImportKey(e,t,r,n,i){if("raw"===e){const e=new gv;return e.data=Buffer.from(t),e.algorithm={name:this.name},e.extractable=!1,e.usages=i,Sg(e)}throw new Jy("format: Must be 'raw'")}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof gv))throw new TypeError("key: Is not PBKDF CryptoKey")}}class bv extends yg{get alg(){return`HS${this.algorithm.hash.name.toUpperCase().replace("SHA-","")}`}set alg(e){}}(0,Dy.__decorate)([$y({name:"k",converter:pg})],bv.prototype,"data",void 0);class Ev extends sg{async onGenerateKey(e,t,r){const n=(e.length||this.getDefaultLength(e.hash.name))>>3<<3,i=new bv;return i.algorithm={...e,length:n,name:this.name},i.extractable=t,i.usages=r,i.data=p().randomBytes(n>>3),Sg(i)}async onSign(e,t,r){const n=$g.getAlgorithmName(t.algorithm.hash),i=p().createHmac(n,Eg(t).data).update(Buffer.from(r)).digest();return new Uint8Array(i).buffer}async onVerify(e,t,r,n){const i=$g.getAlgorithmName(t.algorithm.hash);return 0===p().createHmac(i,Eg(t).data).update(Buffer.from(n)).digest().compare(Buffer.from(r))}async onImportKey(e,t,r,n,i){let s;switch(e.toLowerCase()){case"jwk":s=zy.fromJSON(t,{targetSchema:bv});break;case"raw":s=new bv,s.data=Buffer.from(t);break;default:throw new Jy("format: Must be 'jwk' or 'raw'")}return s.algorithm={hash:{name:r.hash.name},name:this.name,length:s.data.length<<3},s.extractable=n,s.usages=i,Sg(s)}async onExportKey(e,t){switch(e.toLowerCase()){case"jwk":return Gy.toJSON(Eg(t));case"raw":return new Uint8Array(Eg(t).data).buffer;default:throw new Jy("format: Must be 'jwk' or 'raw'")}}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof bv))throw new TypeError("key: Is not HMAC CryptoKey")}}class Sv extends yg{}class Av extends ag{async onImportKey(e,t,r,n,i){if("raw"!==e.toLowerCase())throw new Jy("Operation not supported");const s=new Sv;return s.data=Buffer.from(t),s.algorithm={name:this.name},s.extractable=n,s.usages=i,Sg(s)}async onDeriveBits(e,t,r){const n=e.hash.name.replace("-",""),i=p().createHash(n).digest().length,s=r/8,o=El.toUint8Array(e.info),a=p().createHmac(n,El.toUint8Array(e.salt)).update(El.toUint8Array(Eg(t).data)).digest(),c=[Buffer.alloc(0)],u=Math.ceil(s/i)+1;for(let e=1;e<u;++e)c.push(p().createHmac(n,a).update(Buffer.concat([c[e-1],o,Buffer.from([e])])).digest());return Buffer.concat(c).slice(0,s)}checkCryptoKey(e,t){if(super.checkCryptoKey(e,t),!(Eg(e)instanceof Sv))throw new TypeError("key: Is not HKDF CryptoKey")}}class Iv{static digest(e,t){const r=p().createHash(e.name.toLowerCase(),{outputLength:e.length}).update(Buffer.from(t)).digest();return new Uint8Array(r).buffer}}class wv extends ug{async onDigest(e,t){return Iv.digest(e,t)}}class Tv extends hg{async onDigest(e,t){return Iv.digest(e,t)}}class Cv extends fg{constructor(){var e;super(),this.providers.set(new Ig),this.providers.set(new Pg),this.providers.set(new Bg),this.providers.set(new Ug),this.providers.set(new xg),this.providers.set(new Mg),this.providers.set(new Fg),this.providers.set(new Vg),this.providers.set(new Gg),this.providers.set(new zg),this.providers.set(new Wg),this.providers.set(new Yg),this.providers.set(new cv),this.providers.set(new uv),this.providers.set(new ev),this.providers.set(new tv),this.providers.set(new rv),this.providers.set(new nv),this.providers.set(new vv),this.providers.set(new Ev),this.providers.set(new Av);const t=null===(e=/^v(\d+)/.exec(bu.version))||void 0===e?void 0:e[1];t&&parseInt(t,10)>=12&&(this.providers.set(new wv),this.providers.set(new Tv));const r=f.getHashes();r.includes("sha3-256")&&this.providers.set(new iv),r.includes("sha3-384")&&this.providers.set(new sv),r.includes("sha3-512")&&this.providers.set(new ov),t&&parseInt(t,10)>=14&&(this.providers.set(new yv),this.providers.set(new mv))}}r(8342);var _v,Dv,Rv,Nv=r(285);class Ov{static decodeIP(e){if(64===e.length&&0===parseInt(e,16))return"::/0";if(16!==e.length)return e;const t=parseInt(e.slice(8),16).toString(2).split("").reduce(((e,t)=>e+ +t),0);let r=e.slice(0,8).replace(/(.{2})/g,(e=>`${parseInt(e,16)}.`));return r=r.slice(0,-1),`${r}/${t}`}static toString(e){if(4===e.byteLength||16===e.byteLength){const t=new Uint8Array(e);return Nv.fromByteArray(Array.from(t)).toString()}return this.decodeIP(Il.ToHex(e))}static fromString(e){const t=Nv.parse(e);return new Uint8Array(t.toByteArray()).buffer}}let Uv=class{constructor(e={}){Object.assign(this,e)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};(0,Dy.__decorate)([Sy({type:Mf.TeletexString})],Uv.prototype,"teletexString",void 0),(0,Dy.__decorate)([Sy({type:Mf.PrintableString})],Uv.prototype,"printableString",void 0),(0,Dy.__decorate)([Sy({type:Mf.UniversalString})],Uv.prototype,"universalString",void 0),(0,Dy.__decorate)([Sy({type:Mf.Utf8String})],Uv.prototype,"utf8String",void 0),(0,Dy.__decorate)([Sy({type:Mf.BmpString})],Uv.prototype,"bmpString",void 0),Uv=(0,Dy.__decorate)([Ey({type:xf.Choice})],Uv);let Pv=class extends Uv{constructor(e={}){super(e),Object.assign(this,e)}toString(){return this.ia5String||(this.anyValue?Il.ToHex(this.anyValue):super.toString())}};(0,Dy.__decorate)([Sy({type:Mf.IA5String})],Pv.prototype,"ia5String",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any})],Pv.prototype,"anyValue",void 0),Pv=(0,Dy.__decorate)([Ey({type:xf.Choice})],Pv);class Bv{constructor(e={}){this.type="",this.value=new Pv,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],Bv.prototype,"type",void 0),(0,Dy.__decorate)([Sy({type:Pv})],Bv.prototype,"value",void 0);let xv=_v=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,_v.prototype)}};xv=_v=(0,Dy.__decorate)([Ey({type:xf.Set,itemType:Bv})],xv);let Mv=Dv=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,Dv.prototype)}};Mv=Dv=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:xv})],Mv);let Lv=Rv=class extends Mv{constructor(e){super(e),Object.setPrototypeOf(this,Rv.prototype)}};Lv=Rv=(0,Dy.__decorate)([Ey({type:xf.Sequence})],Lv);const kv={fromASN:e=>Ov.toString(Jp.fromASN(e)),toASN:e=>Jp.toASN(Ov.fromString(e))};class Fv{constructor(e={}){this.typeId="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],Fv.prototype,"typeId",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,context:0})],Fv.prototype,"value",void 0);class Vv{constructor(e={}){this.partyName=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Uv,optional:!0,context:0,implicit:!0})],Vv.prototype,"nameAssigner",void 0),(0,Dy.__decorate)([Sy({type:Uv,context:1,implicit:!0})],Vv.prototype,"partyName",void 0);let Hv=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:Fv,context:0,implicit:!0})],Hv.prototype,"otherName",void 0),(0,Dy.__decorate)([Sy({type:Mf.IA5String,context:1,implicit:!0})],Hv.prototype,"rfc822Name",void 0),(0,Dy.__decorate)([Sy({type:Mf.IA5String,context:2,implicit:!0})],Hv.prototype,"dNSName",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,context:3,implicit:!0})],Hv.prototype,"x400Address",void 0),(0,Dy.__decorate)([Sy({type:Lv,context:4,implicit:!1})],Hv.prototype,"directoryName",void 0),(0,Dy.__decorate)([Sy({type:Vv,context:5})],Hv.prototype,"ediPartyName",void 0),(0,Dy.__decorate)([Sy({type:Mf.IA5String,context:6,implicit:!0})],Hv.prototype,"uniformResourceIdentifier",void 0),(0,Dy.__decorate)([Sy({type:Mf.OctetString,context:7,implicit:!0,converter:kv})],Hv.prototype,"iPAddress",void 0),(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier,context:8,implicit:!0})],Hv.prototype,"registeredID",void 0),Hv=(0,Dy.__decorate)([Ey({type:xf.Choice})],Hv);const jv="1.3.6.1.5.5.7",Kv=`${jv}.3`;var qv;class Gv{constructor(e={}){this.accessMethod="",this.accessLocation=new Hv,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],Gv.prototype,"accessMethod",void 0),(0,Dy.__decorate)([Sy({type:Hv})],Gv.prototype,"accessLocation",void 0);let zv=qv=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,qv.prototype)}};zv=qv=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Gv})],zv);const $v="2.5.29.35";class Wv extends Kp{}class Yv{constructor(e={}){e&&Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Wv,context:0,optional:!0,implicit:!0})],Yv.prototype,"keyIdentifier",void 0),(0,Dy.__decorate)([Sy({type:Hv,context:1,optional:!0,implicit:!0,repeated:"sequence"})],Yv.prototype,"authorityCertIssuer",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,context:2,optional:!0,implicit:!0,converter:$p})],Yv.prototype,"authorityCertSerialNumber",void 0);const Qv="2.5.29.19";class Jv{constructor(e={}){this.cA=!1,Object.assign(this,e)}}var Xv;(0,Dy.__decorate)([Sy({type:Mf.Boolean,defaultValue:!1})],Jv.prototype,"cA",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,optional:!0})],Jv.prototype,"pathLenConstraint",void 0);let Zv=Xv=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,Xv.prototype)}};var eb;Zv=Xv=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Hv})],Zv);let tb=eb=class extends Zv{constructor(e){super(e),Object.setPrototypeOf(this,eb.prototype)}};var rb;tb=eb=(0,Dy.__decorate)([Ey({type:xf.Sequence})],tb);const nb="2.5.29.32";let ib=class{constructor(e={}){Object.assign(this,e)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};(0,Dy.__decorate)([Sy({type:Mf.IA5String})],ib.prototype,"ia5String",void 0),(0,Dy.__decorate)([Sy({type:Mf.VisibleString})],ib.prototype,"visibleString",void 0),(0,Dy.__decorate)([Sy({type:Mf.BmpString})],ib.prototype,"bmpString",void 0),(0,Dy.__decorate)([Sy({type:Mf.Utf8String})],ib.prototype,"utf8String",void 0),ib=(0,Dy.__decorate)([Ey({type:xf.Choice})],ib);class sb{constructor(e={}){this.organization=new ib,this.noticeNumbers=[],Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:ib})],sb.prototype,"organization",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,repeated:"sequence"})],sb.prototype,"noticeNumbers",void 0);class ob{constructor(e={}){Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:sb,optional:!0})],ob.prototype,"noticeRef",void 0),(0,Dy.__decorate)([Sy({type:ib,optional:!0})],ob.prototype,"explicitText",void 0);let ab=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:Mf.IA5String})],ab.prototype,"cPSuri",void 0),(0,Dy.__decorate)([Sy({type:ob})],ab.prototype,"userNotice",void 0),ab=(0,Dy.__decorate)([Ey({type:xf.Choice})],ab);class cb{constructor(e={}){this.policyQualifierId="",this.qualifier=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],cb.prototype,"policyQualifierId",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any})],cb.prototype,"qualifier",void 0);class ub{constructor(e={}){this.policyIdentifier="",Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],ub.prototype,"policyIdentifier",void 0),(0,Dy.__decorate)([Sy({type:cb,repeated:"sequence",optional:!0})],ub.prototype,"policyQualifiers",void 0);let hb=rb=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,rb.prototype)}};hb=rb=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:ub})],hb);let db=class{constructor(e=0){this.value=e}};(0,Dy.__decorate)([Sy({type:Mf.Integer})],db.prototype,"value",void 0),db=(0,Dy.__decorate)([Ey({type:xf.Choice})],db);let lb=class extends db{};var fb;lb=(0,Dy.__decorate)([Ey({type:xf.Choice})],lb);var pb;!function(e){e[e.unused=1]="unused",e[e.keyCompromise=2]="keyCompromise",e[e.cACompromise=4]="cACompromise",e[e.affiliationChanged=8]="affiliationChanged",e[e.superseded=16]="superseded",e[e.cessationOfOperation=32]="cessationOfOperation",e[e.certificateHold=64]="certificateHold",e[e.privilegeWithdrawn=128]="privilegeWithdrawn",e[e.aACompromise=256]="aACompromise"}(pb||(pb={}));class yb extends jp{toJSON(){const e=[],t=this.toNumber();return t&pb.aACompromise&&e.push("aACompromise"),t&pb.affiliationChanged&&e.push("affiliationChanged"),t&pb.cACompromise&&e.push("cACompromise"),t&pb.certificateHold&&e.push("certificateHold"),t&pb.cessationOfOperation&&e.push("cessationOfOperation"),t&pb.keyCompromise&&e.push("keyCompromise"),t&pb.privilegeWithdrawn&&e.push("privilegeWithdrawn"),t&pb.superseded&&e.push("superseded"),t&pb.unused&&e.push("unused"),e}toString(){return`[${this.toJSON().join(", ")}]`}}let mb=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:Hv,context:0,repeated:"sequence",implicit:!0})],mb.prototype,"fullName",void 0),(0,Dy.__decorate)([Sy({type:xv,context:1,implicit:!0})],mb.prototype,"nameRelativeToCRLIssuer",void 0),mb=(0,Dy.__decorate)([Ey({type:xf.Choice})],mb);class gb{constructor(e={}){Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:mb,context:0,optional:!0})],gb.prototype,"distributionPoint",void 0),(0,Dy.__decorate)([Sy({type:yb,context:1,optional:!0,implicit:!0})],gb.prototype,"reasons",void 0),(0,Dy.__decorate)([Sy({type:Hv,context:2,optional:!0,repeated:"sequence",implicit:!0})],gb.prototype,"cRLIssuer",void 0);let vb=fb=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,fb.prototype)}};var bb;vb=fb=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:gb})],vb);let Eb=bb=class extends vb{constructor(e){super(e),Object.setPrototypeOf(this,bb.prototype)}};Eb=bb=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:gb})],Eb);class Sb{constructor(e={}){this.onlyContainsUserCerts=Sb.ONLY,this.onlyContainsCACerts=Sb.ONLY,this.indirectCRL=Sb.ONLY,this.onlyContainsAttributeCerts=Sb.ONLY,Object.assign(this,e)}}Sb.ONLY=!1,(0,Dy.__decorate)([Sy({type:mb,context:0,optional:!0})],Sb.prototype,"distributionPoint",void 0),(0,Dy.__decorate)([Sy({type:Mf.Boolean,context:1,defaultValue:Sb.ONLY,implicit:!0})],Sb.prototype,"onlyContainsUserCerts",void 0),(0,Dy.__decorate)([Sy({type:Mf.Boolean,context:2,defaultValue:Sb.ONLY,implicit:!0})],Sb.prototype,"onlyContainsCACerts",void 0),(0,Dy.__decorate)([Sy({type:yb,context:3,optional:!0,implicit:!0})],Sb.prototype,"onlySomeReasons",void 0),(0,Dy.__decorate)([Sy({type:Mf.Boolean,context:4,defaultValue:Sb.ONLY,implicit:!0})],Sb.prototype,"indirectCRL",void 0),(0,Dy.__decorate)([Sy({type:Mf.Boolean,context:5,defaultValue:Sb.ONLY,implicit:!0})],Sb.prototype,"onlyContainsAttributeCerts",void 0);var Ab;!function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(Ab||(Ab={}));let Ib=class{constructor(e=Ab.unspecified){this.reason=Ab.unspecified,this.reason=e}toJSON(){return Ab[this.reason]}toString(){return this.toJSON()}};var wb;(0,Dy.__decorate)([Sy({type:Mf.Enumerated})],Ib.prototype,"reason",void 0),Ib=(0,Dy.__decorate)([Ey({type:xf.Choice})],Ib);const Tb="2.5.29.37";let Cb=wb=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,wb.prototype)}};Cb=wb=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Mf.ObjectIdentifier})],Cb);const _b=`${Kv}.1`,Db=`${Kv}.2`,Rb=`${Kv}.3`,Nb=`${Kv}.4`,Ob=`${Kv}.8`,Ub=`${Kv}.9`;let Pb=class{constructor(e=new ArrayBuffer(0)){this.value=e}};(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],Pb.prototype,"value",void 0),Pb=(0,Dy.__decorate)([Ey({type:xf.Choice})],Pb);let Bb=class{constructor(e){this.value=new Date,e&&(this.value=e)}};var xb;(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime})],Bb.prototype,"value",void 0),Bb=(0,Dy.__decorate)([Ey({type:xf.Choice})],Bb);let Mb=xb=class extends Zv{constructor(e){super(e),Object.setPrototypeOf(this,xb.prototype)}};Mb=xb=(0,Dy.__decorate)([Ey({type:xf.Sequence})],Mb);const Lb="2.5.29.15";var kb,Fb;!function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(kb||(kb={}));class Vb extends jp{toJSON(){const e=this.toNumber(),t=[];return e&kb.cRLSign&&t.push("crlSign"),e&kb.dataEncipherment&&t.push("dataEncipherment"),e&kb.decipherOnly&&t.push("decipherOnly"),e&kb.digitalSignature&&t.push("digitalSignature"),e&kb.encipherOnly&&t.push("encipherOnly"),e&kb.keyAgreement&&t.push("keyAgreement"),e&kb.keyCertSign&&t.push("keyCertSign"),e&kb.keyEncipherment&&t.push("keyEncipherment"),e&kb.nonRepudiation&&t.push("nonRepudiation"),t}toString(){return`[${this.toJSON().join(", ")}]`}}class Hb{constructor(e={}){this.base=new Hv,this.minimum=0,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Hv})],Hb.prototype,"base",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,context:0,defaultValue:0,implicit:!0})],Hb.prototype,"minimum",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,context:1,optional:!0,implicit:!0})],Hb.prototype,"maximum",void 0);let jb=Fb=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,Fb.prototype)}};jb=Fb=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Hb})],jb);class Kb{constructor(e={}){Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:jb,context:0,optional:!0,implicit:!0})],Kb.prototype,"permittedSubtrees",void 0),(0,Dy.__decorate)([Sy({type:jb,context:1,optional:!0,implicit:!0})],Kb.prototype,"excludedSubtrees",void 0);class qb{constructor(e={}){Object.assign(this,e)}}var Gb;(0,Dy.__decorate)([Sy({type:Mf.Integer,context:0,implicit:!0,optional:!0,converter:$p})],qb.prototype,"requireExplicitPolicy",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,context:1,implicit:!0,optional:!0,converter:$p})],qb.prototype,"inhibitPolicyMapping",void 0);class zb{constructor(e={}){this.issuerDomainPolicy="",this.subjectDomainPolicy="",Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],zb.prototype,"issuerDomainPolicy",void 0),(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],zb.prototype,"subjectDomainPolicy",void 0);let $b=Gb=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,Gb.prototype)}};var Wb;$b=Gb=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:zb})],$b);const Yb="2.5.29.17";let Qb=Wb=class extends Zv{constructor(e){super(e),Object.setPrototypeOf(this,Wb.prototype)}};Qb=Wb=(0,Dy.__decorate)([Ey({type:xf.Sequence})],Qb);class Jb{constructor(e={}){this.type="",this.values=[],Object.assign(this,e)}}var Xb;(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],Jb.prototype,"type",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,repeated:"set"})],Jb.prototype,"values",void 0);let Zb=Xb=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,Xb.prototype)}};Zb=Xb=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Jb})],Zb);const eE="2.5.29.14";class tE extends Wv{}class rE{constructor(e={}){Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime,context:0,implicit:!0,optional:!0})],rE.prototype,"notBefore",void 0),(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime,context:1,implicit:!0,optional:!0})],rE.prototype,"notAfter",void 0);var nE,iE;!function(e){e[e.keyUpdateAllowed=1]="keyUpdateAllowed",e[e.newExtensions=2]="newExtensions",e[e.pKIXCertificate=4]="pKIXCertificate"}(nE||(nE={}));class sE extends jp{toJSON(){const e=[],t=this.toNumber();return t&nE.pKIXCertificate&&e.push("pKIXCertificate"),t&nE.newExtensions&&e.push("newExtensions"),t&nE.keyUpdateAllowed&&e.push("keyUpdateAllowed"),e}toString(){return`[${this.toJSON().join(", ")}]`}}class oE{constructor(e={}){this.entrustVers="",this.entrustInfoFlags=new sE,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.GeneralString})],oE.prototype,"entrustVers",void 0),(0,Dy.__decorate)([Sy({type:sE})],oE.prototype,"entrustInfoFlags",void 0);let aE=iE=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,iE.prototype)}};aE=iE=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Gv})],aE);class cE{constructor(e={}){this.algorithm="",Object.assign(this,e)}isEqual(e){return e instanceof cE&&e.algorithm==this.algorithm&&(e.parameters&&this.parameters&&Tl(e.parameters,this.parameters)||e.parameters===this.parameters)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],cE.prototype,"algorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,optional:!0})],cE.prototype,"parameters",void 0);class uE{constructor(e={}){this.algorithm=new cE,this.subjectPublicKey=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:cE})],uE.prototype,"algorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString})],uE.prototype,"subjectPublicKey",void 0);let hE=class{constructor(e){if(e)if("string"==typeof e||"number"==typeof e||e instanceof Date){const t=new Date(e);t.getUTCFullYear()>2049?this.generalTime=t:this.utcTime=t}else Object.assign(this,e)}getTime(){const e=this.utcTime||this.generalTime;if(!e)throw new Error("Cannot get time from CHOICE object");return e}};(0,Dy.__decorate)([Sy({type:Mf.UTCTime})],hE.prototype,"utcTime",void 0),(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime})],hE.prototype,"generalTime",void 0),hE=(0,Dy.__decorate)([Ey({type:xf.Choice})],hE);class dE{constructor(e){this.notBefore=new hE(new Date),this.notAfter=new hE(new Date),e&&(this.notBefore=new hE(e.notBefore),this.notAfter=new hE(e.notAfter))}}var lE;(0,Dy.__decorate)([Sy({type:hE})],dE.prototype,"notBefore",void 0),(0,Dy.__decorate)([Sy({type:hE})],dE.prototype,"notAfter",void 0);class fE{constructor(e={}){this.extnID="",this.critical=fE.CRITICAL,this.extnValue=new Kp,Object.assign(this,e)}}fE.CRITICAL=!1,(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],fE.prototype,"extnID",void 0),(0,Dy.__decorate)([Sy({type:Mf.Boolean,defaultValue:fE.CRITICAL})],fE.prototype,"critical",void 0),(0,Dy.__decorate)([Sy({type:Kp})],fE.prototype,"extnValue",void 0);let pE=lE=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,lE.prototype)}};var yE,mE;pE=lE=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:fE})],pE),function(e){e[e.v1=0]="v1",e[e.v2=1]="v2",e[e.v3=2]="v3"}(yE||(yE={}));class gE{constructor(e={}){this.version=yE.v1,this.serialNumber=new ArrayBuffer(0),this.signature=new cE,this.issuer=new Lv,this.validity=new dE,this.subject=new Lv,this.subjectPublicKeyInfo=new uE,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer,context:0,defaultValue:yE.v1})],gE.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],gE.prototype,"serialNumber",void 0),(0,Dy.__decorate)([Sy({type:cE})],gE.prototype,"signature",void 0),(0,Dy.__decorate)([Sy({type:Lv})],gE.prototype,"issuer",void 0),(0,Dy.__decorate)([Sy({type:dE})],gE.prototype,"validity",void 0),(0,Dy.__decorate)([Sy({type:Lv})],gE.prototype,"subject",void 0),(0,Dy.__decorate)([Sy({type:uE})],gE.prototype,"subjectPublicKeyInfo",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString,context:1,implicit:!0,optional:!0})],gE.prototype,"issuerUniqueID",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString,context:2,implicit:!0,optional:!0})],gE.prototype,"subjectUniqueID",void 0),(0,Dy.__decorate)([Sy({type:pE,context:3,optional:!0})],gE.prototype,"extensions",void 0);class vE{constructor(e={}){this.tbsCertificate=new gE,this.signatureAlgorithm=new cE,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:gE})],vE.prototype,"tbsCertificate",void 0),(0,Dy.__decorate)([Sy({type:cE})],vE.prototype,"signatureAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString})],vE.prototype,"signatureValue",void 0);class bE{constructor(e={}){this.userCertificate=new ArrayBuffer(0),this.revocationDate=new hE,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],bE.prototype,"userCertificate",void 0),(0,Dy.__decorate)([Sy({type:hE})],bE.prototype,"revocationDate",void 0),(0,Dy.__decorate)([Sy({type:fE,optional:!0,repeated:"sequence"})],bE.prototype,"crlEntryExtensions",void 0);class EE{constructor(e={}){this.signature=new cE,this.issuer=new Lv,this.thisUpdate=new hE,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer,optional:!0})],EE.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:cE})],EE.prototype,"signature",void 0),(0,Dy.__decorate)([Sy({type:Lv})],EE.prototype,"issuer",void 0),(0,Dy.__decorate)([Sy({type:hE})],EE.prototype,"thisUpdate",void 0),(0,Dy.__decorate)([Sy({type:hE,optional:!0})],EE.prototype,"nextUpdate",void 0),(0,Dy.__decorate)([Sy({type:bE,repeated:"sequence",optional:!0})],EE.prototype,"revokedCertificates",void 0),(0,Dy.__decorate)([Sy({type:fE,optional:!0,context:0,repeated:"sequence"})],EE.prototype,"crlExtensions",void 0);class SE{constructor(e={}){this.tbsCertList=new EE,this.signatureAlgorithm=new cE,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:EE})],SE.prototype,"tbsCertList",void 0),(0,Dy.__decorate)([Sy({type:cE})],SE.prototype,"signatureAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString})],SE.prototype,"signature",void 0);class AE{constructor(e={}){this.attrType="",this.attrValues=[],Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],AE.prototype,"attrType",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,repeated:"set"})],AE.prototype,"attrValues",void 0);class IE{constructor(e={}){this.acIssuer=new Hv,this.acSerial=0,this.attrs=[],Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Hv})],IE.prototype,"acIssuer",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer})],IE.prototype,"acSerial",void 0),(0,Dy.__decorate)([Sy({type:Jb,repeated:"sequence"})],IE.prototype,"attrs",void 0);let wE=mE=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,mE.prototype)}};wE=mE=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Mf.ObjectIdentifier})],wE);class TE{constructor(e={}){this.permitUnSpecified=!0,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer,optional:!0})],TE.prototype,"pathLenConstraint",void 0),(0,Dy.__decorate)([Sy({type:wE,implicit:!0,context:0,optional:!0})],TE.prototype,"permittedAttrs",void 0),(0,Dy.__decorate)([Sy({type:wE,implicit:!0,context:1,optional:!0})],TE.prototype,"excludedAttrs",void 0),(0,Dy.__decorate)([Sy({type:Mf.Boolean,defaultValue:!0})],TE.prototype,"permitUnSpecified",void 0);class CE{constructor(e={}){this.issuer=new Zv,this.serial=new ArrayBuffer(0),this.issuerUID=new ArrayBuffer(0),Object.assign(this,e)}}var _E;(0,Dy.__decorate)([Sy({type:Zv})],CE.prototype,"issuer",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],CE.prototype,"serial",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString,optional:!0})],CE.prototype,"issuerUID",void 0),function(e){e[e.publicKey=0]="publicKey",e[e.publicKeyCert=1]="publicKeyCert",e[e.otherObjectTypes=2]="otherObjectTypes"}(_E||(_E={}));class DE{constructor(e={}){this.digestedObjectType=_E.publicKey,this.digestAlgorithm=new cE,this.objectDigest=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Enumerated})],DE.prototype,"digestedObjectType",void 0),(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier,optional:!0})],DE.prototype,"otherObjectTypeID",void 0),(0,Dy.__decorate)([Sy({type:cE})],DE.prototype,"digestAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString})],DE.prototype,"objectDigest",void 0);class RE{constructor(e={}){Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Zv,optional:!0})],RE.prototype,"issuerName",void 0),(0,Dy.__decorate)([Sy({type:CE,context:0,implicit:!0,optional:!0})],RE.prototype,"baseCertificateID",void 0),(0,Dy.__decorate)([Sy({type:DE,context:1,implicit:!0,optional:!0})],RE.prototype,"objectDigestInfo",void 0);let NE=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:Hv,repeated:"sequence"})],NE.prototype,"v1Form",void 0),(0,Dy.__decorate)([Sy({type:RE,context:0,implicit:!0})],NE.prototype,"v2Form",void 0),NE=(0,Dy.__decorate)([Ey({type:xf.Choice})],NE);class OE{constructor(e={}){this.notBeforeTime=new Date,this.notAfterTime=new Date,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime})],OE.prototype,"notBeforeTime",void 0),(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime})],OE.prototype,"notAfterTime",void 0);class UE{constructor(e={}){Object.assign(this,e)}}var PE,BE;(0,Dy.__decorate)([Sy({type:CE,implicit:!0,context:0,optional:!0})],UE.prototype,"baseCertificateID",void 0),(0,Dy.__decorate)([Sy({type:Zv,implicit:!0,context:1,optional:!0})],UE.prototype,"entityName",void 0),(0,Dy.__decorate)([Sy({type:DE,implicit:!0,context:2,optional:!0})],UE.prototype,"objectDigestInfo",void 0),function(e){e[e.v2=1]="v2"}(PE||(PE={}));class xE{constructor(e={}){this.version=PE.v2,this.holder=new UE,this.issuer=new NE,this.signature=new cE,this.serialNumber=new ArrayBuffer(0),this.attrCertValidityPeriod=new OE,this.attributes=[],Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],xE.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:UE})],xE.prototype,"holder",void 0),(0,Dy.__decorate)([Sy({type:NE})],xE.prototype,"issuer",void 0),(0,Dy.__decorate)([Sy({type:cE})],xE.prototype,"signature",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],xE.prototype,"serialNumber",void 0),(0,Dy.__decorate)([Sy({type:OE})],xE.prototype,"attrCertValidityPeriod",void 0),(0,Dy.__decorate)([Sy({type:Jb,repeated:"sequence"})],xE.prototype,"attributes",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString,optional:!0})],xE.prototype,"issuerUniqueID",void 0),(0,Dy.__decorate)([Sy({type:pE,optional:!0})],xE.prototype,"extensions",void 0);class ME{constructor(e={}){this.acinfo=new xE,this.signatureAlgorithm=new cE,this.signatureValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:xE})],ME.prototype,"acinfo",void 0),(0,Dy.__decorate)([Sy({type:cE})],ME.prototype,"signatureAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString})],ME.prototype,"signatureValue",void 0),function(e){e[e.unmarked=1]="unmarked",e[e.unclassified=2]="unclassified",e[e.restricted=4]="restricted",e[e.confidential=8]="confidential",e[e.secret=16]="secret",e[e.topSecret=32]="topSecret"}(BE||(BE={}));class LE extends jp{}class kE{constructor(e={}){this.type="",this.value=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier,implicit:!0,context:0})],kE.prototype,"type",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,implicit:!0,context:1})],kE.prototype,"value",void 0);class FE{constructor(e={}){this.policyId="",this.classList=new LE(BE.unclassified),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],FE.prototype,"policyId",void 0),(0,Dy.__decorate)([Sy({type:LE,defaultValue:new LE(BE.unclassified)})],FE.prototype,"classList",void 0),(0,Dy.__decorate)([Sy({type:kE,repeated:"set"})],FE.prototype,"securityCategories",void 0);class VE{constructor(e={}){Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Kp})],VE.prototype,"cotets",void 0),(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],VE.prototype,"oid",void 0),(0,Dy.__decorate)([Sy({type:Mf.Utf8String})],VE.prototype,"string",void 0);class HE{constructor(e={}){this.values=[],Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Zv,implicit:!0,context:0,optional:!0})],HE.prototype,"policyAuthority",void 0),(0,Dy.__decorate)([Sy({type:VE,repeated:"sequence"})],HE.prototype,"values",void 0);var jE;class KE{constructor(e={}){this.targetCertificate=new CE,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:CE})],KE.prototype,"targetCertificate",void 0),(0,Dy.__decorate)([Sy({type:Hv,optional:!0})],KE.prototype,"targetName",void 0),(0,Dy.__decorate)([Sy({type:DE,optional:!0})],KE.prototype,"certDigestInfo",void 0);let qE=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:Hv,context:0,implicit:!0})],qE.prototype,"targetName",void 0),(0,Dy.__decorate)([Sy({type:Hv,context:1,implicit:!0})],qE.prototype,"targetGroup",void 0),(0,Dy.__decorate)([Sy({type:KE,context:2,implicit:!0})],qE.prototype,"targetCert",void 0),qE=(0,Dy.__decorate)([Ey({type:xf.Choice})],qE);let GE=jE=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,jE.prototype)}};var zE;GE=jE=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:qE})],GE);let $E=zE=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,zE.prototype)}};$E=zE=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:GE})],$E);class WE{constructor(e={}){Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Zv,implicit:!0,context:0,optional:!0})],WE.prototype,"roleAuthority",void 0),(0,Dy.__decorate)([Sy({type:Hv,implicit:!0,context:1})],WE.prototype,"roleName",void 0);class YE{constructor(e={}){this.service=new Hv,this.ident=new Hv,Object.assign(this,e)}}var QE;(0,Dy.__decorate)([Sy({type:Hv})],YE.prototype,"service",void 0),(0,Dy.__decorate)([Sy({type:Hv})],YE.prototype,"ident",void 0),(0,Dy.__decorate)([Sy({type:Kp,optional:!0})],YE.prototype,"authInfo",void 0);class JE{constructor(e={}){this.otherCertFormat="",this.otherCert=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],JE.prototype,"otherCertFormat",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any})],JE.prototype,"otherCert",void 0);let XE=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:vE})],XE.prototype,"certificate",void 0),(0,Dy.__decorate)([Sy({type:ME,context:2,implicit:!0})],XE.prototype,"v2AttrCert",void 0),(0,Dy.__decorate)([Sy({type:JE,context:3,implicit:!0})],XE.prototype,"other",void 0),XE=(0,Dy.__decorate)([Ey({type:xf.Choice})],XE);let ZE=QE=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,QE.prototype)}};ZE=QE=(0,Dy.__decorate)([Ey({type:xf.Set,itemType:XE})],ZE);class eS{constructor(e={}){this.contentType="",this.content=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],eS.prototype,"contentType",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,context:0})],eS.prototype,"content",void 0);let tS=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:Kp})],tS.prototype,"single",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any})],tS.prototype,"any",void 0),tS=(0,Dy.__decorate)([Ey({type:xf.Choice})],tS);class rS{constructor(e={}){this.eContentType="",Object.assign(this,e)}}var nS;(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],rS.prototype,"eContentType",void 0),(0,Dy.__decorate)([Sy({type:tS,context:0,optional:!0})],rS.prototype,"eContent",void 0),function(e){e[e.v0=0]="v0",e[e.v1=1]="v1",e[e.v2=2]="v2",e[e.v3=3]="v3",e[e.v4=4]="v4",e[e.v5=5]="v5"}(nS||(nS={}));let iS=class extends cE{};iS=(0,Dy.__decorate)([Ey({type:xf.Sequence})],iS);let sS=class extends cE{};sS=(0,Dy.__decorate)([Ey({type:xf.Sequence})],sS);let oS=class extends cE{};oS=(0,Dy.__decorate)([Ey({type:xf.Sequence})],oS);let aS=class extends cE{};aS=(0,Dy.__decorate)([Ey({type:xf.Sequence})],aS);let cS=class extends cE{};cS=(0,Dy.__decorate)([Ey({type:xf.Sequence})],cS);let uS=class extends cE{};uS=(0,Dy.__decorate)([Ey({type:xf.Sequence})],uS);let hS=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:Kp,context:0,implicit:!0,optional:!0})],hS.prototype,"value",void 0),(0,Dy.__decorate)([Sy({type:Kp,converter:Xp,context:0,implicit:!0,optional:!0,repeated:"sequence"})],hS.prototype,"constructedValue",void 0),hS=(0,Dy.__decorate)([Ey({type:xf.Choice})],hS);class dS{constructor(e={}){this.contentType="",this.contentEncryptionAlgorithm=new aS,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],dS.prototype,"contentType",void 0),(0,Dy.__decorate)([Sy({type:aS})],dS.prototype,"contentEncryptionAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:hS,optional:!0})],dS.prototype,"encryptedContent",void 0);class lS{constructor(e={}){this.issuer=new Lv,this.serialNumber=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Lv})],lS.prototype,"issuer",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],lS.prototype,"serialNumber",void 0);class fS{constructor(e={}){this.keyAttrId="",Object.assign(this,e)}}var pS;(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],fS.prototype,"keyAttrId",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,optional:!0})],fS.prototype,"keyAttr",void 0);class yS{constructor(e={}){this.subjectKeyIdentifier=new tE,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:tE})],yS.prototype,"subjectKeyIdentifier",void 0),(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime,optional:!0})],yS.prototype,"date",void 0),(0,Dy.__decorate)([Sy({type:fS,optional:!0})],yS.prototype,"other",void 0);let mS=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:yS,context:0,implicit:!0,optional:!0})],mS.prototype,"rKeyId",void 0),(0,Dy.__decorate)([Sy({type:lS,optional:!0})],mS.prototype,"issuerAndSerialNumber",void 0),mS=(0,Dy.__decorate)([Ey({type:xf.Choice})],mS);class gS{constructor(e={}){this.rid=new mS,this.encryptedKey=new Kp,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:mS})],gS.prototype,"rid",void 0),(0,Dy.__decorate)([Sy({type:Kp})],gS.prototype,"encryptedKey",void 0);let vS=pS=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,pS.prototype)}};vS=pS=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:gS})],vS);class bS{constructor(e={}){this.algorithm=new cE,this.publicKey=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:cE})],bS.prototype,"algorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString})],bS.prototype,"publicKey",void 0);let ES=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:tE,context:0,implicit:!0,optional:!0})],ES.prototype,"subjectKeyIdentifier",void 0),(0,Dy.__decorate)([Sy({type:bS,context:1,implicit:!0,optional:!0})],ES.prototype,"originatorKey",void 0),(0,Dy.__decorate)([Sy({type:lS,optional:!0})],ES.prototype,"issuerAndSerialNumber",void 0),ES=(0,Dy.__decorate)([Ey({type:xf.Choice})],ES);class SS{constructor(e={}){this.version=nS.v3,this.originator=new ES,this.keyEncryptionAlgorithm=new oS,this.recipientEncryptedKeys=new vS,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],SS.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:ES,context:0})],SS.prototype,"originator",void 0),(0,Dy.__decorate)([Sy({type:Kp,context:1,optional:!0})],SS.prototype,"ukm",void 0),(0,Dy.__decorate)([Sy({type:oS})],SS.prototype,"keyEncryptionAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:vS})],SS.prototype,"recipientEncryptedKeys",void 0);let AS=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:tE,context:0,implicit:!0})],AS.prototype,"subjectKeyIdentifier",void 0),(0,Dy.__decorate)([Sy({type:lS})],AS.prototype,"issuerAndSerialNumber",void 0),AS=(0,Dy.__decorate)([Ey({type:xf.Choice})],AS);class IS{constructor(e={}){this.version=nS.v0,this.rid=new AS,this.keyEncryptionAlgorithm=new oS,this.encryptedKey=new Kp,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],IS.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:AS})],IS.prototype,"rid",void 0),(0,Dy.__decorate)([Sy({type:oS})],IS.prototype,"keyEncryptionAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Kp})],IS.prototype,"encryptedKey",void 0);class wS{constructor(e={}){this.keyIdentifier=new Kp,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Kp})],wS.prototype,"keyIdentifier",void 0),(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime,optional:!0})],wS.prototype,"date",void 0),(0,Dy.__decorate)([Sy({type:fS,optional:!0})],wS.prototype,"other",void 0);class TS{constructor(e={}){this.version=nS.v4,this.kekid=new wS,this.keyEncryptionAlgorithm=new oS,this.encryptedKey=new Kp,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],TS.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:wS})],TS.prototype,"kekid",void 0),(0,Dy.__decorate)([Sy({type:oS})],TS.prototype,"keyEncryptionAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Kp})],TS.prototype,"encryptedKey",void 0);class CS{constructor(e={}){this.version=nS.v0,this.keyEncryptionAlgorithm=new oS,this.encryptedKey=new Kp,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],CS.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:uS,context:0,optional:!0})],CS.prototype,"keyDerivationAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:oS})],CS.prototype,"keyEncryptionAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Kp})],CS.prototype,"encryptedKey",void 0);class _S{constructor(e={}){this.oriType="",this.oriValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],_S.prototype,"oriType",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any})],_S.prototype,"oriValue",void 0);let DS=class{constructor(e={}){Object.assign(this,e)}};var RS;(0,Dy.__decorate)([Sy({type:IS,optional:!0})],DS.prototype,"ktri",void 0),(0,Dy.__decorate)([Sy({type:SS,context:1,implicit:!0,optional:!0})],DS.prototype,"kari",void 0),(0,Dy.__decorate)([Sy({type:TS,context:2,implicit:!0,optional:!0})],DS.prototype,"kekri",void 0),(0,Dy.__decorate)([Sy({type:CS,context:3,implicit:!0,optional:!0})],DS.prototype,"pwri",void 0),(0,Dy.__decorate)([Sy({type:_S,context:4,implicit:!0,optional:!0})],DS.prototype,"ori",void 0),DS=(0,Dy.__decorate)([Ey({type:xf.Choice})],DS);let NS=RS=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,RS.prototype)}};var OS;NS=RS=(0,Dy.__decorate)([Ey({type:xf.Set,itemType:DS})],NS);class US{constructor(e={}){this.otherRevInfoFormat="",this.otherRevInfo=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],US.prototype,"otherRevInfoFormat",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any})],US.prototype,"otherRevInfo",void 0);let PS=class{constructor(e={}){this.other=new US,Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:US,context:1,implicit:!0})],PS.prototype,"other",void 0),PS=(0,Dy.__decorate)([Ey({type:xf.Choice})],PS);let BS=OS=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,OS.prototype)}};BS=OS=(0,Dy.__decorate)([Ey({type:xf.Set,itemType:PS})],BS);class xS{constructor(e={}){Object.assign(this,e)}}var MS;(0,Dy.__decorate)([Sy({type:ZE,context:0,implicit:!0,optional:!0})],xS.prototype,"certs",void 0),(0,Dy.__decorate)([Sy({type:BS,context:1,implicit:!0,optional:!0})],xS.prototype,"crls",void 0);let LS=MS=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,MS.prototype)}};LS=MS=(0,Dy.__decorate)([Ey({type:xf.Set,itemType:AE})],LS);class kS{constructor(e={}){this.version=nS.v0,this.recipientInfos=new NS,this.encryptedContentInfo=new dS,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],kS.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:xS,context:0,implicit:!0,optional:!0})],kS.prototype,"originatorInfo",void 0),(0,Dy.__decorate)([Sy({type:NS})],kS.prototype,"recipientInfos",void 0),(0,Dy.__decorate)([Sy({type:dS})],kS.prototype,"encryptedContentInfo",void 0),(0,Dy.__decorate)([Sy({type:LS,context:1,implicit:!0,optional:!0})],kS.prototype,"unprotectedAttrs",void 0);let FS=class{constructor(e={}){Object.assign(this,e)}};var VS;(0,Dy.__decorate)([Sy({type:tE,context:0,implicit:!0})],FS.prototype,"subjectKeyIdentifier",void 0),(0,Dy.__decorate)([Sy({type:lS})],FS.prototype,"issuerAndSerialNumber",void 0),FS=(0,Dy.__decorate)([Ey({type:xf.Choice})],FS);class HS{constructor(e={}){this.version=nS.v0,this.sid=new FS,this.digestAlgorithm=new iS,this.signatureAlgorithm=new sS,this.signature=new Kp,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],HS.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:FS})],HS.prototype,"sid",void 0),(0,Dy.__decorate)([Sy({type:iS})],HS.prototype,"digestAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:AE,repeated:"set",context:0,implicit:!0,optional:!0})],HS.prototype,"signedAttrs",void 0),(0,Dy.__decorate)([Sy({type:sS})],HS.prototype,"signatureAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Kp})],HS.prototype,"signature",void 0),(0,Dy.__decorate)([Sy({type:AE,repeated:"set",context:1,implicit:!0,optional:!0})],HS.prototype,"unsignedAttrs",void 0);let jS=VS=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,VS.prototype)}};var KS;jS=VS=(0,Dy.__decorate)([Ey({type:xf.Set,itemType:HS})],jS);let qS=KS=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,KS.prototype)}};qS=KS=(0,Dy.__decorate)([Ey({type:xf.Set,itemType:iS})],qS);class GS{constructor(e={}){this.version=nS.v0,this.digestAlgorithms=new qS,this.encapContentInfo=new rS,this.signerInfos=new jS,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],GS.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:qS})],GS.prototype,"digestAlgorithms",void 0),(0,Dy.__decorate)([Sy({type:rS})],GS.prototype,"encapContentInfo",void 0),(0,Dy.__decorate)([Sy({type:ZE,context:0,implicit:!0,optional:!0})],GS.prototype,"certificates",void 0),(0,Dy.__decorate)([Sy({type:PS,context:1,implicit:!0,optional:!0})],GS.prototype,"crls",void 0),(0,Dy.__decorate)([Sy({type:jS})],GS.prototype,"signerInfos",void 0);const zS="1.2.840.10045.2.1",$S="1.2.840.10045.4.1",WS="1.2.840.10045.4.3.1",YS="1.2.840.10045.4.3.2",QS="1.2.840.10045.4.3.3",JS="1.2.840.10045.4.3.4",XS="1.2.840.10045.3.1.7",ZS="1.3.132.0.34",eA="1.3.132.0.35";function tA(e){return new cE({algorithm:e})}const rA=tA($S),nA=(tA(WS),tA(YS)),iA=tA(QS),sA=tA(JS);let oA=class{constructor(e={}){Object.assign(this,e)}};(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],oA.prototype,"namedCurve",void 0),oA=(0,Dy.__decorate)([Ey({type:xf.Choice})],oA);class aA{constructor(e={}){this.version=1,this.privateKey=new Kp,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],aA.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:Kp})],aA.prototype,"privateKey",void 0),(0,Dy.__decorate)([Sy({type:oA,context:0,optional:!0})],aA.prototype,"parameters",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString,context:1,optional:!0})],aA.prototype,"publicKey",void 0);class cA{constructor(e={}){this.r=new ArrayBuffer(0),this.s=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],cA.prototype,"r",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],cA.prototype,"s",void 0);const uA="1.2.840.113549.1.1",hA=`${uA}.1`,dA=`${uA}.7`,lA=`${uA}.9`,fA=`${uA}.10`,pA=`${uA}.2`,yA=`${uA}.4`,mA=`${uA}.5`,gA=`${uA}.14`,vA=`${uA}.11`,bA=`${uA}.12`,EA=`${uA}.13`,SA=`${uA}.15`,AA=`${uA}.16`,IA="1.3.14.3.2.26",wA="2.16.840.1.101.3.4.2.4",TA="2.16.840.1.101.3.4.2.1",CA="2.16.840.1.101.3.4.2.2",_A="2.16.840.1.101.3.4.2.3",DA=`${uA}.8`;function RA(e){return new cE({algorithm:e,parameters:null})}RA("1.2.840.113549.2.2"),RA("1.2.840.113549.2.5");const NA=RA(IA),OA=(RA(wA),RA(TA),RA(CA),RA(_A),RA("2.16.840.1.101.3.4.2.5"),RA("2.16.840.1.101.3.4.2.6"),new cE({algorithm:DA,parameters:Cy.serialize(NA)})),UA=new cE({algorithm:lA,parameters:Cy.serialize(Jp.toASN(new Uint8Array([218,57,163,238,94,107,75,13,50,85,191,239,149,96,24,144,175,216,7,9]).buffer))});RA(hA),RA(pA),RA(yA),RA(mA),RA(SA),RA(AA),RA(bA),RA(EA),RA(SA),RA(AA);class PA{constructor(e={}){this.hashAlgorithm=new cE(NA),this.maskGenAlgorithm=new cE({algorithm:DA,parameters:Cy.serialize(NA)}),this.pSourceAlgorithm=new cE(UA),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:cE,context:0,defaultValue:NA})],PA.prototype,"hashAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:cE,context:1,defaultValue:OA})],PA.prototype,"maskGenAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:cE,context:2,defaultValue:UA})],PA.prototype,"pSourceAlgorithm",void 0);new cE({algorithm:dA,parameters:Cy.serialize(new PA)});class BA{constructor(e={}){this.hashAlgorithm=new cE(NA),this.maskGenAlgorithm=new cE({algorithm:DA,parameters:Cy.serialize(NA)}),this.saltLength=20,this.trailerField=1,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:cE,context:0,defaultValue:NA})],BA.prototype,"hashAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:cE,context:1,defaultValue:OA})],BA.prototype,"maskGenAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,context:2,defaultValue:20})],BA.prototype,"saltLength",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,context:3,defaultValue:1})],BA.prototype,"trailerField",void 0);new cE({algorithm:fA,parameters:Cy.serialize(new BA)});class xA{constructor(e={}){this.digestAlgorithm=new cE,this.digest=new Kp,Object.assign(this,e)}}var MA;(0,Dy.__decorate)([Sy({type:cE})],xA.prototype,"digestAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Kp})],xA.prototype,"digest",void 0);class LA{constructor(e={}){this.prime=new ArrayBuffer(0),this.exponent=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],LA.prototype,"prime",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],LA.prototype,"exponent",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],LA.prototype,"coefficient",void 0);let kA=MA=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,MA.prototype)}};kA=MA=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:LA})],kA);class FA{constructor(e={}){this.version=0,this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),this.privateExponent=new ArrayBuffer(0),this.prime1=new ArrayBuffer(0),this.prime2=new ArrayBuffer(0),this.exponent1=new ArrayBuffer(0),this.exponent2=new ArrayBuffer(0),this.coefficient=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],FA.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],FA.prototype,"modulus",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],FA.prototype,"publicExponent",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],FA.prototype,"privateExponent",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],FA.prototype,"prime1",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],FA.prototype,"prime2",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],FA.prototype,"exponent1",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],FA.prototype,"exponent2",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],FA.prototype,"coefficient",void 0),(0,Dy.__decorate)([Sy({type:kA,optional:!0})],FA.prototype,"otherPrimeInfos",void 0);class VA{constructor(e={}){this.modulus=new ArrayBuffer(0),this.publicExponent=new ArrayBuffer(0),Object.assign(this,e)}}var HA;(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],VA.prototype,"modulus",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,converter:$p})],VA.prototype,"publicExponent",void 0),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(HA||(HA={}));const jA=HA;var KA=function(e,t){return KA=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},KA(e,t)};function qA(e,t){function r(){this.constructor=e}KA(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function GA(e,t,r,n){return new(r||(r=Promise))((function(i,s){function o(e){try{c(n.next(e))}catch(e){s(e)}}function a(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}c((n=n.apply(e,t||[])).next())}))}function zA(e,t){var r,n,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}function $A(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function WA(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(i)throw i.error}}return o}function YA(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(WA(arguments[t]));return e}function QA(e){return!!e.useClass}function JA(e){return!!e.useFactory}var XA=function(){function e(e){this.wrap=e,this.reflectMethods=["get","getPrototypeOf","setPrototypeOf","getOwnPropertyDescriptor","defineProperty","has","set","deleteProperty","apply","construct","ownKeys"]}return e.prototype.createProxy=function(e){var t,r=this,n=!1;return new Proxy({},this.createHandler((function(){return n||(t=e(r.wrap()),n=!0),t})))},e.prototype.createHandler=function(e){var t={};return this.reflectMethods.forEach((function(r){t[r]=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t[0]=e();var i=Reflect[r];return i.apply(void 0,YA(t))}})),t},e}();function ZA(e){return"string"==typeof e||"symbol"==typeof e}function eI(e){return"object"==typeof e&&"token"in e&&"transform"in e}function tI(e){return!!e.useToken}function rI(e){return null!=e.useValue}const nI=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){return this._registryMap.entries()},e.prototype.getAll=function(e){return this.ensure(e),this._registryMap.get(e)},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){this._registryMap.set(e,t)},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){this._registryMap.clear()},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}();const iI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qA(t,e),t}(nI);const sI=function(){this.scopedResolutions=new Map};function oI(e,t,r){var n,i,s=WA(e.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1],o=function(e,t){return null===e?"at position #"+t:'"'+e.split(",")[t].trim()+'" at position #'+t}(void 0===s?null:s,t);return n="Cannot inject the dependency "+o+' of "'+e.name+'" constructor. Reason:',void 0===i&&(i="    "),YA([n],r.message.split("\n").map((function(e){return i+e}))).join("\n")}var aI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qA(t,e),t}(nI),cI=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return qA(t,e),t}(nI);const uI=function(){this.preResolution=new aI,this.postResolution=new cI};var hI=new Map,dI=function(){function e(e){this.parent=e,this._registry=new iI,this.interceptors=new uI,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,r){var n;if(void 0===r&&(r={lifecycle:jA.Transient}),this.ensureNotDisposed(),n=function(e){return QA(e)||rI(e)||tI(e)||JA(e)}(t)?t:{useClass:t},tI(n))for(var i=[e],s=n;null!=s;){var o=s.useToken;if(i.includes(o))throw new Error("Token registration cycle detected! "+YA(i,[o]).join(" -> "));i.push(o);var a=this._registry.get(o);s=a&&tI(a.provider)?a.provider:null}if((r.lifecycle===jA.Singleton||r.lifecycle==jA.ContainerScoped||r.lifecycle==jA.ResolutionScoped)&&(rI(n)||JA(n)))throw new Error('Cannot use lifecycle "'+jA[r.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:n,options:r}),this},e.prototype.registerType=function(e,t){return this.ensureNotDisposed(),ZA(t)?this.register(e,{useToken:t}):this.register(e,{useClass:t})},e.prototype.registerInstance=function(e,t){return this.ensureNotDisposed(),this.register(e,{useValue:t})},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),ZA(e)){if(ZA(t))return this.register(e,{useToken:t},{lifecycle:jA.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:jA.Singleton});throw new Error('Cannot register a type name as a singleton without a "to" token')}var r=e;return t&&!ZA(t)&&(r=t),this.register(e,{useClass:r},{lifecycle:jA.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new sI),this.ensureNotDisposed();var r=this.getRegistration(e);if(!r&&ZA(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),r){var n=this.resolveRegistration(r,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}if(function(e){return"function"==typeof e||e instanceof XA}(e)){n=this.construct(e,t);return this.executePostResolutionInterceptor(e,n,"Single"),n}throw new Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var r,n;if(this.interceptors.preResolution.has(e)){var i=[];try{for(var s=$A(this.interceptors.preResolution.getAll(e)),o=s.next();!o.done;o=s.next()){var a=o.value;"Once"!=a.options.frequency&&i.push(a),a.callback(e,t)}}catch(e){r={error:e}}finally{try{o&&!o.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}this.interceptors.preResolution.setAll(e,i)}},e.prototype.executePostResolutionInterceptor=function(e,t,r){var n,i;if(this.interceptors.postResolution.has(e)){var s=[];try{for(var o=$A(this.interceptors.postResolution.getAll(e)),a=o.next();!a.done;a=o.next()){var c=a.value;"Once"!=c.options.frequency&&s.push(c),c.callback(e,t,r)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}this.interceptors.postResolution.setAll(e,s)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===jA.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var r,n=e.options.lifecycle===jA.Singleton,i=e.options.lifecycle===jA.ContainerScoped,s=n||i;return r=rI(e.provider)?e.provider.useValue:tI(e.provider)?s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):QA(e.provider)?s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):JA(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===jA.ResolutionScoped&&t.scopedResolutions.set(e,r),r},e.prototype.resolveAll=function(e,t){var r=this;void 0===t&&(t=new sI),this.ensureNotDisposed();var n=this.getAllRegistrations(e);if(!n&&ZA(e))throw new Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"All"),n){var i=n.map((function(e){return r.resolveRegistration(e,t)}));return this.executePostResolutionInterceptor(e,i,"All"),i}var s=[this.construct(e,t)];return this.executePostResolutionInterceptor(e,s,"All"),s},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){this.ensureNotDisposed(),this._registry.clear(),this.interceptors.preResolution.clear(),this.interceptors.postResolution.clear()},e.prototype.clearInstances=function(){var e,t;this.ensureNotDisposed();try{for(var r=$A(this._registry.entries()),n=r.next();!n.done;n=r.next()){var i=WA(n.value,2),s=i[0],o=i[1];this._registry.setAll(s,o.filter((function(e){return!rI(e.provider)})).map((function(e){return e.instance=void 0,e})))}}catch(t){e={error:t}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},e.prototype.createChildContainer=function(){var t,r;this.ensureNotDisposed();var n=new e(this);try{for(var i=$A(this._registry.entries()),s=i.next();!s.done;s=i.next()){var o=WA(s.value,2),a=o[0],c=o[1];c.some((function(e){return e.options.lifecycle===jA.ContainerScoped}))&&n._registry.setAll(a,c.map((function(e){return e.options.lifecycle===jA.ContainerScoped?{provider:e.provider,options:e.options}:e})))}}catch(e){t={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.beforeResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.preResolution.set(e,{callback:t,options:r})},e.prototype.afterResolution=function(e,t,r){void 0===r&&(r={frequency:"Always"}),this.interceptors.postResolution.set(e,{callback:t,options:r})},e.prototype.dispose=function(){return GA(this,void 0,void 0,(function(){var e;return zA(this,(function(t){switch(t.label){case 0:return this.disposed=!0,e=[],this.disposables.forEach((function(t){var r=t.dispose();r&&e.push(r)})),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){return this.isRegistered(e)?this._registry.getAll(e):this.parent?this.parent.getAllRegistrations(e):null},e.prototype.construct=function(e,t){var r=this;if(e instanceof XA)return e.createProxy((function(e){return r.resolve(e,t)}));var n,i=function(){var n=hI.get(e);if(!n||0===n.length){if(0===e.length)return new e;throw new Error('TypeInfo not known for "'+e.name+'"')}var i=n.map(r.resolveParams(t,e));return new(e.bind.apply(e,YA([void 0],i)))}();return"function"!=typeof(n=i).dispose||n.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var r=this;return function(n,i){var s,o,a,c;try{return"object"==typeof(c=n)&&"token"in c&&"multiple"in c?eI(n)?n.multiple?(s=r.resolve(n.transform)).transform.apply(s,YA([r.resolveAll(n.token)],n.transformArgs)):(o=r.resolve(n.transform)).transform.apply(o,YA([r.resolve(n.token,e)],n.transformArgs)):n.multiple?r.resolveAll(n.token):r.resolve(n.token,e):eI(n)?(a=r.resolve(n.transform,e)).transform.apply(a,YA([r.resolve(n.token,e)],n.transformArgs)):r.resolve(n,e)}catch(e){throw new Error(oI(t,i,e))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw new Error("This container has been disposed, you cannot interact with a disposed container")},e}(),lI=new dI;var fI="injectionTokens";const pI=function(){return function(e){hI.set(e,function(e){var t=Reflect.getMetadata("design:paramtypes",e)||[],r=Reflect.getOwnMetadata(fI,e)||{};return Object.keys(r).forEach((function(e){t[+e]=r[e]})),t}(e))}};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw new Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var yI;class mI{constructor(e={}){this.attrId="",this.attrValues=[],Object.assign(e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],mI.prototype,"attrId",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,repeated:"set"})],mI.prototype,"attrValues",void 0);let gI=yI=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,yI.prototype)}};var vI;gI=yI=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:mI})],gI);let bI=vI=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,vI.prototype)}};bI=vI=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:eS})],bI);class EI{constructor(e={}){this.certId="",this.certValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],EI.prototype,"certId",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,context:0})],EI.prototype,"certValue",void 0);class SI{constructor(e={}){this.crlId="",this.crltValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],SI.prototype,"crlId",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,context:0})],SI.prototype,"crltValue",void 0);class AI extends Kp{}class II{constructor(e={}){this.encryptionAlgorithm=new cE,this.encryptedData=new AI,Object.assign(this,e)}}var wI,TI;(0,Dy.__decorate)([Sy({type:cE})],II.prototype,"encryptionAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:AI})],II.prototype,"encryptedData",void 0),function(e){e[e.v1=0]="v1"}(TI||(TI={}));class CI extends Kp{}let _I=wI=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,wI.prototype)}};_I=wI=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Jb})],_I);class DI{constructor(e={}){this.version=TI.v1,this.privateKeyAlgorithm=new cE,this.privateKey=new CI,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],DI.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:cE})],DI.prototype,"privateKeyAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:CI})],DI.prototype,"privateKey",void 0),(0,Dy.__decorate)([Sy({type:_I,implicit:!0,context:0,optional:!0})],DI.prototype,"attributes",void 0);let RI=class extends DI{};RI=(0,Dy.__decorate)([Ey({type:xf.Sequence})],RI);let NI=class extends II{};NI=(0,Dy.__decorate)([Ey({type:xf.Sequence})],NI);class OI{constructor(e={}){this.secretTypeId="",this.secretValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],OI.prototype,"secretTypeId",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,context:0})],OI.prototype,"secretValue",void 0);class UI{constructor(e={}){this.mac=new xA,this.macSalt=new Kp,this.iterations=1,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:xA})],UI.prototype,"mac",void 0),(0,Dy.__decorate)([Sy({type:Kp})],UI.prototype,"macSalt",void 0),(0,Dy.__decorate)([Sy({type:Mf.Integer,defaultValue:1})],UI.prototype,"iterations",void 0);class PI{constructor(e={}){this.version=3,this.authSafe=new eS,this.macData=new UI,Object.assign(this,e)}}var BI;(0,Dy.__decorate)([Sy({type:Mf.Integer})],PI.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:eS})],PI.prototype,"authSafe",void 0),(0,Dy.__decorate)([Sy({type:UI,optional:!0})],PI.prototype,"macData",void 0);class xI{constructor(e={}){this.bagId="",this.bagValue=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],xI.prototype,"bagId",void 0),(0,Dy.__decorate)([Sy({type:Mf.Any,context:0})],xI.prototype,"bagValue",void 0),(0,Dy.__decorate)([Sy({type:mI,repeated:"set",optional:!0})],xI.prototype,"bagAttributes",void 0);let MI=BI=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,BI.prototype)}};var LI,kI,FI;MI=BI=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:xI})],MI);const VI="1.2.840.113549.1.9",HI=`${VI}.7`,jI=`${VI}.14`;let KI=class extends Uv{constructor(e={}){super(e)}toString(){return{}.toString(),this.ia5String||super.toString()}};(0,Dy.__decorate)([Sy({type:Mf.IA5String})],KI.prototype,"ia5String",void 0),KI=(0,Dy.__decorate)([Ey({type:xf.Choice})],KI);let qI=class extends eS{};qI=(0,Dy.__decorate)([Ey({type:xf.Sequence})],qI);let GI=class extends PI{};GI=(0,Dy.__decorate)([Ey({type:xf.Sequence})],GI);let zI=class extends II{};zI=(0,Dy.__decorate)([Ey({type:xf.Sequence})],zI);let $I=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,Dy.__decorate)([Sy({type:Mf.IA5String})],$I.prototype,"value",void 0),$I=(0,Dy.__decorate)([Ey({type:xf.Choice})],$I);let WI=class extends KI{};WI=(0,Dy.__decorate)([Ey({type:xf.Choice})],WI);let YI=class extends Uv{};YI=(0,Dy.__decorate)([Ey({type:xf.Choice})],YI);let QI=class{constructor(e=new Date){this.value=e}};(0,Dy.__decorate)([Sy({type:Mf.GeneralizedTime})],QI.prototype,"value",void 0),QI=(0,Dy.__decorate)([Ey({type:xf.Choice})],QI);let JI=class extends Uv{};JI=(0,Dy.__decorate)([Ey({type:xf.Choice})],JI);let XI=class{constructor(e="M"){this.value=e}toString(){return this.value}};(0,Dy.__decorate)([Sy({type:Mf.PrintableString})],XI.prototype,"value",void 0),XI=(0,Dy.__decorate)([Ey({type:xf.Choice})],XI);let ZI=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,Dy.__decorate)([Sy({type:Mf.PrintableString})],ZI.prototype,"value",void 0),ZI=(0,Dy.__decorate)([Ey({type:xf.Choice})],ZI);let ew=class extends ZI{};ew=(0,Dy.__decorate)([Ey({type:xf.Choice})],ew);let tw=class extends Uv{};tw=(0,Dy.__decorate)([Ey({type:xf.Choice})],tw);let rw=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,Dy.__decorate)([Sy({type:Mf.ObjectIdentifier})],rw.prototype,"value",void 0),rw=(0,Dy.__decorate)([Ey({type:xf.Choice})],rw);let nw=class extends hE{};nw=(0,Dy.__decorate)([Ey({type:xf.Choice})],nw);let iw=class{constructor(e=0){this.value=e}toString(){return this.value.toString()}};(0,Dy.__decorate)([Sy({type:Mf.Integer})],iw.prototype,"value",void 0),iw=(0,Dy.__decorate)([Ey({type:xf.Choice})],iw);let sw=class extends HS{};sw=(0,Dy.__decorate)([Ey({type:xf.Sequence})],sw);let ow=class extends Uv{};ow=(0,Dy.__decorate)([Ey({type:xf.Choice})],ow);let aw=LI=class extends pE{constructor(e){super(e),Object.setPrototypeOf(this,LI.prototype)}};aw=LI=(0,Dy.__decorate)([Ey({type:xf.Sequence})],aw);let cw=kI=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,kI.prototype)}};cw=kI=(0,Dy.__decorate)([Ey({type:xf.Set,itemType:AE})],cw);let uw=class{constructor(e=""){this.value=e}toString(){return this.value}};(0,Dy.__decorate)([Sy({type:Mf.BmpString})],uw.prototype,"value",void 0),uw=(0,Dy.__decorate)([Ey({type:xf.Choice})],uw);let hw=class extends cE{};hw=(0,Dy.__decorate)([Ey({type:xf.Sequence})],hw);let dw=FI=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,FI.prototype)}};var lw;dw=FI=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:hw})],dw);let fw=lw=class extends Ty{constructor(e){super(e),Object.setPrototypeOf(this,lw.prototype)}};fw=lw=(0,Dy.__decorate)([Ey({type:xf.Sequence,itemType:Jb})],fw);class pw{constructor(e={}){this.version=0,this.subject=new Lv,this.subjectPKInfo=new uE,this.attributes=new fw,Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:Mf.Integer})],pw.prototype,"version",void 0),(0,Dy.__decorate)([Sy({type:Lv})],pw.prototype,"subject",void 0),(0,Dy.__decorate)([Sy({type:uE})],pw.prototype,"subjectPKInfo",void 0),(0,Dy.__decorate)([Sy({type:fw,implicit:!0,context:0})],pw.prototype,"attributes",void 0);class yw{constructor(e={}){this.certificationRequestInfo=new pw,this.signatureAlgorithm=new cE,this.signature=new ArrayBuffer(0),Object.assign(this,e)}}(0,Dy.__decorate)([Sy({type:pw})],yw.prototype,"certificationRequestInfo",void 0),(0,Dy.__decorate)([Sy({type:cE})],yw.prototype,"signatureAlgorithm",void 0),(0,Dy.__decorate)([Sy({type:Mf.BitString})],yw.prototype,"signature",void 0);const mw="crypto.algorithm";const gw="crypto.algorithmProvider";var vw;lI.registerSingleton(gw,class{getAlgorithms(){return lI.resolveAll(mw)}toAsnAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toAsnAlgorithm(e);if(r)return r}if(/[0-9.]+/.test(e.name)){const t=new cE({algorithm:e.name});if("parameters"in e){const r=e;t.parameters=r.parameters}return t}throw new Error("Cannot convert WebCrypto algorithm to ASN.1 algorithm")}toWebAlgorithm(e){for(const t of this.getAlgorithms()){const r=t.toWebAlgorithm(e);if(r)return r}return{name:e.algorithm,parameters:e.parameters}}});const bw="1.3.36.3.3.2.8.1.1.1",Ew="1.3.36.3.3.2.8.1.1.2",Sw="1.3.36.3.3.2.8.1.1.3",Aw="1.3.36.3.3.2.8.1.1.4",Iw="1.3.36.3.3.2.8.1.1.5",ww="1.3.36.3.3.2.8.1.1.6",Tw="1.3.36.3.3.2.8.1.1.7",Cw="1.3.36.3.3.2.8.1.1.8",_w="1.3.36.3.3.2.8.1.1.9",Dw="1.3.36.3.3.2.8.1.1.10",Rw="1.3.36.3.3.2.8.1.1.11",Nw="1.3.36.3.3.2.8.1.1.12",Ow="1.3.36.3.3.2.8.1.1.13",Uw="1.3.36.3.3.2.8.1.1.14",Pw="brainpoolP160r1",Bw="brainpoolP160t1",xw="brainpoolP192r1",Mw="brainpoolP192t1",Lw="brainpoolP224r1",kw="brainpoolP224t1",Fw="brainpoolP256r1",Vw="brainpoolP256t1",Hw="brainpoolP320r1",jw="brainpoolP320t1",Kw="brainpoolP384r1",qw="brainpoolP384t1",Gw="brainpoolP512r1",zw="brainpoolP512t1",$w="ECDSA";let Ww=vw=class{toAsnAlgorithm(e){if(e.name.toLowerCase()===$w.toLowerCase())if("hash"in e){switch(("string"==typeof e.hash?e.hash:e.hash.name).toLowerCase()){case"sha-1":return rA;case"sha-256":return nA;case"sha-384":return iA;case"sha-512":return sA}}else if("namedCurve"in e){let t="";switch(e.namedCurve){case"P-256":t=XS;break;case"K-256":t=vw.SECP256K1;break;case"P-384":t=ZS;break;case"P-521":t=eA;break;case Pw:t=bw;break;case Bw:t=Ew;break;case xw:t=Sw;break;case Mw:t=Aw;break;case Lw:t=Iw;break;case kw:t=ww;break;case Fw:t=Tw;break;case Vw:t=Cw;break;case Hw:t=_w;break;case jw:t=Dw;break;case Kw:t=Rw;break;case qw:t=Nw;break;case Gw:t=Ow;break;case zw:t=Uw}if(t)return new cE({algorithm:zS,parameters:Cy.serialize(new oA({namedCurve:t}))})}return null}toWebAlgorithm(e){switch(e.algorithm){case $S:return{name:$w,hash:{name:"SHA-1"}};case YS:return{name:$w,hash:{name:"SHA-256"}};case QS:return{name:$w,hash:{name:"SHA-384"}};case JS:return{name:$w,hash:{name:"SHA-512"}};case zS:if(!e.parameters)throw new TypeError("Cannot get required parameters from EC algorithm");switch(Cy.parse(e.parameters,oA).namedCurve){case XS:return{name:$w,namedCurve:"P-256"};case vw.SECP256K1:return{name:$w,namedCurve:"K-256"};case ZS:return{name:$w,namedCurve:"P-384"};case eA:return{name:$w,namedCurve:"P-521"};case bw:return{name:$w,namedCurve:Pw};case Ew:return{name:$w,namedCurve:Bw};case Sw:return{name:$w,namedCurve:xw};case Aw:return{name:$w,namedCurve:Mw};case Iw:return{name:$w,namedCurve:Lw};case ww:return{name:$w,namedCurve:kw};case Tw:return{name:$w,namedCurve:Fw};case Cw:return{name:$w,namedCurve:Vw};case _w:return{name:$w,namedCurve:Hw};case Dw:return{name:$w,namedCurve:jw};case Rw:return{name:$w,namedCurve:Kw};case Nw:return{name:$w,namedCurve:qw};case Ow:return{name:$w,namedCurve:Gw};case Uw:return{name:$w,namedCurve:zw}}}return null}};Ww.SECP256K1="1.3.132.0.10",Ww=vw=(0,Dy.__decorate)([pI()],Ww),lI.registerSingleton(mw,Ww);const Yw=Symbol("name"),Qw=Symbol("value");class Jw{constructor(e,t={},r=""){this[Yw]=e,this[Qw]=r;for(const e in t)this[e]=t[e]}}Jw.NAME=Yw,Jw.VALUE=Qw;class Xw{static toString(e){const t=this.items[e];return t||e}}Xw.items={[IA]:"sha1",[wA]:"sha224",[TA]:"sha256",[CA]:"sha384",[_A]:"sha512",[hA]:"rsaEncryption",[mA]:"sha1WithRSAEncryption",[gA]:"sha224WithRSAEncryption",[vA]:"sha256WithRSAEncryption",[bA]:"sha384WithRSAEncryption",[EA]:"sha512WithRSAEncryption",[zS]:"ecPublicKey",[$S]:"ecdsaWithSHA1",[WS]:"ecdsaWithSHA224",[YS]:"ecdsaWithSHA256",[QS]:"ecdsaWithSHA384",[JS]:"ecdsaWithSHA512",[_b]:"TLS WWW server authentication",[Db]:"TLS WWW client authentication",[Rb]:"Code Signing",[Nb]:"E-mail Protection",[Ob]:"Time Stamping",[Ub]:"OCSP Signing","1.2.840.113549.1.7.2":"Signed Data"};class Zw{static serialize(e){return this.serializeObj(e).join("\n")}static pad(e=0){return"".padStart(2*e," ")}static serializeObj(e,t=0){const r=[];let n=this.pad(t++),i="";const s=e[Jw.VALUE];s&&(i=` ${s}`),r.push(`${n}${e[Jw.NAME]}:${i}`),n=this.pad(t);for(const i in e){if("symbol"==typeof i)continue;const s=e[i],o=i?`${i}: `:"";if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)r.push(`${n}${o}${s}`);else if(s instanceof Date)r.push(`${n}${o}${s.toUTCString()}`);else if(Array.isArray(s))for(const e of s)e[Jw.NAME]=i,r.push(...this.serializeObj(e,t));else if(s instanceof Jw)s[Jw.NAME]=i,r.push(...this.serializeObj(s,t));else if(El.isBufferSource(s))i?(r.push(`${n}${o}`),r.push(...this.serializeBufferSource(s,t+1))):r.push(...this.serializeBufferSource(s,t));else{if(!("toTextObject"in s))throw new TypeError("Cannot serialize data in text format. Unsupported type.");{const e=s.toTextObject();e[Jw.NAME]=i,r.push(...this.serializeObj(e,t))}}}return r}static serializeBufferSource(e,t=0){const r=this.pad(t),n=El.toUint8Array(e),i=[];for(let e=0;e<n.length;){const t=[];for(let r=0;r<16&&e<n.length;r++){8===r&&t.push("");const i=n[e++].toString(16).padStart(2,"0");t.push(i)}i.push(`${r}${t.join(" ")}`)}return i}static serializeAlgorithm(e){return this.algorithmSerializer.toTextObject(e)}}Zw.oidSerializer=Xw,Zw.algorithmSerializer=class{static toTextObject(e){const t=new Jw("Algorithm Identifier",{},Xw.toString(e.algorithm));if(e.parameters)switch(e.algorithm){case zS:{const r=(new Ww).toWebAlgorithm(e);r&&"namedCurve"in r?t["Named Curve"]=r.namedCurve:t.Parameters=e.parameters;break}default:t.Parameters=e.parameters}return t}};class eT{constructor(...e){if(1===e.length){const t=e[0];this.rawData=Cy.serialize(t),this.onInit(t)}else{const t=Cy.parse(e[0],e[1]);this.rawData=El.toArrayBuffer(e[0]),this.onInit(t)}}equal(e){return e instanceof eT&&Tl(e.rawData,this.rawData)}toString(e="text"){switch(e){case"asn":return Cy.toString(this.rawData);case"text":return Zw.serialize(this.toTextObject());case"hex":return Il.ToHex(this.rawData);case"base64":return Il.ToBase64(this.rawData);case"base64url":return Il.ToBase64Url(this.rawData);default:throw TypeError("Argument 'format' is unsupported value")}}getTextName(){return this.constructor.NAME}toTextObject(){const e=this.toTextObjectEmpty();return e[""]=this.rawData,e}toTextObjectEmpty(e){return new Jw(this.getTextName(),{},e)}}eT.NAME="ASN";class tT extends eT{constructor(...e){let t;t=El.isBufferSource(e[0])?El.toArrayBuffer(e[0]):Cy.serialize(new fE({extnID:e[0],critical:e[1],extnValue:new Kp(El.toArrayBuffer(e[2]))})),super(t,fE)}onInit(e){this.type=e.extnID,this.critical=e.critical,this.value=e.extnValue.buffer}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.value,e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty(this.critical?"critical":void 0);return e[Jw.NAME]===tT.NAME&&(e[Jw.NAME]=Xw.toString(this.type)),e}}var rT;class nT{constructor(){this.items=new Map,this[rT]="CryptoProvider","undefined"!=typeof self&&"undefined"!=typeof crypto&&this.set(nT.DEFAULT,crypto)}static isCryptoKeyPair(e){return e&&e.privateKey&&e.publicKey}static isCryptoKey(e){return e&&e.usages&&e.type&&e.algorithm&&void 0!==e.extractable}clear(){this.items.clear()}delete(e){return this.items.delete(e)}forEach(e,t){return this.items.forEach(e,t)}has(e){return this.items.has(e)}get size(){return this.items.size}entries(){return this.items.entries()}keys(){return this.items.keys()}values(){return this.items.values()}[Symbol.iterator](){return this.items[Symbol.iterator]()}get(e=nT.DEFAULT){const t=this.items.get(e.toLowerCase());if(!t)throw new Error(`Cannot get Crypto by name '${e}'`);return t}set(e,t){if("string"==typeof e){if(!t)throw new TypeError("Argument 'value' is required");this.items.set(e.toLowerCase(),t)}else this.items.set(nT.DEFAULT,e);return this}}rT=Symbol.toStringTag,nT.DEFAULT="default";const iT=new nT,sT=/^[0-2](?:\.[1-9][0-9]*)+$/;class oT{constructor(e={}){this.items={};for(const t in e)this.register(t,e[t])}get(e){return this.items[e]||null}findId(e){return t=e,new RegExp(sT).test(t)?e:this.get(e);var t}register(e,t){this.items[e]=t,this.items[t]=e}}const aT=new oT;function cT(e,t){return`\\${Il.ToHex(Il.FromUtf8String(t)).toUpperCase()}`}aT.register("CN","2.5.4.3"),aT.register("L","2.5.4.7"),aT.register("ST","2.5.4.8"),aT.register("O","2.5.4.10"),aT.register("OU","2.5.4.11"),aT.register("C","2.5.4.6"),aT.register("DC","0.9.2342.19200300.100.1.25"),aT.register("E","1.2.840.113549.1.9.1"),aT.register("G","2.5.4.42"),aT.register("I","2.5.4.43"),aT.register("SN","2.5.4.4"),aT.register("T","2.5.4.12");class uT{constructor(e,t={}){this.extraNames=new oT,this.asn=new Lv;for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];this.extraNames.register(e,r)}"string"==typeof e?this.asn=this.fromString(e):e instanceof Lv?this.asn=e:El.isBufferSource(e)?this.asn=Cy.parse(e,Lv):this.asn=this.fromJSON(e)}static isASCII(e){for(let t=0;t<e.length;t++){if(e.charCodeAt(t)>255)return!1}return!0}getField(e){const t=this.extraNames.findId(e)||aT.findId(e),r=[];for(const e of this.asn)for(const n of e)n.type===t&&r.push(n.value.toString());return r}getName(e){return this.extraNames.get(e)||aT.get(e)}toString(){return this.asn.map((e=>e.map((e=>`${this.getName(e.type)||e.type}=${e.value.anyValue?`#${Il.ToHex(e.value.anyValue)}`:e.value.toString().replace(/([,+"\\<>;])/g,"\\$1").replace(/^([ #])/,"\\$1").replace(/([ ]$)/,"\\$1").replace(/([\r\n\t])/,cT)}`)).join("+"))).join(", ")}toJSON(){var e;const t=[];for(const r of this.asn){const n={};for(const t of r){const r=this.getName(t.type)||t.type;null!==(e=n[r])&&void 0!==e||(n[r]=[]),n[r].push(t.value.anyValue?`#${Il.ToHex(t.value.anyValue)}`:t.value.toString())}t.push(n)}return t}fromString(e){const t=new Lv,r=/(\d\.[\d.]*\d|[A-Za-z]+)=((?:"")|(?:".*?[^\\]")|(?:[^,+].*?(?:[^\\][,+]))|(?:))([,+])?/g;let n=null,i=",";for(;n=r.exec(`${e},`);){let[,e,r]=n;const s=r[r.length-1];","!==s&&"+"!==s||(r=r.slice(0,r.length-1),n[3]=s);const o=n[3];if(/[\d.]+/.test(e)||(e=this.getName(e)||""),!e)throw new Error(`Cannot get OID for name type '${e}'`);const a=new Bv({type:e});if("#"===r.charAt(0))a.value.anyValue=Il.FromHex(r.slice(1));else{const t=/"(.*?[^\\])?"/.exec(r);t&&(r=t[1]),r=r.replace(/\\0a/gi,"\n").replace(/\\0d/gi,"\r").replace(/\\0g/gi,"\t").replace(/\\(.)/g,"$1"),e===this.getName("E")||e===this.getName("DC")?a.value.ia5String=r:uT.isASCII(r)?a.value.printableString=r:a.value.utf8String=r}"+"===i?t[t.length-1].push(a):t.push(new xv([a])),i=o}return t}fromJSON(e){const t=new Lv;for(const r of e){const e=new xv;for(const t in r){let n=t;if(/[\d.]+/.test(t)||(n=this.getName(t)||""),!n)throw new Error(`Cannot get OID for name type '${t}'`);const i=r[t];for(const t of i){const r=new Bv({type:n});if("object"==typeof t)for(const e in t)switch(e){case"ia5String":r.value.ia5String=t[e];break;case"utf8String":r.value.utf8String=t[e];break;case"universalString":r.value.universalString=t[e];break;case"bmpString":r.value.bmpString=t[e];break;case"printableString":r.value.printableString=t[e]}else"#"===t[0]?r.value.anyValue=Il.FromHex(t.slice(1)):n===this.getName("E")||n===this.getName("DC")?r.value.ia5String=t:r.value.printableString=t;e.push(r)}}t.push(e)}return t}toArrayBuffer(){return Cy.serialize(this.asn)}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||iT.get()):r=e[0]||iT.get(),await r.subtle.digest(n,this.toArrayBuffer())}}const hT="Cannot initialize GeneralName from ASN.1 data.",dT=`${hT} Unsupported string format in use.`,lT=`${hT} Value doesn't match to GUID regular expression.`,fT=/^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i,pT="1.3.6.1.4.1.311.25.1",yT="1.3.6.1.4.1.311.20.2.3",mT="dns",gT="dn",vT="email",bT="ip",ET="url",ST="guid",AT="upn",IT="id";class wT extends eT{constructor(...e){let t;if(2===e.length)switch(e[0]){case gT:{const r=new uT(e[1]).toArrayBuffer(),n=Cy.parse(r,Lv);t=new Hv({directoryName:n});break}case mT:t=new Hv({dNSName:e[1]});break;case vT:t=new Hv({rfc822Name:e[1]});break;case ST:{const r=new RegExp(fT,"i").exec(e[1]);if(!r)throw new Error("Cannot parse GUID value. Value doesn't match to regular expression");const n=r.slice(1).map(((e,t)=>t<3?Il.ToHex(new Uint8Array(Il.FromHex(e)).reverse()):e)).join("");t=new Hv({otherName:new Fv({typeId:pT,value:Cy.serialize(new Kp(Il.FromHex(n)))})});break}case bT:t=new Hv({iPAddress:e[1]});break;case IT:t=new Hv({registeredID:e[1]});break;case AT:t=new Hv({otherName:new Fv({typeId:yT,value:Cy.serialize(ey.toASN(e[1]))})});break;case ET:t=new Hv({uniformResourceIdentifier:e[1]});break;default:throw new Error("Cannot create GeneralName. Unsupported type of the name")}else t=El.isBufferSource(e[0])?Cy.parse(e[0],Hv):e[0];super(t)}onInit(e){if(null!=e.dNSName)this.type=mT,this.value=e.dNSName;else if(null!=e.rfc822Name)this.type=vT,this.value=e.rfc822Name;else if(null!=e.iPAddress)this.type=bT,this.value=e.iPAddress;else if(null!=e.uniformResourceIdentifier)this.type=ET,this.value=e.uniformResourceIdentifier;else if(null!=e.registeredID)this.type=IT,this.value=e.registeredID;else if(null!=e.directoryName)this.type=gT,this.value=new uT(e.directoryName).toString();else{if(null==e.otherName)throw new Error(dT);if(e.otherName.typeId===pT){this.type=ST;const t=Cy.parse(e.otherName.value,Kp),r=new RegExp(fT,"i").exec(Il.ToHex(t));if(!r)throw new Error(lT);this.value=r.slice(1).map(((e,t)=>t<3?Il.ToHex(new Uint8Array(Il.FromHex(e)).reverse()):e)).join("-")}else{if(e.otherName.typeId!==yT)throw new Error(dT);this.type=AT,this.value=Cy.parse(e.otherName.value,Uv).toString()}}}toJSON(){return{type:this.type,value:this.value}}toTextObject(){let e;switch(this.type){case gT:case mT:case ST:case bT:case IT:case AT:case ET:e=this.type.toUpperCase();break;case vT:e="Email";break;default:throw new Error("Unsupported GeneralName type")}let t=this.value;return this.type===IT&&(t=Xw.toString(t)),new Jw(e,void 0,t)}}class TT extends eT{constructor(e){let t;if(e instanceof Zv)t=e;else if(Array.isArray(e)){const r=[];for(const t of e)if(t instanceof Hv)r.push(t);else{const e=Cy.parse(new wT(t.type,t.value).rawData,Hv);r.push(e)}t=new Zv(r)}else{if(!El.isBufferSource(e))throw new Error("Cannot initialize GeneralNames. Incorrect incoming arguments");t=Cy.parse(e,Zv)}super(t)}onInit(e){const t=[];for(const r of e){let e=null;try{e=new wT(r)}catch{continue}t.push(e)}this.items=t}toJSON(){return this.items.map((e=>e.toJSON()))}toTextObject(){const e=super.toTextObjectEmpty();for(const t of this.items){const r=t.toTextObject();let n=e[r[Jw.NAME]];Array.isArray(n)||(n=[],e[r[Jw.NAME]]=n),n.push(r)}return e}}TT.NAME="GeneralNames";const CT="\\n",_T="-{5}BEGIN ([^\\n]+(?=-{5}))-{5}\\n(?:((?:[^:\\n]+: (?:[^\\n]+\\n(?: +[^\\n]+\\n)*))+))?\\n?((?:[a-zA-Z0-9=+/]+\\n)+)-{5}END \\1-{5}";class DT{static isPem(e){return"string"==typeof e&&new RegExp(_T,"g").test(e)}static decodeWithHeaders(e){e=e.replace(/\r/g,"");const t=new RegExp(_T,"g"),r=[];let n=null;for(;n=t.exec(e);){const e=n[3].replace(new RegExp("[\\n]+","g"),""),t={type:n[1],headers:[],rawData:Il.FromBase64(e)},i=n[2];if(i){const e=i.split(new RegExp(CT,"g"));let r=null;for(const n of e){const[e,i]=n.split(/:(.*)/);if(void 0===i){if(!r)throw new Error("Cannot parse PEM string. Incorrect header value");r.value+=e.trim()}else r&&t.headers.push(r),r={key:e,value:i.trim()}}r&&t.headers.push(r)}r.push(t)}return r}static decode(e){return this.decodeWithHeaders(e).map((e=>e.rawData))}static decodeFirst(e){const t=this.decode(e);if(!t.length)throw new RangeError("PEM string doesn't contain any objects");return t[0]}static encode(e,t){if(Array.isArray(e)){const r=new Array;return t?e.forEach((e=>{if(!El.isBufferSource(e))throw new TypeError("Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource");r.push(this.encodeStruct({type:t,rawData:El.toArrayBuffer(e)}))})):e.forEach((e=>{if(!("type"in e))throw new TypeError("Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut");r.push(this.encodeStruct(e))})),r.join("\n")}if(!t)throw new Error("Required argument 'tag' is missed");return this.encodeStruct({type:t,rawData:El.toArrayBuffer(e)})}static encodeStruct(e){var t;const r=e.type.toLocaleUpperCase(),n=[];if(n.push(`-----BEGIN ${r}-----`),null===(t=e.headers)||void 0===t?void 0:t.length){for(const t of e.headers)n.push(`${t.key}: ${t.value}`);n.push("")}const i=Il.ToBase64(e.rawData);let s,o=0;const a=Array();for(;o<i.length&&(i.length-o<64?s=i.substring(o):(s=i.substring(o,o+64),o+=64),0!==s.length)&&(a.push(s),!(s.length<64)););return n.push(...a),n.push(`-----END ${r}-----`),n.join("\n")}}DT.CertificateTag="CERTIFICATE",DT.CrlTag="CRL",DT.CertificateRequestTag="CERTIFICATE REQUEST",DT.PublicKeyTag="PUBLIC KEY",DT.PrivateKeyTag="PRIVATE KEY";class RT extends eT{static isAsnEncoded(e){return El.isBufferSource(e)||"string"==typeof e}static toArrayBuffer(e){if("string"==typeof e){if(DT.isPem(e))return DT.decode(e)[0];if(Il.isHex(e))return Il.FromHex(e);if(Il.isBase64(e))return Il.FromBase64(e);if(Il.isBase64Url(e))return Il.FromBase64Url(e);throw new TypeError("Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url")}{const t=Il.ToBinary(e);return DT.isPem(t)?DT.decode(t)[0]:Il.isHex(t)?Il.FromHex(t):Il.isBase64(t)?Il.FromBase64(t):Il.isBase64Url(t)?Il.FromBase64Url(t):El.toArrayBuffer(e)}}constructor(...e){RT.isAsnEncoded(e[0])?super(RT.toArrayBuffer(e[0]),e[1]):super(e[0])}toString(e="pem"){return"pem"===e?DT.encode(this.rawData,this.tag):super.toString(e)}}class NT extends RT{constructor(e){RT.isAsnEncoded(e)?super(e,uE):super(e),this.tag=DT.PublicKeyTag}async export(...e){let t,r=["verify"],n={hash:"SHA-256",...this.algorithm};return e.length>1?(n=e[0]||n,r=e[1]||r,t=e[2]||iT.get()):t=e[0]||iT.get(),t.subtle.importKey("spki",this.rawData,n,!0,r)}onInit(e){const t=lI.resolve(gw),r=this.algorithm=t.toWebAlgorithm(e.algorithm);switch(e.algorithm.algorithm){case hA:{const t=Cy.parse(e.subjectPublicKey,VA),n=El.toUint8Array(t.modulus);r.publicExponent=El.toUint8Array(t.publicExponent),r.modulusLength=(n[0]?n:n.slice(1)).byteLength<<3;break}}}async getThumbprint(...e){var t;let r,n="SHA-1";return e.length>=1&&!(null===(t=e[0])||void 0===t?void 0:t.subtle)?(n=e[0]||n,r=e[1]||iT.get()):r=e[0]||iT.get(),await r.subtle.digest(n,this.rawData)}async getKeyIdentifier(e){e||(e=iT.get());const t=Cy.parse(this.rawData,uE);return await e.subtle.digest("SHA-1",t.subjectPublicKey)}toTextObject(){const e=this.toTextObjectEmpty(),t=Cy.parse(this.rawData,uE);if(e.Algorithm=Zw.serializeAlgorithm(t.algorithm),t.algorithm.algorithm===zS)e["EC Point"]=t.subjectPublicKey;else e["Raw Data"]=t.subjectPublicKey;return e}}class OT{static register(e,t){this.items.set(e,t)}static create(e){const t=new tT(e),r=this.items.get(t.type);return r?new r(e):t}}OT.items=new Map;const UT="crypto.signatureFormatter";class PT extends RT{constructor(e){RT.isAsnEncoded(e)?super(e,vE):super(e),this.tag=DT.CertificateTag}onInit(e){const t=e.tbsCertificate;this.tbs=Cy.serialize(t),this.serialNumber=Il.ToHex(t.serialNumber),this.subjectName=new uT(t.subject),this.subject=new uT(t.subject).toString(),this.issuerName=new uT(t.issuer),this.issuer=this.issuerName.toString();const r=lI.resolve(gw);this.signatureAlgorithm=r.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signatureValue;const n=t.validity.notBefore.utcTime||t.validity.notBefore.generalTime;if(!n)throw new Error("Cannot get 'notBefore' value");this.notBefore=n;const i=t.validity.notAfter.utcTime||t.validity.notAfter.generalTime;if(!i)throw new Error("Cannot get 'notAfter' value");this.notAfter=i,this.extensions=[],t.extensions&&(this.extensions=t.extensions.map((e=>OT.create(Cy.serialize(e))))),this.publicKey=new NT(t.subjectPublicKeyInfo)}getExtension(e){for(const t of this.extensions)if("string"==typeof e){if(t.type===e)return t}else if(t instanceof e)return t;return null}getExtensions(e){return this.extensions.filter((t=>"string"==typeof e?t.type===e:t instanceof e))}async verify(e={},t=iT.get()){let r,n;const i=e.publicKey;try{if(i)if("publicKey"in i)r={...i.publicKey.algorithm,...this.signatureAlgorithm},n=await i.publicKey.export(r,["verify"]);else if(i instanceof NT)r={...i.algorithm,...this.signatureAlgorithm},n=await i.export(r,["verify"]);else if(El.isBufferSource(i)){const e=new NT(i);r={...e.algorithm,...this.signatureAlgorithm},n=await e.export(r,["verify"])}else r={...i.algorithm,...this.signatureAlgorithm},n=i;else r={...this.publicKey.algorithm,...this.signatureAlgorithm},n=await this.publicKey.export(r,["verify"],t)}catch(e){return!1}const s=lI.resolveAll(UT).reverse();let o=null;for(const e of s)if(o=e.toWebSignature(r,this.signature),o)break;if(!o)throw Error("Cannot convert ASN.1 signature value to WebCrypto format");const a=await t.subtle.verify(this.signatureAlgorithm,n,o,this.tbs);if(e.signatureOnly)return a;{const t=(e.date||new Date).getTime();return a&&this.notBefore.getTime()<t&&t<this.notAfter.getTime()}}async getThumbprint(...e){let t,r="SHA-1";return e[0]&&(e[0].subtle?t=e[0]:(r=e[0]||r,t=e[1])),null!=t||(t=iT.get()),await t.subtle.digest(r,this.rawData)}async isSelfSigned(e=iT.get()){return this.subject===this.issuer&&await this.verify({signatureOnly:!0},e)}toTextObject(){const e=this.toTextObjectEmpty(),t=Cy.parse(this.rawData,vE),r=t.tbsCertificate,n=new Jw("",{Version:`${yE[r.version]} (${r.version})`,"Serial Number":r.serialNumber,"Signature Algorithm":Zw.serializeAlgorithm(r.signature),Issuer:this.issuer,Validity:new Jw("",{"Not Before":r.validity.notBefore.getTime(),"Not After":r.validity.notAfter.getTime()}),Subject:this.subject,"Subject Public Key Info":this.publicKey});if(r.issuerUniqueID&&(n["Issuer Unique ID"]=r.issuerUniqueID),r.subjectUniqueID&&(n["Subject Unique ID"]=r.subjectUniqueID),this.extensions.length){const e=new Jw("");for(const t of this.extensions){const r=t.toTextObject();e[r[Jw.NAME]]=r}n.Extensions=e}return e.Data=n,e.Signature=new Jw("",{Algorithm:Zw.serializeAlgorithm(t.signatureAlgorithm),"":t.signatureValue}),e}}PT.NAME="Certificate";class BT extends tT{constructor(...e){if(El.isBufferSource(e[0]))super(e[0]);else if("string"==typeof e[0]){const t=new Yv({keyIdentifier:new Wv(Il.FromHex(e[0]))});super($v,e[1],Cy.serialize(t))}else{const t=e[0],r=t.name instanceof TT?Cy.parse(t.name.rawData,Zv):t.name,n=new Yv({authorityCertIssuer:r,authorityCertSerialNumber:Il.FromHex(t.serialNumber)});super($v,e[1],Cy.serialize(n))}}static async create(e,t=!1,r=iT.get()){if(e instanceof PT||nT.isCryptoKey(e)){const n=e instanceof PT?await e.publicKey.export(r):e,i=await r.subtle.exportKey("spki",n),s=new NT(i),o=await s.getKeyIdentifier(r);return new BT(Il.ToHex(o),t)}return new BT(e,t)}onInit(e){super.onInit(e);const t=Cy.parse(e.extnValue,Yv);t.keyIdentifier&&(this.keyId=Il.ToHex(t.keyIdentifier)),t.authorityCertIssuer&&t.authorityCertSerialNumber&&(this.certId={name:t.authorityCertIssuer,serialNumber:Il.ToHex(t.authorityCertSerialNumber)})}toTextObject(){const e=this.toTextObjectWithoutValue(),t=Cy.parse(this.value,Yv);return t.authorityCertIssuer&&(e["Authority Issuer"]=new TT(t.authorityCertIssuer).toTextObject()),t.authorityCertSerialNumber&&(e["Authority Serial Number"]=t.authorityCertSerialNumber),t.keyIdentifier&&(e[""]=t.keyIdentifier),e}}BT.NAME="Authority Key Identifier";class xT extends tT{constructor(...e){if(El.isBufferSource(e[0])){super(e[0]);const t=Cy.parse(this.value,Jv);this.ca=t.cA,this.pathLength=t.pathLenConstraint}else{const t=new Jv({cA:e[0],pathLenConstraint:e[1]});super(Qv,e[2],Cy.serialize(t)),this.ca=e[0],this.pathLength=e[1]}}toTextObject(){const e=this.toTextObjectWithoutValue();return this.ca&&(e.CA=this.ca),void 0!==this.pathLength&&(e["Path Length"]=this.pathLength),e}}var MT,LT;xT.NAME="Basic Constraints",function(e){e.serverAuth="1.3.6.1.5.5.7.3.1",e.clientAuth="1.3.6.1.5.5.7.3.2",e.codeSigning="1.3.6.1.5.5.7.3.3",e.emailProtection="1.3.6.1.5.5.7.3.4",e.timeStamping="1.3.6.1.5.5.7.3.8",e.ocspSigning="1.3.6.1.5.5.7.3.9"}(MT||(MT={}));class kT extends tT{constructor(...e){if(El.isBufferSource(e[0])){super(e[0]);const t=Cy.parse(this.value,Cb);this.usages=t.map((e=>e))}else{const t=new Cb(e[0]);super(Tb,e[1],Cy.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[""]=this.usages.map((e=>Xw.toString(e))).join(", "),e}}kT.NAME="Extended Key Usages",function(e){e[e.digitalSignature=1]="digitalSignature",e[e.nonRepudiation=2]="nonRepudiation",e[e.keyEncipherment=4]="keyEncipherment",e[e.dataEncipherment=8]="dataEncipherment",e[e.keyAgreement=16]="keyAgreement",e[e.keyCertSign=32]="keyCertSign",e[e.cRLSign=64]="cRLSign",e[e.encipherOnly=128]="encipherOnly",e[e.decipherOnly=256]="decipherOnly"}(LT||(LT={}));class FT extends tT{constructor(...e){if(El.isBufferSource(e[0])){super(e[0]);const t=Cy.parse(this.value,Vb);this.usages=t.toNumber()}else{const t=new Vb(e[0]);super(Lb,e[1],Cy.serialize(t)),this.usages=e[0]}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=Cy.parse(this.value,Vb);return e[""]=t.toJSON().join(", "),e}}FT.NAME="Key Usages";class VT extends tT{constructor(...e){if(El.isBufferSource(e[0])){super(e[0]);const t=Cy.parse(this.value,tE);this.keyId=Il.ToHex(t)}else{const t="string"==typeof e[0]?Il.FromHex(e[0]):e[0],r=new tE(t);super(eE,e[1],Cy.serialize(r)),this.keyId=Il.ToHex(t)}}static async create(e,t=!1,r=iT.get()){let n;n=e instanceof NT?e.rawData:"publicKey"in e?e.publicKey.rawData:El.isBufferSource(e)?e:await r.subtle.exportKey("spki",e);const i=new NT(n),s=await i.getKeyIdentifier(r);return new VT(Il.ToHex(s),t)}toTextObject(){const e=this.toTextObjectWithoutValue(),t=Cy.parse(this.value,tE);return e[""]=t,e}}VT.NAME="Subject Key Identifier";class HT extends tT{constructor(...e){El.isBufferSource(e[0])?super(e[0]):super(Yb,e[1],new TT(e[0]||[]).rawData)}onInit(e){super.onInit(e);const t=Cy.parse(e.extnValue,Qb);this.names=new TT(t)}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.names.toTextObject();for(const r in t)e[r]=t[r];return e}}HT.NAME="Subject Alternative Name";class jT extends tT{constructor(...e){var t;if(El.isBufferSource(e[0])){super(e[0]);const t=Cy.parse(this.value,hb);this.policies=t.map((e=>e.policyIdentifier))}else{const r=e[0],n=null!==(t=e[1])&&void 0!==t&&t,i=new hb(r.map((e=>new ub({policyIdentifier:e}))));super(nb,n,Cy.serialize(i)),this.policies=r}}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Policy=this.policies.map((e=>new Jw("",{},Xw.toString(e)))),e}}jT.NAME="Certificate Policies",OT.register(nb,jT);class KT extends eT{constructor(...e){let t;if(El.isBufferSource(e[0]))t=El.toArrayBuffer(e[0]);else{const r=e[0],n=Array.isArray(e[1])?e[1].map((e=>El.toArrayBuffer(e))):[];t=Cy.serialize(new Jb({type:r,values:n}))}super(t,Jb)}onInit(e){this.type=e.type,this.values=e.values}toTextObject(){const e=this.toTextObjectWithoutValue();return e.Value=this.values.map((e=>new Jw("",{"":e}))),e}toTextObjectWithoutValue(){const e=this.toTextObjectEmpty();return e[Jw.NAME]===KT.NAME&&(e[Jw.NAME]=Xw.toString(this.type)),e}}KT.NAME="Attribute";class qT extends KT{constructor(...e){var t;if(El.isBufferSource(e[0]))super(e[0]);else{const t=new ow({printableString:e[0]});super(HI,[Cy.serialize(t)])}null!==(t=this.password)&&void 0!==t||(this.password="")}onInit(e){if(super.onInit(e),this.values[0]){const e=Cy.parse(this.values[0],ow);this.password=e.toString()}}toTextObject(){const e=this.toTextObjectWithoutValue();return e[Jw.VALUE]=this.password,e}}qT.NAME="Challenge Password";class GT extends KT{constructor(...e){var t;if(El.isBufferSource(e[0]))super(e[0]);else{const t=e[0],r=new pE;for(const e of t)r.push(Cy.parse(e.rawData,fE));super(jI,[Cy.serialize(r)])}null!==(t=this.items)&&void 0!==t||(this.items=[])}onInit(e){if(super.onInit(e),this.values[0]){const e=Cy.parse(this.values[0],pE);this.items=e.map((e=>OT.create(Cy.serialize(e))))}}toTextObject(){const e=this.toTextObjectWithoutValue(),t=this.items.map((e=>e.toTextObject()));for(const r of t)e[r[Jw.NAME]]=r;return e}}GT.NAME="Extensions";class zT{static register(e,t){this.items.set(e,t)}static create(e){const t=new KT(e),r=this.items.get(t.type);return r?new r(e):t}}zT.items=new Map;let $T=class{toAsnAlgorithm(e){if("rsassa-pkcs1-v1_5"===e.name.toLowerCase()){if(!e.hash)return new cE({algorithm:hA,parameters:null});switch(e.hash.name.toLowerCase()){case"sha-1":return new cE({algorithm:mA,parameters:null});case"sha-256":return new cE({algorithm:vA,parameters:null});case"sha-384":return new cE({algorithm:bA,parameters:null});case"sha-512":return new cE({algorithm:EA,parameters:null})}}return null}toWebAlgorithm(e){switch(e.algorithm){case hA:return{name:"RSASSA-PKCS1-v1_5"};case mA:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}};case vA:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case bA:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-384"}};case EA:return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-512"}}}return null}};$T=(0,Dy.__decorate)([pI()],$T),lI.registerSingleton(mw,$T);class WT{addPadding(e,t){const r=El.toUint8Array(t),n=new Uint8Array(e);return n.set(r,e-r.length),n}removePadding(e,t=!1){let r=El.toUint8Array(e);for(let e=0;e<r.length;e++)if(r[e]){r=r.slice(e);break}if(t&&r[0]>127){const e=new Uint8Array(r.length+1);return e.set(r,1),e.buffer}return r.buffer}toAsnSignature(e,t){if("ECDSA"===e.name){const r=e.namedCurve,n=WT.namedCurveSize.get(r)||WT.defaultNamedCurveSize,i=new cA,s=El.toUint8Array(t);return i.r=this.removePadding(s.slice(0,n),!0),i.s=this.removePadding(s.slice(n,n+n),!0),Cy.serialize(i)}return null}toWebSignature(e,t){if("ECDSA"===e.name){const r=Cy.parse(t,cA),n=e.namedCurve,i=WT.namedCurveSize.get(n)||WT.defaultNamedCurveSize;return wl(this.addPadding(i,this.removePadding(r.r)),this.addPadding(i,this.removePadding(r.s)))}return null}}WT.namedCurveSize=new Map,WT.defaultNamedCurveSize=32;const YT="1.3.101.110",QT="1.3.101.111",JT="1.3.101.112",XT="1.3.101.113";let ZT=class{toAsnAlgorithm(e){let t=null;switch(e.name.toLowerCase()){case"eddsa":switch(e.namedCurve.toLowerCase()){case"ed25519":t=JT;break;case"ed448":t=XT}break;case"ecdh-es":switch(e.namedCurve.toLowerCase()){case"x25519":t=YT;break;case"x448":t=QT}}return t?new cE({algorithm:t}):null}toWebAlgorithm(e){switch(e.algorithm){case JT:return{name:"EdDSA",namedCurve:"Ed25519"};case XT:return{name:"EdDSA",namedCurve:"Ed448"};case YT:return{name:"ECDH-ES",namedCurve:"X25519"};case QT:return{name:"ECDH-ES",namedCurve:"X448"}}return null}};ZT=(0,Dy.__decorate)([pI()],ZT),lI.registerSingleton(mw,ZT);class eC extends RT{constructor(e){RT.isAsnEncoded(e)?super(e,yw):super(e),this.tag=DT.CertificateRequestTag}onInit(e){this.tbs=Cy.serialize(e.certificationRequestInfo),this.publicKey=new NT(e.certificationRequestInfo.subjectPKInfo);const t=lI.resolve(gw);this.signatureAlgorithm=t.toWebAlgorithm(e.signatureAlgorithm),this.signature=e.signature,this.attributes=e.certificationRequestInfo.attributes.map((e=>zT.create(Cy.serialize(e))));const r=this.getAttribute(jI);this.extensions=[],r instanceof GT&&(this.extensions=r.items),this.subjectName=new uT(e.certificationRequestInfo.subject),this.subject=this.subjectName.toString()}getAttribute(e){for(const t of this.attributes)if(t.type===e)return t;return null}getAttributes(e){return this.attributes.filter((t=>t.type===e))}getExtension(e){for(const t of this.extensions)if(t.type===e)return t;return null}getExtensions(e){return this.extensions.filter((t=>t.type===e))}async verify(e=iT.get()){const t={...this.publicKey.algorithm,...this.signatureAlgorithm},r=await this.publicKey.export(t,["verify"],e),n=lI.resolveAll(UT).reverse();let i=null;for(const e of n)if(i=e.toWebSignature(t,this.signature),i)break;if(!i)throw Error("Cannot convert WebCrypto signature value to ASN.1 format");return await e.subtle.verify(this.signatureAlgorithm,r,i,this.tbs)}toTextObject(){const e=this.toTextObjectEmpty(),t=Cy.parse(this.rawData,yw),r=t.certificationRequestInfo,n=new Jw("",{Version:`${yE[r.version]} (${r.version})`,Subject:this.subject,"Subject Public Key Info":this.publicKey});if(this.attributes.length){const e=new Jw("");for(const t of this.attributes){const r=t.toTextObject();e[r[Jw.NAME]]=r}n.Attributes=e}return e.Data=n,e.Signature=new Jw("",{Algorithm:Zw.serializeAlgorithm(t.signatureAlgorithm),"":t.signature}),e}}eC.NAME="PKCS#10 Certificate Request";var tC;!function(e){e[e.unspecified=0]="unspecified",e[e.keyCompromise=1]="keyCompromise",e[e.cACompromise=2]="cACompromise",e[e.affiliationChanged=3]="affiliationChanged",e[e.superseded=4]="superseded",e[e.cessationOfOperation=5]="cessationOfOperation",e[e.certificateHold=6]="certificateHold",e[e.removeFromCRL=8]="removeFromCRL",e[e.privilegeWithdrawn=9]="privilegeWithdrawn",e[e.aACompromise=10]="aACompromise"}(tC||(tC={}));OT.register(Qv,xT),OT.register(Tb,kT),OT.register(Lb,FT),OT.register(eE,VT),OT.register($v,BT),OT.register(Yb,HT),zT.register(HI,qT),zT.register(jI,GT),lI.registerSingleton(UT,class{toAsnSignature(e,t){return El.toArrayBuffer(t)}toWebSignature(e,t){return El.toArrayBuffer(t)}}),lI.registerSingleton(UT,WT),WT.namedCurveSize.set("P-256",32),WT.namedCurveSize.set("K-256",32),WT.namedCurveSize.set("P-384",48),WT.namedCurveSize.set("P-521",66);var rC=r(4798);var nC=r(182),iC=r(9100);function sC(e,t,r){const n=(0,f.createHmac)(e,t);return n.update(r),n.digest()}function oC(e,t,r,n="sha256"){const i=r,s=[];let o=t;do{o=sC(n,e,o);const i=sC(n,e,Buffer.concat([o,t]));s.push(i),r-=i.length}while(r>0);return Buffer.concat(s,i)}function aC(e,t){return(0,f.createHash)(e).update(t).digest()}const cC=1;const{uint16be:uC,uint24be:hC,buffer:dC,array:lC,uint8:fC,string:pC}=rC.types,yC=lC({type:uC,data:dC(uC)},uC,"bytes"),mC=dC(hC),gC=fC,vC=pC(uC),bC={hash:fC,signature:fC},EC={major:fC,minor:fC},SC=new class extends dg{constructor(){super(...arguments),this.subtle=new Cv}getRandomValues(e){if(!ArrayBuffer.isView(e))throw new TypeError("Failed to execute 'getRandomValues' on 'Crypto': parameter 1 is not of type 'ArrayBufferView'");const t=Buffer.from(e.buffer,e.byteOffset,e.byteLength);return p().randomFillSync(t),e}};iT.set(SC);r(1287),vh()("werift:packages/webrtc/src/utils.ts");vh()("werift:packages/webrtc/src/media/receiver/nack.ts");vh()("werift:packages/webrtc/media/receiver/receiverTwcc");(0,gh.debug)("werift:packages/webrtc/src/media/rtpReceiver.ts");vh()("werift:packages/webrtc/src/media/router.ts");vh()("werift:packages/webrtc/src/media/rtpSender.ts");class AC{static spec={msg_type:rC.types.uint8,length:rC.types.uint24be,message_seq:rC.types.uint16be,fragment_offset:rC.types.uint24be,fragment_length:rC.types.uint24be,fragment:rC.types.buffer((e=>e.current.fragment_length))};constructor(e,t,r,n,i,s){this.msg_type=e,this.length=t,this.message_seq=r,this.fragment_offset=n,this.fragment_length=i,this.fragment=s}get summary(){return getObjectSummary(this)}static createEmpty(){return new AC(void 0,void 0,void 0,void 0,void 0,void 0)}static deSerialize(e){return new AC(...Object.values(decode(e,AC.spec)))}serialize(){const e=encode(this,AC.spec).slice();return Buffer.from(e)}chunk(e){let t=0;const r=this.fragment.length;if(0===r)return[new AC(this.msg_type,r,this.message_seq,t,0,this.fragment)];const n=[];for(e||1240;t<r;){const i=Math.min(e,r-t),s=Buffer.from(this.fragment.slice(t,t+i));if(s.length<=0)throw new Error("Zero or less bytes processed while fragmenting handshake message.");n.push(new AC(this.msg_type,r,this.message_seq,t,s.length,s)),s.length}return n}static assemble(e){if(!e||!e.length)throw new Error("cannot reassemble handshake from empty array");e.sort(((e,t)=>e.fragment_offset-t.fragment_offset));const t=Buffer.alloc(e[0].length);for(const r of e)r.fragment.copy(t,r.fragment_offset);return new AC(e[0].msg_type,e[0].length,e[0].message_seq,0,t.length,t)}static findAllFragments(e,t){const r=e.find((e=>e.msg_type===t));return r&&e&&e.length?e.filter((e=>e.msg_type===r.msg_type&&e.message_seq===r.message_seq&&e.length===r.length)):[]}}let IC;!function(e){e[e.hello_request_0=0]="hello_request_0",e[e.client_hello_1=1]="client_hello_1",e[e.server_hello_2=2]="server_hello_2",e[e.hello_verify_request_3=3]="hello_verify_request_3",e[e.certificate_11=11]="certificate_11",e[e.server_key_exchange_12=12]="server_key_exchange_12",e[e.certificate_request_13=13]="certificate_request_13",e[e.server_hello_done_14=14]="server_hello_done_14",e[e.certificate_verify_15=15]="certificate_verify_15",e[e.client_key_exchange_16=16]="client_key_exchange_16",e[e.finished_20=20]="finished_20"}(IC||(IC={}));class wC{static spec={gmt_unix_time:rC.types.uint32be,random_bytes:rC.types.buffer(28)};constructor(e=Math.floor(Date.now()/1e3),t=(0,f.randomBytes)(28)){this.gmt_unix_time=e,this.random_bytes=t}static deSerialize(e){return new wC(...Object.values((0,rC.decode)(e,wC.spec)))}static from(e){return new wC(...Object.values(e))}serialize(){const e=(0,rC.encode)(this,wC.spec).slice();return Buffer.from(e)}}class TC{msgType=HandshakeType.client_hello_1;messageSeq=0;static spec={clientVersion:{major:rC.types.uint8,minor:rC.types.uint8},random:wC.spec,sessionId:rC.types.buffer(rC.types.uint8),cookie:rC.types.buffer(rC.types.uint8),cipherSuites:rC.types.array(rC.types.uint16be,rC.types.uint16be,"bytes"),compressionMethods:rC.types.array(rC.types.uint8,rC.types.uint8,"bytes"),extensions:yC};constructor(e,t,r,n,i,s,o){this.clientVersion=e,this.random=t,this.sessionId=r,this.cookie=n,this.cipherSuites=i,this.compressionMethods=s,this.extensions=o}static createEmpty(){return new TC(void 0,void 0,void 0,void 0,void 0,void 0,void 0)}static deSerialize(e){return new TC(...Object.values(decode(e,TC.spec)))}serialize(){const e=encode(this,TC.spec).slice();return Buffer.from(e)}toFragment(){const e=this.serialize();return new FragmentedHandshake(this.msgType,e.length,this.messageSeq,0,e.length,e)}}class CC{static spec={contentType:rC.types.uint8,protocolVersion:EC,epoch:rC.types.uint16be,sequenceNumber:rC.types.uint48be,contentLen:rC.types.uint16be};constructor(e,t,r,n,i){this.contentType=e,this.protocolVersion=t,this.epoch=r,this.sequenceNumber=n,this.contentLen=i}static createEmpty(){return new CC(void 0,void 0,void 0,void 0,void 0)}static deSerialize(e){return new CC(...Object.values((0,rC.decode)(e,CC.spec)))}serialize(){const e=(0,rC.encode)(this,CC.spec).slice();return Buffer.from(e)}}class _C{static spec={epoch:rC.types.uint16be,sequenceNumber:rC.types.uint48be,contentType:rC.types.uint8,protocolVersion:EC,contentLen:rC.types.uint16be};constructor(e,t,r,n,i){this.epoch=e,this.sequenceNumber=t,this.contentType=r,this.protocolVersion=n,this.contentLen=i}static createEmpty(){return new _C(void 0,void 0,void 0,void 0,void 0)}static deSerialize(e){return new _C(...Object.values(decode(e,_C.spec)))}serialize(){const e=encode(this,_C.spec).slice();return Buffer.from(e)}}class DC{static spec={recordLayerHeader:CC.spec,fragment:rC.types.buffer((e=>e.current.recordLayerHeader.contentLen))};constructor(e,t){this.recordLayerHeader=e,this.fragment=t}get summary(){return{header:this.recordLayerHeader,fragment:dumpBuffer(this.fragment)}}static createEmpty(){return new DC(void 0,void 0)}static deSerialize(e){return new DC(...Object.values(decode(e,DC.spec)))}serialize(){const e=encode(this,DC.spec).slice();return Buffer.from(e)}computeMACHeader(){return new MACHeader(this.recordLayerHeader.epoch,this.recordLayerHeader.sequenceNumber,this.recordLayerHeader.contentType,this.recordLayerHeader.protocolVersion,this.recordLayerHeader.contentLen).serialize()}}let RC,NC;!function(e){e[e.changeCipherSpec=20]="changeCipherSpec",e[e.alert=21]="alert",e[e.handshake=22]="handshake",e[e.applicationData=23]="applicationData"}(RC||(RC={})),function(e){e[e.CloseNotify=0]="CloseNotify",e[e.UnexpectedMessage=10]="UnexpectedMessage",e[e.BadRecordMac=20]="BadRecordMac",e[e.DecryptionFailed=21]="DecryptionFailed",e[e.RecordOverflow=22]="RecordOverflow",e[e.DecompressionFailure=30]="DecompressionFailure",e[e.HandshakeFailure=40]="HandshakeFailure",e[e.NoCertificate=41]="NoCertificate",e[e.BadCertificate=42]="BadCertificate",e[e.UnsupportedCertificate=43]="UnsupportedCertificate",e[e.CertificateRevoked=44]="CertificateRevoked",e[e.CertificateExpired=45]="CertificateExpired",e[e.CertificateUnknown=46]="CertificateUnknown",e[e.IllegalParameter=47]="IllegalParameter",e[e.UnknownCa=48]="UnknownCa",e[e.AccessDenied=49]="AccessDenied",e[e.DecodeError=50]="DecodeError",e[e.DecryptError=51]="DecryptError",e[e.ExportRestriction=60]="ExportRestriction",e[e.ProtocolVersion=70]="ProtocolVersion",e[e.InsufficientSecurity=71]="InsufficientSecurity",e[e.InternalError=80]="InternalError",e[e.UserCanceled=90]="UserCanceled",e[e.NoRenegotiation=100]="NoRenegotiation",e[e.UnsupportedExtension=110]="UnsupportedExtension"}(NC||(NC={}));vh()("werift-dtls : packages/dtls/src/flight/flight.ts : warn"),vh()("werift-dtls : packages/dtls/src/flight/flight.ts : err");const OC=0,UC=1,PC=1,BC=2,xC=3,MC=1,LC=2,kC=3,FC=4,VC=5;class HC{id=0;toString(){return this.name}}const jC=e=>"0x"+e.toString("hex").replace(/(.)(.)/g,"$1$2 ").split(" ").filter((e=>null!=e&&e.length>0)).join(",0x"),{createDecode:KC,encode:qC,types:{uint8:GC,uint16be:zC,uint48be:$C}}=r(4798),WC={epoch:zC,sequence:$C,type:GC,version:zC,length:zC},YC=vh()("werift-dtls : packages/dtls/src/cipher/suites/aead.ts : err");class QC extends class{id=0;verifyDataLength=12;init(...e){throw new Error("not implemented")}encrypt(...e){throw new Error("not implemented")}decrypt(...e){throw new Error("not implemented")}toString(){return this.name}}{keyLength=0;nonceLength=0;ivLength=0;authTagLength=0;nonceImplicitLength=0;nonceExplicitLength=0;constructor(){super()}get summary(){return e=this,Object.entries({...e}).reduce(((e,[t,r])=>("number"!=typeof r&&"string"!=typeof r||(e[t]=r),Buffer.isBuffer(r)&&(e[t]=jC(r)),e)),{});var e}init(e,t,r){const n=function(e,t,r,n,i,s,o="sha256"){const a=2*n+2*i,c=e,u=Buffer.concat([r,t]),h=oC(c,Buffer.concat([Buffer.from("key expansion"),u]),a,o),d=(0,rC.createDecode)(h),l=d.readBuffer(n),f=d.readBuffer(n),p=d.readBuffer(i),y=d.readBuffer(i),m=Buffer.alloc(s,0),g=Buffer.alloc(s,0);return p.copy(m,0),y.copy(g,0),{clientWriteKey:l,serverWriteKey:f,clientNonce:m,serverNonce:g}}(e,r,t,this.keyLength,this.ivLength,this.nonceLength,this.hashAlgorithm);this.clientWriteKey=n.clientWriteKey,this.serverWriteKey=n.serverWriteKey,this.clientNonce=n.clientNonce,this.serverNonce=n.serverNonce}encrypt(e,t,r){const n=e===cC,i=n?this.clientNonce:this.serverNonce,s=n?this.clientWriteKey:this.serverWriteKey;if(!i||!s)throw new Error;i.writeUInt16BE(r.epoch,this.nonceImplicitLength),i.writeUIntBE(r.sequenceNumber,this.nonceImplicitLength+2,6);const o=i.slice(this.nonceImplicitLength),a={epoch:r.epoch,sequence:r.sequenceNumber,type:r.type,version:r.version,length:t.length},c=qC(a,WC).slice(),u=f.createCipheriv(this.blockAlgorithm,s,i,{authTagLength:this.authTagLength});u.setAAD(c,{plaintextLength:t.length});const h=u.update(t),d=u.final(),l=u.getAuthTag();return Buffer.concat([o,h,d,l])}decrypt(e,t,r){const n=e===cC,i=n?this.serverNonce:this.clientNonce,s=n?this.serverWriteKey:this.clientWriteKey;if(!i||!s)throw new Error;const o=KC(t);o.readBuffer(this.nonceExplicitLength).copy(i,this.nonceImplicitLength);const a=o.readBuffer(o.length-this.authTagLength),c=o.readBuffer(this.authTagLength),u={epoch:r.epoch,sequence:r.sequenceNumber,type:r.type,version:r.version,length:a.length},h=qC(u,WC).slice(),d=f.createDecipheriv(this.blockAlgorithm,s,i,{authTagLength:this.authTagLength});d.setAuthTag(c),d.setAAD(h,{plaintextLength:a.length});const l=d.update(a);try{const e=d.final();return e.length>0?Buffer.concat([l,e]):l}catch(n){throw YC("decrypt failed",n,e,jC(t),r,this.summary),n}}}const JC=49195,XC=49196,ZC=49199,e_=49200,t_=156,r_=157,n_=168,i_=169,s_=53249,o_=53250,a_={K_LEN:16,N_MIN:12,N_MAX:12,P_MAX:2**36-31,A_MAX:2**53-1,C_MAX:2**36-15},c_={K_LEN:32,N_MIN:12,N_MAX:12,P_MAX:2**36-31,A_MAX:2**53-1,C_MAX:2**36-15},u_=function(){const e=new HC;return e.id=MC,e.name="RSA",e.keyType=PC,e}(),h_=function(){const e=new HC;return e.id=LC,e.name="ECDHE_RSA",e.signType=UC,e.keyType=PC,e}(),d_=function(){const e=new HC;return e.id=kC,e.name="ECDHE_ECDSA",e.signType=UC,e.keyType=BC,e}(),l_=function(){const e=new HC;return e.id=FC,e.name="PSK",e.signType=OC,e.keyType=xC,e}(),f_=function(){const e=new HC;return e.id=VC,e.name="ECDHE_PSK",e.signType=UC,e.keyType=xC,e}();function p_(e,t,r,n,i,s="sha256"){const o=new QC;return o.id=e,o.name=t,o.blockAlgorithm=r,o.kx=n,o.hashAlgorithm=s,o.keyLength=i.K_LEN,o.nonceLength=i.N_MAX,o.nonceImplicitLength=4,o.nonceExplicitLength=8,o.ivLength=o.nonceImplicitLength,o.authTagLength=16,o}class y_{static type=65281;static spec={type:rC.types.uint16be,data:rC.types.uint8};type=y_.type;data=0;constructor(e={}){Object.assign(this,e)}static createEmpty(){return new y_}static deSerialize(e){return new y_((0,rC.decode)(e,y_.spec))}serialize(){const e=(0,rC.encode)(this,y_.spec).slice();return Buffer.from(e)}get extension(){return{type:this.type,data:this.serialize().slice(2)}}}var m_=r(7273),g_=r.n(m_);class v_{static type=14;static spec={type:rC.types.uint16be,data:rC.types.buffer(rC.types.uint16be)};type=v_.type;data=Buffer.from([]);profiles=[];mki=Buffer.from([0]);constructor(e={}){Object.assign(this,e)}static create(e,t){return new v_({profiles:e,mki:t})}static deSerialize(e){const t=new v_((0,rC.decode)(e,v_.spec)),r=t.data.readUInt16BE(),n=g_()(r/2).map((e=>t.data.readUInt16BE(2*e+2)));return t.profiles=n,t.mki=t.data.slice(r+2),t}serialize(){const e=Buffer.alloc(2);e.writeUInt16BE(2*this.profiles.length);const t=Buffer.concat([e,...this.profiles.map((e=>{const t=Buffer.alloc(2);return t.writeUInt16BE(e),t})),this.mki]);this.data=t;const r=(0,rC.encode)(this,v_.spec).slice();return Buffer.from(r)}static fromData(e){const t=Buffer.alloc(4);return t.writeUInt16BE(v_.type),t.writeUInt16BE(e.length,2),v_.deSerialize(Buffer.concat([t,e]))}get extension(){return{type:this.type,data:this.serialize().slice(4)}}}class b_{msgType=HandshakeType.certificate_11;static spec={certificateList:rC.types.array(mC,rC.types.uint24be,"bytes")};constructor(e){this.certificateList=e}static createEmpty(){return new b_(void 0)}static deSerialize(e){return new b_(...Object.values(decode(e,b_.spec)))}serialize(){const e=encode(this,b_.spec).slice();return Buffer.from(e)}toFragment(){const e=this.serialize();return new FragmentedHandshake(this.msgType,e.length,this.messageSeq,0,e.length,e)}}class E_{static spec={type:rC.types.uint8};constructor(e=1){this.type=e}static createEmpty(){return new E_}static deSerialize(e){return new E_(...Object.values(decode(e,E_.spec)))}serialize(){const e=encode(this,E_.spec).slice();return Buffer.from(e)}}class S_{msgType=HandshakeType.certificate_verify_15;static spec={algorithm:rC.types.uint16be,signature:rC.types.buffer(rC.types.uint16be)};constructor(e,t){this.algorithm=e,this.signature=t}static createEmpty(){return new S_(void 0,void 0)}static deSerialize(e){const t=decode(e,S_.spec);return new S_(...Object.values(t))}serialize(){const e=encode(this,S_.spec).slice();return Buffer.from(e)}toFragment(){const e=this.serialize();return new FragmentedHandshake(this.msgType,e.length,this.messageSeq,0,e.length,e)}}class A_{msgType=HandshakeType.client_key_exchange_16;static spec={publicKey:rC.types.buffer(rC.types.uint8)};constructor(e){this.publicKey=e}static createEmpty(){return new A_(void 0)}static deSerialize(e){const t=decode(e,A_.spec);return new A_(...Object.values(t))}serialize(){const e=encode(this,A_.spec).slice();return Buffer.from(e)}toFragment(){const e=this.serialize();return new FragmentedHandshake(this.msgType,e.length,this.messageSeq,0,e.length,e)}}class I_{msgType=HandshakeType.certificate_request_13;static spec={certificateTypes:rC.types.array(gC,rC.types.uint8,"bytes"),signatures:rC.types.array(bC,rC.types.uint16be,"bytes"),authorities:rC.types.array(vC,rC.types.uint16be,"bytes")};constructor(e,t,r){this.certificateTypes=e,this.signatures=t,this.authorities=r}static createEmpty(){return new I_(void 0,void 0,void 0)}static deSerialize(e){return new I_(...Object.values(decode(e,I_.spec)))}serialize(){const e=encode(this,I_.spec).slice();return Buffer.from(e)}toFragment(){const e=this.serialize();return new FragmentedHandshake(this.msgType,e.length,this.messageSeq,0,e.length,e)}}class w_{msgType=HandshakeType.server_hello_2;static spec={serverVersion:EC,random:wC.spec,sessionId:rC.types.buffer(rC.types.uint8),cipherSuite:rC.types.uint16be,compressionMethod:rC.types.uint8};constructor(e,t,r,n,i,s){this.serverVersion=e,this.random=t,this.sessionId=r,this.cipherSuite=n,this.compressionMethod=i,this.extensions=s}static createEmpty(){return new w_(void 0,void 0,void 0,void 0,void 0,void 0)}static deSerialize(e){const t=decode(e,w_.spec),r=new w_(...Object.values(t));return r.serialize().length<e.length?new w_(...Object.values(decode(e,{...w_.spec,extensions:ExtensionList}))):r}serialize(){const e=void 0===this.extensions?encode(this,w_.spec).slice():encode(this,{...w_.spec,extensions:ExtensionList}).slice();return Buffer.from(e)}toFragment(){const e=this.serialize();return new FragmentedHandshake(this.msgType,e.length,this.messageSeq,0,e.length,e)}}class T_{msgType=HandshakeType.server_key_exchange_12;static spec={ellipticCurveType:rC.types.uint8,namedCurve:rC.types.uint16be,publicKeyLength:rC.types.uint8,publicKey:rC.types.buffer((e=>e.current.publicKeyLength)),hashAlgorithm:rC.types.uint8,signatureAlgorithm:rC.types.uint8,signatureLength:rC.types.uint16be,signature:rC.types.buffer((e=>e.current.signatureLength))};constructor(e,t,r,n,i,s,o,a){this.ellipticCurveType=e,this.namedCurve=t,this.publicKeyLength=r,this.publicKey=n,this.hashAlgorithm=i,this.signatureAlgorithm=s,this.signatureLength=o,this.signature=a}static createEmpty(){return new T_(void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}static deSerialize(e){const t=decode(e,T_.spec);return new T_(...Object.values(t))}serialize(){return encodeBuffer(this,T_.spec)}toFragment(){const e=this.serialize();return new FragmentedHandshake(this.msgType,e.length,this.messageSeq,0,e.length,e)}}const C_=vh()("werift-dtls : packages/dtls/src/flight/client/flight5.ts : log");const __={};__[IC.server_hello_2]=({cipher:e,srtp:t,dtls:r})=>n=>{C_(r.sessionId,"serverHello",n.cipherSuite),e.remoteRandom=wC.from(n.random),e.cipherSuite=n.cipherSuite,C_(r.sessionId,"selected cipherSuite",e.cipherSuite),n.extensions&&n.extensions.forEach((e=>{switch(e.type){case v_.type:const n=v_.fromData(e.data),i=class{static findMatchingSRTPProfile(e,t){for(const r of t)if(e.includes(r))return r}}.findMatchingSRTPProfile(n.profiles,r.options.srtpProfiles||[]);if(C_(r.sessionId,"selected srtp profile",i),null==i)return;t.srtpProfile=i;break;case class{static type=23}.type:r.remoteExtendedMasterSecret=!0;break;case y_.type:C_(r.sessionId,"RenegotiationIndication")}}))},__[IC.certificate_11]=({cipher:e,dtls:t})=>r=>{C_(t.sessionId,"handshake certificate",r),e.remoteCertificate=r.certificateList[0]},__[IC.server_key_exchange_12]=({cipher:e,dtls:t})=>r=>{if(!e.localRandom||!e.remoteRandom)throw new Error;C_(t.sessionId,"ServerKeyExchange",r),C_(t.sessionId,"selected curve",r.namedCurve),e.remoteKeyPair={curve:r.namedCurve,publicKey:r.publicKey},e.localKeyPair=function(e){switch(e){case Qd.secp256r1_23:{const t=new nC.ec("p256").genKeyPair();return{curve:e,privateKey:t.getPrivate().toBuffer("be"),publicKey:Buffer.from(t.getPublic().encode("array",!1))}}case Qd.x25519_29:{const t=iC.box.keyPair();return{curve:e,privateKey:Buffer.from(t.secretKey.buffer),publicKey:Buffer.from(t.publicKey.buffer)}}default:throw new Error}}(r.namedCurve)},__[IC.certificate_request_13]=({dtls:e})=>t=>{C_(e.sessionId,"certificate_request",t),e.requestedCertificateTypes=t.certificateTypes,e.requestedSignatureAlgorithms=t.signatures},__[IC.server_hello_done_14]=({dtls:e})=>t=>{C_(e.sessionId,"server_hello_done",t)};class D_{msgType=HandshakeType.hello_verify_request_3;static spec={serverVersion:EC,cookie:rC.types.buffer(rC.types.uint8)};constructor(e,t){this.serverVersion=e,this.cookie=t}static createEmpty(){return new D_(void 0,void 0)}static deSerialize(e){return new D_(...Object.values(decode(e,D_.spec)))}serialize(){const e=encode(this,D_.spec).slice();return Buffer.from(e)}get version(){return{major:255-this.serverVersion.major,minor:255-this.serverVersion.minor}}toFragment(){const e=this.serialize();return new FragmentedHandshake(this.msgType,e.length,this.messageSeq,0,e.length,e)}}(0,gh.debug)("werift-dtls : packages/dtls/src/context/dtls.ts : log");class R_{static type=null;static spec={type:rC.types.uint16be,data:rC.types.array(rC.types.uint16be,rC.types.uint16be,"bytes")};type=R_.type;data=[];constructor(e={}){Object.assign(this,e)}static createEmpty(){return new R_}static fromData(e){return new R_({type:R_.type,data:decode(e,R_.spec.data)})}static deSerialize(e){return new R_(decode(e,R_.spec))}serialize(){return Buffer.from(encode(this,R_.spec).slice())}get extension(){return{type:this.type,data:this.serialize().slice(2)}}}class N_{static type=null;static spec={type:rC.types.uint16be,data:rC.types.array({hash:rC.types.uint8,signature:rC.types.uint8},rC.types.uint16be,"bytes")};type=N_.type;data=[];constructor(e={}){Object.assign(this,e)}static createEmpty(){return new N_}static deSerialize(e){return new N_(decode(e,N_.spec))}serialize(){const e=encode(this,N_.spec).slice();return Buffer.from(e)}static fromData(e){const t=Buffer.alloc(2);return t.writeUInt16BE(N_.type),N_.deSerialize(Buffer.concat([t,e]))}get extension(){return{type:this.type,data:this.serialize().slice(2)}}}class O_{static spec={level:rC.types.uint8,description:rC.types.uint8};constructor(e,t){this.level=e,this.description=t}static deSerialize(e){return new O_(...Object.values(decode(e,O_.spec)))}serialize(){const e=encode(this,O_.spec).slice();return Buffer.from(e)}}vh()("werift-dtls : packages/dtls/record/receive.ts : log"),vh()("werift-dtls : packages/dtls/record/receive.ts : err"),vh()("werift-dtls : packages/dtls/src/socket.ts : log"),vh()("werift-dtls : packages/dtls/src/socket.ts : err");vh()("werift-dtls : packages/dtls/src/client.ts : log");vh()("werift-dtls : packages/dtls/flight/server/flight2.ts : log"),vh()("werift-dtls : packages/dtls/flight/server/flight4.ts : log");const U_=vh()("werift-dtls : packages/dtls/flight/server/flight6.ts");const P_={};P_[IC.client_key_exchange_16]=({cipher:e,dtls:t})=>r=>{if(e.remoteKeyPair={curve:e.namedCurve,publicKey:r.publicKey},!(e.remoteKeyPair.publicKey&&e.localKeyPair&&e.remoteRandom&&e.localRandom))throw new Error("not exist");const n=function(e,t,r){switch(r){case Qd.secp256r1_23:const r=new nC.ec("p256"),n=r.keyFromPublic(e).getPublic(),i=r.keyFromPrivate(t).getPrivate(),s=n.mul(i);return Buffer.from(s.encode("array",!1)).slice(1,33);case Qd.x25519_29:return Buffer.from(iC.scalarMult(t,e));default:throw new Error}}(e.remoteKeyPair.publicKey,e.localKeyPair.privateKey,e.localKeyPair.curve);U_(t.sessionId,"extendedMasterSecret",t.options.extendedMasterSecret,t.remoteExtendedMasterSecret);const i=Buffer.concat(t.sortedHandshakeCache.map((e=>e.serialize())));e.masterSecret=t.options.extendedMasterSecret&&t.remoteExtendedMasterSecret?function(e,t){const r=aC("sha256",t);return oC(e,Buffer.concat([Buffer.from("extended master secret"),r]),48)}(n,i):function(e,t,r){return oC(e,Buffer.concat([Buffer.from("master secret"),t,r]),48)}(n,e.remoteRandom.serialize(),e.localRandom.serialize()),e.cipher=function(e){switch(e){case t_:return p_(t_,"TLS_RSA_WITH_AES_128_GCM_SHA256","aes-128-gcm",u_,a_);case r_:return p_(r_,"TLS_RSA_WITH_AES_256_GCM_SHA384","aes-256-gcm",u_,c_,"sha384");case ZC:return p_(ZC,"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","aes-128-gcm",h_,a_);case e_:return p_(e_,"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","aes-256-gcm",h_,c_,"sha384");case JC:return p_(JC,"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","aes-128-gcm",d_,a_);case XC:return p_(XC,"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","aes-256-gcm",d_,c_,"sha384");case n_:return p_(n_,"TLS_PSK_WITH_AES_128_GCM_SHA256","aes-128-gcm",l_,a_,"sha256");case i_:return p_(i_,"TLS_PSK_WITH_AES_256_GCM_SHA384","aes-256-gcm",l_,c_,"sha384");case s_:return p_(s_,"TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256","aes-128-gcm",f_,a_,"sha256");case o_:return p_(o_,"TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384","aes-256-gcm",f_,c_,"sha384")}return null}(e.cipherSuite),e.cipher.init(e.masterSecret,e.localRandom.serialize(),e.remoteRandom.serialize()),U_(t.sessionId,"setup cipher",e.cipher.summary)},P_[IC.finished_20]=({dtls:e})=>t=>{U_(e.sessionId,"finished",t)};vh()("werift-dtls : packages/dtls/src/server.ts : log");vh()("werift-dtls : packages/dtls/src/transport.ts");vh()("werift:packages/webrtc/src/transport/dtls.ts");vh()("werift:packages/webrtc/src/transport/ice.ts");let B_,x_;!function(e){e[e.DCEP=50]="DCEP",e[e.STRING=51]="STRING",e[e.BINARY=53]="BINARY",e[e.STRING_EMPTY=56]="STRING_EMPTY",e[e.BINARY_EMPTY=57]="BINARY_EMPTY"}(B_||(B_={})),function(e){e[e.CLOSED=1]="CLOSED",e[e.COOKIE_WAIT=2]="COOKIE_WAIT",e[e.COOKIE_ECHOED=3]="COOKIE_ECHOED",e[e.ESTABLISHED=4]="ESTABLISHED",e[e.SHUTDOWN_PENDING=5]="SHUTDOWN_PENDING",e[e.SHUTDOWN_SENT=6]="SHUTDOWN_SENT",e[e.SHUTDOWN_RECEIVED=7]="SHUTDOWN_RECEIVED",e[e.SHUTDOWN_ACK_SENT=8]="SHUTDOWN_ACK_SENT"}(x_||(x_={}));r(2849);class M_{get body(){return this._body}set body(e){this._body=e}static type=-1;constructor(e=0,t=Buffer.from("")){this.flags=e,this._body=t}get type(){return M_.type}get bytes(){if(!this.body)throw new Error;return Buffer.concat([Buffer.from(uh.T.Pack("!BBH",[this.type,this.flags,this.body.length+4])),this.body,...[...Array(eD(this.body.length))].map((()=>Buffer.from("\0")))])}}class L_ extends M_{constructor(e=0,t){super(e,t),this.flags=e,t?([this.initiateTag,this.advertisedRwnd,this.outboundStreams,this.inboundStreams,this.initialTsn]=uh.T.Unpack("!LLHHL",t),this.params=rD(t.slice(16))):(this.initiateTag=0,this.advertisedRwnd=0,this.outboundStreams=0,this.inboundStreams=0,this.initialTsn=0,this.params=[])}get body(){let e=Buffer.from(uh.T.Pack("!LLHHL",[this.initiateTag,this.advertisedRwnd,this.outboundStreams,this.inboundStreams,this.initialTsn]));return e=Buffer.concat([e,tD(this.params)]),e}}class k_ extends L_{static type=1;get type(){return k_.type}}class F_ extends L_{static type=2;get type(){return F_.type}}class V_ extends M_{static type=192;streams=[];constructor(e=0,t){if(super(e,t),this.flags=e,t){this.cumulativeTsn=uh.T.Unpack("!L",t)[0];let e=4;for(;e<t.length;)this.streams.push(uh.T.Unpack("!HH",t.slice(e))),e+=4}else this.cumulativeTsn=0}get type(){return V_.type}set body(e){}get body(){const e=Buffer.from(uh.T.Pack("!L",[this.cumulativeTsn]));return Buffer.concat([e,...this.streams.map((([e,t])=>Buffer.from(uh.T.Pack("!HH",[e,t]))))])}}class H_ extends M_{static type=0;get type(){return H_.type}tsn=0;streamId=0;streamSeqNum=0;protocol=0;userData=Buffer.from("");abandoned=!1;acked=!1;misses=0;retransmit=!1;sentCount=0;bookSize=0;constructor(e=0,t){super(e,t),this.flags=e,t&&([this.tsn,this.streamId,this.streamSeqNum,this.protocol]=uh.T.Unpack("!LHHL",t),this.userData=t.slice(12))}get bytes(){const e=16+this.userData.length;let t=Buffer.concat([Buffer.from(uh.T.Pack("!BBHLHHL",[this.type,this.flags,e,this.tsn,this.streamId,this.streamSeqNum,this.protocol])),this.userData]);return e%4&&(t=Buffer.concat([t,...[...Array(eD(e))].map((()=>Buffer.from("\0")))])),t}}class j_ extends M_{static type=10;get type(){return j_.type}}class K_ extends M_{static type=11;get type(){return K_.type}}class q_ extends M_{params=[];constructor(e=0,t){super(e,t),this.flags=e,t&&(this.params=rD(t))}get body(){return tD(this.params)}}class G_ extends q_{static type=6;get type(){return G_.type}}class z_ extends q_{static type=9;static CODE={InvalidStreamIdentifier:1,MissingMandatoryParameter:2,StaleCookieError:3,OutofResource:4,UnresolvableAddress:5,UnrecognizedChunkType:6,InvalidMandatoryParameter:7,UnrecognizedParameters:8,NoUserData:9,CookieReceivedWhileShuttingDown:10,RestartofanAssociationwithNewAddresses:11,UserInitiatedAbort:12,ProtocolViolation:13};get type(){return z_.type}get descriptions(){return this.params.map((([e,t])=>({name:(Object.entries(z_.CODE).find((([,t])=>t===e))||[])[0],body:t})))}}class $_ extends q_{static type=4;get type(){return $_.type}}class W_ extends q_{static type=5;get type(){return W_.type}}class Y_ extends q_{static type=130;get type(){return Y_.type}}class Q_ extends M_{static type=3;get type(){return Q_.type}gaps=[];duplicates=[];cumulativeTsn=0;advertisedRwnd=0;constructor(e=0,t){if(super(e,t),this.flags=e,t){const[e,r,n,i]=uh.T.Unpack("!LLHH",t);this.cumulativeTsn=e,this.advertisedRwnd=r;let s=12;[...Array(n)].forEach((()=>{this.gaps.push(uh.T.Unpack("!HH",t.slice(s))),s+=4})),[...Array(i)].forEach((()=>{this.duplicates.push(uh.T.Unpack("!L",t.slice(s))[0]),s+=4}))}}get bytes(){const e=16+4*(this.gaps.length+this.duplicates.length);let t=Buffer.from(uh.T.Pack("!BBHLLHH",[this.type,this.flags,e,this.cumulativeTsn,this.advertisedRwnd,this.gaps.length,this.duplicates.length]));return t=Buffer.concat([t,...this.gaps.map((e=>Buffer.from(uh.T.Pack("!HH",e))))]),t=Buffer.concat([t,...this.duplicates.map((e=>Buffer.from(uh.T.Pack("!L",[e]))))]),t}}class J_ extends M_{static type=7;get type(){return J_.type}cumulativeTsn=0;constructor(e=0,t){super(e,t),this.flags=e,t&&(this.cumulativeTsn=uh.T.Unpack("!L",t)[0])}get body(){return Buffer.from(uh.T.Pack("!L",[this.cumulativeTsn]))}}class X_ extends M_{static type=8;get type(){return X_.type}}class Z_ extends M_{static type=14;get type(){return Z_.type}}[H_,k_,F_,Q_,$_,W_,G_,J_,X_,z_,j_,K_,Z_,Y_,V_].reduce(((e,t)=>(e[t.type]=t,e)),{});function eD(e){const t=e%4;return t?4-t:0}function tD(e){let t=Buffer.from(""),r=Buffer.from("");return e.forEach((([e,n])=>{const i=n.length+4;t=Buffer.concat([t,r,Buffer.from(uh.T.Pack("!HH",[e,i])),n]),r=Buffer.concat([...Array(eD(i))].map((()=>Buffer.from("\0"))))})),t}function rD(e){const t=[];let r=0;for(;r<=e.length-4;){const[n,i]=uh.T.Unpack("!HH",e.slice(r));t.push([n,e.slice(r+4,r+i)]),r+=i+eD(i)}return t}vh()("werift/sctp/sctp");vh()("werift:packages/webrtc/src/transport/sctp.ts");vh()("werift:packages/webrtc/src/peerConnection.ts");new bl({mimeType:"audio/opus",clockRate:48e3,channels:2}),new bl({mimeType:"audio/PCMU",clockRate:8e3,channels:1,payloadType:0}),new bl({mimeType:"video/VP8",clockRate:9e4,rtcpFeedback:[{type:"nack"},{type:"nack",parameter:"pli"},{type:"goog-remb"}]});const{mediaManager:nD}=i();function iD(e){const t=e.onRtp;return e.onRtp=r=>{e.onRtp=t,e.firstPacket?.(r),e.onRtp(r)},t=>e.onRtp(t)}function sD(e,t){t?.on("message",iD(e))}async function oD(e,t,r,n,i,s){try{if(!i){const r=await t.setup({type:"udp",path:n.control,onRtp:(e,t)=>s(t)});return e.log("rtsp/udp",n.codec,r),!1}}catch(e){if(!(e instanceof jd))throw e}return await t.setup({type:"tcp",port:r,path:n.control,onRtp:(e,t)=>s(t)}),e.log("rtsp/tcp",n.codec),!0}function aD(e,t){return"copy"===e||e&&e===t}async function cD(e,t,r,n){r.audio||delete r.audio,r.video||delete r.video;const i=new Nd,s=e=>{const t=e?.onRtp;t&&(e.onRtp=e=>{if(i.finished)return;const r=127&e.readUint8(1);r>=72&&r<=76||t(e)})};s(r.video),s(r.audio);let o,{inputArguments:a,videoDecoderArguments:c}=t;i.promise.finally((()=>o?.safeTeardown()));let u=!1;const{rtspMode:h,onRtspClient:d,rtspClientForceTcp:l}=n||{},{video:f,audio:p}=r;r=Object.assign({},r);const y=f?.codecCopy,m=p?.codecCopy,g=await nD.getFFmpegPath(),v=t.container?.startsWith("rtsp");let b;const E=new Nd,S=new Nd,A=new Nd;S.promise.then((e=>f?.onMSection?.(e))),A.promise.then((e=>p?.onMSection?.(e)));let I=!1;if(t.url&&v&&aD(y,t.mediaStreamOptions?.video?.codec)){delete r.video,o=new Kd(t.url),o.requestTimeout=1e4;try{const t=await o.options();b=(await o.describe()).body.toString();const n=kd(b),s=n.msections.find((e=>"video"===e.type&&(e.codec===y||"copy"===y)));if(!s)throw new Error(`advertised video codec ${y} not found in sdp.`);S.resolve(s);let c=0;await oD(e,o,c,s,l,iD(f)),c+=2;const h=n.msections.find((e=>"audio"===e.type&&(e.codec===m||"copy"===m)));if(e.log("a/v",y,m,"found",s.codec,h?.codec),p)if(h&&aD(m,h?.codec))delete r.audio,A.resolve(h),await oD(e,o,c,h,l,iD(p)),c+=2;else{const t=kd(b);let n=t.msections.find((e=>"audio"===e.type&&e.codec===m));if(n||(n=t.msections.find((e=>"audio"===e.type))),n){t.msections=t.msections.filter((e=>e===n));const r=Od(function(e,t,r){const n=new RegExp(`m=${t} \\d+`);return e.replace(/c=IN .*/,"c=IN IP4 127.0.0.1").replace(n,`m=${t} ${r}`)}(t.toSdp(),"audio",0)),s=kd(r).msections.find((e=>"audio"===e.type)).control;let u=!0,h=!1;const d=await oD(e,o,c,n,!1,(t=>{if(u&&(u=!1,"aac"===n.codec)){const r=Ih.deSerialize(t).payload;if(255==r[0]&&240==(240&r[1])){h=!0,I=!0;const t=["-hide_banner","-f","aac","-i","pipe:3",...p.encoderArguments,...p.outputArguments];wu(e,t);const r=vu().spawn(g,t,{stdio:["pipe","pipe","pipe","pipe","pipe"]});Iu(e,r),i.promise.finally((()=>Au(r))),r.on("exit",(()=>i.resolve(void 0))),f=r.stdio[3]}}if(h){const e=Ih.deSerialize(t);f?.write(e.payload)}else y?.sendTrack(s,t,!1)})),l=await uu();let f,y;i.promise.finally((()=>l.clientPromise.then((e=>e.destroy())))),l.clientPromise.then((async e=>{const t=new qd(e,r,!d);i.promise.finally((()=>y.destroy())),await t.handlePlayback(),y=t})),p.ffmpegDestination="127.0.0.1",p.srtp=void 0,a=["-i",`rtsp://${l.host}:${l.port}`]}else delete r.audio,e.warn("audio section not found in sdp."),A.resolve(void 0)}else A.resolve(void 0);u=await(d?.(o,t)),u||await o.play()}catch(e){throw o.client.destroy(),e}}else e.log("video codec/container not matched, transcoding:",y);const w=e=>{E.resolve(e);const t=kd(e),r=t.msections.find((e=>"video"===e.type)),n=t.msections.find((e=>"audio"===e.type));return S.resolve(r),A.resolve(n),{videoSection:r,audioSection:n}};await async function(e,t,r){for(const e of Object.keys(r)){const n=r[e];n.bind=await lu(),n.bind.server.setRecvBufferSize(1048576);const{server:i,port:s}=n.bind;t.promise.finally((()=>hu(i)));const o=n.outputArguments=[];n.payloadType&&o.push("-payload_type",n.payloadType.toString()),n.ssrc&&o.push("-ssrc",n.ssrc.toString()),sD(n,i)}}(0,i,r),o?.client.on("close",(()=>i.resolve(void 0)));const T=!h,C=new Nd;if(Object.keys(r).length){let t;if(T){C.resolve(void 0);for(const e of Object.keys(r)){const t=r[e];let n=t.ffmpegDestination||"127.0.0.1";"127.0.0.1"===n&&(n=`${n}:${t.bind.port}`);const i=new URLSearchParams;let s=`rtp://${n}`;t.rtcpPort&&i.set("rtcpport",t.rtcpPort.toString()),t.packetSize&&i.set("pkt_size",t.packetSize.toString()),t.srtp&&(s=`s${s}`,t.outputArguments.push("-srtp_out_suite",t.srtp.crytoSuite,"-srtp_out_params",t.srtp.key.toString("base64"))),s=`${s}?${i}`,t.outputArguments.push("-dn","-sn"),"video"!==e&&t.outputArguments.push("-vn"),"audio"!==e&&t.outputArguments.push("-an"),t.outputArguments.push("-f","rtp"),t.outputArguments.push(s)}}const n=[];for(const e of Object.keys(r)){const t=r[e];n.push(...t.encoderArguments,...t.outputArguments)}const s=["-hide_banner",...c||[],...a,...n];if(T)s.push("-sdp_file","pipe:4");else{const t="udp"===h,n=await uu();s.push("-rtsp_transport",t?"udp":"tcp","-f","rtsp",`rtsp://127.0.0.1:${n.port}`),n.clientPromise.then((async n=>{n.on("close",(()=>i.resolve(void 0))),i.promise.finally((()=>n.destroy()));const s=new qd(n,void 0,t);await s.handleSetup(["announce"]);const{videoSection:o,audioSection:a}=w(s.sdp);if(await s.handleSetup(),sD(f,s.setupTracks[o?.control]?.rtp),sD(p,s.setupTracks[a?.control]?.rtp),C.resolve(s),"pull"!==h){let t=!0,n=!0;for await(const i of s.handleRecord())i.type===o.codec?(t&&(t=!1,f.firstPacket?.(i.packet)),f.onRtp(i.packet)):i.type===a?.codec?(n&&(n=!1,r.audio.firstPacket?.(i.packet)),p.onRtp(i.packet)):e.warn("unexpected rtsp sample",i.type)}}))}wu(e,s),t=vu().spawn(g,s,{stdio:["pipe","pipe","pipe","pipe","pipe"]}),i.promise.finally((()=>Au(t))),t.on("exit",(()=>{I||i.resolve(void 0)})),i.promise.finally((()=>Au(t))),Iu(e,t),i.promise.finally((()=>Au(t))),T&&t.stdio[4].on("data",(e=>{const t=e.toString();w(t)}))}else e.log("bypassing ffmpeg, perfect codecs"),E.resolve(b);return u||process.nextTick((()=>{o?.readLoop().catch((()=>{})).finally((()=>i.resolve(void 0)))})),{rtspServer:C.promise,sdpContents:E.promise,videoSection:S.promise,audioSection:A.promise,kill:()=>i.resolve(void 0),killPromise:i.promise,get killed(){return i.finished}}}class uD{depacketized=[];constructor(e){this.framesPerPacket=e}repacketize(e){const t=3&e.payload[0];let r;const n=()=>{let t=e.payload.readUInt8(r);return t>=252&&(r++,t+=4*e.payload.readUInt8(r)),t};if(0===t){if(1===this.framesPerPacket&&!this.depacketized.length)return e;this.depacketized.push(e.payload.subarray(1))}else if(1===t){if(2===this.framesPerPacket&&!this.depacketized.length)return e;const t=e.payload.length-1;if(t%2)throw new Error("expected equal sized opus packets (code 1)");const r=t/2;this.depacketized.push(e.payload.subarray(1,1+r)),this.depacketized.push(e.payload.subarray(1+r))}else if(2===t){if(2===this.framesPerPacket&&!this.depacketized.length)return e;r=1;const t=n();this.depacketized.push(e.payload.subarray(r,r+t)),this.depacketized.push(e.payload.subarray(r+t))}else if(3===t){const t=e.payload[1],i=63&t,s=128&t;if(this.framesPerPacket===i&&!this.depacketized.length)return e;r=2;let o=0;if(64&t&&(o=e.payload.readUInt8(r),r++,255===o&&(o=254+e.payload.readUInt8(r),r++)),s){const t=[];for(let e=0;e<i;e++){const e=n();t.push(e)}for(let n=0;n<i;n++){const i=t[n],s=r;r+=i,this.depacketized.push(e.payload.subarray(s,r))}}else{const t=e.payload.length-r-o;if(t%i)throw new Error("expected equal sized opus packets (code 3)");const n=t/i;for(let t=0;t<i;t++){const i=r+t*n,s=i+n;this.depacketized.push(e.payload.subarray(i,s))}}}if(this.depacketized.length<this.framesPerPacket)return;const i=this.depacketized.slice(0,this.framesPerPacket);this.depacketized=this.depacketized.slice(this.framesPerPacket);let s=e.payload[0];s|=3;const o=[s,128|this.framesPerPacket];o.push(...i.slice(0,-1).map((e=>e.length)));const a=Buffer.from(o),c=Buffer.concat([a,...i]);return e.payload=c,e}}function hD(e,t,r,n,i,s,o,a,c,u){const h=new Td(t),d=new Id(t);let l,f,p,y=0,m=0,g=0,v=0,b=0,E=!0;const S=new Set,A=()=>{S.size&&(e.log("scanning for idr start found:",...S),S.clear())},I=zd()((()=>{A()}),1e3);let w=1;if(u){switch(u.audioSampleRate){case cr.KHZ_24:w=3;break;case cr.KHZ_16:w=2}w=w*u.audioPacketTime/20,f=new uD(u.framesPerPacket)}else{const t=c.maxPacketSize-12;p=new th(e,t,c),r.setSendBufferSize(1048576)}function T(e){b=e;const t=new ed({ssrc:n,senderInfo:new td({ntpTimestamp:Wu(),rtpTimestamp:m,packetCount:g,octetCount:v})}),i=d.encrypt(t.serialize());r.send(i,s,o)}function C(e){const t=Date.now();t>b+1e3*a&&T(t),m=e.header.timestamp,g++,v+=e.payload.length,e.header.padding=!1,e.header.ssrc=n,e.header.payloadType=i;const c=h.encrypt(e.payload,e.header);r.send(c,s,o)}return{sendRtp:function(t){if(void 0===l&&(e.log(`received first ${u?"audio":"video"} packet`),l=t.header.sequenceNumber),y||(y=t.header.timestamp),u){if(!(t=f.repacketize(t)))return;return t.header.timestamp=(y+160*g*w)%4294967295,void C(t)}const r=p.repacketize(t);if(r?.length)for(const t of r){if(E){const r=Vd(t.payload,!0);E=!r.has(5),E?(r.forEach(S.add,S),I()):(A(),e.log("idr start found:",...r))}C(t)}},sendRtcp:function(){return T(Date.now())}}}async function dD(e,t,r,n,i){const s=i.startRequest,o=i.startRequest.video.mtu,a=Buffer.concat([i.prepareRequest.video.srtp_key,i.prepareRequest.video.srtp_salt]),c=Buffer.concat([i.prepareRequest.audio.srtp_key,i.prepareRequest.audio.srtp_salt]),u=n.mediaStreamOptions,h=n.h264FilterArguments?.slice()||[],d=[],l=rh(r);(l.audio||l.video)&&Yu();const f=n.mediaStreamOptions?.video?.codec,p=!!n.h264EncoderArguments?.length||!!n.h264FilterArguments?.length,y=l.video||p||"rtsp"!==n.container;if(n.mediaStreamOptions?.oobCodecParameters&&h.push("-bsf:v","dump_extra"),l.video||p){l.video||!n.h264EncoderArguments?h.push("-c:v","libx264","-pix_fmt","yuvj420p","-preset","ultrafast","-bf","0"):h.push(...n.h264EncoderArguments);mu(h,`scale=w='min(${s.video.width},iw)':h=-2`);const e=n.destinationVideoBitrate||1e3*s.video.max_bit_rate;h.push("-b:v",e.toString(),"-bufsize",(2*e).toString(),"-maxrate",e.toString(),"-g",""+4*s.video.fps,"-r",s.video.fps.toString())}else Qu(t,e,f),h.push("-vcodec","copy");let m=i.prepareRequest.targetAddress,g=i.prepareRequest.video.port,v=g;let b=r.getItem("rtpSender")||"Default";t.log({tool:u?.tool,rtpSender:b});const E=n.mediaStreamOptions?.video?.h264Info||{},S=E.fuab||E.stapb||E.mtap16||E.mtap32||E.sei;"Default"===b&&S&&("scrypted"===u?.tool?t.warn('H264 oddities are reported in the stream. Stream tool is marked safe as "scrypted", ignoring oddity. If there are issues streaming, consider switching to FFmpeg Sender.'):(t.warn("H264 oddities are reported in the stream. Using FFmpeg."),b="FFmpeg")),"Default"===b&&(b="Scrypted"),"Scrypted"===b&&y&&t.warn("Scrypted RTP Sender can not be used since transcoding is enabled or the stream container is not RTSP.");const A=!y&&"Scrypted"===b,I=s.audio.codec,w=I===ar.OPUS;let T,C=s.audio.packet_time/20;if(null===u?.audio);else if(I===ar.OPUS||I===ar.AAC_ELD){let e,r,n,o;if(d.push("-acodec",...w?["libopus","-application","lowdelay","-frame_duration",s.audio.packet_time.toString()]:["libfdk_aac","-profile:a","aac_eld"],"-flags","+global_header","-ar",`${s.audio.sample_rate}k`,"-b:a",`${s.audio.max_bit_rate}k`,"-bufsize",4*s.audio.max_bit_rate+"k","-ac",`${s.audio.channel}`),w){const n=hD(t,i.aconfig,i.audioReturn,i.audiossrc,i.startRequest.audio.pt,i.prepareRequest.audio.port,i.prepareRequest.targetAddress,i.startRequest.audio.rtcp_interval,void 0,{audioPacketTime:i.startRequest.audio.packet_time,audioSampleRate:i.startRequest.audio.sample_rate,framesPerPacket:C});r=function(){n.sendRtcp()},e=function(e){n.sendRtp(Ih.deSerialize(e))}}else o=`${i.prepareRequest.targetAddress}:${i.prepareRequest.audio.port}`;T={codecCopy:!l.audio&&w?"opus":"transcode",encoderArguments:d,ffmpegDestination:o,packetSize:400,rtcpPort:n,payloadType:s.audio.pt,ssrc:i.audiossrc,srtp:o?{crytoSuite:i.prepareRequest.audio.srtpCryptoSuite===$t.AES_CM_128_HMAC_SHA1_80?"AES_CM_128_HMAC_SHA1_80":"AES_CM_256_HMAC_SHA1_80",key:c}:void 0,firstPacket:r,onRtp:e}}else t.warn(e.name,"homekit requested unknown audio codec, audio will not be streamed.",s);if(await async function(e,t){t.videoReturnRtcpReady&&(e.log("Waiting for video RTCP packet before sending video."),await t.videoReturnRtcpReady,e.log("Received first video RTCP packet."))}(t,i),i.killed)return void t.log("session ended before streaming could start. bailing.");const _={maxPacketSize:o,sps:void 0,pps:void 0},D=hD(t,i.vconfig,i.videoReturn,i.videossrc,i.startRequest.video.pt,i.prepareRequest.video.port,i.prepareRequest.targetAddress,i.startRequest.video.rtcp_interval,_),R={video:{codecCopy:A?"h264":"transcode",encoderArguments:h,ffmpegDestination:`${m}:${g}`,packetSize:o,rtcpPort:v,payloadType:s.video.pt,ssrc:i.videossrc,srtp:{crytoSuite:i.prepareRequest.video.srtpCryptoSuite===$t.AES_CM_128_HMAC_SHA1_80?"AES_CM_128_HMAC_SHA1_80":"AES_CM_256_HMAC_SHA1_80",key:a},onMSection:e=>{const t=function(e){const t=e?.fmtp?.[0]?.parameters?.["sprop-parameter-sets"]?.split(",");if(2!==t?.length)return{sps:void 0,pps:void 0};const[r,n]=t;return{sps:Buffer.from(r,"base64"),pps:Buffer.from(n,"base64")}}(e);_.sps=t?.sps,_.pps=t?.pps},firstPacket(){D.sendRtcp()},onRtp(e){D.sendRtp(Ih.deSerialize(e))}}};T&&(R.audio=T);const N=await cD(t,n,R);i.killPromise.finally((()=>N.kill())),N.killPromise.finally((()=>i.kill()))}const{mediaManager:lD}=i(),fD=/^[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}$/,pD=/^::ffff:[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}\.[\d]{1,3}$/;async function yD(e,t){const r=P().createSocket(e),{port:n}=await du(r,0,t);return{socket:r,port:n}}function mD(e,r,n,s){const o=new Map,c=e.interfaces?.includes(t.ScryptedInterface.Intercom),u={handleSnapshotRequest:Yd(e,0,s,r),async prepareStream(e,t){const{sessionID:n}=e;let s;const c=Date.now(),u=new Promise((e=>{s=()=>{e();const t=o.get(n);t&&(o.delete(n),r.log(`streaming session killed, duration: ${Math.round((Date.now()-c)/1e3)}s`),t.killed=!0)}})),h="ipv6"===e.addressVersion?"udp6":"udp4";let d=await a();if(d){const e=Object.values(X().networkInterfaces()).flat().map((e=>e?.address));if(!e.find((e=>e===d))){const e="The provided Scrypted Server Address was not found in the list of network addresses and may be invalid and will not be used (DHCP assignment change?): "+d;r.error(e),i().log.a(e),d=void 0}}const{socket:l,port:f}=await yD(h,d),{socket:p,port:y}=await yD(h,d);l.setSendBufferSize(1048576),p.setSendBufferSize(1048576),u.finally((()=>{hu(l),hu(p)}));const m=_t.generateSynchronisationSource(),g=_t.generateSynchronisationSource(),v={aconfig:{keys:{localMasterKey:e.audio.srtp_key,localMasterSalt:e.audio.srtp_salt,remoteMasterKey:e.audio.srtp_key,remoteMasterSalt:e.audio.srtp_salt},profile:1},vconfig:{keys:{localMasterKey:e.video.srtp_key,localMasterSalt:e.video.srtp_salt,remoteMasterKey:e.video.srtp_key,remoteMasterSalt:e.video.srtp_salt},profile:1},kill:s,killPromise:u,killed:!1,prepareRequest:e,startRequest:null,videossrc:m,audiossrc:g,videoReturn:l,audioReturn:p,videoReturnRtcpReady:void 0};o.set(e.sessionID,v);const b={video:{srtp_key:e.video.srtp_key,srtp_salt:e.video.srtp_salt,port:f,ssrc:m},audio:{srtp_key:e.audio.srtp_key,srtp_salt:e.audio.srtp_salt,port:y,ssrc:g}};if(r.log("destination address",v.prepareRequest.targetAddress,v.prepareRequest.video.port,v.prepareRequest.audio.port),d)r.log("using address override",d),b.addressOverride=d;else{let t;if(r.warn("==========================================================================="),r.warn("The Scrypted Server Address is not set in the Scrypted settings."),r.warn("If there are issues streaming, set this address to your wired IP address manually."),r.warn("More information can be found in the HomeKit Plugin README."),r.warn("==========================================================================="),i().log.a("The Scrypted Server Address should be set in the Scrypted settings. More information can be found in the HomeKit Plugin README."),"ipv4"===e.addressVersion){const r=e.connection.localAddress;fD.exec(r)?t=r:pD.exec(r)&&(t=r.substring("::ffff:".length))}else"ipv6"!==e.addressVersion||fD.exec(e.connection.localAddress)||(t=e.connection.localAddress);if(t?.startsWith("169.")&&(t=void 0),t){const r=X().networkInterfaces()[e.connection.networkInterface];r&&r.find((e=>e.address===t))&&(b.addressOverride=t)}}r.log("source address",b.addressOverride,f,y),t(null,b)},async handleStreamRequest(a,u){if(r.log("handleStreamRequest",a),a.type===ur.STOP)return o.get(a.sessionID)?.kill(),void u();const h=o.get(a.sessionID);if(!h)return void u(new Error("unknown session"));if(u(),a.type===ur.RECONFIGURE)return void h.tryReconfigureBitrate?.("reconfigure",1e3*a.video.max_bit_rate);h.startRequest=a;let d=!1;try{for(const e of s.storageSettings.values.slowConnections)e.includes(h.prepareRequest.targetAddress)&&(d=!0)}catch(e){}d?r.log("Streaming request is coming from a device in the slow mode connection list. Medium resolution stream will be selected."):(d=s.storageSettings.values.slowConnections?.includes(h.prepareRequest.targetAddress),d&&r.log("Streaming request is coming from the active HomeHub. Medium resolution stream will be selected in case this is a remote wifi connection or a wireless HomeHub. Using Accessory Mode is recommended if not already in use."));const{destination:f,isLowBandwidth:p,isWatch:y}=await async function(e,t,r,n){const i=n.audio.packet_time>=60,s=n.video.width<=640;return{destination:s?"low-resolution":i?"remote":t?"medium-resolution":"local",isWatch:s,isLowBandwidth:i}}(0,d,0,a),m=!!s.storageSettings.values.lastKnownHomeHub,g=d||p||!m;g&&r.log("Will wait for initial RTCP packet.",{isHomeHub:d,isLowBandwidth:p,hasHomeHub:m});const v=g?Pu(1e3,(0,l.once)(h.videoReturn,"message")).catch((()=>{r.warn("Video RTCP Packet timed out. There may be a network (routing/firewall) issue preventing the Apple device sending UDP packets back to Scrypted.")})):void 0;h.videoReturnRtcpReady=v,r.log({isLowBandwidth:p,isWatch:y,destination:f}),h.startRequest=a;const b=new Id(h.vconfig);let E;const S=()=>{clearTimeout(E),E=setTimeout((()=>{r.log("HomeKit Streaming RTCP timed out. Terminating Streaming."),h.kill()}),3e4)};h.killPromise.finally((()=>clearTimeout(E)));let A=0;const I=rh(n),w={destination:f,destinationId:h.prepareRequest.targetAddress,adaptive:!0,video:{codec:"h264",bitrate:1e3*a.video.max_bit_rate},audio:{codec:a.audio.codec===ar.OPUS?"opus":"pcm"},tool:I.video?"ffmpeg":"scrypted"},T=await e.getVideoStream(w),C=await lD.convertMediaObjectToJSON(T,t.ScryptedMimeTypes.FFmpegInput);let _;try{_=await i().mediaManager.convertMediaObject(T,t.ScryptedMimeTypes.MediaStreamFeedback)}catch(e){}h.mediaStreamOptions=C.mediaStreamOptions,h.tryReconfigureBitrate=(e,t)=>{_?_.reconfigureStream({video:{bitrate:t}}):r.log("Media Stream reconfiguration was requested. Upgrade to Scrypted NVR for adaptive bitrate support.")},h.videoReturn.on("message",(e=>{S();const t=b.decrypt(e);if(_)return void _.onRtcp(t);(e=>{e.reports[0]?.packetsLost&&e.reports[0].packetsLost!==A&&(r.log("packet loss",e.reports[0].packetsLost),A=e.reports[0].packetsLost)})(nd.deSerialize(t).find((e=>201===e.type)))})),S();try{await dD(e,r,n,C,h)}catch(e){return void r.error("streaming error",e)}if(c){let t,n,i=!1;h.audioReturn.once("message",(async s=>{try{const{clientPromise:s,url:o}=await uu(),a=o.replace("tcp","rtsp");let c=function(e,t,r="IP4",n="127.0.0.1",i=0){const s=e.codec===ar.OPUS,{sample_rate:o}=e;let a="F8F0212C00BC00",c=Buffer.from(a,"hex"),u=c[1];u&=225,u|=(o===cr.KHZ_8?11:o===cr.KHZ_24?6:8)<<1,c[1]=u,a=c.toString("hex").toUpperCase();const h=["v=0","o=- 0 0 IN "+r+" 127.0.0.1","s=HomeKit Audio Talkback","c=IN "+r+" "+n,"t=0 0","m=audio "+i+" RTP/AVP 110","b=AS:24",...s?["a=rtpmap:110 opus/24000/2","a=fmtp:101 minptime=10;useinbandfec=1"]:["a=rtpmap:110 MPEG4-GENERIC/16000/1","a=fmtp:110 profile-level-id=1;mode=AAC-hbr;sizelength=13;indexlength=3;indexdeltalength=3; config="+a]];return t&&h.push("a=crypto:1 AES_CM_128_HMAC_SHA1_80 inline:"+t.toString("base64")),h.join("\n")}(h.startRequest.audio);c=Od(c);const u=kd(c);n=u.msections[0].control;const d={url:a,inputArguments:["-acodec",h.startRequest.audio.codec===ar.OPUS?"libopus":"libfdk_aac","-i",a]},l=await lD.createFFmpegMediaObject(d,{sourceId:e.id});e.startIntercom(l).catch((e=>r.error("intercom failed to start",e)));const f=await s,p=()=>{f.removeAllListeners(),r.log("Stopping intercom."),e.stopIntercom(),f.destroy(),t=void 0,i=!1};f.on("close",p),h.killPromise.finally(p),t=new qd(f,c),await t.handlePlayback(),i=!0}catch(e){r.error("two way audio failed",e)}}));const s=new Td(h.aconfig);h.audioReturn.on("message",(e=>{if(!i)return;const r=s.decrypt(e);Ih.deSerialize(r).header.payloadType===h.startRequest.audio.pt&&t.sendTrack(n,r,!1)}))}}};return u}const{deviceManager:gD}=i();function vD(e,t,r){const n=gD.getMixinStorage(e.id,t.nativeId).getItem("resetAccessory")||"";return new Wr(e.name,M(n+e.id+(r?"-"+r:"")))}function bD(e,r){if(!e.interfaces.includes(t.ScryptedInterface.AirQualitySensor))return;const n=r.addService(xe.AirQualitySensor);return su(e,t.ScryptedInterface.AirQualitySensor,n,sn.AirQuality,(()=>function(e){switch(e){case t.AirQuality.Excellent:return sn.AirQuality.EXCELLENT;case t.AirQuality.Good:return sn.AirQuality.GOOD;case t.AirQuality.Fair:return sn.AirQuality.FAIR;case t.AirQuality.Inferior:return sn.AirQuality.INFERIOR;case t.AirQuality.Poor:return sn.AirQuality.POOR}return sn.AirQuality.UNKNOWN}(e.airQuality))),e.interfaces.includes(t.ScryptedInterface.PM10Sensor)&&su(e,t.ScryptedInterface.PM10Sensor,n,sn.PM10Density,(()=>e.pm10Density||0)),e.interfaces.includes(t.ScryptedInterface.PM25Sensor)&&su(e,t.ScryptedInterface.PM25Sensor,n,sn.PM2_5Density,(()=>e.pm25Density||0)),e.interfaces.includes(t.ScryptedInterface.VOCSensor)&&su(e,t.ScryptedInterface.VOCSensor,n,sn.VOCDensity,(()=>e.vocDensity||0)),e.interfaces.includes(t.ScryptedInterface.NOXSensor)&&su(e,t.ScryptedInterface.NOXSensor,n,sn.NitrogenDioxideDensity,(()=>e.noxDensity||0)),n}function ED(e,r){if(!e.interfaces.includes(t.ScryptedInterface.CO2Sensor))return;const n=r.addService(xe.CarbonDioxideSensor,e.name);return su(e,t.ScryptedInterface.CO2Sensor,n,sn.CarbonDioxideLevel,(()=>e.co2ppm||0)),su(e,t.ScryptedInterface.CO2Sensor,n,sn.CarbonDioxideDetected,(()=>(e.co2ppm||0)>5e3)),n}function SD(e,r){if(!e.interfaces.includes(t.ScryptedInterface.OnOff)&&!e.interfaces.includes(t.ScryptedInterface.Fan))return;const n=r.addService(xe.Fanv2,e.name);return e.interfaces.includes(t.ScryptedInterface.OnOff)&&(su(e,t.ScryptedInterface.OnOff,n,sn.Active,(()=>!!e.on)),n.getCharacteristic(sn.Active).on(rn.SET,((t,r)=>{r(),t?e.turnOn():e.turnOff()}))),void 0!==e.fan?.counterClockwise&&(su(e,t.ScryptedInterface.Fan,n,sn.RotationDirection,(()=>e.fan?.counterClockwise?sn.RotationDirection.COUNTER_CLOCKWISE:sn.RotationDirection.CLOCKWISE)),n.getCharacteristic(sn.RotationDirection).on(rn.SET,((t,r)=>{r(),e.setFan({counterClockwise:t===sn.RotationDirection.COUNTER_CLOCKWISE})}))),void 0!==e.fan?.swing&&(su(e,t.ScryptedInterface.Fan,n,sn.SwingMode,(()=>e.fan?.swing?sn.SwingMode.SWING_ENABLED:sn.SwingMode.SWING_DISABLED)),n.getCharacteristic(sn.SwingMode).on(rn.SET,((t,r)=>{r(),e.setFan({swing:t===sn.SwingMode.SWING_ENABLED})}))),void 0!==e.fan?.maxSpeed&&(su(e,t.ScryptedInterface.Fan,n,sn.RotationSpeed,(()=>{const t=e.fan?.speed;if(!t)return 0;const r=e.fan?.maxSpeed;if(!r)return 100;const n=t/r;return Math.abs(Math.round(100*n))})),n.getCharacteristic(sn.RotationSpeed).on(rn.SET,((t,r)=>{r();const n=e.fan?.maxSpeed,i=n?Math.round(t/100*n):1;e.setFan({speed:i})})),n.getCharacteristic(sn.RotationSpeed).setProps({minStep:100/e.fan?.maxSpeed})),void 0!==e.fan?.availableModes&&(su(e,t.ScryptedInterface.Fan,n,sn.TargetFanState,(()=>e.fan?.mode===t.FanMode.Manual?sn.TargetFanState.MANUAL:sn.TargetFanState.AUTO)),n.getCharacteristic(sn.TargetFanState).on(rn.SET,((r,n)=>{n(),e.setFan({mode:r===sn.TargetFanState.MANUAL?t.FanMode.Manual:t.FanMode.Auto})})),su(e,t.ScryptedInterface.Fan,n,sn.CurrentFanState,(()=>e.fan?.active?e.fan.speed?sn.CurrentFanState.BLOWING_AIR:sn.CurrentFanState.IDLE:sn.CurrentFanState.INACTIVE))),n}const{deviceManager:AD,systemManager:ID}=i();function wD(e){return e.interfaces.includes(t.ScryptedInterface.OnOff)}function TD(e,r,n){const i=vD(e,r),s=i.addService(n,e.name);return s.getCharacteristic(sn.On).on(rn.SET,((t,r)=>{r(),t?e.turnOn():e.turnOff()})),su(e,t.ScryptedInterface.OnOff,s,sn.On,(()=>!!e.on)),{accessory:i,service:s}}iu({type:t.ScryptedDeviceType.Camera,probe:e=>e.interfaces.includes(t.ScryptedInterface.VideoCamera),async getAccessory(e,r){const n=AD.getMixinConsole(e.id,void 0),i=AD.getMixinStorage(e.id,void 0),s=e.interfaces?.includes(t.ScryptedInterface.Intercom),o=[],a=[ar.OPUS];for(const e of a)for(const t of[cr.KHZ_8,cr.KHZ_16,cr.KHZ_24])o.push({type:e,samplerate:t,bitrate:0,audioChannels:1}),o.push({type:e,samplerate:t,bitrate:1,audioChannels:1});const c={video:{codec:{type:xt.H264,levels:[Lt.LEVEL3_1,Lt.LEVEL3_2,Lt.LEVEL4_0],profiles:[Mt.MAIN]},resolutions:[[3840,2160,30],[1920,1080,30],[1280,720,30],[320,240,15]]},audio:{codecs:o,twoWayAudio:s},supportedCryptoSuites:[$t.AES_CM_128_HMAC_SHA1_80,$t.NONE]};let u,h;const d=vD(e,r),l="true"===i.getItem("detectAudio"),f=e.interfaces.includes(t.ScryptedInterface.AudioSensor)&&l,p=i.getItem("linkedMotionSensor"),y="selectedRecordingConfiguration";if(p||e.interfaces.includes(t.ScryptedInterface.MotionSensor)||f){u={handleFragmentsRequests(t){const s=_r.parseSelectedConfiguration(i.getItem(y));return ch(t,e,s,n,r)}};const t=[],s=[];for(const e of[vr.KHZ_32])s.push(e);const o=[gr.AAC_LC];0;for(const e of o){const r={type:e,bitrateMode:0,samplerate:s,audioChannels:1};t.push(r)}h={motionService:!0,prebufferLength:4e3,eventTriggerOptions:1,mediaContainerConfigurations:[{type:0,fragmentLength:4e3}],video:{codec:{type:"true"===i.getItem("h265Support")?xt.H265:xt.H264,levels:[Lt.LEVEL3_1,Lt.LEVEL3_2,Lt.LEVEL4_0],profiles:[Mt.BASELINE,Mt.MAIN,Mt.HIGH]},resolutions:[[1280,720,30],[1920,1080,30]]},audio:{codecs:t}}}const m=mD(e,n,i,r),g=new _t({cameraStreamCount:8,delegate:m,streamingOptions:c,recording:{options:h,delegate:u}});if(d.configureController(g),g.motionService){const r=ID.getDeviceById(p)||e;if(!r)return;const n=f?()=>!!r.audioDetected||!!r.motionDetected:()=>!!r.motionDetected,{motionService:s}=g;su(r,t.ScryptedInterface.MotionSensor,s,sn.MotionDetected,(()=>n()),!0);const{recordingManagement:o}=g,a=(e,t)=>{const r=`characteristic-v2-${t.UUID}`;e.getCharacteristic(t).on(rn.GET,(e=>e(null,"true"===i.getItem(r)?1:0))).on(rn.SET,((e,t)=>{t(),i.setItem(r,(!!e).toString())}))};if(a(o.getService(),sn.Active),a(o.getService(),sn.RecordingAudioActive),a(g.cameraOperatingModeService,sn.EventSnapshotsActive),a(g.cameraOperatingModeService,sn.HomeKitCameraActive),a(g.cameraOperatingModeService,sn.PeriodicSnapshotsActive),e.interfaces.includes(t.ScryptedInterface.OnOff)){const r=g.cameraOperatingModeService.getCharacteristic(sn.CameraOperatingModeIndicator),n="true"===i.getItem("statusIndicator"),s=`characteristic-v2-${sn.CameraOperatingModeIndicator.UUID}`;su(e,t.ScryptedInterface.OnOff,g.cameraOperatingModeService,sn.CameraOperatingModeIndicator,(()=>n?e.on?1:0:"true"===i.getItem(s)?1:0)),r.on(rn.SET,((t,r)=>{if(r(),!n)return i.setItem(s,(!!t).toString());t?e.turnOn():e.turnOff()}))}else a(g.cameraOperatingModeService,sn.CameraOperatingModeIndicator);o.getService().getCharacteristic(sn.SelectedCameraRecordingConfiguration).on(rn.GET,(e=>{e(null,i.getItem(y)||"")})).on(rn.SET,((e,t)=>{i.setItem(y,e.toString()),t()}))}if(e.interfaces.includes(t.ScryptedInterface.ObjectDetector)){const r=i.getItem("objectDetectionContactSensors"),n=[];try{n.push(...JSON.parse(r))}catch(e){}for(const r of new Set(n)){const n=new Cc(`${e.name}: `+r,r);d.addService(n);let s,o=sn.OccupancyDetected.OCCUPANCY_NOT_DETECTED;const a=()=>{clearTimeout(s),s=setTimeout((()=>{o=sn.OccupancyDetected.OCCUPANCY_NOT_DETECTED,n.updateCharacteristic(sn.OccupancyDetected,o)}),1e3*(parseInt(i.getItem("objectDetectionContactSensorTimeout"))||VD))};su(e,t.ScryptedInterface.ObjectDetector,n,sn.OccupancyDetected,((e,t,n)=>{if(!e)return o;const i=n;if(!i.detections)return o;return i.detections.map((e=>e.className)).includes(r)&&(o=sn.OccupancyDetected.OCCUPANCY_DETECTED,a()),o}),!0)}}return d}}),iu({type:t.ScryptedDeviceType.Doorbell,probe:e=>e.interfaces.includes(t.ScryptedInterface.BinarySensor),getAccessory:async(e,r)=>{const n={interfaces:e.interfaces,type:e.type};n.type=t.ScryptedDeviceType.Camera;const s=nu[t.ScryptedInterface.Camera],o=s.probe(n)?await s.getAccessory(e,r):vD(e,r),a=o.addService(xe.Doorbell),c=HD({storage:i().deviceManager.getMixinStorage(e.id,r.nativeId),onDeviceEvent:void 0}).values.doorbellAutomationButton?new Vc(e.name,void 0):void 0;return c&&(c.getCharacteristic(sn.ProgrammableSwitchEvent).setProps({maxValue:sn.ProgrammableSwitchEvent.SINGLE_PRESS}),o.addService(c)),e.listen({event:t.ScryptedInterface.BinarySensor,watch:!1},(()=>{e.binaryState&&(a.updateCharacteristic(sn.ProgrammableSwitchEvent,sn.ProgrammableSwitchEvent.SINGLE_PRESS),c?.updateCharacteristic(sn.ProgrammableSwitchEvent,sn.ProgrammableSwitchEvent.SINGLE_PRESS))})),a.getCharacteristic(sn.ProgrammableSwitchEvent).on(rn.GET,(e=>e(null,null))),a.setPrimaryService(!0),o}}),iu({type:t.ScryptedDeviceType.Fan,probe:e=>!!e.interfaces.includes(t.ScryptedInterface.Fan),getAccessory:async(e,r)=>{const n=vD(e,r);if(SD(e,n).setPrimaryService(),e.interfaces.includes(t.ScryptedInterface.TemperatureSetting)&&e.interfaces.includes(t.ScryptedInterface.Thermometer)){const i=n.addService(xe.HeaterCooler),s=.1,o=10,a=32.222,c=-17.7778,u=71.1111;function h(e){switch(e){case t.ThermostatMode.Off:return sn.CurrentHeaterCoolerState.IDLE;case t.ThermostatMode.Cool:return sn.CurrentHeaterCoolerState.COOLING;case t.ThermostatMode.Heat:return sn.CurrentHeaterCoolerState.HEATING}}function d(e){switch(e){case t.ThermostatMode.Cool:return sn.TargetHeaterCoolerState.COOL;case t.ThermostatMode.Heat:return sn.TargetHeaterCoolerState.HEAT;case t.ThermostatMode.Auto:return sn.TargetHeaterCoolerState.AUTO}}function l(e){switch(e){case sn.TargetHeaterCoolerState.HEAT:return t.ThermostatMode.Heat;case sn.TargetHeaterCoolerState.COOL:return t.ThermostatMode.Cool;case sn.TargetHeaterCoolerState.AUTO:return t.ThermostatMode.Auto}}i.getCharacteristic(sn.CurrentTemperature).setProps({minStep:s,minValue:c,maxValue:u}),i.getCharacteristic(sn.CoolingThresholdTemperature).setProps({minStep:s,minValue:o,maxValue:a}),i.getCharacteristic(sn.HeatingThresholdTemperature).setProps({minStep:s,minValue:o,maxValue:a});let f=[];for(const b of e.thermostatAvailableModes){const E=d(b);E&&!f.includes(E)&&f.push(E)}f.sort();const p=f[0],y=f[f.length-1];i.getCharacteristic(sn.TargetHeaterCoolerState).setProps({maxValue:y,minValue:p,validValues:f});let m=[];for(const S of e.thermostatAvailableModes){const A=h(S);A&&!m.includes(A)&&m.push(A)}m.sort();const g=m[0],v=m[m.length-1];i.getCharacteristic(sn.CurrentHeaterCoolerState).setProps({maxValue:v,minValue:g,validValues:m}),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.Active,(()=>e.thermostatActiveMode!==t.ThermostatMode.Off)),i.getCharacteristic(sn.Active).on(rn.SET,((r,n)=>{n(),r?e.setThermostatMode(t.ThermostatMode.On):e.setThermostatMode(t.ThermostatMode.Off)})),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.CurrentHeaterCoolerState,(()=>h(e.thermostatActiveMode)??g)),i.getCharacteristic(sn.TargetHeaterCoolerState).on(rn.SET,((r,n)=>{n();const i=l(r);e.setThermostatMode(i??t.ThermostatMode.Off)})),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.TargetHeaterCoolerState,(()=>d(e.thermostatMode)??p)),i.getCharacteristic(sn.HeatingThresholdTemperature).on(rn.SET,((t,r)=>{r(),e.setThermostatSetpoint(t)})),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.HeatingThresholdTemperature,(()=>Math.max(e.thermostatSetpoint||0,10))),i.getCharacteristic(sn.CoolingThresholdTemperature).on(rn.SET,((t,r)=>{r(),e.setThermostatSetpoint(t)})),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.CoolingThresholdTemperature,(()=>Math.max(e.thermostatSetpoint||0,10))),su(e,t.ScryptedInterface.Thermometer,i,sn.CurrentTemperature,(()=>e.temperature||0)),su(e,t.ScryptedInterface.Thermometer,i,sn.TemperatureDisplayUnits,(()=>e.temperatureUnit===t.TemperatureUnit.F?sn.TemperatureDisplayUnits.FAHRENHEIT:sn.TemperatureDisplayUnits.CELSIUS)),i.getCharacteristic(sn.TemperatureDisplayUnits).on(rn.SET,((r,n)=>{n(),e.setTemperatureUnit(r===sn.TemperatureDisplayUnits.FAHRENHEIT?t.TemperatureUnit.F:t.TemperatureUnit.C)})),void 0!==e.fan?.swing&&(su(e,t.ScryptedInterface.Fan,i,sn.SwingMode,(()=>e.fan?.swing?sn.SwingMode.SWING_ENABLED:sn.SwingMode.SWING_DISABLED)),i.getCharacteristic(sn.SwingMode).on(rn.SET,((t,r)=>{r(),e.setFan({swing:t===sn.SwingMode.SWING_ENABLED})}))),void 0!==e.fan?.maxSpeed&&(su(e,t.ScryptedInterface.Fan,i,sn.RotationSpeed,(()=>{const t=e.fan?.speed;if(!t)return 0;const r=e.fan?.maxSpeed;if(!r)return 100;const n=t/r;return Math.abs(Math.round(100*n))})),i.getCharacteristic(sn.RotationSpeed).on(rn.SET,((t,r)=>{r();const n=e.fan?.maxSpeed,i=n?Math.round(t/100*n):1;e.setFan({speed:i})})))}else if(e.interfaces.includes(t.ScryptedInterface.Thermometer)){const I=n.addService(xe.TemperatureSensor);su(e,t.ScryptedInterface.Thermometer,I,sn.CurrentTemperature,(()=>e.temperature||0))}if(e.interfaces.includes(t.ScryptedInterface.HumiditySetting)&&e.interfaces.includes(t.ScryptedInterface.HumiditySensor)){const w=n.addService(xe.HumidifierDehumidifier);su(e,t.ScryptedInterface.HumiditySetting,w,sn.Active,(()=>!!e.humiditySetting?.mode&&e.humiditySetting.mode!==t.HumidityMode.Off)),w.getCharacteristic(sn.Active).on(rn.SET,((r,n)=>{n(),e.setHumidity({mode:r?t.HumidityMode.Auto:t.HumidityMode.Off})})),su(e,t.ScryptedInterface.HumiditySensor,w,sn.CurrentRelativeHumidity,(()=>e.humidity||0)),su(e,t.ScryptedInterface.HumiditySetting,w,sn.CurrentHumidifierDehumidifierState,(()=>e.humiditySetting?.activeMode?e.humiditySetting.activeMode===t.HumidityMode.Dehumidify?sn.CurrentHumidifierDehumidifierState.DEHUMIDIFYING:e.humiditySetting.activeMode===t.HumidityMode.Humidify?sn.CurrentHumidifierDehumidifierState.HUMIDIFYING:sn.CurrentHumidifierDehumidifierState.IDLE:sn.CurrentHumidifierDehumidifierState.INACTIVE)),su(e,t.ScryptedInterface.HumiditySetting,w,sn.TargetHumidifierDehumidifierState,(()=>e.humiditySetting?.mode&&e.humiditySetting?.mode!==t.HumidityMode.Auto?e.humiditySetting?.mode===t.HumidityMode.Dehumidify?sn.TargetHumidifierDehumidifierState.DEHUMIDIFIER:sn.TargetHumidifierDehumidifierState.HUMIDIFIER:sn.TargetHumidifierDehumidifierState.HUMIDIFIER_OR_DEHUMIDIFIER)),w.getCharacteristic(sn.TargetHumidifierDehumidifierState).on(rn.SET,((r,n)=>{n(),e.setHumidity({mode:r===sn.TargetHumidifierDehumidifierState.HUMIDIFIER?t.HumidityMode.Humidify:r===sn.TargetHumidifierDehumidifierState.DEHUMIDIFIER?t.HumidityMode.Dehumidify:t.HumidityMode.Auto})})),su(e,t.ScryptedInterface.HumiditySetting,w,sn.RelativeHumidityHumidifierThreshold,(()=>e.humiditySetting?.humidifierSetpoint||0)),w.getCharacteristic(sn.RelativeHumidityHumidifierThreshold).on(rn.SET,((t,r)=>{r(),e.setHumidity({humidifierSetpoint:t})})),su(e,t.ScryptedInterface.HumiditySetting,w,sn.RelativeHumidityDehumidifierThreshold,(()=>e.humiditySetting?.dehumidifierSetpoint||0)),w.getCharacteristic(sn.RelativeHumidityDehumidifierThreshold).on(rn.SET,((t,r)=>{r(),e.setHumidity({dehumidifierSetpoint:t})})),void 0!==e.fan?.swing&&(su(e,t.ScryptedInterface.Fan,w,sn.SwingMode,(()=>e.fan?.swing?sn.SwingMode.SWING_ENABLED:sn.SwingMode.SWING_DISABLED)),w.getCharacteristic(sn.SwingMode).on(rn.SET,((t,r)=>{r(),e.setFan({swing:t===sn.SwingMode.SWING_ENABLED})}))),void 0!==e.fan?.maxSpeed&&(su(e,t.ScryptedInterface.Fan,w,sn.RotationSpeed,(()=>{const t=e.fan?.speed;if(!t)return 0;const r=e.fan?.maxSpeed;if(!r)return 100;const n=t/r;return Math.abs(Math.round(100*n))})),w.getCharacteristic(sn.RotationSpeed).on(rn.SET,((t,r)=>{r();const n=e.fan?.maxSpeed,i=n?Math.round(t/100*n):1;e.setFan({speed:i})})))}else if(e.interfaces.includes(t.ScryptedInterface.HumiditySensor)){const T=n.addService(xe.HumiditySensor);su(e,t.ScryptedInterface.HumiditySensor,T,sn.CurrentRelativeHumidity,(()=>e.humidity||0))}return bD(e,n),ED(e,n),n}}),iu({type:t.ScryptedDeviceType.Garage,probe:e=>e.interfaces.includes(t.ScryptedInterface.Entry)&&e.interfaces.includes(t.ScryptedInterface.EntrySensor),getAccessory:async(e,r)=>{const n=vD(e,r),i=n.addService(xe.GarageDoorOpener,e.name);su(e,t.ScryptedInterface.EntrySensor,i,sn.CurrentDoorState,(()=>e.entryOpen?sn.CurrentDoorState.OPEN:sn.CurrentDoorState.CLOSED)),su(e,t.ScryptedInterface.EntrySensor,i,sn.TargetDoorState,(()=>e.entryOpen?sn.TargetDoorState.OPEN:sn.TargetDoorState.CLOSED));let s=e.entryOpen?sn.TargetDoorState.OPEN:sn.TargetDoorState.CLOSED;return i.getCharacteristic(sn.TargetDoorState).on(rn.SET,((t,r)=>{r(),t===sn.TargetDoorState.OPEN?(s=sn.TargetDoorState.OPEN,e.openEntry()):(s=sn.TargetDoorState.CLOSED,e.closeEntry())})),n}}),iu({type:t.ScryptedDeviceType.Irrigation,probe:e=>e.interfaces.includes(t.ScryptedInterface.StartStop),getAccessory:async(e,r)=>{const n=vD(e,r),i=n.addService(xe.Valve,e.name);return i.getCharacteristic(sn.Active).on(rn.SET,((t,r)=>{r(),t?e.start():e.stop()})),su(e,t.ScryptedInterface.StartStop,i,sn.Active,(()=>e.running?sn.Active.ACTIVE:sn.Active.INACTIVE)),su(e,t.ScryptedInterface.StartStop,i,sn.InUse,(()=>e.running?sn.InUse.IN_USE:sn.InUse.NOT_IN_USE)),i.updateCharacteristic(sn.RemainingDuration,1800),n}}),iu({type:t.ScryptedDeviceType.Light,probe:wD,getAccessory:async(e,r)=>{const{accessory:n,service:i}=TD(e,r,xe.Lightbulb);let s,o,a;e.interfaces.includes(t.ScryptedInterface.Brightness)&&(i.addCharacteristic(sn.Brightness).on(rn.SET,((t,r)=>{r(),e.setBrightness(t)})),su(e,t.ScryptedInterface.Brightness,i,sn.Brightness,(()=>Math.min(Math.max(e.brightness||0,0),100))));const c=()=>{clearTimeout(a),a=setTimeout((()=>e.setHsv(s,o/100,(e.brightness||0)/100)),100)};return e.interfaces.includes(t.ScryptedInterface.ColorSettingHsv)&&(i.addCharacteristic(sn.Hue).on(rn.SET,((e,t)=>{t(),s=e,c()})),i.addCharacteristic(sn.Saturation).on(rn.SET,((e,t)=>{t(),o=e,c()})),su(e,t.ScryptedInterface.ColorSettingHsv,i,sn.Hue,(()=>e.hsv?.h||0)),su(e,t.ScryptedInterface.ColorSettingHsv,i,sn.Saturation,(()=>100*(e.hsv?.s||0)))),e.interfaces.includes(t.ScryptedInterface.ColorSettingTemperature)&&(i.addCharacteristic(sn.ColorTemperature).on(rn.SET,((t,r)=>{r(),e.setColorTemperature(Math.round(1e6/t))})),su(e,t.ScryptedInterface.ColorSettingTemperature,i,sn.ColorTemperature,(()=>Math.round(1e6/e.colorTemperature)))),n}}),iu({type:t.ScryptedDeviceType.Lock,probe:e=>e.interfaces.includes(t.ScryptedInterface.Lock),getAccessory:async(e,r)=>{const n=vD(e,r),i=n.addService(xe.LockMechanism,e.name);function s(e){return e===t.LockState.Locked?sn.LockTargetState.SECURED:sn.LockTargetState.UNSECURED}let o=s(e.lockState);return i.getCharacteristic(sn.LockTargetState).on(rn.SET,((t,r)=>{if(o=t,r(),o===sn.LockTargetState.UNSECURED)e.unlock();else e.lock()})),su(e,t.ScryptedInterface.Lock,i,sn.LockTargetState,(()=>(o=s(e.lockState),o))),su(e,t.ScryptedInterface.Lock,i,sn.LockCurrentState,(()=>function(e){switch(e){case t.LockState.Locked:return sn.LockCurrentState.SECURED;case t.LockState.Jammed:return sn.LockCurrentState.JAMMED;default:return sn.LockCurrentState.UNSECURED}}(e.lockState))),n}});const{systemManager:CD}=i();iu({type:t.ScryptedDeviceType.Display,probe:e=>e.interfaces.includes(t.ScryptedInterface.MediaPlayer),getAccessory:async(e,r)=>{const n=vD(e,r);n.category=Kr.TELEVISION;const i=n.addService(xe.Television,"Television","Television");let s=0;const o=new Set;i.getCharacteristic(sn.Active).on(rn.SET,((t,r)=>{t!==sn.Active.ACTIVE&&e.stop(),r()}));let a=!1;su(e,t.ScryptedInterface.MediaPlayer,i,sn.Active,(()=>((async()=>{const r=await e.getMediaStatus();a=r&&r.mediaPlayerState!==t.MediaPlayerState.Idle,i.updateCharacteristic(sn.Active,a?sn.Active.ACTIVE:sn.Active.INACTIVE)})(),a?sn.Active.ACTIVE:sn.Active.INACTIVE))),i.getCharacteristic(sn.ActiveIdentifier).on(rn.SET,(async(t,r)=>{if(s=t,0===s)return r(),void e.stop();const n=s.toString();if(o.has(n))try{const t=CD.getDeviceById(n),i=await t.getVideoStream({destination:"local"});e.load(i,null),r()}catch(e){r(e)}else r(new Error("unknown ActiveIdentifier"))})).on(rn.GET,(async e=>{e(null,s)})),i.updateCharacteristic(sn.ConfiguredName,e.name),i.getCharacteristic(sn.RemoteKey).on(rn.SET,((e,t)=>{t()})),i.updateCharacteristic(sn.SleepDiscoveryMode,sn.SleepDiscoveryMode.ALWAYS_DISCOVERABLE);const c=n.addService(xe.TelevisionSpeaker);c.updateCharacteristic(sn.Active,sn.Active.ACTIVE),c.getCharacteristic(sn.Mute).on(rn.SET,((e,t)=>{t()})).on(rn.GET,(async e=>{e(null,!1)}));const u=n.addService(xe.InputSource,"idle","Idle");u.updateCharacteristic(sn.Identifier,0).updateCharacteristic(sn.ConfiguredName,"Idle").updateCharacteristic(sn.IsConfigured,sn.IsConfigured.CONFIGURED).updateCharacteristic(sn.InputSourceType,sn.InputSourceType.APPLICATION),i.addLinkedService(u);for(const e of Object.keys(CD.getSystemState())){const r=CD.getDeviceById(e);if(r.type!==t.ScryptedDeviceType.Camera)continue;o.add(r.id);const s=n.addService(xe.InputSource,r.name,`input-${r.id}`);s.updateCharacteristic(sn.Identifier,r.id).updateCharacteristic(sn.ConfiguredName,r.name).updateCharacteristic(sn.IsConfigured,sn.IsConfigured.CONFIGURED).updateCharacteristic(sn.InputSourceType,sn.InputSourceType.APPLICATION),i.addLinkedService(s)}return n}}),iu({type:t.ScryptedDeviceType.SecuritySystem,probe:e=>!!e.interfaces.includes(t.ScryptedInterface.SecuritySystem),getAccessory:async(e,r)=>{const n=vD(e,r),i=n.addService(xe.SecuritySystem,e.name);return i.setPrimaryService(),su(e,t.ScryptedInterface.SecuritySystem,i,sn.SecuritySystemCurrentState,(()=>function(e,r){if(r)return sn.SecuritySystemCurrentState.ALARM_TRIGGERED;switch(e){case t.SecuritySystemMode.AwayArmed:return sn.SecuritySystemCurrentState.AWAY_ARM;case t.SecuritySystemMode.HomeArmed:return sn.SecuritySystemCurrentState.STAY_ARM;case t.SecuritySystemMode.NightArmed:return sn.SecuritySystemCurrentState.NIGHT_ARM}return sn.SecuritySystemCurrentState.DISARMED}(e.securitySystemState?.mode,e.securitySystemState?.triggered))),su(e,t.ScryptedInterface.SecuritySystem,i,sn.SecuritySystemTargetState,(()=>function(e){switch(e){case t.SecuritySystemMode.AwayArmed:return sn.SecuritySystemTargetState.AWAY_ARM;case t.SecuritySystemMode.HomeArmed:return sn.SecuritySystemTargetState.STAY_ARM;case t.SecuritySystemMode.NightArmed:return sn.SecuritySystemTargetState.NIGHT_ARM}return sn.SecuritySystemTargetState.DISARM}(e.securitySystemState?.mode))),i.getCharacteristic(sn.SecuritySystemTargetState).setProps({validValues:function(e){let r=[sn.SecuritySystemTargetState.DISARM];return e?(e.includes(t.SecuritySystemMode.HomeArmed)&&r.push(sn.SecuritySystemTargetState.STAY_ARM),e.includes(t.SecuritySystemMode.AwayArmed)&&r.push(sn.SecuritySystemTargetState.AWAY_ARM),e.includes(t.SecuritySystemMode.NightArmed)&&r.push(sn.SecuritySystemTargetState.NIGHT_ARM),r):r}(e.securitySystemState?.supportedModes)}).on(rn.SET,((r,n)=>{n();const i=function(e){switch(e){case sn.SecuritySystemTargetState.STAY_ARM:return t.SecuritySystemMode.HomeArmed;case sn.SecuritySystemTargetState.AWAY_ARM:return t.SecuritySystemMode.AwayArmed;case sn.SecuritySystemTargetState.NIGHT_ARM:return t.SecuritySystemMode.NightArmed}return t.SecuritySystemMode.Disarmed}(r);i===t.SecuritySystemMode.Disarmed?e.disarmSecuritySystem():e.armSecuritySystem(i)})),su(e,t.ScryptedInterface.SecuritySystem,i,sn.SecuritySystemAlarmType,(()=>!!e.securitySystemState?.triggered)),n}});const _D=[t.ScryptedInterface.Thermometer,t.ScryptedInterface.BinarySensor,t.ScryptedInterface.OccupancySensor,t.ScryptedInterface.AmbientLightSensor,t.ScryptedInterface.AudioSensor,t.ScryptedInterface.MotionSensor,t.ScryptedInterface.Thermometer,t.ScryptedInterface.HumiditySensor,t.ScryptedInterface.FloodSensor,t.ScryptedInterface.AirQualitySensor,t.ScryptedInterface.PM10Sensor,t.ScryptedInterface.PM25Sensor,t.ScryptedInterface.VOCSensor,t.ScryptedInterface.NOXSensor,t.ScryptedInterface.EntrySensor,t.ScryptedInterface.CO2Sensor];iu({type:t.ScryptedDeviceType.Sensor,probe(e){for(const t of e.interfaces)if(_D.includes(t))return!0;return!1},getAccessory:async(e,r)=>{const n=vD(e,r);if(e.interfaces.includes(t.ScryptedInterface.EntrySensor)){const r=n.addService(xe.ContactSensor,e.name);su(e,t.ScryptedInterface.EntrySensor,r,sn.ContactSensorState,(()=>!!e.entryOpen))}else if(e.interfaces.includes(t.ScryptedInterface.BinarySensor)){const r=n.addService(xe.ContactSensor,e.name);su(e,t.ScryptedInterface.BinarySensor,r,sn.ContactSensorState,(()=>!!e.binaryState))}if(e.interfaces.includes(t.ScryptedInterface.OccupancySensor)){const r=n.addService(xe.OccupancySensor,e.name);su(e,t.ScryptedInterface.OccupancySensor,r,sn.OccupancyDetected,(()=>!!e.occupied))}if(e.interfaces.includes(t.ScryptedInterface.AmbientLightSensor)){const r=n.addService(xe.LightSensor,e.name);su(e,t.ScryptedInterface.AmbientLightSensor,r,sn.CurrentAmbientLightLevel,(()=>e.ambientLight||0))}if(e.interfaces.includes(t.ScryptedInterface.AudioSensor)){const r=n.addService(xe.ContactSensor,e.name+" Alarm Sound","AudioSensor");su(e,t.ScryptedInterface.AudioSensor,r,sn.ContactSensorState,(()=>!!e.audioDetected))}if(e.interfaces.includes(t.ScryptedInterface.MotionSensor)){const r=n.addService(xe.MotionSensor,e.name);su(e,t.ScryptedInterface.MotionSensor,r,sn.MotionDetected,(()=>!!e.motionDetected),!0)}if(e.interfaces.includes(t.ScryptedInterface.Thermometer)){const r=n.addService(xe.TemperatureSensor,e.name);su(e,t.ScryptedInterface.Thermometer,r,sn.CurrentTemperature,(()=>e.temperature||0))}if(e.interfaces.includes(t.ScryptedInterface.HumiditySensor)){const r=n.addService(xe.HumiditySensor,e.name);su(e,t.ScryptedInterface.HumiditySensor,r,sn.CurrentRelativeHumidity,(()=>e.humidity||0))}if(e.interfaces.includes(t.ScryptedInterface.FloodSensor)){const r=n.addService(xe.LeakSensor,e.name);su(e,t.ScryptedInterface.FloodSensor,r,sn.LeakDetected,(()=>!!e.flooded))}if(e.interfaces.includes(t.ScryptedInterface.AirQualitySensor)){const r=n.addService(xe.AirQualitySensor,e.name);su(e,t.ScryptedInterface.AirQualitySensor,r,sn.AirQuality,(()=>function(e){switch(e){case t.AirQuality.Excellent:return sn.AirQuality.EXCELLENT;case t.AirQuality.Good:return sn.AirQuality.GOOD;case t.AirQuality.Fair:return sn.AirQuality.FAIR;case t.AirQuality.Inferior:return sn.AirQuality.INFERIOR;case t.AirQuality.Poor:return sn.AirQuality.POOR}return sn.AirQuality.UNKNOWN}(e.airQuality))),e.interfaces.includes(t.ScryptedInterface.PM10Sensor)&&su(e,t.ScryptedInterface.PM10Sensor,r,sn.PM10Density,(()=>e.pm10Density||0)),e.interfaces.includes(t.ScryptedInterface.PM25Sensor)&&su(e,t.ScryptedInterface.PM25Sensor,r,sn.PM2_5Density,(()=>e.pm25Density||0)),e.interfaces.includes(t.ScryptedInterface.VOCSensor)&&su(e,t.ScryptedInterface.VOCSensor,r,sn.VOCDensity,(()=>e.vocDensity||0)),e.interfaces.includes(t.ScryptedInterface.NOXSensor)&&su(e,t.ScryptedInterface.NOXSensor,r,sn.NitrogenDioxideDensity,(()=>e.noxDensity||0))}if(e.interfaces.includes(t.ScryptedInterface.CO2Sensor)){const r=n.addService(xe.CarbonDioxideSensor,e.name);su(e,t.ScryptedInterface.CO2Sensor,r,sn.CarbonDioxideLevel,(()=>e.co2ppm||0)),su(e,t.ScryptedInterface.CO2Sensor,r,sn.CarbonDioxideDetected,(()=>(e.co2ppm||0)>5e3))}const i=[xe.ContactSensor,xe.AirQualitySensor,xe.CarbonDioxideSensor,xe.CarbonMonoxideSensor,xe.HumiditySensor,xe.LeakSensor,xe.LightSensor,xe.MotionSensor,xe.OccupancySensor,xe.SecuritySystem,xe.SmokeSensor,xe.TemperatureSensor];if(e.interfaces.includes(t.ScryptedInterface.TamperSensor))for(const r of n.services)for(const n of i)r instanceof n&&su(e,t.ScryptedInterface.TamperSensor,r,sn.StatusTampered,(()=>e.tampered?1:0));return n}}),iu({type:t.ScryptedDeviceType.Switch,probe:wD,getAccessory:async(e,t)=>{const{accessory:r,service:n}=TD(e,t,xe.Switch);return r}}),iu({type:t.ScryptedDeviceType.Siren,probe:wD,getAccessory:async(e,t)=>{const{accessory:r,service:n}=TD(e,t,xe.Switch);return r}}),iu({type:t.ScryptedDeviceType.Thermostat,probe:e=>!(!e.interfaces.includes(t.ScryptedInterface.TemperatureSetting)||!e.interfaces.includes(t.ScryptedInterface.Thermometer)),getAccessory:async(e,r)=>{const n=vD(e,r),i=n.addService(xe.Thermostat,e.name);i.setPrimaryService();const s=.1,o=32.222;if(i.getCharacteristic(sn.CurrentTemperature).setProps({minStep:s,minValue:-17.7778,maxValue:71.1111}),i.getCharacteristic(sn.TargetTemperature).setProps({minStep:s,minValue:10,maxValue:o}),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.CurrentHeatingCoolingState,(()=>function(e){switch(e){case t.ThermostatMode.Off:return sn.CurrentHeatingCoolingState.OFF;case t.ThermostatMode.Cool:return sn.CurrentHeatingCoolingState.COOL;case t.ThermostatMode.Heat:return sn.CurrentHeatingCoolingState.HEAT}return sn.CurrentHeatingCoolingState.HEAT}(e.thermostatActiveMode))),i.getCharacteristic(sn.TargetHeatingCoolingState).on(rn.SET,((r,n)=>{n(),e.setThermostatMode(function(r){switch(r){case sn.TargetHeatingCoolingState.OFF:return t.ThermostatMode.Off;case sn.TargetHeatingCoolingState.HEAT:return t.ThermostatMode.Heat;case sn.TargetHeatingCoolingState.COOL:return t.ThermostatMode.Cool;case sn.TargetHeatingCoolingState.AUTO:return e.thermostatAvailableModes.includes(t.ThermostatMode.HeatCool)?t.ThermostatMode.HeatCool:t.ThermostatMode.Auto}}(r))})),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.TargetHeatingCoolingState,(()=>function(e){switch(e){case t.ThermostatMode.Off:return sn.TargetHeatingCoolingState.OFF;case t.ThermostatMode.Cool:return sn.TargetHeatingCoolingState.COOL;case t.ThermostatMode.Heat:return sn.TargetHeatingCoolingState.HEAT;case t.ThermostatMode.Auto:case t.ThermostatMode.HeatCool:return sn.TargetHeatingCoolingState.AUTO}return sn.TargetHeatingCoolingState.AUTO}(e.thermostatMode))),e.thermostatAvailableModes.includes(t.ThermostatMode.Auto)||e.thermostatAvailableModes.includes(t.ThermostatMode.HeatCool)||i.getCharacteristic(sn.TargetHeatingCoolingState).setProps({maxValue:sn.TargetHeatingCoolingState.COOL}),i.getCharacteristic(sn.TargetTemperature).on(rn.SET,((t,r)=>{r(),e.setThermostatSetpoint(t)})),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.TargetTemperature,(()=>Math.max(e.thermostatSetpoint||0,10))),e.thermostatAvailableModes.includes(t.ThermostatMode.HeatCool)&&(i.getCharacteristic(sn.CoolingThresholdTemperature).setProps({minStep:s,minValue:10,maxValue:o}),i.getCharacteristic(sn.HeatingThresholdTemperature).setProps({minStep:s,minValue:10,maxValue:o}),i.getCharacteristic(sn.HeatingThresholdTemperature).on(rn.SET,((t,r)=>{r(),e.setThermostatSetpointLow(t)})),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.HeatingThresholdTemperature,(()=>Math.max(e.thermostatSetpointLow||0,10))),i.getCharacteristic(sn.CoolingThresholdTemperature).on(rn.SET,((t,r)=>{r(),e.setThermostatSetpointHigh(t)})),su(e,t.ScryptedInterface.TemperatureSetting,i,sn.CoolingThresholdTemperature,(()=>Math.max(e.thermostatSetpointHigh||0,10)))),su(e,t.ScryptedInterface.Thermometer,i,sn.TemperatureDisplayUnits,(()=>e.temperatureUnit===t.TemperatureUnit.F?sn.TemperatureDisplayUnits.FAHRENHEIT:sn.TemperatureDisplayUnits.CELSIUS)),i.getCharacteristic(sn.TemperatureDisplayUnits).on(rn.SET,((r,n)=>{n(),e.setTemperatureUnit(r===sn.TemperatureDisplayUnits.FAHRENHEIT?t.TemperatureUnit.F:t.TemperatureUnit.C)})),su(e,t.ScryptedInterface.Thermometer,i,sn.CurrentTemperature,(()=>e.temperature||0)),e.interfaces.includes(t.ScryptedInterface.HumiditySensor)&&su(e,t.ScryptedInterface.HumiditySensor,i,sn.CurrentRelativeHumidity,(()=>e.humidity||0)),e.interfaces.includes(t.ScryptedInterface.HumiditySetting)&&e.interfaces.includes(t.ScryptedInterface.HumiditySensor)){const r=n.addService(xe.HumidifierDehumidifier);su(e,t.ScryptedInterface.HumiditySetting,r,sn.Active,(()=>!!e.humiditySetting?.mode&&e.humiditySetting.mode!==t.HumidityMode.Off)),r.getCharacteristic(sn.Active).on(rn.SET,((r,n)=>{n(),e.setHumidity({mode:r?t.HumidityMode.Auto:t.HumidityMode.Off})})),su(e,t.ScryptedInterface.HumiditySensor,r,sn.CurrentRelativeHumidity,(()=>e.humidity||0)),su(e,t.ScryptedInterface.HumiditySetting,r,sn.CurrentHumidifierDehumidifierState,(()=>e.humiditySetting?.activeMode?e.humiditySetting.activeMode===t.HumidityMode.Dehumidify?sn.CurrentHumidifierDehumidifierState.DEHUMIDIFYING:e.humiditySetting.activeMode===t.HumidityMode.Humidify?sn.CurrentHumidifierDehumidifierState.HUMIDIFYING:sn.CurrentHumidifierDehumidifierState.IDLE:sn.CurrentHumidifierDehumidifierState.INACTIVE)),su(e,t.ScryptedInterface.HumiditySetting,r,sn.TargetHumidifierDehumidifierState,(()=>e.humiditySetting?.mode&&e.humiditySetting?.mode!==t.HumidityMode.Auto?e.humiditySetting?.mode===t.HumidityMode.Dehumidify?sn.TargetHumidifierDehumidifierState.DEHUMIDIFIER:sn.TargetHumidifierDehumidifierState.HUMIDIFIER:sn.TargetHumidifierDehumidifierState.HUMIDIFIER_OR_DEHUMIDIFIER)),r.getCharacteristic(sn.TargetHumidifierDehumidifierState).on(rn.SET,((r,n)=>{n(),e.setHumidity({mode:r===sn.TargetHumidifierDehumidifierState.HUMIDIFIER?t.HumidityMode.Humidify:r===sn.TargetHumidifierDehumidifierState.DEHUMIDIFIER?t.HumidityMode.Dehumidify:t.HumidityMode.Auto})})),su(e,t.ScryptedInterface.HumiditySetting,r,sn.RelativeHumidityHumidifierThreshold,(()=>e.humiditySetting?.humidifierSetpoint||0)),r.getCharacteristic(sn.RelativeHumidityHumidifierThreshold).on(rn.SET,((t,r)=>{r(),e.setHumidity({humidifierSetpoint:t})})),su(e,t.ScryptedInterface.HumiditySetting,r,sn.RelativeHumidityDehumidifierThreshold,(()=>e.humiditySetting?.dehumidifierSetpoint||0)),r.getCharacteristic(sn.RelativeHumidityDehumidifierThreshold).on(rn.SET,((t,r)=>{r(),e.setHumidity({dehumidifierSetpoint:t})}))}return SD(e,n),bD(e,n),ED(e,n),n}}),iu({type:t.ScryptedDeviceType.Vacuum,probe:e=>e.interfaces.includes(t.ScryptedInterface.StartStop),getAccessory:async(e,r)=>{const n=vD(e,r),i=n.addService(xe.Outlet,e.name);return i.getCharacteristic(sn.On).on(rn.SET,((r,n)=>{n(),r?e.start():e.interfaces.includes(t.ScryptedInterface.Dock)?e.dock():e.stop()})),su(e,t.ScryptedInterface.StartStop,i,sn.On,(()=>!!e.running)),n}}),iu({type:t.ScryptedDeviceType.Outlet,probe:wD,getAccessory:async(e,t)=>{const{accessory:r,service:n}=TD(e,t,xe.Outlet);return r}}),iu({type:t.ScryptedDeviceType.Notifier,probe:wD,getAccessory:async(e,t)=>{const{accessory:r,service:n}=TD(e,t,xe.Switch);return r}}),iu({type:t.ScryptedDeviceType.WindowCovering,probe:e=>e.interfaces.includes(t.ScryptedInterface.Entry)&&e.interfaces.includes(t.ScryptedInterface.EntrySensor),getAccessory:async(e,r)=>{const n=vD(e,r),i=n.addService(xe.WindowCovering,e.name);su(e,t.ScryptedInterface.EntrySensor,i,sn.CurrentPosition,(()=>e.entryOpen?100:0)),su(e,t.ScryptedInterface.EntrySensor,i,sn.TargetPosition,(()=>e.entryOpen?100:0));let s=e.entryOpen?100:0;return i.getCharacteristic(sn.TargetPosition).setProps({minValue:0,maxValue:100,minStep:100}).on(rn.SET,((t,r)=>{r(),100===t?(s=100,e.openEntry()):(s=0,e.closeEntry())})),n}});class DD{initSync(){}getItem(e){const t=localStorage.getItem(e);if(t)return JSON.parse(t)}setItemSync(e,t){localStorage.setItem(e,JSON.stringify(t))}removeItemSync(e){localStorage.removeItem(e)}persistSync(){}}function RD(e){let t=e.getItem("uuid");return t||(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),e.setItem("uuid",t)),t}function ND(e){switch(e){case t.ScryptedDeviceType.Camera:return Kr.CAMERA;case t.ScryptedDeviceType.Doorbell:return Kr.VIDEO_DOORBELL;case t.ScryptedDeviceType.Fan:return Kr.FAN;case t.ScryptedDeviceType.Garage:return Kr.GARAGE_DOOR_OPENER;case t.ScryptedDeviceType.Irrigation:return Kr.SPRINKLER;case t.ScryptedDeviceType.Light:return Kr.LIGHTBULB;case t.ScryptedDeviceType.Lock:return Kr.DOOR_LOCK;case t.ScryptedDeviceType.Display:return Kr.TELEVISION;case t.ScryptedDeviceType.Outlet:return Kr.OUTLET;case t.ScryptedDeviceType.Sensor:return Kr.SENSOR;case t.ScryptedDeviceType.Switch:case t.ScryptedDeviceType.Siren:return Kr.SWITCH;case t.ScryptedDeviceType.Thermostat:return Kr.THERMOSTAT;case t.ScryptedDeviceType.Vacuum:return Kr.OUTLET}}function OD(){const e=[];for(let t=0;t<6;t++)e.push((0,f.randomBytes)(1).toString("hex"));return e.join(":")}function UD(){return Math.round(3e4+2e4*Math.random())}function PD(e,t,r){return{qrCode:{group:t,subgroup:r,title:"Pairing QR Code",type:"qrcode",readonly:!0,description:"Scan with your iOS camera to pair this Scrypted with HomeKit."},portOverride:{group:t,subgroup:r,title:"Bridge Port",persistedDefaultValue:UD(),description:"Optional: The TCP port used by the Scrypted bridge. If none is specified, a random port will be chosen.",type:"number"},pincode:{group:t,subgroup:r,title:"Manual Pairing Code",persistedDefaultValue:yu(),readonly:!0},mac:{group:t,subgroup:r,hide:!0,title:"Username Override",persistedDefaultValue:OD()},resetAccessory:{group:t,subgroup:r,title:"Reset Pairing",description:"Resetting the pairing will resync it to HomeKit as a new device. Bridged devices will automatically relink as a new device. Accessory devices must be manually removed from the Home app and re-paired. Enter RESET to reset the pairing.",placeholder:"RESET",mapPut:(t,r)=>{if("RESET"===r)return e.storage.removeItem("mac"),i().log.a(`You must reload the HomeKit plugin for the changes to ${e.name} to take effect.`),p().randomBytes(8).toString("hex");throw new Error("HomeKit Accessory Reset cancelled.")},mapGet:()=>""}}}function BD(e,t,r){t._server.httpServer.on("connection-opened",(t=>{t.on("authenticated",(()=>{e.log("HomeKit Connection",t.remoteAddress),r.add(t.remoteAddress)}))}))}const{log:xD}=i();class MD extends cu{storageSettings=new s.StorageSettings(this,{standalone:{subgroup:"Pairing",title:"Standalone Accessory Mode",description:"Advertise this to HomeKit as a standalone accessory rather than through the Scrypted HomeKit bridge. Enabling this option will remove it from the bridge. The accessory will then need to be re-paired to HomeKit. The pairing code will be available after the HomeKit plugin has been reloaded."+(this.interfaces.includes(t.ScryptedInterface.VideoCamera)?" Cameras running in accessory mode with Rebroadcast Prebuffers will send a notification when the stream becomes unavailable.":""),type:"boolean",onPut:(e,t)=>{void 0!==e&&this.alertReload()},persistedDefaultValue:!1},...PD(this,void 0,"Pairing")});constructor(e){super(e);const t=!this.storageSettings.values.standalone;this.storageSettings.settings.qrCode.hide=t,this.storageSettings.settings.pincode.hide=t,this.storageSettings.settings.resetAccessory.hide=t,this.storageSettings.settings.portOverride.hide=t}alertReload(){xD.a(`You must reload the HomeKit plugin for the changes to ${this.name} to take effect.`)}async getMixinSettings(){return this.storageSettings.getSettings()}async putMixinSetting(e,t){this.storageSettings.putSetting(e,t)}}const{systemManager:LD,deviceManager:kD,log:FD}=i(),VD=60;function HD(e){return new s.StorageSettings(e,{hasWarnedBridgedCamera:{description:"Setting to warn user that bridged cameras are bad.",type:"boolean",hide:!0},doorbellAutomationButton:{title:"Doorbell Automation Button",type:"boolean",description:"Add an unconfigured doorbell button to HomeKit that can be used to create automations.",hide:!0}})}class jD extends MD{cameraStorageSettings=HD(this);constructor(e){super(e),this.storageSettings.settings.standalone.persistedDefaultValue=!0,this.cameraStorageSettings.settings.doorbellAutomationButton.hide=this.type!==t.ScryptedDeviceType.Doorbell,this.cameraStorageSettings.values.hasWarnedBridgedCamera||this.storageSettings.values.standalone||(this.cameraStorageSettings.values.hasWarnedBridgedCamera=!0,FD.a(`${this.name} is paired in Bridge Mode. Using Accessory Mode is recommended for cameras for optimal performance.`))}async getReadmeMarkdown(){let e=this.mixinDeviceInterfaces.includes(t.ScryptedInterface.Readme)?await this.mixinDevice.getReadmeMarkdown()+"\n\n":"";this.storageSettings.values.standalone||(e+='\n## <span style="color:red">HomeKit Performance Warning</span>\n\nHomeKit Cameras should be paired to HomeKit in Accessory Mode for optimal performance. iOS 15.5+ will always route bridged camera video through the active HomeHub, which may result in severe performance degradation.\n\nEnable Standalone Accessory Mode in the HomeKit settings for this camera and reload the HomeKit plugin. This camera can then be individually paired with the Home app. The pairing QR code can be seen in this camera\'s console.\n\nMore details can be found [here](https://github.com/koush/scrypted/blob/main/plugins/homekit/notes/iOS-15.5.md).\n');const r=kD.getDeviceState(this.mixinProviderNativeId).id;return e+=`\n## HomeKit Codec Settings\n\nThe recommended codec settings for cameras in HomeKit can be viewed in the [HomeKit plugin](#/device/${r}).\n\n## HomeKit Troubleshooting\n\nThe latest troubleshooting guide for all known streaming or recording issues can be viewed in the [HomeKit plugin](#/device/${r}).`,e}async getMixinSettings(){const e=[],r=LD.getDeviceById(this.id);e.push({title:"Linked Motion Sensor",key:"linkedMotionSensor",type:"device",deviceFilter:'interfaces.includes("MotionSensor")',value:this.storage.getItem("linkedMotionSensor")||this.id,placeholder:this.interfaces.includes(t.ScryptedInterface.MotionSensor)?void 0:"None",description:"Set the motion sensor used to trigger HomeKit Secure Video recordings. Defaults to the device provided motion sensor when available."}),e.push({title:"RTP Sender",key:"rtpSender",description:"The RTP Sender used by Scrypted. FFMpeg is stable. Scrypted is experimental and much faster.",choices:["Default","Scrypted","FFmpeg"],value:this.storage.getItem("rtpSender")||"Default"});let n=rh(this.storage);if(e.push({title:"Debug Mode",key:"debugMode",description:"Force transcoding on this camera for streaming and recording. This setting can be used to diagnose errors with HomeKit functionality. Enable the Rebroadcast plugin for more robust transcoding options.",choices:["Transcode Video","Transcode Audio","Save Recordings"],multiple:!0,value:n.value}),this.interfaces.includes(t.ScryptedInterface.AudioSensor)&&e.push({title:"Audio Activity Detection",key:"detectAudio",type:"boolean",value:("true"===this.storage.getItem("detectAudio")).toString(),description:"Trigger HomeKit Secure Video recording on audio activity."}),this.interfaces.includes(t.ScryptedInterface.ObjectDetector))try{const t=(await r.getObjectTypes())?.classes?.filter((e=>"motion"!==e));if(t?.length){const r=[];try{r.push(...JSON.parse(this.storage.getItem("objectDetectionContactSensors")))}catch(e){}e.push({title:"Object Detection Sensors",type:"string",choices:t,multiple:!0,key:"objectDetectionContactSensors",description:"Create HomeKit occupancy sensors that detect specific people or objects.",value:r}),e.push({title:"Object Detection Timeout",type:"number",key:"objectDetectionContactSensorTimeout",description:"Duration in seconds the sensor will report as occupied, before resetting.",value:this.storage.getItem("objectDetectionContactSensorTimeout")||VD})}}catch(e){}return this.interfaces.includes(t.ScryptedInterface.OnOff)&&e.push({title:"Camera Status Indicator",description:"Allow HomeKit to control the camera status indicator light.",key:"statusIndicator",value:"true"===this.storage.getItem("statusIndicator"),type:"boolean"}),[...e,...await this.cameraStorageSettings.getSettings(),...await super.getMixinSettings()]}async putMixinSetting(e,r){if(this.storageSettings.settings[e])return super.putMixinSetting(e,r);"objectDetectionContactSensors"===e||"debugMode"===e?this.storage.setItem(e,JSON.stringify(r)):this.storage.setItem(e,r?.toString()),"detectAudio"!==e&&"linkedMotionSensor"!==e&&"objectDetectionContactSensors"!==e||super.alertReload(),kD.onMixinEvent(this.id,this,t.ScryptedInterface.Settings,void 0)}}function KD(e,t){const r=e.info,n=t.getService(xe.AccessoryInformation);r?.manufacturer&&n.updateCharacteristic(sn.Manufacturer,r.manufacturer),r?.model&&n.updateCharacteristic(sn.Model,r.model),r?.serialNumber&&n.updateCharacteristic(sn.SerialNumber,r.serialNumber),r?.firmware&&n.updateCharacteristic(sn.FirmwareRevision,r.firmware),r?.version&&n.updateCharacteristic(sn.HardwareRevision,r.version)}class qD extends Error{constructor(e){super(e),this.name="InvalidPathError",Object.setPrototypeOf(this,qD.prototype)}}class GD extends Error{constructor(e){super(e),this.name="NoMatchError",Object.setPrototypeOf(this,GD.prototype)}}function zD(e,t={platform:process.platform,release:(0,J.release)(),fsExistsSync:Bu.existsSync,pathNormalize:ku.normalize,pathSep:ku.sep,cpExecFile:gu.execFile}){function r(e,r,n,i=1){return new Promise(((s,o)=>{const[a,...c]=e;if(void 0===a)return Promise.reject(new Error("cmd must contain at least one item"));t.cpExecFile(a,c,((e,t)=>{e&&o(e);try{s(function(e,t,r,n){const i=e.trim().split("\n").slice(1).map((e=>e.trim().split(/\s+(?=[\d/])/))).filter(t);if(0===i.length)throw new GD;const s=i[0];return{diskPath:s[r.diskPath],free:parseInt(s[r.free],10)*n,size:parseInt(s[r.size],10)*n}}(t,r,n,i))}catch(e){o(e)}}))}))}return"win32"===t.platform?function(e){return":"!==e.charAt(1)?new Promise(((t,r)=>{r(new qD(`The following path is invalid (should be X:\\...): ${e}`))})):r((n=t.release,parseInt(n.split(".")[0],10)>6?["powershell","Get-CimInstance -ClassName Win32_LogicalDisk | Select-Object Caption, FreeSpace, Size"]:["wmic","logicaldisk","get","size,freespace,caption"]),(t=>{const r=t[0];return e.toUpperCase().startsWith(r.toUpperCase())}),{diskPath:0,free:1,size:2});var n}(e):function(e){if(!t.pathNormalize(e).startsWith(t.pathSep))return new Promise(((r,n)=>{n(new qD(`The following path is invalid (should start by ${t.pathSep}): ${e}`))}));const n=function(e,t){let r=e,n=t.fsExistsSync(r);for(;!n;)r=t.pathNormalize(r+"/.."),n=t.fsExistsSync(r);return r}(e,t);return r(["df","-Pk","--",n],(()=>!0),{diskPath:5,free:3,size:1},1024)}(e)}const{systemManager:$D}=i();class WD extends t.ScryptedDeviceBase{storageSettings=new s.StorageSettings(this,{reset:{title:"Remove All Clips",description:"Type REMOVE to confirm clearing all clips from Scrypted storage.",placeholder:"REMOVE",onPut(){!async function(){const e=await ju();await xu().promises.rm(e,{recursive:!0,force:!0})}()},mapPut(){}}});constructor(e){super(e),this.fromMimeType="x-scrypted-homekit/x-hksv",this.toMimeType=t.ScryptedMimeTypes.MediaObject,this.prune()}resetPruneInterval(){clearTimeout(this.pruneInterval),this.pruneInterval=setInterval((()=>{this.prune()}),36e5)}async getVideoClips(e){const t=await Ku(e);for(const e of t){const{id:t}=Gu(e.id);e.description=$D.getDeviceById(t)?.name}return t}getVideoClip(e){return async function(e){const{id:t,startTime:r}=Gu(e),{mp4Path:n}=await qu(t,r),i=`file:${n}`;return Vu.createMediaObjectFromUrl(i)}(e)}getVideoClipThumbnail(e){return async function(e){const{id:t,startTime:r}=Gu(e),{mp4Path:n,thumbnailPath:i}=await qu(t,r);let s;try{s=await xu().promises.readFile(i)}catch(e){}if(!s){const e={url:void 0,inputArguments:["-ss","00:00:04","-i",n]},t=await Vu.createFFmpegMediaObject(e);s=await Vu.convertMediaObjectToBuffer(t,"image/jpeg"),await xu().promises.writeFile(i,s)}const o=`file:${i}`;return Vu.createMediaObjectFromUrl(o)}(e)}async removeVideoClips(...e){if(!e.length){e=(await Ku(void 0,this.id)).map((e=>e.id))}for(const t of e)await zu(t);this.onDeviceEvent(t.ScryptedInterface.VideoClips,void 0)}async prune(){const e=await ju();let t=864e6;(await zD(e)).free<1e10&&(t=864e5,this.console.warn(`Low Disk space: ${e}`),this.console.warn("Pruning videos older than 1 day to recover space.")),async function(e,t){const r=await ju(),n=(await xu().promises.readdir(r)).filter((e=>e.endsWith(".json"))),i=Date.now(),s=i-e,o=i+864e5;let a=0,c=0,u=0;for(const e of n){const r=e.slice(0,-".json".length);let n=0;try{const{id:e,startTime:t}=Gu(r);try{const{mp4Path:r}=await qu(e,t);n+=(await xu().promises.stat(r)).size}catch(e){}if(t<s)throw new Error("Pruning old clip");if(!t)throw new Error("Pruning invalid start time");if(t>o)throw new Error("Pruning weird future clip");a++,u+=n}catch(e){c+=n,t.log("removing video clip",r),zu(r)}}t.log(`Removed Recordings: ${n.length-a}: ${c} bytes.`),t.log(`Retained Recordings: ${a}: ${u} bytes.`)}(t,this.console)}async getReadmeMarkdown(){return"# HomeKit Secure Video Local Copy\n\nThis extension will save your HomeKit Secure Video Clips for local review in Scrypted."}getSettings(){return this.storageSettings.getSettings()}putSetting(e,t){return this.storageSettings.putSetting(e,t)}}const{systemManager:YD,deviceManager:QD}=i();Nr.setStorage(new DD);class JD extends t.ScryptedDeviceBase{seenConnections=new Set;bridge=new ru("Scrypted",RD(this.storage));snapshotThrottles=new Map;standalones=new Map;cameraMixins=new Map;storageSettings=new s.StorageSettings(this,{...PD(this,void 0),portOverride:{group:"Network",title:"Server Port",persistedDefaultValue:UD(),description:"Optional: The TCP port used by the Scrypted Server. If none is specified, a random port will be chosen.",type:"number"},advertiserOverride:{group:"Network",title:"mDNS Advertiser",description:"Optional: Override the mDNS advertiser used to locate the Scrypted bridge",choices:["Default",Gr.CIAO,Gr.BONJOUR,Gr.AVAHI],defaultValue:"Default"},advertiserAddresses:{group:"Network",title:"mDNS Interfaces",description:"Optional: Change the address or interfaces that will advertise the HomeKit bridge and accessories.",placeholder:"192.168.2.111, en0, etc.",combobox:!0,choices:["Default","Server Address","All Addresses"],defaultValue:"Default"},slowConnections:{group:"Network",title:"Slow Mode Addresses",description:"The addressess of Home Hubs and iOS clients that will always be served remote/medium streams.",type:"string",multiple:!0,combobox:!0,onGet:async()=>({choices:[...this.seenConnections]})},lastKnownHomeHub:{hide:!0,description:"The last home hub to request a recording. Internally used to determine if a streaming request is coming from remote wifi."}});constructor(){super(),this.start(),(async()=>{await QD.onDevicesChanged({devices:[{name:"HomeKit Secure Video Debug Mode Clips",nativeId:Hu,type:t.ScryptedDeviceType.DataSource,interfaces:[t.ScryptedInterface.VideoClips,t.ScryptedInterface.Settings,t.ScryptedInterface.Readme]}]}),this.videoClips=new WD(Hu),this.videoClipsId=this.videoClips.id})()}async releaseDevice(e,t){}async getDevice(e){if(e===Hu)return this.videoClips;throw new Error("unknown device: "+e)}async getSettings(){return this.storageSettings.getSettings()}async putSetting(e,t){await this.storageSettings.putSetting(e,t),e===this.storageSettings.keys.portOverride&&this.log.a("Reload the HomeKit plugin to apply this change.")}getAdvertiser(){let e=this.storageSettings.values.advertiserOverride;switch(e){case Gr.BONJOUR:case Gr.AVAHI:case Gr.CIAO:break;default:e=Gr.CIAO}return e}async start(){let e;this.log.clearAlerts();try{e=JSON.parse(this.storage.getItem("defaultIncluded"))}catch(t){e={}}const r=await YD.getComponent("plugins"),n=new Set;for(const i of Object.keys(YD.getSystemState())){const o=YD.getDeviceById(i),a=nu[o.type];if(!a?.probe(o))continue;try{const t=(o.mixins||[]).slice();if(!t.includes(this.id)){if(4===e[o.id])continue;t.push(this.id),await r.setMixins(o.id,t),e[o.id]=4}}catch(e){console.error("error while checking device if syncable",e),this.log.a("Error while checking device if syncable. See Console.");continue}this.console.log("adding",o.name);const c=await a.getAccessory(o,this);if(c){n.add(i),ou(o,c),KD(o,c);const e=QD.getMixinStorage(o.id,this.nativeId),r=o.type===t.ScryptedDeviceType.Camera||o.type===t.ScryptedDeviceType.Doorbell?"false"!==e.getItem("standalone"):"true"===e.getItem("standalone");e.getItem("standalone")||e.setItem("standalone",r.toString());const a=ND(o.type);if(r&&a){this.standalones.set(o.id,c);const t=new s.StorageSettings({storage:e,onDeviceEvent:async()=>{}},PD({storage:e,get name(){return o.name}},void 0,"Pairing"));t.settings.pincode.persistedDefaultValue=yu();const r=QD.getMixinConsole(o.id,this.nativeId);let n=!1,i=!1;const u=async()=>{try{n=!0,r.log("Device is in accessory mode and is online. HomeKit services are being published."),await this.publishAccessory(c,t.values.mac,t.values.pincode,a,t.values.portOverride),i||(i=!0,t.values.qrCode=c.setupURI(),BD(r,c,this.seenConnections))}catch(e){r.error("There was an error publishing the standalone accessory",e)}};try{u()}catch(e){r.error("There was an error publishing the standalone accessory",e)}}else r&&this.console.warn("Could not find standalone category mapping for accessory",o.name,o.type),this.bridge.addBridgedAccessory(c)}}this.storage.setItem("defaultIncluded",JSON.stringify(e));const i=this.storageSettings.values.mac,a=this.bridge.getService(xe.AccessoryInformation);a.updateCharacteristic(sn.Manufacturer,"scrypted.app"),a.updateCharacteristic(sn.Model,"scrypted"),a.updateCharacteristic(sn.SerialNumber,i),a.updateCharacteristic(sn.FirmwareRevision,o);const c=await this.getAdvertiserInterfaceBind();this.console.log("mdns bind address",c);const u={username:i,port:this.storageSettings.values.portOverride,pincode:this.storageSettings.values.pincode,category:Kr.BRIDGE,addIdentifyingMaterial:!0,advertiser:this.getAdvertiser(),bind:c};this.bridge.publish(u,!0),this.storageSettings.values.qrCode=this.bridge.setupURI(),BD(this.console,this.bridge,this.seenConnections),YD.listen((async(e,r,i)=>{if(r.eventInterface!==t.ScryptedInterface.ScryptedDevice)return;if(r.property===t.ScryptedInterfaceProperty.id)return;const s=await this.canMixin(e.type,e.interfaces),o=e?.mixins?.includes(this.id),a=n.has(e?.id);return a&&!s?(this.console.log("restart event",e?.id,r.property,i),void this.log.a(`${e.name} can no longer be synced. Reload the HomeKit plugin to apply these changes.`)):!a&&o?(this.console.log("restart event",e?.id,r.property,i),this.log.a(`${e.name} was added. HomeKit plugin will reload momentarily.`),void QD.requestRestart()):void 0}))}async canMixin(e,r){if(!nu[e]?.probe({interfaces:r,type:e}))return null;const n=[t.ScryptedInterface.Settings,"mixin:@scrypted/homekit"];return!r.includes(t.ScryptedInterface.VideoCamera)||e!==t.ScryptedDeviceType.Doorbell&&e!==t.ScryptedDeviceType.Camera||n.push(t.ScryptedInterface.Readme),n}async getAdvertiserInterfaceBind(){let e=this.storageSettings.values.advertiserAddresses;return"All Addresses"===e?e=void 0:e&&"Default"!==e&&"Server Address"!==e||(e=await a()),e}async publishAccessory(e,t,r,n,i){const s=await this.getAdvertiserInterfaceBind();await e.publish({username:t,port:i,pincode:r,category:n,addIdentifyingMaterial:!1,advertiser:this.getAdvertiser(),bind:s})}async getMixin(e,r,n){const i={mixinProviderNativeId:this.nativeId,mixinDeviceInterfaces:r,group:"HomeKit",groupKey:"homekit",mixinDevice:e,mixinDeviceState:n};let s;var o,a;return o=n.type,a=r,o!==t.ScryptedDeviceType.Camera&&o!==t.ScryptedDeviceType.Doorbell||!a.includes(t.ScryptedInterface.VideoCamera)?s=new MD(i):(s=new jD(i),this.cameraMixins.set(s.id,s)),s.storageSettings.settings.pincode.persistedDefaultValue=yu(),s}async releaseMixin(e,t){const r=YD.getDeviceById(e);r.mixins?.includes(this.id)||(this.console.log("release mixin",e),this.log.a(`${r.name} was removed. The HomeKit plugin will reload momentarily.`),QD.requestRestart())}}const XD=JD})();var i=exports="undefined"==typeof exports?{}:exports;for(var s in n)i[s]=n[s];n.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();
//# sourceMappingURL=main.nodejs.js.map