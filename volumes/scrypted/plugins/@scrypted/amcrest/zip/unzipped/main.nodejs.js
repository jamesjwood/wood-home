(()=>{var e={5948:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseWWWAuthenticateHeader=function(e,t=c,{strict:r=!0}={strict:!0}){let o=null;if(t.some((t=>(0===e.indexOf(t.type+" ")||!r&&0===e.indexOf(t.type.toLowerCase()+" "))&&(o={type:t.type,data:t.parseWWWAuthenticateRest(e.substr(t.type.length+1))},!0))),!o)throw new n.default("E_UNKNOWN_AUTH_MECHANISM",e);return o},t.parseAuthorizationHeader=function(e,t=c,{strict:r=!0}={strict:!0}){let o=null;if(t.some((function(t){return(0===e.indexOf(t.type+" ")||!r&&0===e.indexOf(t.type.toLowerCase()+" "))&&(o={type:t.type,data:t.parseAuthorizationRest(e.substr(t.type.length+1))},!0)})),o)return o;throw new n.default("E_UNKNOWN_AUTH_MECHANISM",e)},t.buildWWWAuthenticateHeader=function(e,t){return`${e.type} ${e.buildWWWAuthenticateRest(t)}`},t.buildAuthorizationHeader=function(e,t){return`${e.type} ${e.buildAuthorizationRest(t)}`},Object.defineProperty(t,"BASIC",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"DIGEST",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"BEARER",{enumerable:!0,get:function(){return s.default}}),t.mechanisms=void 0;var n=a(r(1945)),o=a(r(6750)),i=a(r(3107)),s=a(r(736));function a(e){return e&&e.__esModule?e:{default:e}}const c=[o.default,i.default,s.default];t.mechanisms=c,o.default,i.default,s.default},6750:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=(n=r(1945))&&n.__esModule?n:{default:n},i=r(9358);const s=["realm"],a=s,c={type:"Basic",parseWWWAuthenticateRest:function(e){return(0,i.parseHTTPHeadersQuotedKeyValueSet)(e,a,s)},buildWWWAuthenticateRest:function(e){return(0,i.buildHTTPHeadersQuotedKeyValueSet)(e,a,s)},parseAuthorizationRest:function(e){if(!e)throw new o.default("E_EMPTY_AUTH");const{username:t,password:r}=c.decodeHash(e);return{hash:e,username:t,password:r}},buildAuthorizationRest:function({hash:e,username:t,password:r}){if(t&&r)return c.computeHash({username:t,password:r});if(!e)throw new o.default("E_NO_HASH");return e},computeHash:function({username:e,password:t}){return Buffer.from(e+":"+t).toString("base64")},decodeHash:function(e){const[t,...r]=Buffer.from(e,"base64").toString().split(":");return{username:t,password:r.join(":")}}};var u=c;t.default=u},736:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=(n=r(1945))&&n.__esModule?n:{default:n},i=r(9358);const s=["invalid_request","invalid_token","insufficient_scope"],a=["realm","scope","error","error_description"];var c={type:"Bearer",parseWWWAuthenticateRest:function(e){return(0,i.parseHTTPHeadersQuotedKeyValueSet)(e,a,[])},buildWWWAuthenticateRest:function(e){if(e.error&&-1===s.indexOf(e.error))throw new o.default("E_INVALID_ERROR",e.error,s);return(0,i.buildHTTPHeadersQuotedKeyValueSet)(e,a,[])},parseAuthorizationRest:function(e){if(!e)throw new o.default("E_EMPTY_AUTH");return{hash:e}},buildAuthorizationRest:function({hash:e}){if(!e)throw new o.default("E_NO_HASH");return e}};t.default=c},3107:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=r(9358),i=(n=r(6113))&&n.__esModule?n:{default:n};const s=["realm","nonce"],a=[...s,"domain","opaque","stale","algorithm","qop"],c=["username","realm","nonce","uri","response"],u=[...c,"algorithm","cnonce","opaque","qop","nc"];function d(e,t){const r=i.default.createHash(e);return r.update(t),r.digest("hex")}var p={type:"Digest",parseWWWAuthenticateRest:function(e){return(0,o.parseHTTPHeadersQuotedKeyValueSet)(e,a,s)},buildWWWAuthenticateRest:function(e){return(0,o.buildHTTPHeadersQuotedKeyValueSet)(e,a,s)},parseAuthorizationRest:function(e){return(0,o.parseHTTPHeadersQuotedKeyValueSet)(e,u,c)},buildAuthorizationRest:function(e){return(0,o.buildHTTPHeadersQuotedKeyValueSet)(e,u,c)},computeHash:function(e){const t=e.ha1||d(e.algorithm,[e.username,e.realm,e.password].join(":")),r=d(e.algorithm,[e.method,e.uri].join(":"));return d(e.algorithm,[t,e.nonce,e.nc,e.cnonce,e.qop,r].join(":"))}};t.default=p},9358:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseHTTPHeadersQuotedKeyValueSet=function(e,t,r=[]){const n=e.trim().match(i);if(!n)throw new o.default("E_MALFORMED_QUOTEDKEYVALUE",e);const a=n.map(((e,t)=>{const r=e.split("=");if(2!==r.length)throw new o.default("E_MALFORMED_QUOTEDKEYVALUE",t,e,r.length);return r})).reduce((function(e,[r,n],i){if(-1===t.indexOf(r))throw new o.default("E_UNAUTHORIZED_KEY",i,r);return e[r]=n.replace(/^"(.+(?="$))"$/,"$1"),e}),{});return s(r,a),a},t.buildHTTPHeadersQuotedKeyValueSet=function(e,t,r=[]){return s(r,e),t.reduce((function(t,r){return e[r]?t+(t?", ":"")+r+'="'+e[r]+'"':t}),"")};var n,o=(n=r(1945))&&n.__esModule?n:{default:n};const i=/\w+=(".*?"|[^",]+)(?=,|$)/g;function s(e,t){e.forEach((e=>{if(void 0===t[e])throw new o.default("E_REQUIRED_KEY",e)}))}},4988:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6113),o=r(7310),i=r(9669),s=r(2833);function a(e){return e.constructor===Array?e[0]:e}t.default=class{constructor({axios:e,password:t,username:r}){this.axios=e||i.default,this.count=0,this.password=t,this.username=r}async request(e){var t,r;try{return await this.axios.request(e)}catch(i){if(void 0===i.response||401!==i.response.status||!(null===(t=i.response.headers["www-authenticate"])||void 0===t?void 0:t.includes("nonce")))throw i;const c=i.response.headers["www-authenticate"],u=s.parse(c);++this.count;const d=("00000000"+this.count).slice(-8),p=n.randomBytes(24).toString("hex"),l=a(u.params.realm),h=a(u.params.nonce),f=n.createHash("md5").update(`${this.username}:${l}:${this.password}`).digest("hex"),m=o.parse(e.url).pathname,g=n.createHash("md5").update(`${null!==(r=e.method)&&void 0!==r?r:"GET"}:${m}`).digest("hex"),y=n.createHash("md5").update(`${f}:${h}:${d}:${p}:auth:${g}`).digest("hex"),v={username:this.username,realm:l,nonce:h,uri:m||"",qop:"auth",algorithm:"MD5",response:y,nc:d,cnonce:p},S=`Digest ${Object.entries(v).map((([e,t])=>{return`${e}=${t&&(r=t,`"${r.replace(/"/g,'\\"')}"`)}`;var r})).join(", ")}`;return e.headers?e.headers.authorization=S:e.headers={authorization:S},this.axios.request(e)}}}},8955:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(4442);function o(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=function(e){return e.reduce((function(e,t){var r=i(t,2),s=r[0],a=r[1],c=function(e){return function(t){return`${e}=${t&&!(0,n.isToken)(t)?(0,n.quote)(t):t}`}}(s);if(!(0,n.isToken)(s))throw new TypeError;return Array.isArray(a)?o(e).concat(o(a.map(c))):o(e).concat([c(a)])}),[])},a=function e(t,r){if(Array.isArray(t))return s(t);if("object"==typeof t){var n=t;return e(Object.keys(t).map((function(e){return[e,n[e]]})),r)}throw new TypeError};t.default=function(e,t,r){var i="string"==typeof e?{scheme:e,token:t,params:r}:e;if("object"!=typeof i)throw new TypeError;if(!(0,n.isScheme)(i.scheme))throw new TypeError("Invalid scheme.");return[i.scheme].concat(o(void 0!==i.token?[i.token]:[]),o(void 0!==i.params?a(i.params):[])).join(" ")}},2833:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"format",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return o.default}});var n=i(r(8955)),o=i(r(7787));function i(e){return e&&e.__esModule?e:{default:e}}},7787:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(4442),o=/((?:[a-zA-Z0-9._~+\/-]+=*(?:\s+|$))|[^\u0000-\u001F\u007F()<>@,;:\\"/?={}\[\]\u0020\u0009]+)(?:=([^\\"=\s,]+|"(?:[^"\\]|\\.)*"))?/g,i=function(e,t){var r='"'===t.charAt(0)?(0,n.unquote)(t):t.trim();return Array.isArray(e)?e.concat(r):"string"==typeof e?[e,r]:r};t.default=function(e){if("string"!=typeof e)throw new TypeError("Header value must be a string.");var t=e.indexOf(" "),r=e.substr(0,t);if(!(0,n.isScheme)(r))throw new TypeError(`Invalid scheme ${r}`);return function(e,t){for(var r=null,n={};;){var s=o.exec(t);if(null===s)break;s[2]?n[s[1]]=i(n[s[1]],s[2]):r=i(r,s[1])}return{scheme:e,params:n,token:r}}(r,e.substr(t))}},4442:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unquote=t.quote=t.isScheme=t.isToken=void 0;var r=/^[^\u0000-\u001F\u007F()<>@,;:\\"/?={}\[\]\u0020\u0009]+$/,n=function(e){return"string"==typeof e&&r.test(e)};t.isToken=n;var o=n;t.isScheme=o;t.quote=function(e){return`"${e.replace(/"/g,'\\"')}"`};t.unquote=function(e){return e.substr(1,e.length-2).replace(/\\"/g,'"')}},9669:(e,t,r)=>{e.exports=r(1609)},7970:(e,t,r)=>{"use strict";var n=r(4867),o=r(6026),i=r(4097),s=r(5327),a=r(3685),c=r(5687),u=r(938).http,d=r(938).https,p=r(7310),l=r(9796),h=r(8593),f=r(5061),m=r(481),g=/https:?/;function y(e,t,r){if(e.hostname=t.host,e.host=t.host,e.port=t.port,e.path=r,t.auth){var n=Buffer.from(t.auth.username+":"+t.auth.password,"utf8").toString("base64");e.headers["Proxy-Authorization"]="Basic "+n}e.beforeRedirect=function(e){e.headers.host=e.host,y(e,t,e.href)}}e.exports=function(e){return new Promise((function(t,r){var v=function(e){t(e)},S=function(e){r(e)},b=e.data,w=e.headers;if("User-Agent"in w||"user-agent"in w?w["User-Agent"]||w["user-agent"]||(delete w["User-Agent"],delete w["user-agent"]):w["User-Agent"]="axios/"+h.version,b&&!n.isStream(b)){if(Buffer.isBuffer(b));else if(n.isArrayBuffer(b))b=Buffer.from(new Uint8Array(b));else{if(!n.isString(b))return S(f("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));b=Buffer.from(b,"utf-8")}w["Content-Length"]=b.length}var _=void 0;e.auth&&(_=(e.auth.username||"")+":"+(e.auth.password||""));var P=i(e.baseURL,e.url),T=p.parse(P),O=T.protocol||"http:";if(!_&&T.auth){var E=T.auth.split(":");_=(E[0]||"")+":"+(E[1]||"")}_&&delete w.Authorization;var R=g.test(O),A=R?e.httpsAgent:e.httpAgent,C={path:s(T.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method.toUpperCase(),headers:w,agent:A,agents:{http:e.httpAgent,https:e.httpsAgent},auth:_};e.socketPath?C.socketPath=e.socketPath:(C.hostname=T.hostname,C.port=T.port);var x,I=e.proxy;if(!I&&!1!==I){var D=O.slice(0,-1)+"_proxy",M=process.env[D]||process.env[D.toUpperCase()];if(M){var j=p.parse(M),k=process.env.no_proxy||process.env.NO_PROXY,L=!0;if(k)L=!k.split(",").map((function(e){return e.trim()})).some((function(e){return!!e&&("*"===e||("."===e[0]&&T.hostname.substr(T.hostname.length-e.length)===e||T.hostname===e))}));if(L&&(I={host:j.hostname,port:j.port,protocol:j.protocol},j.auth)){var N=j.auth.split(":");I.auth={username:N[0],password:N[1]}}}}I&&(C.headers.host=T.hostname+(T.port?":"+T.port:""),y(C,I,O+"//"+T.hostname+(T.port?":"+T.port:"")+C.path));var B=R&&(!I||g.test(I.protocol));e.transport?x=e.transport:0===e.maxRedirects?x=B?c:a:(e.maxRedirects&&(C.maxRedirects=e.maxRedirects),x=B?d:u),e.maxBodyLength>-1&&(C.maxBodyLength=e.maxBodyLength);var U=x.request(C,(function(t){if(!U.aborted){var r=t,i=t.req||U;if(204!==t.statusCode&&"HEAD"!==i.method&&!1!==e.decompress)switch(t.headers["content-encoding"]){case"gzip":case"compress":case"deflate":r=r.pipe(l.createUnzip()),delete t.headers["content-encoding"]}var s={status:t.statusCode,statusText:t.statusMessage,headers:t.headers,config:e,request:i};if("stream"===e.responseType)s.data=r,o(v,S,s);else{var a=[],c=0;r.on("data",(function(t){a.push(t),c+=t.length,e.maxContentLength>-1&&c>e.maxContentLength&&(r.destroy(),S(f("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,i)))})),r.on("error",(function(t){U.aborted||S(m(t,e,null,i))})),r.on("end",(function(){var t=Buffer.concat(a);"arraybuffer"!==e.responseType&&(t=t.toString(e.responseEncoding),e.responseEncoding&&"utf8"!==e.responseEncoding||(t=n.stripBOM(t))),s.data=t,o(v,S,s)}))}}}));if(U.on("error",(function(t){U.aborted&&"ERR_FR_TOO_MANY_REDIRECTS"!==t.code||S(m(t,e,null,U))})),e.timeout){var H=parseInt(e.timeout,10);if(isNaN(H))return void S(f("error trying to parse `config.timeout` to int",e,"ERR_PARSE_TIMEOUT",U));U.setTimeout(H,(function(){U.abort(),S(f("timeout of "+H+"ms exceeded",e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",U))}))}e.cancelToken&&e.cancelToken.promise.then((function(e){U.aborted||(U.abort(),S(e))})),n.isStream(b)?b.on("error",(function(t){S(m(t,e,null,U))})).pipe(U):U.end(b)}))}},5448:(e,t,r)=>{"use strict";var n=r(4867),o=r(6026),i=r(4372),s=r(5327),a=r(4097),c=r(4109),u=r(7985),d=r(5061);e.exports=function(e){return new Promise((function(t,r){var p=e.data,l=e.headers,h=e.responseType;n.isFormData(p)&&delete l["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";l.Authorization="Basic "+btoa(m+":"+g)}var y=a(e.baseURL,e.url);function v(){if(f){var n="getAllResponseHeaders"in f?c(f.getAllResponseHeaders()):null,i={data:h&&"text"!==h&&"json"!==h?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};o(t,r,i),f=null}}if(f.open(e.method.toUpperCase(),s(y,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,"onloadend"in f?f.onloadend=v:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(v)},f.onabort=function(){f&&(r(d("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){r(d("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(d(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var S=(e.withCredentials||u(y))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;S&&(l[e.xsrfHeaderName]=S)}"setRequestHeader"in f&&n.forEach(l,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete l[t]:f.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),h&&"json"!==h&&(f.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),r(e),f=null)})),p||(p=null),f.send(p)}))}},1609:(e,t,r)=>{"use strict";var n=r(4867),o=r(1849),i=r(321),s=r(7185);function a(e){var t=new i(e),r=o(i.prototype.request,t);return n.extend(r,i.prototype,t),n.extend(r,t),r}var c=a(r(5655));c.Axios=i,c.create=function(e){return a(s(c.defaults,e))},c.Cancel=r(5263),c.CancelToken=r(4972),c.isCancel=r(6502),c.all=function(e){return Promise.all(e)},c.spread=r(8713),c.isAxiosError=r(6268),e.exports=c,e.exports.default=c},5263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:(e,t,r)=>{"use strict";var n=r(5263);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},6502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,r)=>{"use strict";var n=r(4867),o=r(5327),i=r(782),s=r(3572),a=r(7185),c=r(4875),u=c.validators;function d(e){this.defaults=e,this.interceptors={request:new i,response:new i}}d.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean,"1.0.0"),forcedJSONParsing:u.transitional(u.boolean,"1.0.0"),clarifyTimeoutError:u.transitional(u.boolean,"1.0.0")},!1);var r=[],n=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(n=n&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var o,i=[];if(this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)})),!n){var d=[s,void 0];for(Array.prototype.unshift.apply(d,r),d=d.concat(i),o=Promise.resolve(e);d.length;)o=o.then(d.shift(),d.shift());return o}for(var p=e;r.length;){var l=r.shift(),h=r.shift();try{p=l(p)}catch(e){h(e);break}}try{o=s(p)}catch(e){return Promise.reject(e)}for(;i.length;)o=o.then(i.shift(),i.shift());return o},d.prototype.getUri=function(e){return e=a(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){d.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){d.prototype[e]=function(t,r,n){return this.request(a(n||{},{method:e,url:t,data:r}))}})),e.exports=d},782:(e,t,r)=>{"use strict";var n=r(4867);function o(){this.handlers=[]}o.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},4097:(e,t,r)=>{"use strict";var n=r(1793),o=r(7303);e.exports=function(e,t){return e&&!n(t)?o(e,t):t}},5061:(e,t,r)=>{"use strict";var n=r(481);e.exports=function(e,t,r,o,i){var s=new Error(e);return n(s,t,r,o,i)}},3572:(e,t,r)=>{"use strict";var n=r(4867),o=r(8527),i=r(6502),s=r(5655);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=o.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return a(e),t.data=o.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(a(e),t&&t.response&&(t.response.data=o.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},7185:(e,t,r)=>{"use strict";var n=r(4867);e.exports=function(e,t){t=t||{};var r={},o=["url","method","data"],i=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function u(o){n.isUndefined(t[o])?n.isUndefined(e[o])||(r[o]=c(void 0,e[o])):r[o]=c(e[o],t[o])}n.forEach(o,(function(e){n.isUndefined(t[e])||(r[e]=c(void 0,t[e]))})),n.forEach(i,u),n.forEach(s,(function(o){n.isUndefined(t[o])?n.isUndefined(e[o])||(r[o]=c(void 0,e[o])):r[o]=c(void 0,t[o])})),n.forEach(a,(function(n){n in t?r[n]=c(e[n],t[n]):n in e&&(r[n]=c(void 0,e[n]))}));var d=o.concat(i).concat(s).concat(a),p=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return n.forEach(p,u),r}},6026:(e,t,r)=>{"use strict";var n=r(5061);e.exports=function(e,t,r){var o=r.config.validateStatus;r.status&&o&&!o(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},8527:(e,t,r)=>{"use strict";var n=r(4867),o=r(5655);e.exports=function(e,t,r){var i=this||o;return n.forEach(r,(function(r){e=r.call(i,e,t)})),e}},5655:(e,t,r)=>{"use strict";var n=r(4867),o=r(6016),i=r(481),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:("undefined"!=typeof XMLHttpRequest?c=r(5448):"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)&&(c=r(7970)),c),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,r){if(n.isString(e))try{return(t||JSON.parse)(e),n.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,r=t&&t.silentJSONParsing,o=t&&t.forcedJSONParsing,s=!r&&"json"===this.responseType;if(s||o&&n.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw i(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){u.headers[e]=n.merge(s)})),e.exports=u},1849:e=>{"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},5327:(e,t,r)=>{"use strict";var n=r(4867);function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(n.isURLSearchParams(t))i=t.toString();else{var s=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),s.push(o(t)+"="+o(e))})))})),i=s.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},7303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:(e,t,r)=>{"use strict";var n=r(4867);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,o,i,s){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(o)&&a.push("path="+o),n.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},6268:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},7985:(e,t,r)=>{"use strict";var n=r(4867);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=o(window.location.href),function(t){var r=n.isString(t)?o(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},6016:(e,t,r)=>{"use strict";var n=r(4867);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},4109:(e,t,r)=>{"use strict";var n=r(4867),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,s={};return e?(n.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),r=n.trim(e.substr(i+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([r]):s[t]?s[t]+", "+r:r}})),s):s}},8713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},4875:(e,t,r)=>{"use strict";var n=r(8593),o={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){o[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var i={},s=n.version.split(".");function a(e,t){for(var r=t?t.split("."):s,n=e.split("."),o=0;o<3;o++){if(r[o]>n[o])return!0;if(r[o]<n[o])return!1}return!1}o.transitional=function(e,t,r){var o=t&&a(t);function s(e,t){return"[Axios v"+n.version+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,a){if(!1===e)throw new Error(s(n," has been removed in "+t));return o&&!i[n]&&(i[n]=!0,console.warn(s(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),o=n.length;o-- >0;){var i=n[o],s=t[i];if(s){var a=e[i],c=void 0===a||s(a,i,e);if(!0!==c)throw new TypeError("option "+i+" must be "+c)}else if(!0!==r)throw Error("Unknown option "+i)}},validators:o}},4867:(e,t,r)=>{"use strict";var n=r(1849),o=Object.prototype.toString;function i(e){return"[object Array]"===o.call(e)}function s(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==o.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===o.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:s,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:u,isStream:function(e){return a(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:d,merge:function e(){var t={};function r(r,n){c(t[n])&&c(r)?t[n]=e(t[n],r):c(r)?t[n]=e({},r):i(r)?t[n]=r.slice():t[n]=r}for(var n=0,o=arguments.length;n<o;n++)d(arguments[n],r);return t},extend:function(e,t,r){return d(t,(function(t,o){e[o]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},2261:(e,t,r)=>{var n;e.exports=function(){if(!n){try{n=r(Object(function(){var e=new Error("Cannot find module 'debug'");throw e.code="MODULE_NOT_FOUND",e}()))("follow-redirects")}catch(e){}"function"!=typeof n&&(n=function(){})}n.apply(null,arguments)}},938:(e,t,r)=>{var n=r(7310),o=n.URL,i=r(3685),s=r(5687),a=r(2781).Writable,c=r(9491),u=r(2261),d=["abort","aborted","connect","error","socket","timeout"],p=Object.create(null);d.forEach((function(e){p[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}}));var l=w("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),h=w("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),f=w("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),m=w("ERR_STREAM_WRITE_AFTER_END","write after end");function g(e,t){a.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(e){r._processResponse(e)},this._performRequest()}function y(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach((function(i){var s=i+":",a=r[s]=e[i],d=t[i]=Object.create(a);Object.defineProperties(d,{request:{value:function(e,i,a){if("string"==typeof e){var d=e;try{e=S(new o(d))}catch(t){e=n.parse(d)}}else o&&e instanceof o?e=S(e):(a=i,i=e,e={protocol:s});return"function"==typeof i&&(a=i,i=null),(i=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,i)).nativeProtocols=r,c.equal(i.protocol,s,"protocol mismatch"),u("options",i),new g(i,a)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(e,t,r){var n=d.request(e,t,r);return n.end(),n},configurable:!0,enumerable:!0,writable:!0}})})),t}function v(){}function S(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return""!==e.port&&(t.port=Number(e.port)),t}function b(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return null==r?void 0:String(r).trim()}function w(e,t){function r(e){Error.captureStackTrace(this,this.constructor),e?(this.message=t+": "+e.message,this.cause=e):this.message=t}return r.prototype=new Error,r.prototype.constructor=r,r.prototype.name="Error ["+e+"]",r.prototype.code=e,r}function _(e){for(var t=0;t<d.length;t++)e.removeListener(d[t],p[d[t]]);e.on("error",v),e.abort()}g.prototype=Object.create(a.prototype),g.prototype.abort=function(){_(this._currentRequest),this.emit("abort")},g.prototype.write=function(e,t,r){if(this._ending)throw new m;if(!("string"==typeof e||"object"==typeof e&&"length"in e))throw new TypeError("data should be a string, Buffer or Uint8Array");"function"==typeof t&&(r=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new f),this.abort()):r&&r()},g.prototype.end=function(e,t,r){if("function"==typeof e?(r=e,e=t=null):"function"==typeof t&&(r=t,t=null),e){var n=this,o=this._currentRequest;this.write(e,t,(function(){n._ended=!0,o.end(null,null,r)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,r)},g.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},g.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},g.prototype.setTimeout=function(e,t){var r=this;function n(t){t.setTimeout(e),t.removeListener("timeout",t.destroy),t.addListener("timeout",t.destroy)}function o(t){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout((function(){r.emit("timeout"),i()}),e),n(t)}function i(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",i),r.removeListener("error",i),r.removeListener("response",i),t&&r.removeListener("timeout",t),r.socket||r._currentRequest.removeListener("socket",o)}return t&&this.on("timeout",t),this.socket?o(this.socket):this._currentRequest.once("socket",o),this.on("socket",n),this.on("abort",i),this.on("error",i),this.on("response",i),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){g.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(g.prototype,e,{get:function(){return this._currentRequest[e]}})})),g.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},g.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var r=e.substr(0,e.length-1);this._options.agent=this._options.agents[r]}var o=this._currentRequest=t.request(this._options,this._onNativeResponse);this._currentUrl=n.format(this._options),o._redirectable=this;for(var i=0;i<d.length;i++)o.on(d[i],p[d[i]]);if(this._isRedirect){var s=0,a=this,c=this._requestBodyBuffers;!function e(t){if(o===a._currentRequest)if(t)a.emit("error",t);else if(s<c.length){var r=c[s++];o.finished||o.write(r.data,r.encoding,e)}else a._ended&&o.end()}()}}else this.emit("error",new TypeError("Unsupported protocol "+e))},g.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r=e.headers.location;if(!r||!1===this._options.followRedirects||t<300||t>=400)return e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),void(this._requestBodyBuffers=[]);if(_(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects)this.emit("error",new h);else{((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],b(/^content-/i,this._options.headers));var o,i=b(/^host$/i,this._options.headers),s=n.parse(this._currentUrl),a=i||s.host,c=/^\w+:/.test(r)?this._currentUrl:n.format(Object.assign(s,{host:a}));try{o=n.resolve(c,r)}catch(e){return void this.emit("error",new l(e))}u("redirecting to",o),this._isRedirect=!0;var d=n.parse(o);if(Object.assign(this._options,d),(d.protocol!==s.protocol&&"https:"!==d.protocol||d.host!==a&&!function(e,t){const r=e.length-t.length-1;return r>0&&"."===e[r]&&e.endsWith(t)}(d.host,a))&&b(/^(?:authorization|cookie)$/i,this._options.headers),"function"==typeof this._options.beforeRedirect){var p={headers:e.headers};try{this._options.beforeRedirect.call(null,this._options,p)}catch(e){return void this.emit("error",e)}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(e){this.emit("error",new l(e))}}},e.exports=y({http:i,https:s}),e.exports.wrap=y},1765:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6113),o=r(7310),i=r(6613),s=r(7352);function a(e){return e.constructor===Array?e[0]:e}t.default=class{constructor({axios:e,password:t,username:r}){this.axios=e||i.default,this.count=0,this.password=t,this.username=r}async request(e){var t,r;try{return await this.axios.request(e)}catch(i){if(void 0===i.response||401!==i.response.status||!(null===(t=i.response.headers["www-authenticate"])||void 0===t?void 0:t.includes("nonce")))throw i;const c=i.response.headers["www-authenticate"],u=s.parse(c);++this.count;const d=("00000000"+this.count).slice(-8),p=n.randomBytes(24).toString("hex"),l=a(u.params.realm),h=a(u.params.nonce),f=n.createHash("md5").update(`${this.username}:${l}:${this.password}`).digest("hex"),m=o.parse(e.url).pathname,g=n.createHash("md5").update(`${null!==(r=e.method)&&void 0!==r?r:"GET"}:${m}`).digest("hex"),y=n.createHash("md5").update(`${f}:${h}:${d}:${p}:auth:${g}`).digest("hex"),v={username:this.username,realm:l,nonce:h,uri:m||"",qop:"auth",algorithm:"MD5",response:y,nc:d,cnonce:p},S=`Digest ${Object.entries(v).map((([e,t])=>{return`${e}=${t&&(r=t,`"${r.replace(/"/g,'\\"')}"`)}`;var r})).join(", ")}`;return e.headers?e.headers.authorization=S:e.headers={authorization:S},this.axios.request(e)}}}},5770:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(5163);function o(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==a.return||a.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var s=function(e){return e.reduce((function(e,t){var r=i(t,2),s=r[0],a=r[1],c=function(e){return function(t){return`${e}=${t&&!(0,n.isToken)(t)?(0,n.quote)(t):t}`}}(s);if(!(0,n.isToken)(s))throw new TypeError;return Array.isArray(a)?o(e).concat(o(a.map(c))):o(e).concat([c(a)])}),[])},a=function e(t,r){if(Array.isArray(t))return s(t);if("object"==typeof t){var n=t;return e(Object.keys(t).map((function(e){return[e,n[e]]})),r)}throw new TypeError};t.default=function(e,t,r){var i="string"==typeof e?{scheme:e,token:t,params:r}:e;if("object"!=typeof i)throw new TypeError;if(!(0,n.isScheme)(i.scheme))throw new TypeError("Invalid scheme.");return[i.scheme].concat(o(void 0!==i.token?[i.token]:[]),o(void 0!==i.params?a(i.params):[])).join(" ")}},7352:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"format",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return o.default}});var n=i(r(5770)),o=i(r(9714));function i(e){return e&&e.__esModule?e:{default:e}}},9714:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(5163),o=/((?:[a-zA-Z0-9._~+\/-]+=*(?:\s+|$))|[^\u0000-\u001F\u007F()<>@,;:\\"/?={}\[\]\u0020\u0009]+)(?:=([^\\"=\s,]+|"(?:[^"\\]|\\.)*"))?/g,i=function(e,t){var r='"'===t.charAt(0)?(0,n.unquote)(t):t.trim();return Array.isArray(e)?e.concat(r):"string"==typeof e?[e,r]:r};t.default=function(e){if("string"!=typeof e)throw new TypeError("Header value must be a string.");var t=e.indexOf(" "),r=e.substr(0,t);if(!(0,n.isScheme)(r))throw new TypeError(`Invalid scheme ${r}`);return function(e,t){for(var r=null,n={};;){var s=o.exec(t);if(null===s)break;s[2]?n[s[1]]=i(n[s[1]],s[2]):r=i(r,s[1])}return{scheme:e,params:n,token:r}}(r,e.substr(t))}},5163:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unquote=t.quote=t.isScheme=t.isToken=void 0;var r=/^[^\u0000-\u001F\u007F()<>@,;:\\"/?={}\[\]\u0020\u0009]+$/,n=function(e){return"string"==typeof e&&r.test(e)};t.isToken=n;var o=n;t.isScheme=o;t.quote=function(e){return`"${e.replace(/"/g,'\\"')}"`};t.unquote=function(e){return e.substr(1,e.length-2).replace(/\\"/g,'"')}},6613:(e,t,r)=>{e.exports=r(1732)},3501:(e,t,r)=>{"use strict";var n=r(6106),o=r(7223),i=r(3591),s=r(8025),a=r(3685),c=r(5687),u=r(3824).http,d=r(3824).https,p=r(7310),l=r(9796),h=r(532),f=r(2384),m=r(9847),g=/https:?/;function y(e,t,r){if(e.hostname=t.host,e.host=t.host,e.port=t.port,e.path=r,t.auth){var n=Buffer.from(t.auth.username+":"+t.auth.password,"utf8").toString("base64");e.headers["Proxy-Authorization"]="Basic "+n}e.beforeRedirect=function(e){e.headers.host=e.host,y(e,t,e.href)}}e.exports=function(e){return new Promise((function(t,r){var v=function(e){t(e)},S=function(e){r(e)},b=e.data,w=e.headers;if("User-Agent"in w||"user-agent"in w?w["User-Agent"]||w["user-agent"]||(delete w["User-Agent"],delete w["user-agent"]):w["User-Agent"]="axios/"+h.version,b&&!n.isStream(b)){if(Buffer.isBuffer(b));else if(n.isArrayBuffer(b))b=Buffer.from(new Uint8Array(b));else{if(!n.isString(b))return S(f("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));b=Buffer.from(b,"utf-8")}w["Content-Length"]=b.length}var _=void 0;e.auth&&(_=(e.auth.username||"")+":"+(e.auth.password||""));var P=i(e.baseURL,e.url),T=p.parse(P),O=T.protocol||"http:";if(!_&&T.auth){var E=T.auth.split(":");_=(E[0]||"")+":"+(E[1]||"")}_&&delete w.Authorization;var R=g.test(O),A=R?e.httpsAgent:e.httpAgent,C={path:s(T.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method.toUpperCase(),headers:w,agent:A,agents:{http:e.httpAgent,https:e.httpsAgent},auth:_};e.socketPath?C.socketPath=e.socketPath:(C.hostname=T.hostname,C.port=T.port);var x,I=e.proxy;if(!I&&!1!==I){var D=O.slice(0,-1)+"_proxy",M=process.env[D]||process.env[D.toUpperCase()];if(M){var j=p.parse(M),k=process.env.no_proxy||process.env.NO_PROXY,L=!0;if(k)L=!k.split(",").map((function(e){return e.trim()})).some((function(e){return!!e&&("*"===e||("."===e[0]&&T.hostname.substr(T.hostname.length-e.length)===e||T.hostname===e))}));if(L&&(I={host:j.hostname,port:j.port,protocol:j.protocol},j.auth)){var N=j.auth.split(":");I.auth={username:N[0],password:N[1]}}}}I&&(C.headers.host=T.hostname+(T.port?":"+T.port:""),y(C,I,O+"//"+T.hostname+(T.port?":"+T.port:"")+C.path));var B=R&&(!I||g.test(I.protocol));e.transport?x=e.transport:0===e.maxRedirects?x=B?c:a:(e.maxRedirects&&(C.maxRedirects=e.maxRedirects),x=B?d:u),e.maxBodyLength>-1&&(C.maxBodyLength=e.maxBodyLength);var U=x.request(C,(function(t){if(!U.aborted){var r=t,i=t.req||U;if(204!==t.statusCode&&"HEAD"!==i.method&&!1!==e.decompress)switch(t.headers["content-encoding"]){case"gzip":case"compress":case"deflate":r=r.pipe(l.createUnzip()),delete t.headers["content-encoding"]}var s={status:t.statusCode,statusText:t.statusMessage,headers:t.headers,config:e,request:i};if("stream"===e.responseType)s.data=r,o(v,S,s);else{var a=[],c=0;r.on("data",(function(t){a.push(t),c+=t.length,e.maxContentLength>-1&&c>e.maxContentLength&&(r.destroy(),S(f("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,i)))})),r.on("error",(function(t){U.aborted||S(m(t,e,null,i))})),r.on("end",(function(){var t=Buffer.concat(a);"arraybuffer"!==e.responseType&&(t=t.toString(e.responseEncoding),e.responseEncoding&&"utf8"!==e.responseEncoding||(t=n.stripBOM(t))),s.data=t,o(v,S,s)}))}}}));if(U.on("error",(function(t){U.aborted&&"ERR_FR_TOO_MANY_REDIRECTS"!==t.code||S(m(t,e,null,U))})),e.timeout){var H=parseInt(e.timeout,10);if(isNaN(H))return void S(f("error trying to parse `config.timeout` to int",e,"ERR_PARSE_TIMEOUT",U));U.setTimeout(H,(function(){U.abort(),S(f("timeout of "+H+"ms exceeded",e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",U))}))}e.cancelToken&&e.cancelToken.promise.then((function(e){U.aborted||(U.abort(),S(e))})),n.isStream(b)?b.on("error",(function(t){S(m(t,e,null,U))})).pipe(U):U.end(b)}))}},663:(e,t,r)=>{"use strict";var n=r(6106),o=r(7223),i=r(4674),s=r(8025),a=r(3591),c=r(6492),u=r(2523),d=r(2384);e.exports=function(e){return new Promise((function(t,r){var p=e.data,l=e.headers,h=e.responseType;n.isFormData(p)&&delete l["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var m=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";l.Authorization="Basic "+btoa(m+":"+g)}var y=a(e.baseURL,e.url);function v(){if(f){var n="getAllResponseHeaders"in f?c(f.getAllResponseHeaders()):null,i={data:h&&"text"!==h&&"json"!==h?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};o(t,r,i),f=null}}if(f.open(e.method.toUpperCase(),s(y,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,"onloadend"in f?f.onloadend=v:f.onreadystatechange=function(){f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))&&setTimeout(v)},f.onabort=function(){f&&(r(d("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){r(d("Network Error",e,null,f)),f=null},f.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(d(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",f)),f=null},n.isStandardBrowserEnv()){var S=(e.withCredentials||u(y))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;S&&(l[e.xsrfHeaderName]=S)}"setRequestHeader"in f&&n.forEach(l,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete l[t]:f.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(f.withCredentials=!!e.withCredentials),h&&"json"!==h&&(f.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),r(e),f=null)})),p||(p=null),f.send(p)}))}},1732:(e,t,r)=>{"use strict";var n=r(6106),o=r(6995),i=r(9599),s=r(849);function a(e){var t=new i(e),r=o(i.prototype.request,t);return n.extend(r,i.prototype,t),n.extend(r,t),r}var c=a(r(6803));c.Axios=i,c.create=function(e){return a(s(c.defaults,e))},c.Cancel=r(436),c.CancelToken=r(6396),c.isCancel=r(8174),c.all=function(e){return Promise.all(e)},c.spread=r(7225),c.isAxiosError=r(7090),e.exports=c,e.exports.default=c},436:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},6396:(e,t,r)=>{"use strict";var n=r(436);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o((function(t){e=t})),cancel:e}},e.exports=o},8174:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},9599:(e,t,r)=>{"use strict";var n=r(6106),o=r(8025),i=r(875),s=r(5537),a=r(849),c=r(5549),u=c.validators;function d(e){this.defaults=e,this.interceptors={request:new i,response:new i}}d.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean,"1.0.0"),forcedJSONParsing:u.transitional(u.boolean,"1.0.0"),clarifyTimeoutError:u.transitional(u.boolean,"1.0.0")},!1);var r=[],n=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(n=n&&t.synchronous,r.unshift(t.fulfilled,t.rejected))}));var o,i=[];if(this.interceptors.response.forEach((function(e){i.push(e.fulfilled,e.rejected)})),!n){var d=[s,void 0];for(Array.prototype.unshift.apply(d,r),d=d.concat(i),o=Promise.resolve(e);d.length;)o=o.then(d.shift(),d.shift());return o}for(var p=e;r.length;){var l=r.shift(),h=r.shift();try{p=l(p)}catch(e){h(e);break}}try{o=s(p)}catch(e){return Promise.reject(e)}for(;i.length;)o=o.then(i.shift(),i.shift());return o},d.prototype.getUri=function(e){return e=a(this.defaults,e),o(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){d.prototype[e]=function(t,r){return this.request(a(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){d.prototype[e]=function(t,r,n){return this.request(a(n||{},{method:e,url:t,data:r}))}})),e.exports=d},875:(e,t,r)=>{"use strict";var n=r(6106);function o(){this.handlers=[]}o.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=o},3591:(e,t,r)=>{"use strict";var n=r(2117),o=r(1774);e.exports=function(e,t){return e&&!n(t)?o(e,t):t}},2384:(e,t,r)=>{"use strict";var n=r(9847);e.exports=function(e,t,r,o,i){var s=new Error(e);return n(s,t,r,o,i)}},5537:(e,t,r)=>{"use strict";var n=r(6106),o=r(3393),i=r(8174),s=r(6803);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=o.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||s.adapter)(e).then((function(t){return a(e),t.data=o.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(a(e),t&&t.response&&(t.response.data=o.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},9847:e=>{"use strict";e.exports=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},849:(e,t,r)=>{"use strict";var n=r(6106);e.exports=function(e,t){t=t||{};var r={},o=["url","method","data"],i=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function u(o){n.isUndefined(t[o])?n.isUndefined(e[o])||(r[o]=c(void 0,e[o])):r[o]=c(e[o],t[o])}n.forEach(o,(function(e){n.isUndefined(t[e])||(r[e]=c(void 0,t[e]))})),n.forEach(i,u),n.forEach(s,(function(o){n.isUndefined(t[o])?n.isUndefined(e[o])||(r[o]=c(void 0,e[o])):r[o]=c(void 0,t[o])})),n.forEach(a,(function(n){n in t?r[n]=c(e[n],t[n]):n in e&&(r[n]=c(void 0,e[n]))}));var d=o.concat(i).concat(s).concat(a),p=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return n.forEach(p,u),r}},7223:(e,t,r)=>{"use strict";var n=r(2384);e.exports=function(e,t,r){var o=r.config.validateStatus;r.status&&o&&!o(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},3393:(e,t,r)=>{"use strict";var n=r(6106),o=r(6803);e.exports=function(e,t,r){var i=this||o;return n.forEach(r,(function(r){e=r.call(i,e,t)})),e}},6803:(e,t,r)=>{"use strict";var n=r(6106),o=r(2685),i=r(9847),s={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!n.isUndefined(e)&&n.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:("undefined"!=typeof XMLHttpRequest?c=r(663):"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)&&(c=r(3501)),c),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),n.isFormData(e)||n.isArrayBuffer(e)||n.isBuffer(e)||n.isStream(e)||n.isFile(e)||n.isBlob(e)?e:n.isArrayBufferView(e)?e.buffer:n.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):n.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,r){if(n.isString(e))try{return(t||JSON.parse)(e),n.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,r=t&&t.silentJSONParsing,o=t&&t.forcedJSONParsing,s=!r&&"json"===this.responseType;if(s||o&&n.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(s){if("SyntaxError"===e.name)throw i(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},n.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),n.forEach(["post","put","patch"],(function(e){u.headers[e]=n.merge(s)})),e.exports=u},6995:e=>{"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},8025:(e,t,r)=>{"use strict";var n=r(6106);function o(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var i;if(r)i=r(t);else if(n.isURLSearchParams(t))i=t.toString();else{var s=[];n.forEach(t,(function(e,t){null!=e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),s.push(o(t)+"="+o(e))})))})),i=s.join("&")}if(i){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},1774:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4674:(e,t,r)=>{"use strict";var n=r(6106);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,o,i,s){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(o)&&a.push("path="+o),n.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},2117:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},7090:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},2523:(e,t,r)=>{"use strict";var n=r(6106);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=o(window.location.href),function(t){var r=n.isString(t)?o(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},2685:(e,t,r)=>{"use strict";var n=r(6106);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},6492:(e,t,r)=>{"use strict";var n=r(6106),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,i,s={};return e?(n.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=n.trim(e.substr(0,i)).toLowerCase(),r=n.trim(e.substr(i+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([r]):s[t]?s[t]+", "+r:r}})),s):s}},7225:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},5549:(e,t,r)=>{"use strict";var n=r(532),o={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){o[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var i={},s=n.version.split(".");function a(e,t){for(var r=t?t.split("."):s,n=e.split("."),o=0;o<3;o++){if(r[o]>n[o])return!0;if(r[o]<n[o])return!1}return!1}o.transitional=function(e,t,r){var o=t&&a(t);function s(e,t){return"[Axios v"+n.version+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,a){if(!1===e)throw new Error(s(n," has been removed in "+t));return o&&!i[n]&&(i[n]=!0,console.warn(s(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},e.exports={isOlderVersion:a,assertOptions:function(e,t,r){if("object"!=typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),o=n.length;o-- >0;){var i=n[o],s=t[i];if(s){var a=e[i],c=void 0===a||s(a,i,e);if(!0!==c)throw new TypeError("option "+i+" must be "+c)}else if(!0!==r)throw Error("Unknown option "+i)}},validators:o}},6106:(e,t,r)=>{"use strict";var n=r(6995),o=Object.prototype.toString;function i(e){return"[object Array]"===o.call(e)}function s(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==o.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===o.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),i(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:i,isArrayBuffer:function(e){return"[object ArrayBuffer]"===o.call(e)},isBuffer:function(e){return null!==e&&!s(e)&&null!==e.constructor&&!s(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:s,isDate:function(e){return"[object Date]"===o.call(e)},isFile:function(e){return"[object File]"===o.call(e)},isBlob:function(e){return"[object Blob]"===o.call(e)},isFunction:u,isStream:function(e){return a(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:d,merge:function e(){var t={};function r(r,n){c(t[n])&&c(r)?t[n]=e(t[n],r):c(r)?t[n]=e({},r):i(r)?t[n]=r.slice():t[n]=r}for(var n=0,o=arguments.length;n<o;n++)d(arguments[n],r);return t},extend:function(e,t,r){return d(t,(function(t,o){e[o]=r&&"function"==typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},6496:(e,t,r)=>{var n;e.exports=function(){if(!n){try{n=r(Object(function(){var e=new Error("Cannot find module 'debug'");throw e.code="MODULE_NOT_FOUND",e}()))("follow-redirects")}catch(e){}"function"!=typeof n&&(n=function(){})}n.apply(null,arguments)}},3824:(e,t,r)=>{var n=r(7310),o=n.URL,i=r(3685),s=r(5687),a=r(2781).Writable,c=r(9491),u=r(6496),d=["abort","aborted","connect","error","socket","timeout"],p=Object.create(null);d.forEach((function(e){p[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}}));var l=_("ERR_INVALID_URL","Invalid URL",TypeError),h=_("ERR_FR_REDIRECTION_FAILURE","Redirected request failed"),f=_("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),m=_("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),g=_("ERR_STREAM_WRITE_AFTER_END","write after end");function y(e,t){a.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(e){r._processResponse(e)},this._performRequest()}function v(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach((function(i){var s=i+":",a=r[s]=e[i],d=t[i]=Object.create(a);Object.defineProperties(d,{request:{value:function(e,i,a){if(T(e)){var d;try{d=b(new o(e))}catch(t){d=n.parse(e)}if(!T(d.protocol))throw new l({input:e});e=d}else o&&e instanceof o?e=b(e):(a=i,i=e,e={protocol:s});return O(i)&&(a=i,i=null),(i=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,i)).nativeProtocols=r,T(i.host)||T(i.hostname)||(i.hostname="::1"),c.equal(i.protocol,s,"protocol mismatch"),u("options",i),new y(i,a)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(e,t,r){var n=d.request(e,t,r);return n.end(),n},configurable:!0,enumerable:!0,writable:!0}})})),t}function S(){}function b(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return""!==e.port&&(t.port=Number(e.port)),t}function w(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return null==r?void 0:String(r).trim()}function _(e,t,r){function n(r){Error.captureStackTrace(this,this.constructor),Object.assign(this,r||{}),this.code=e,this.message=this.cause?t+": "+this.cause.message:t}return n.prototype=new(r||Error),n.prototype.constructor=n,n.prototype.name="Error ["+e+"]",n}function P(e){for(var t of d)e.removeListener(t,p[t]);e.on("error",S),e.abort()}function T(e){return"string"==typeof e||e instanceof String}function O(e){return"function"==typeof e}y.prototype=Object.create(a.prototype),y.prototype.abort=function(){P(this._currentRequest),this.emit("abort")},y.prototype.write=function(e,t,r){if(this._ending)throw new g;if(!T(e)&&("object"!=typeof(n=e)||!("length"in n)))throw new TypeError("data should be a string, Buffer or Uint8Array");var n;O(t)&&(r=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new m),this.abort()):r&&r()},y.prototype.end=function(e,t,r){if(O(e)?(r=e,e=t=null):O(t)&&(r=t,t=null),e){var n=this,o=this._currentRequest;this.write(e,t,(function(){n._ended=!0,o.end(null,null,r)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,r)},y.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},y.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},y.prototype.setTimeout=function(e,t){var r=this;function n(t){t.setTimeout(e),t.removeListener("timeout",t.destroy),t.addListener("timeout",t.destroy)}function o(t){r._timeout&&clearTimeout(r._timeout),r._timeout=setTimeout((function(){r.emit("timeout"),i()}),e),n(t)}function i(){r._timeout&&(clearTimeout(r._timeout),r._timeout=null),r.removeListener("abort",i),r.removeListener("error",i),r.removeListener("response",i),t&&r.removeListener("timeout",t),r.socket||r._currentRequest.removeListener("socket",o)}return t&&this.on("timeout",t),this.socket?o(this.socket):this._currentRequest.once("socket",o),this.on("socket",n),this.on("abort",i),this.on("error",i),this.on("response",i),this},["flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){y.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(y.prototype,e,{get:function(){return this._currentRequest[e]}})})),y.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},y.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var r=e.slice(0,-1);this._options.agent=this._options.agents[r]}var o=this._currentRequest=t.request(this._options,this._onNativeResponse);for(var i of(o._redirectable=this,d))o.on(i,p[i]);if(this._currentUrl=/^\//.test(this._options.path)?n.format(this._options):this._options.path,this._isRedirect){var s=0,a=this,c=this._requestBodyBuffers;!function e(t){if(o===a._currentRequest)if(t)a.emit("error",t);else if(s<c.length){var r=c[s++];o.finished||o.write(r.data,r.encoding,e)}else a._ended&&o.end()}()}}else this.emit("error",new TypeError("Unsupported protocol "+e))},y.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r=e.headers.location;if(!r||!1===this._options.followRedirects||t<300||t>=400)return e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),void(this._requestBodyBuffers=[]);if(P(this._currentRequest),e.destroy(),++this._redirectCount>this._options.maxRedirects)this.emit("error",new f);else{var o,i=this._options.beforeRedirect;i&&(o=Object.assign({Host:e.req.getHeader("host")},this._options.headers));var s=this._options.method;((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],w(/^content-/i,this._options.headers));var a,d=w(/^host$/i,this._options.headers),p=n.parse(this._currentUrl),l=d||p.host,m=/^\w+:/.test(r)?this._currentUrl:n.format(Object.assign(p,{host:l}));try{a=n.resolve(m,r)}catch(e){return void this.emit("error",new h({cause:e}))}u("redirecting to",a),this._isRedirect=!0;var g=n.parse(a);if(Object.assign(this._options,g),(g.protocol!==p.protocol&&"https:"!==g.protocol||g.host!==l&&!function(e,t){c(T(e)&&T(t));var r=e.length-t.length-1;return r>0&&"."===e[r]&&e.endsWith(t)}(g.host,l))&&w(/^(?:authorization|cookie)$/i,this._options.headers),O(i)){var y={headers:e.headers,statusCode:t},v={url:m,method:s,headers:o};try{i(this._options,y,v)}catch(e){return void this.emit("error",e)}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(e){this.emit("error",new h({cause:e}))}}},e.exports=v({http:i,https:s}),e.exports.wrap=v},7954:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.MixinDeviceBase=t.ScryptedDeviceBase=void 0,o(r(5492),t);const i=r(5492);class s extends i.DeviceBase{constructor(e){super(),this.nativeId=e}get storage(){return this._storage||(this._storage=deviceManager.getDeviceStorage(this.nativeId)),this._storage}get log(){return this._log||(this._log=deviceManager.getDeviceLogger(this.nativeId)),this._log}get console(){return this._console||(this._console=deviceManager.getDeviceConsole(this.nativeId)),this._console}async createMediaObject(e,t){return mediaManager.createMediaObject(e,t,{sourceId:this.id})}getMediaObjectConsole(e){return"string"!=typeof e.sourceId?this.console:deviceManager.getMixinConsole(e.sourceId,this.nativeId)}_lazyLoadDeviceState(){this._deviceState||(this.nativeId?this._deviceState=deviceManager.getDeviceState(this.nativeId):this._deviceState=deviceManager.getDeviceState())}onDeviceEvent(e,t){return deviceManager.onDeviceEvent(this.nativeId,e,t)}}t.ScryptedDeviceBase=s;class a extends i.DeviceBase{constructor(e){super(),this._listeners=new Set,this.nativeId=systemManager.getDeviceById(this.id)?.nativeId,this.mixinDevice=e.mixinDevice,this.mixinDeviceInterfaces=e.mixinDeviceInterfaces,this.mixinStorageSuffix=e.mixinStorageSuffix,this._deviceState=e.mixinDeviceState,this._deviceState.__rpcproxy_traps_all_properties&&deviceManager.createDeviceState&&"string"==typeof this._deviceState.id&&(this._deviceState=deviceManager.createDeviceState(this._deviceState.id,this._deviceState.setState)),this.mixinProviderNativeId=e.mixinProviderNativeId}get storage(){if(!this._storage){const e=this.mixinStorageSuffix,t=this.id+(e?":"+e:"");this._storage=deviceManager.getMixinStorage(t,this.mixinProviderNativeId)}return this._storage}get console(){return this._console||(deviceManager.getMixinConsole?this._console=deviceManager.getMixinConsole(this.id,this.mixinProviderNativeId):this._console=deviceManager.getDeviceConsole(this.mixinProviderNativeId)),this._console}async createMediaObject(e,t){return mediaManager.createMediaObject(e,t,{sourceId:this.id})}getMediaObjectConsole(e){return"string"!=typeof e.sourceId?this.console:deviceManager.getMixinConsole(e.sourceId,this.mixinProviderNativeId)}onDeviceEvent(e,t){return deviceManager.onMixinEvent(this.id,this,e,t)}_lazyLoadDeviceState(){}manageListener(e){this._listeners.add(e)}release(){for(const e of this._listeners)e.removeListener()}}t.MixinDeviceBase=a,function(){function e(e){return function(){return this._lazyLoadDeviceState(),this._deviceState?.[e]}}function t(e){return function(t){this._lazyLoadDeviceState(),this._deviceState?this._deviceState[e]=t:console.warn("device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.")}}for(const r of Object.values(i.ScryptedInterfaceProperty))r!==i.ScryptedInterfaceProperty.nativeId&&(Object.defineProperty(s.prototype,r,{set:t(r),get:e(r)}),Object.defineProperty(a.prototype,r,{set:t(r),get:e(r)}))}();let c={};try{let e;try{e=pluginRuntimeAPI}catch(e){}c=Object.assign(c,{log:deviceManager.getDeviceLogger(void 0),deviceManager,endpointManager,mediaManager,systemManager,pluginHostAPI,...e});try{systemManager.setScryptedInterfaceDescriptors?.(i.TYPES_VERSION,i.ScryptedInterfaceDescriptors)?.catch((()=>{}))}catch(e){}}catch(e){console.error("sdk initialization error, import @scrypted/types or use @scrypted/client instead",e)}t.default=c},5492:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScryptedMimeTypes=t.ScryptedInterface=t.MediaPlayerState=t.SecuritySystemObstruction=t.SecuritySystemMode=t.AirQuality=t.ChargeState=t.LockState=t.PanTiltZoomMovement=t.ThermostatMode=t.TemperatureUnit=t.FanMode=t.HumidityMode=t.ScryptedDeviceType=t.ScryptedInterfaceDescriptors=t.ScryptedInterfaceMethod=t.ScryptedInterfaceProperty=t.DeviceBase=t.TYPES_VERSION=void 0,t.TYPES_VERSION="0.2.78";t.DeviceBase=class{},function(e){e.id="id",e.info="info",e.interfaces="interfaces",e.mixins="mixins",e.name="name",e.nativeId="nativeId",e.pluginId="pluginId",e.providedInterfaces="providedInterfaces",e.providedName="providedName",e.providedRoom="providedRoom",e.providedType="providedType",e.providerId="providerId",e.room="room",e.type="type",e.on="on",e.brightness="brightness",e.colorTemperature="colorTemperature",e.rgb="rgb",e.hsv="hsv",e.running="running",e.paused="paused",e.docked="docked",e.temperatureSetting="temperatureSetting",e.thermostatActiveMode="thermostatActiveMode",e.thermostatAvailableModes="thermostatAvailableModes",e.thermostatMode="thermostatMode",e.thermostatSetpoint="thermostatSetpoint",e.thermostatSetpointHigh="thermostatSetpointHigh",e.thermostatSetpointLow="thermostatSetpointLow",e.temperature="temperature",e.temperatureUnit="temperatureUnit",e.humidity="humidity",e.ptzCapabilities="ptzCapabilities",e.lockState="lockState",e.entryOpen="entryOpen",e.batteryLevel="batteryLevel",e.chargeState="chargeState",e.online="online",e.fromMimeType="fromMimeType",e.toMimeType="toMimeType",e.binaryState="binaryState",e.tampered="tampered",e.powerDetected="powerDetected",e.audioDetected="audioDetected",e.motionDetected="motionDetected",e.ambientLight="ambientLight",e.occupied="occupied",e.flooded="flooded",e.ultraviolet="ultraviolet",e.luminance="luminance",e.position="position",e.securitySystemState="securitySystemState",e.pm10Density="pm10Density",e.pm25Density="pm25Density",e.vocDensity="vocDensity",e.noxDensity="noxDensity",e.co2ppm="co2ppm",e.airQuality="airQuality",e.humiditySetting="humiditySetting",e.fan="fan",e.applicationInfo="applicationInfo"}(t.ScryptedInterfaceProperty||(t.ScryptedInterfaceProperty={})),function(e){e.listen="listen",e.probe="probe",e.setMixins="setMixins",e.setName="setName",e.setRoom="setRoom",e.setType="setType",e.getPluginJson="getPluginJson",e.turnOff="turnOff",e.turnOn="turnOn",e.setBrightness="setBrightness",e.getTemperatureMaxK="getTemperatureMaxK",e.getTemperatureMinK="getTemperatureMinK",e.setColorTemperature="setColorTemperature",e.setRgb="setRgb",e.setHsv="setHsv",e.sendNotification="sendNotification",e.start="start",e.stop="stop",e.pause="pause",e.resume="resume",e.dock="dock",e.setTemperature="setTemperature",e.setThermostatMode="setThermostatMode",e.setThermostatSetpoint="setThermostatSetpoint",e.setThermostatSetpointHigh="setThermostatSetpointHigh",e.setThermostatSetpointLow="setThermostatSetpointLow",e.setTemperatureUnit="setTemperatureUnit",e.getPictureOptions="getPictureOptions",e.takePicture="takePicture",e.getAudioStream="getAudioStream",e.startDisplay="startDisplay",e.stopDisplay="stopDisplay",e.getVideoStream="getVideoStream",e.getVideoStreamOptions="getVideoStreamOptions",e.getRecordingStream="getRecordingStream",e.getRecordingStreamCurrentTime="getRecordingStreamCurrentTime",e.getRecordingStreamOptions="getRecordingStreamOptions",e.getRecordingStreamThumbnail="getRecordingStreamThumbnail",e.ptzCommand="ptzCommand",e.getRecordedEvents="getRecordedEvents",e.getVideoClip="getVideoClip",e.getVideoClipThumbnail="getVideoClipThumbnail",e.getVideoClips="getVideoClips",e.removeVideoClips="removeVideoClips",e.setVideoStreamOptions="setVideoStreamOptions",e.startIntercom="startIntercom",e.stopIntercom="stopIntercom",e.lock="lock",e.unlock="unlock",e.addPassword="addPassword",e.getPasswords="getPasswords",e.removePassword="removePassword",e.activate="activate",e.deactivate="deactivate",e.isReversible="isReversible",e.closeEntry="closeEntry",e.openEntry="openEntry",e.getDevice="getDevice",e.releaseDevice="releaseDevice",e.adoptDevice="adoptDevice",e.discoverDevices="discoverDevices",e.createDevice="createDevice",e.getCreateDeviceSettings="getCreateDeviceSettings",e.getRefreshFrequency="getRefreshFrequency",e.refresh="refresh",e.getMediaStatus="getMediaStatus",e.load="load",e.seek="seek",e.skipNext="skipNext",e.skipPrevious="skipPrevious",e.convert="convert",e.getSettings="getSettings",e.putSetting="putSetting",e.armSecuritySystem="armSecuritySystem",e.disarmSecuritySystem="disarmSecuritySystem",e.getReadmeMarkdown="getReadmeMarkdown",e.getOauthUrl="getOauthUrl",e.onOauthCallback="onOauthCallback",e.canMixin="canMixin",e.getMixin="getMixin",e.releaseMixin="releaseMixin",e.onRequest="onRequest",e.onConnection="onConnection",e.onPush="onPush",e.run="run",e.eval="eval",e.loadScripts="loadScripts",e.saveScript="saveScript",e.trackObjects="trackObjects",e.getDetectionInput="getDetectionInput",e.getObjectTypes="getObjectTypes",e.detectObjects="detectObjects",e.generateObjectDetections="generateObjectDetections",e.getDetectionModel="getDetectionModel",e.setHumidity="setHumidity",e.setFan="setFan",e.startRTCSignalingSession="startRTCSignalingSession",e.createRTCSignalingSession="createRTCSignalingSession",e.getScryptedUserAccessControl="getScryptedUserAccessControl",e.generateVideoFrames="generateVideoFrames"}(t.ScryptedInterfaceMethod||(t.ScryptedInterfaceMethod={})),t.ScryptedInterfaceDescriptors={ScryptedDevice:{name:"ScryptedDevice",methods:["listen","probe","setMixins","setName","setRoom","setType"],properties:["id","info","interfaces","mixins","name","nativeId","pluginId","providedInterfaces","providedName","providedRoom","providedType","providerId","room","type"]},ScryptedPlugin:{name:"ScryptedPlugin",methods:["getPluginJson"],properties:[]},OnOff:{name:"OnOff",methods:["turnOff","turnOn"],properties:["on"]},Brightness:{name:"Brightness",methods:["setBrightness"],properties:["brightness"]},ColorSettingTemperature:{name:"ColorSettingTemperature",methods:["getTemperatureMaxK","getTemperatureMinK","setColorTemperature"],properties:["colorTemperature"]},ColorSettingRgb:{name:"ColorSettingRgb",methods:["setRgb"],properties:["rgb"]},ColorSettingHsv:{name:"ColorSettingHsv",methods:["setHsv"],properties:["hsv"]},Notifier:{name:"Notifier",methods:["sendNotification"],properties:[]},StartStop:{name:"StartStop",methods:["start","stop"],properties:["running"]},Pause:{name:"Pause",methods:["pause","resume"],properties:["paused"]},Dock:{name:"Dock",methods:["dock"],properties:["docked"]},TemperatureSetting:{name:"TemperatureSetting",methods:["setTemperature","setThermostatMode","setThermostatSetpoint","setThermostatSetpointHigh","setThermostatSetpointLow"],properties:["temperatureSetting","thermostatActiveMode","thermostatAvailableModes","thermostatMode","thermostatSetpoint","thermostatSetpointHigh","thermostatSetpointLow"]},Thermometer:{name:"Thermometer",methods:["setTemperatureUnit"],properties:["temperature","temperatureUnit"]},HumiditySensor:{name:"HumiditySensor",methods:[],properties:["humidity"]},Camera:{name:"Camera",methods:["getPictureOptions","takePicture"],properties:[]},Microphone:{name:"Microphone",methods:["getAudioStream"],properties:[]},Display:{name:"Display",methods:["startDisplay","stopDisplay"],properties:[]},VideoCamera:{name:"VideoCamera",methods:["getVideoStream","getVideoStreamOptions"],properties:[]},VideoRecorder:{name:"VideoRecorder",methods:["getRecordingStream","getRecordingStreamCurrentTime","getRecordingStreamOptions","getRecordingStreamThumbnail"],properties:[]},PanTiltZoom:{name:"PanTiltZoom",methods:["ptzCommand"],properties:["ptzCapabilities"]},EventRecorder:{name:"EventRecorder",methods:["getRecordedEvents"],properties:[]},VideoClips:{name:"VideoClips",methods:["getVideoClip","getVideoClipThumbnail","getVideoClips","removeVideoClips"],properties:[]},VideoCameraConfiguration:{name:"VideoCameraConfiguration",methods:["setVideoStreamOptions"],properties:[]},Intercom:{name:"Intercom",methods:["startIntercom","stopIntercom"],properties:[]},Lock:{name:"Lock",methods:["lock","unlock"],properties:["lockState"]},PasswordStore:{name:"PasswordStore",methods:["addPassword","getPasswords","removePassword"],properties:[]},Scene:{name:"Scene",methods:["activate","deactivate","isReversible"],properties:[]},Entry:{name:"Entry",methods:["closeEntry","openEntry"],properties:[]},EntrySensor:{name:"EntrySensor",methods:[],properties:["entryOpen"]},DeviceProvider:{name:"DeviceProvider",methods:["getDevice","releaseDevice"],properties:[]},DeviceDiscovery:{name:"DeviceDiscovery",methods:["adoptDevice","discoverDevices"],properties:[]},DeviceCreator:{name:"DeviceCreator",methods:["createDevice","getCreateDeviceSettings"],properties:[]},Battery:{name:"Battery",methods:[],properties:["batteryLevel"]},Charger:{name:"Charger",methods:[],properties:["chargeState"]},Refresh:{name:"Refresh",methods:["getRefreshFrequency","refresh"],properties:[]},MediaPlayer:{name:"MediaPlayer",methods:["getMediaStatus","load","seek","skipNext","skipPrevious"],properties:[]},Online:{name:"Online",methods:[],properties:["online"]},BufferConverter:{name:"BufferConverter",methods:["convert"],properties:["fromMimeType","toMimeType"]},Settings:{name:"Settings",methods:["getSettings","putSetting"],properties:[]},BinarySensor:{name:"BinarySensor",methods:[],properties:["binaryState"]},TamperSensor:{name:"TamperSensor",methods:[],properties:["tampered"]},PowerSensor:{name:"PowerSensor",methods:[],properties:["powerDetected"]},AudioSensor:{name:"AudioSensor",methods:[],properties:["audioDetected"]},MotionSensor:{name:"MotionSensor",methods:[],properties:["motionDetected"]},AmbientLightSensor:{name:"AmbientLightSensor",methods:[],properties:["ambientLight"]},OccupancySensor:{name:"OccupancySensor",methods:[],properties:["occupied"]},FloodSensor:{name:"FloodSensor",methods:[],properties:["flooded"]},UltravioletSensor:{name:"UltravioletSensor",methods:[],properties:["ultraviolet"]},LuminanceSensor:{name:"LuminanceSensor",methods:[],properties:["luminance"]},PositionSensor:{name:"PositionSensor",methods:[],properties:["position"]},SecuritySystem:{name:"SecuritySystem",methods:["armSecuritySystem","disarmSecuritySystem"],properties:["securitySystemState"]},PM10Sensor:{name:"PM10Sensor",methods:[],properties:["pm10Density"]},PM25Sensor:{name:"PM25Sensor",methods:[],properties:["pm25Density"]},VOCSensor:{name:"VOCSensor",methods:[],properties:["vocDensity"]},NOXSensor:{name:"NOXSensor",methods:[],properties:["noxDensity"]},CO2Sensor:{name:"CO2Sensor",methods:[],properties:["co2ppm"]},AirQualitySensor:{name:"AirQualitySensor",methods:[],properties:["airQuality"]},Readme:{name:"Readme",methods:["getReadmeMarkdown"],properties:[]},OauthClient:{name:"OauthClient",methods:["getOauthUrl","onOauthCallback"],properties:[]},MixinProvider:{name:"MixinProvider",methods:["canMixin","getMixin","releaseMixin"],properties:[]},HttpRequestHandler:{name:"HttpRequestHandler",methods:["onRequest"],properties:[]},EngineIOHandler:{name:"EngineIOHandler",methods:["onConnection"],properties:[]},PushHandler:{name:"PushHandler",methods:["onPush"],properties:[]},Program:{name:"Program",methods:["run"],properties:[]},Scriptable:{name:"Scriptable",methods:["eval","loadScripts","saveScript"],properties:[]},ObjectTracker:{name:"ObjectTracker",methods:["trackObjects"],properties:[]},ObjectDetector:{name:"ObjectDetector",methods:["getDetectionInput","getObjectTypes"],properties:[]},ObjectDetection:{name:"ObjectDetection",methods:["detectObjects","generateObjectDetections","getDetectionModel"],properties:[]},HumiditySetting:{name:"HumiditySetting",methods:["setHumidity"],properties:["humiditySetting"]},Fan:{name:"Fan",methods:["setFan"],properties:["fan"]},RTCSignalingChannel:{name:"RTCSignalingChannel",methods:["startRTCSignalingSession"],properties:[]},RTCSignalingClient:{name:"RTCSignalingClient",methods:["createRTCSignalingSession"],properties:[]},LauncherApplication:{name:"LauncherApplication",methods:[],properties:["applicationInfo"]},ScryptedUser:{name:"ScryptedUser",methods:["getScryptedUserAccessControl"],properties:[]},VideoFrameGenerator:{name:"VideoFrameGenerator",methods:["generateVideoFrames"],properties:[]}},function(e){e.Builtin="Builtin",e.Camera="Camera",e.Fan="Fan",e.Light="Light",e.Switch="Switch",e.Outlet="Outlet",e.Sensor="Sensor",e.Scene="Scene",e.Program="Program",e.Automation="Automation",e.Vacuum="Vacuum",e.Notifier="Notifier",e.Thermostat="Thermostat",e.Lock="Lock",e.PasswordControl="PasswordControl",e.Display="Display",e.SmartDisplay="SmartDisplay",e.Speaker="Speaker",e.SmartSpeaker="SmartSpeaker",e.Event="Event",e.Entry="Entry",e.Garage="Garage",e.DeviceProvider="DeviceProvider",e.DataSource="DataSource",e.API="API",e.Doorbell="Doorbell",e.Irrigation="Irrigation",e.Valve="Valve",e.Person="Person",e.SecuritySystem="SecuritySystem",e.WindowCovering="WindowCovering",e.Siren="Siren",e.Unknown="Unknown"}(t.ScryptedDeviceType||(t.ScryptedDeviceType={})),function(e){e.Humidify="Humidify",e.Dehumidify="Dehumidify",e.Auto="Auto",e.Off="Off"}(t.HumidityMode||(t.HumidityMode={})),function(e){e.Auto="Auto",e.Manual="Manual"}(t.FanMode||(t.FanMode={})),function(e){e.C="C",e.F="F"}(t.TemperatureUnit||(t.TemperatureUnit={})),function(e){e.Off="Off",e.Cool="Cool",e.Heat="Heat",e.HeatCool="HeatCool",e.Auto="Auto",e.FanOnly="FanOnly",e.Purifier="Purifier",e.Eco="Eco",e.Dry="Dry",e.On="On"}(t.ThermostatMode||(t.ThermostatMode={})),function(e){e.Absolute="Absolute",e.Relative="Relative"}(t.PanTiltZoomMovement||(t.PanTiltZoomMovement={})),function(e){e.Locked="Locked",e.Unlocked="Unlocked",e.Jammed="Jammed"}(t.LockState||(t.LockState={})),function(e){e.Trickle="trickle",e.Charging="charging",e.NotCharging="not-charging"}(t.ChargeState||(t.ChargeState={})),function(e){e.Unknown="Unknown",e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Inferior="Inferior",e.Poor="Poor"}(t.AirQuality||(t.AirQuality={})),function(e){e.Disarmed="Disarmed",e.HomeArmed="HomeArmed",e.AwayArmed="AwayArmed",e.NightArmed="NightArmed"}(t.SecuritySystemMode||(t.SecuritySystemMode={})),function(e){e.Sensor="Sensor",e.Occupied="Occupied",e.Time="Time",e.Error="Error"}(t.SecuritySystemObstruction||(t.SecuritySystemObstruction={})),function(e){e.Idle="Idle",e.Playing="Playing",e.Paused="Paused",e.Buffering="Buffering"}(t.MediaPlayerState||(t.MediaPlayerState={})),function(e){e.ScryptedDevice="ScryptedDevice",e.ScryptedPlugin="ScryptedPlugin",e.OnOff="OnOff",e.Brightness="Brightness",e.ColorSettingTemperature="ColorSettingTemperature",e.ColorSettingRgb="ColorSettingRgb",e.ColorSettingHsv="ColorSettingHsv",e.Notifier="Notifier",e.StartStop="StartStop",e.Pause="Pause",e.Dock="Dock",e.TemperatureSetting="TemperatureSetting",e.Thermometer="Thermometer",e.HumiditySensor="HumiditySensor",e.Camera="Camera",e.Microphone="Microphone",e.Display="Display",e.VideoCamera="VideoCamera",e.VideoRecorder="VideoRecorder",e.PanTiltZoom="PanTiltZoom",e.EventRecorder="EventRecorder",e.VideoClips="VideoClips",e.VideoCameraConfiguration="VideoCameraConfiguration",e.Intercom="Intercom",e.Lock="Lock",e.PasswordStore="PasswordStore",e.Scene="Scene",e.Entry="Entry",e.EntrySensor="EntrySensor",e.DeviceProvider="DeviceProvider",e.DeviceDiscovery="DeviceDiscovery",e.DeviceCreator="DeviceCreator",e.Battery="Battery",e.Charger="Charger",e.Refresh="Refresh",e.MediaPlayer="MediaPlayer",e.Online="Online",e.BufferConverter="BufferConverter",e.Settings="Settings",e.BinarySensor="BinarySensor",e.TamperSensor="TamperSensor",e.PowerSensor="PowerSensor",e.AudioSensor="AudioSensor",e.MotionSensor="MotionSensor",e.AmbientLightSensor="AmbientLightSensor",e.OccupancySensor="OccupancySensor",e.FloodSensor="FloodSensor",e.UltravioletSensor="UltravioletSensor",e.LuminanceSensor="LuminanceSensor",e.PositionSensor="PositionSensor",e.SecuritySystem="SecuritySystem",e.PM10Sensor="PM10Sensor",e.PM25Sensor="PM25Sensor",e.VOCSensor="VOCSensor",e.NOXSensor="NOXSensor",e.CO2Sensor="CO2Sensor",e.AirQualitySensor="AirQualitySensor",e.Readme="Readme",e.OauthClient="OauthClient",e.MixinProvider="MixinProvider",e.HttpRequestHandler="HttpRequestHandler",e.EngineIOHandler="EngineIOHandler",e.PushHandler="PushHandler",e.Program="Program",e.Scriptable="Scriptable",e.ObjectTracker="ObjectTracker",e.ObjectDetector="ObjectDetector",e.ObjectDetection="ObjectDetection",e.HumiditySetting="HumiditySetting",e.Fan="Fan",e.RTCSignalingChannel="RTCSignalingChannel",e.RTCSignalingClient="RTCSignalingClient",e.LauncherApplication="LauncherApplication",e.ScryptedUser="ScryptedUser",e.VideoFrameGenerator="VideoFrameGenerator"}(t.ScryptedInterface||(t.ScryptedInterface={})),function(e){e.Url="text/x-uri",e.InsecureLocalUrl="text/x-insecure-local-uri",e.LocalUrl="text/x-local-uri",e.PushEndpoint="text/x-push-endpoint",e.SchemePrefix="x-scrypted/x-scrypted-scheme-",e.MediaStreamUrl="text/x-media-url",e.MediaObject="x-scrypted/x-scrypted-media-object",e.RequestMediaObject="x-scrypted/x-scrypted-request-media-object",e.RequestMediaStream="x-scrypted/x-scrypted-request-stream",e.MediaStreamFeedback="x-scrypted/x-media-stream-feedback",e.FFmpegInput="x-scrypted/x-ffmpeg-input",e.FFmpegTranscodeStream="x-scrypted/x-ffmpeg-transcode-stream",e.RTCSignalingChannel="x-scrypted/x-scrypted-rtc-signaling-channel",e.RTCSignalingSession="x-scrypted/x-scrypted-rtc-signaling-session",e.RTCConnectionManagement="x-scrypted/x-scrypted-rtc-connection-management",e.Image="x-scrypted/x-scrypted-image"}(t.ScryptedMimeTypes||(t.ScryptedMimeTypes={}))},6405:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Deferred=void 0;t.Deferred=class{constructor(){this.finished=!1,this.promise=new Promise(((e,t)=>{this.resolve=t=>{this.finished=!0,e(t)},this.reject=e=>{this.finished=!0,t(e)}}))}}},400:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ListenZeroSingleClientTimeoutError=t.listenZeroSingleClient=t.listenZero=t.bind=t.createBindUdp=t.reserveUdpPort=t.createBindZero=t.bindZero=t.bindUdp=t.closeQuiet=void 0;const o=r(2361),i=n(r(1891));async function s(e,t,r){e.bind(t,r),await(0,o.once)(e,"listening");const n=e.address().port;return{port:n,url:`udp://127.0.0.1:${n}`}}async function a(e){return c(0,e)}async function c(e,t){const r=i.default.createSocket(t||"udp4"),{port:n,url:o}=await s(r,e);return{server:r,port:n,url:o}}t.closeQuiet=async function(e){if(e)try{await new Promise(((t,r)=>{try{e.close(t)}catch(e){r(e)}}))}catch(e){}},t.bindUdp=s,t.bindZero=async function(e){return s(e,0)},t.createBindZero=a,t.reserveUdpPort=async function(){const e=await a();return await new Promise((t=>e.server.close((()=>t(void 0))))),e.port},t.createBindUdp=c,t.bind=async function(e,t){return e.bind(t),await(0,o.once)(e,"listening"),{port:t,url:`udp://127.0.0.1:${t}`}};var u=r(7189);Object.defineProperty(t,"listenZero",{enumerable:!0,get:function(){return u.listenZero}}),Object.defineProperty(t,"listenZeroSingleClient",{enumerable:!0,get:function(){return u.listenZeroSingleClient}}),Object.defineProperty(t,"ListenZeroSingleClientTimeoutError",{enumerable:!0,get:function(){return u.ListenZeroSingleClientTimeoutError}})},4921:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(1795),t)},2808:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMapPromiseDebouncer=t.createPromiseDebouncer=t.timeoutFunction=t.timeoutPromise=t.TimeoutError=t.singletonPromise=void 0,t.singletonPromise=function(e,t,r=0){if(e?.promise)return e;const n=t();return e?e.promise=n:e={promise:n,cacheDuration:r},n.finally((()=>setTimeout((()=>e.promise=void 0),e.cacheDuration))),e};class r extends Error{constructor(e){super("Operation Timed Out"),this.promise=e}}t.TimeoutError=r,t.timeoutPromise=function(e,t){return new Promise(((n,o)=>{const i=setTimeout((()=>o(new r(t))),e);t.then((e=>{clearTimeout(i),n(e)})).catch((e=>{clearTimeout(i),o(e)}))}))},t.timeoutFunction=function(e,t){return new Promise(((n,o)=>{let i=!1;const s=t((()=>i)),a=setTimeout((()=>{i=!0,o(new r(s))}),e);s.then((e=>{clearTimeout(a),n(e)})).catch((e=>{clearTimeout(a),o(e)}))}))},t.createPromiseDebouncer=function(){let e;return t=>(e||(e=t().finally((()=>e=void 0))),e)},t.createMapPromiseDebouncer=function(){const e=new Map;return(t,r)=>{const n=JSON.stringify(t);let o=e.get(n);return o||(o=r().finally((()=>e.delete(n))),e.set(n,o)),o}}},6521:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.readString=t.readLine=t.readUntil=t.readLength=t.StreamEndError=t.read16BELengthLoop=void 0;const n=r(2361);t.read16BELengthLoop=async function(e,t){let r;const{skipHeader:o,callback:i}=t,s=t.offset||0,a=t.headerLength||2;let c,u;e.on("error",(e=>r=e));let d=0,p=0;const l=()=>{p++,h()},h=()=>{for(;;){if(d!==p)return;if(c){const t=e.read(u);if(!t)return;i(c,t),c=void 0}else{if(c=e.read(a),!c)return;if(o?.(c,l)){d++,c=void 0;continue}u=c.readUInt16BE(s)}}};throw h(),e.on("readable",h),await(0,n.once)(e,"end"),new Error("stream ended")};class o extends Error{constructor(){super()}}async function i(e,t){if(e.readableEnded||e.destroyed)throw new Error("stream ended");if(!t)return Buffer.alloc(0);{const r=e.read(t);if(r)return r}return new Promise(((r,n)=>{const i=()=>{const o=e.read(t);if(o)return a(),void r(o);(e.readableEnded||e.destroyed)&&n(new Error("stream ended during read"))},s=()=>{a(),n(new o)},a=()=>{e.removeListener("readable",i),e.removeListener("end",s)};e.on("readable",i),e.on("end",s)}))}t.StreamEndError=o,t.readLength=i;const s="\n".charCodeAt(0);async function a(e,t){const r=[];let n=0;for(;;){const o=await i(e,1);if(!o)throw new Error("end of stream");if(o[0]===t)break;r[n++]=o[0]}return Buffer.from(r).toString()}t.readUntil=a,t.readLine=async function(e){return a(e,s)},t.readString=async function(e){let t="";return(e=await e).on("data",(e=>{t+=e.toString()})),e.resume(),await(0,n.once)(e,"end"),t}},7030:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.listenSingleRtspClient=t.RtspServer=t.RtspClient=t.RtspBase=t.RtspStatusError=t.parseSemicolonDelimited=t.getFirstAuthenticateHeader=t.parseHeaders=t.createRtspParser=t.getNaluTypesInNalu=t.getNaluFragmentInformation=t.getNaluTypes=t.findH264NaluTypeInNalu=t.findH264NaluType=t.H264_NAL_TYPE_MTAP32=t.H264_NAL_TYPE_MTAP16=t.H264_NAL_TYPE_FU_B=t.H264_NAL_TYPE_FU_A=t.H264_NAL_TYPE_STAP_B=t.H264_NAL_TYPE_STAP_A=t.H264_NAL_TYPE_PPS=t.H264_NAL_TYPE_SPS=t.H264_NAL_TYPE_SEI=t.H264_NAL_TYPE_IDR=t.H264_NAL_TYPE_RESERVED31=t.H264_NAL_TYPE_RESERVED30=t.H264_NAL_TYPE_RESERVED0=t.writeMessage=t.readBody=t.readMessage=t.RTSP_FRAME_MAGIC=void 0;const a=i(r(6113)),c=r(2361),u=r(5948),d=r(9358),p=s(r(1808)),l=s(r(4404)),h=r(6405),f=r(400),m=r(2808),g=r(6521),y=r(1853),v=r(5045),S=r(7310),b=["realm","nonce"];async function w(e){let t=[];for(;;){let r=await(0,g.readLine)(e);if(r=r.trim(),!r)return t;t.push(r)}}async function _(e,t){const r=parseInt(t["content-length"]);if(r)return(0,g.readLength)(e,r)}function P(e,t,r,n,o){let i=void 0!==t?`${t}\r\n`:"";r&&(n["Content-Length"]=r.length.toString());for(const[e,t]of Object.entries(n))i+=`${e}: ${t}\r\n`;i+="\r\n",e.write(i),o?.log("rtsp outgoing message\n",i),o?.log(),r&&e.write(r)}function T(e,t){if("h264"===e.type)return O(e.chunks[e.chunks.length-1].subarray(12),t)}function O(e,r){const n=31&e[0];if(n===t.H264_NAL_TYPE_STAP_A){let t=1;for(;t<e.length;){const n=e.readUInt16BE(t);t+=2;if((31&e[t])===r)return e.subarray(t,t+n);t+=n}}else if(n===t.H264_NAL_TYPE_FU_A){const t=31&e[1],n=!!(128&e[1]);if(t===r&&n)return e.subarray(1)}else if(n===r)return e}function E(e,r=!1,n=!1){const o=new Set,i=31&e[0];if(i===t.H264_NAL_TYPE_STAP_A){o.add(t.H264_NAL_TYPE_STAP_A);let r=1;for(;r<e.length;){const t=e.readUInt16BE(r);r+=2;const n=31&e[r];o.add(n),r+=t}}else if(i===t.H264_NAL_TYPE_FU_A){o.add(t.H264_NAL_TYPE_FU_A);const i=31&e[1];if(r){!!(128&e[1])&&o.add(i)}else if(n){!!(64&e[1])&&o.add(i)}else o.add(i)}else o.add(i);return o}function R(e){const t={};for(const r of e.slice(1)){const e=r.indexOf(":");let n="";-1!==e&&(n=r.substring(e+1).trim());t[r.substring(0,e).toLowerCase()]=n}return t}function A(e){for(const t of e.slice(1)){const e=t.indexOf(":");let r="";-1!==e&&(r=t.substring(e+1).trim());if("www-authenticate"===t.substring(0,e).toLowerCase())return r}}function C(e){const t={};for(const r of e.split(";")){const[e,n]=r.split("=",2);t[e]=n}return t}t.RTSP_FRAME_MAGIC=36,t.readMessage=w,t.readBody=_,t.writeMessage=P,t.H264_NAL_TYPE_RESERVED0=0,t.H264_NAL_TYPE_RESERVED30=30,t.H264_NAL_TYPE_RESERVED31=31,t.H264_NAL_TYPE_IDR=5,t.H264_NAL_TYPE_SEI=6,t.H264_NAL_TYPE_SPS=7,t.H264_NAL_TYPE_PPS=8,t.H264_NAL_TYPE_STAP_A=24,t.H264_NAL_TYPE_STAP_B=25,t.H264_NAL_TYPE_FU_A=28,t.H264_NAL_TYPE_FU_B=29,t.H264_NAL_TYPE_MTAP16=26,t.H264_NAL_TYPE_MTAP32=27,t.findH264NaluType=T,t.findH264NaluTypeInNalu=O,t.getNaluTypes=function(e){return"h264"!==e.type?new Set:E(e.chunks[e.chunks.length-1].subarray(12))},t.getNaluFragmentInformation=function(e){const r=(31&e[0])===t.H264_NAL_TYPE_FU_A;return{fua:r,fuaStart:r&&!!(128&e[1]),fuaEnd:r&&!!(64&e[1])}},t.getNaluTypesInNalu=E,t.createRtspParser=function(e){let r;return{container:"rtsp",tcpProtocol:"rtsp://127.0.0.1/"+(0,a.randomBytes)(8).toString("hex"),inputArguments:["-rtsp_transport","tcp"],outputArguments:["-rtsp_transport","tcp",...e?.vcodec||[],...e?.acodec||[],"-f","rtsp"],findSyncFrame(e){let r,n={};const o=()=>e.slice(r);for(let o=0;o<e.length;o++){const i=e[o];"h264"===i.type?T(i,t.H264_NAL_TYPE_SPS)&&(r=o):n[i.type]=i}if(void 0!==r)return o();n={};for(let o=0;o<e.length;o++){const i=e[o];"h264"===i.type?T(i,t.H264_NAL_TYPE_IDR)&&(r=o):n[i.type]=i}return void 0!==r?o():void 0},sdp:new Promise((e=>r=e)),async*parse(e,t,n){const o=new D(e);await o.handleSetup(),r(o.sdp);for await(const{type:e,rtcp:r,header:i,packet:s}of o.handleRecord())yield{chunks:[i,s],type:`${r?"rtcp-":""}${e}`,width:t,height:n}}}},t.parseHeaders=R,t.getFirstAuthenticateHeader=A,t.parseSemicolonDelimited=C;class x extends Error{constructor(e){super(`RTSP Error: ${e.line}`),this.status=e}}t.RtspStatusError=x;class I{constructor(){}write(e,t,r){P(this.client,e,r,t,this.console)}async readMessage(){const e=await w(this.client);return this.console?.log("rtsp incoming message\n",e.join("\n")),this.console?.log(),e}}t.RtspBase=I;t.RtspClient=class extends I{constructor(e){super(),this.url=e,this.cseq=0,this.needKeepAlive=!1,this.setupOptions=new Map,this.issuedTeardown=!1,this.hasGetParameter=!0;const t=new S.URL(e),r=parseInt(t.port)||554;e.startsWith("rtsps")?this.client=l.default.connect({rejectUnauthorized:!1,port:r,host:t.hostname}):this.client=p.default.connect(r,t.hostname),this.client.on("error",(e=>{this.console?.log("client error",e)}))}async safeTeardown(){if(!this.issuedTeardown){this.issuedTeardown=!0;try{this.writeTeardown(),await(0,v.sleep)(500)}catch(e){}finally{this.client.destroy()}}}writeRequest(e,t,r,n){t=t||{};let o=this.url;r&&(r.includes("rtsp://")||r.includes("rtsps://")?o=r:o+=(o.endsWith("/")?"":"/")+r);const i=new S.URL(o);i.username="",i.password="";const s=`${e} ${i} RTSP/1.0`,a=this.cseq++;t.CSeq=a.toString(),t["User-Agent"]="Scrypted",this.wwwAuthenticate&&(t.Authorization=this.createAuthorizationHeader(e,new S.URL(o))),this.session&&(t.Session=this.session),this.write(s,t,n)}async handleDataPayload(e){if(e[0]!==t.RTSP_FRAME_MAGIC)throw new Error("RTSP Client received invalid frame magic. This may be a bug in your camera firmware. If this error persists, switch your RTSP Parser to FFmpeg or Scrypted (UDP): "+e.toString());const r=e.readUInt8(1),n=e.readUInt16BE(2),o=await(0,g.readLength)(this.client,n);this.setupOptions.get(r)?.onRtp?.(e,o)}async readDataPayload(){const e=await(0,g.readLength)(this.client,4);return this.handleDataPayload(e)}createBadHeader(e){return new Error("RTSP Client received invalid frame magic. This may be a bug in your camera firmware. If this error persists, switch your RTSP Parser to FFmpeg or Scrypted (UDP): "+e.toString())}async readLoopLegacy(){try{for(;;)this.needKeepAlive&&(this.needKeepAlive=!1,this.hasGetParameter?await this.getParameter():await this.options()),await this.readDataPayload()}catch(e){throw this.client.destroy(e),e}}async readLoop(){const e=new h.Deferred;let r,n,o;const i=async()=>{this.needKeepAlive&&(this.needKeepAlive=!1,this.hasGetParameter?this.writeGetParameter():this.writeOptions());try{for(;;){if(!r){if(r=this.client.read(4),!r)return;if(r[0]!==t.RTSP_FRAME_MAGIC){if("RTSP"!==r.toString())throw this.createBadHeader(r);this.client.unshift(r),r=void 0,this.client.removeListener("readable",i);const e=await super.readMessage();await this.readBody(R(e));this.client.on("readable",i);continue}n=r.readUInt8(1),o=r.readUInt16BE(2)}const e=this.client.read(o);if(!e)return;const s=r;r=void 0;this.setupOptions.get(n)?.onRtp?.(s,e)}}catch(t){e.reject(t),this.client.destroy()}};i(),this.client.on("readable",i),await Promise.all([(0,c.once)(this.client,"end")])}async readMessage(){for(;;){const e=await(0,g.readLength)(this.client,4);if(e[0]!==t.RTSP_FRAME_MAGIC){if("RTSP"===e.toString()){this.client.unshift(e);return await super.readMessage()}throw this.createBadHeader(e)}await this.handleDataPayload(e)}}createAuthorizationHeader(e,t){if(!this.wwwAuthenticate)throw new Error("no WWW-Authenticate found");if(this.wwwAuthenticate.includes("Basic")){return`Basic ${u.BASIC.computeHash(t)}`}const r=(0,d.parseHTTPHeadersQuotedKeyValueSet)(this.wwwAuthenticate,{indexOf:()=>0},b),n=new S.URL(this.url),o=decodeURIComponent(n.username),i=decodeURIComponent(n.password),s=new S.URL(t.toString());s.username="",s.password="";const c=a.default.createHash("md5").update(`${o}:${r.realm}:${i}`).digest("hex"),p=a.default.createHash("md5").update(`${e}:${s}`).digest("hex"),l=a.default.createHash("md5").update(`${c}:${r.nonce}:${p}`).digest("hex"),h={username:o,realm:r.realm,nonce:r.nonce,uri:s.toString(),algorithm:"MD5",response:l};return`Digest ${Object.entries(h).map((([e,t])=>{return`${e}=${t&&(r=t,`"${r.replace(/"/g,'\\"')}"`)}`;var r})).join(", ")}`}async readBody(e){return _(this.client,e)}async request(e,t,r,n,o){this.writeRequest(e,t,r,n);const i=this.requestTimeout?await(0,m.timeoutPromise)(this.requestTimeout,this.readMessage()):await this.readMessage(),s=i[0],[a,c,u]=s.split(" ",3),d=parseInt(c),p=R(i),l={line:s,code:d,version:a,reason:u};if(200!==d&&!p["www-authenticate"])throw new x(l);const h=A(i)||p["www-authenticate"];if(h){if(o)throw new Error("auth failed");return this.wwwAuthenticate=h,this.request(e,t,r,n,!0)}return{headers:p,body:await this.readBody(p),status:l}}async options(){const e=await this.request("OPTIONS",{}),t=e.headers.public;return t&&(this.hasGetParameter=t.toLowerCase().includes("get_parameter")),e}writeOptions(){return this.writeRequest("OPTIONS")}async getParameter(){return this.request("GET_PARAMETER")}writeGetParameter(){return this.writeRequest("GET_PARAMETER")}async describe(e){return this.request("DESCRIBE",{...e||{},Accept:"application/sdp"})}async setup(e){const t="udp"===e.type?"":"/TCP",r="udp"===e.type?"client_port":"interleaved";let n;if("tcp"===e.type)n=e.port;else{if(!e.dgram){const t=await(0,f.createBindZero)();e.dgram=t.server,this.client.on("close",(()=>(0,f.closeQuiet)(t.server)))}n=e.dgram.address().port,e.dgram.on("message",(t=>e.onRtp(void 0,t)))}const o={Transport:`RTP/AVP${t};unicast;${r}=${n}-${n+1}`},i=await this.request("SETUP",o,e.path);let s;if(i.headers.session){const e=C(i.headers.session);let t=parseInt(e.timeout);if(t){let e=setInterval((()=>this.needKeepAlive=!0),1e3*(t-5));this.client.once("close",(()=>clearInterval(e)))}this.session=i.headers.session.split(";")[0]}if(i.headers.transport){const e=i.headers.transport.match(/.*?interleaved=([0-9]+)-([0-9]+)/);if(e){const[t,r,n]=e;r&&n&&(s={begin:parseInt(r),end:parseInt(n)})}}return"tcp"===e.type&&this.setupOptions.set(s?s.begin:n,e),Object.assign({interleaved:s,options:e},i)}async play(e={},t="0.000"){return e.Range=`npt=${t}-`,this.request("PLAY",e)}writePlay(e="0.000"){const t={Range:`npt=${e}-`};return this.writeRequest("PLAY",t)}writeRtpPayload(e,t){return this.client.write(e),this.client.write(Buffer.from(t))}send(e,r){const n=Buffer.alloc(4);return n.writeUInt8(t.RTSP_FRAME_MAGIC,0),n.writeUInt8(r,1),n.writeUInt16BE(e.length,2),this.writeRtpPayload(n,e)}async pause(){return this.request("PAUSE")}async teardown(){try{return await this.request("TEARDOWN")}finally{this.client.destroy()}}writeTeardown(){this.writeRequest("TEARDOWN")}};class D{constructor(e,t,r,n){this.client=e,this.sdp=t,this.udp=r,this.checkRequest=n,this.setupTracks={},this.availableOptions=["DESCRIBE","OPTIONS","PAUSE","PLAY","SETUP","TEARDOWN","ANNOUNCE","RECORD","GET_PARAMETER"],this.session=(0,a.randomBytes)(4).toString("hex"),t&&(t=t.trim()),e instanceof p.default.Socket&&e.setNoDelay(!0)}async handleSetup(e=["play","record","teardown"]){let t=[];for(;;){let r=await(0,g.readLine)(this.client);if(r=r.trim(),r)t.push(r);else{const r=await this.headers(t);if(e.includes(r))return r;t=[]}}}async handlePlayback(){return this.handleSetup()}async handleTeardown(){return this.handleSetup()}async*handleRecord(){for(;;){const e=await(0,g.readLength)(this.client,4);if(e[0]!==t.RTSP_FRAME_MAGIC)throw new Error("RTSP Server expected frame magic but received: "+e.toString());const r=e.readUInt16BE(2),n=await(0,g.readLength)(this.client,r),o=e.readUInt8(1),i=o-o%2,s=Object.values(this.setupTracks).find((e=>e.destination===i));if(!s)throw new Error("RSTP Server received unknown channel: "+o);yield{type:s.codec,rtcp:o%2==1,header:e,packet:n}}}writeRtpPayload(e,t){return this.client.write(e),this.client.write(Buffer.from(t))}send(e,t){const r=Buffer.alloc(4);return r.writeUInt8(36,0),r.writeUInt8(t,1),r.writeUInt16BE(e.length,2),this.writeRtpPayload(r,e)}sendUdp(e,t,r){e.send(r,t,"127.0.0.1")}sendTrack(e,t,r){const n=this.setupTracks[e];return n?"udp"===n.protocol?(this.udp?this.sendUdp(r?n.rtcp:n.rtp,n.destination,t):this.console?.warn("RTSP Server UDP socket not available."),!0):this.send(t,r?n.destination+1:n.destination):(this.console?.warn("RTSP Server track not found:",e),!0)}options(e,t){const r={};r.Public=this.availableOptions.join(", "),this.respond(200,"OK",t,r)}async get_parameter(e,t){this.respond(200,"OK",t,{})}describe(e,t){const r={};r["Content-Base"]=e,r["Content-Type"]="application/sdp",this.respond(200,"OK",t,r,Buffer.from(this.sdp))}setupInterleaved(e,t,r){this.setupTracks[e.control]={control:e.control,protocol:"tcp",destination:t,codec:e.codec}}async setup(e,t){const r={};let n=t.transport;r.Session=this.session;const o=(0,y.parseSdp)(this.sdp).msections.find((t=>e.endsWith(t.control)));if(o){if(n.includes("TCP"))if(this.resolveInterleaved){const[e,t]=this.resolveInterleaved(o);this.setupInterleaved(o,e,t),n=`RTP/AVP/TCP;unicast;interleaved=${e}-${t}`}else{const e=n.match(/.*?interleaved=([0-9]+)-([0-9]+)/);if(e){const t=parseInt(e[1]),r=parseInt(e[2]);this.setupInterleaved(o,t,r)}}else{if(!this.udp)return void this.respond(461,"Unsupported Transport",t,{});const e=n.match(/.*?client_port=([0-9]+)-([0-9]+)/),[r,i,s]=e,a=await(0,f.createBindZero)(),c=await(0,f.createBindUdp)(a.port+1);this.client.on("close",(()=>(0,f.closeQuiet)(a.server))),this.client.on("close",(()=>(0,f.closeQuiet)(c.server))),this.setupTracks[o.control]={control:o.control,protocol:"udp",destination:parseInt(i),codec:o.codec,rtp:a.server,rtcp:c.server},n=n.replace("RTP/AVP/UDP","RTP/AVP").replace("RTP/AVP","RTP/AVP/UDP"),n+=`;server_port=${a.port}-${c.port}`}r.Transport=n,this.respond(200,"OK",t,r)}else this.respond(404,"Not Found",t,r)}play(e,t){const r={},n=Object.values(this.setupTracks).map((t=>`url=${e}/${t.control}`)).join(",");r["RTP-Info"]=n,r.Range="npt=now-",r.Session=this.session,this.respond(200,"OK",t,r)}async announce(e,t){const r=parseInt(t["content-length"]),n=await(0,g.readLength)(this.client,r);this.sdp=n.toString();const o={};o.Session=this.session,this.respond(200,"OK",t,o)}async record(e,t){const r={};r.Session=this.session,this.respond(200,"OK",t,r)}async teardown(e,t){const r={};r.Session=this.session,this.respond(200,"OK",t,r),this.client.destroy()}async headers(e){this.console?.log("request headers",e.join("\n"));let[t,r]=e[0].split(" ",2);t=t.toLowerCase();const n=R(e);if(this.checkRequest){let o;try{o=await this.checkRequest(t,r,n,e)}catch(e){this.console?.error("error checking request",e)}if(!o)throw this.respond(400,"Bad Request",n,{}),this.client.destroy(),new Error("check request failed")}if(this[t]&&this.availableOptions.includes(t.toUpperCase()))return await this[t](r,n),t;this.respond(400,"Bad Request",n,{})}respond(e,t,r,n,o){let i=`RTSP/1.0 ${e} ${t}\r\n`;r.cseq&&(n.CSeq=r.cseq),o&&(n["Content-Length"]=o.length.toString());for(const[e,t]of Object.entries(n))i+=`${e}: ${t}\r\n`;this.console?.log("response headers",i),i+="\r\n",this.client.write(i),o&&(this.client.write(o),this.console?.log("response body",o.toString()))}destroy(){this.client.destroy();for(const e of Object.values(this.setupTracks))(0,f.closeQuiet)(e.rtp),(0,f.closeQuiet)(e.rtcp)}}t.RtspServer=D,t.listenSingleRtspClient=async function(e){const t=e?.pathToken||a.default.randomBytes(8).toString("hex");let{url:r,clientPromise:n,server:o}=await(0,f.listenZeroSingleClient)(e?.hostname);const i="/"+t;r=r.replace("tcp:","rtsp:")+i;const s=n.then((t=>{const r=(e?.createServer||(e=>new D(e)))(t);return r.checkRequest=async(e,t,n,o)=>{r.checkRequest=void 0;return new S.URL(t).pathname===i},r}));return{url:r,rtspServerPromise:s,server:o}}},1853:(e,t)=>{"use strict";function r(e){let t=e.split("\n").map((e=>e.trim()));t=t.filter((e=>!e.includes("a=control:")));let r=0;for(let e=0;e<t.length;e++){t[e].startsWith("m=")&&(t.splice(e+1,0,"a=control:trackID="+r),r++)}return t.join("\r\n")}function n(e,t,r=["recvonly","sendrecv"]){const n=function(e){return("\n"+e).split("\nm=")}(e).filter((e=>e.startsWith(t)));for(const e of n){const t=()=>{const t=e.split("\n").map((e=>e.trim())),r="a=control:",n=t.find((e=>e.startsWith(r)));return{section:"m="+e,trackId:n.substring(r.length)}};for(const n of r)if(e.includes(`a=${n}`))return t();if(r.includes("recvonly")&&!e.includes("sendonly")&&!e.includes("inactive"))return t()}}function o(e){const t=[];for(const r of e.split(" ").slice(3)||[])t.push(parseInt(r));return t}function i(e){const t=e.split(" ");return{type:t[0].substring(2),port:parseInt(t[1]),protocol:t[2],payloadTypes:o(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.getSpsPps=t.parseSdp=t.parseMSection=t.parseRtpMap=t.parseFmtp=t.parseMLine=t.parseMLinePayloadTypes=t.findTracksByType=t.findTrackByType=t.findFmtp=t.createSdpInput=t.addTrackControls=t.replaceSectionPort=t.replacePorts=void 0,t.replacePorts=function(e,t,r){return e.replace(/c=IN .*/,"c=IN IP4 127.0.0.1").replace(/m=audio \d+/,`m=audio ${t}`).replace(/m=video \d+/,`m=video ${r}`)},t.replaceSectionPort=function(e,t,r){const n=new RegExp(`m=${t} \\d+`);return e.replace(/c=IN .*/,"c=IN IP4 127.0.0.1").replace(n,`m=${t} ${r}`)},t.addTrackControls=r,t.createSdpInput=function(e,t,n){let o=n.replace(/c=IN .*/,"c=IN IP4 127.0.0.1").replace(/m=audio \d+/,`m=audio ${e}`).replace(/m=video \d+/,`m=video ${t}`),i=o.split("\n").map((e=>e.trim()));return i=i.filter((e=>!e.includes("a=rtcp-mux"))).filter((e=>!e.includes("a=candidate"))).filter((e=>!e.includes("a=ice"))),o=i.join("\r\n"),o=r(o),o=o.split("m=").slice(1).map((e=>"m="+e)).join(""),o},t.findFmtp=function(e,t){let r=e.split("\n").map((e=>e.trim()));const n=new RegExp(`a=rtpmap:(\\d+) ${t}`);return r.map((e=>e.match(n))).filter((e=>!!e)).map((e=>{const t=parseInt(e[1]),n=`a=fmtp:${t} `,o=r.find((e=>e.startsWith(n)))?.substring(n.length);return{payloadType:t,fmtp:o}}))},t.findTrackByType=n,t.findTracksByType=function(e,t=["recvonly","sendrecv"]){return{audio:n(e,"audio",t)?.trackId,video:n(e,"video",t)?.trackId}},t.parseMLinePayloadTypes=o,t.parseMLine=i;function s(e){return e.filter((e=>e.startsWith("a=fmtp"))).map((e=>{const t=e.indexOf(" ");if(-1===t)return;const r=e.substring(0,t),n=e.substring(t+1),o=parseInt(r.split(":")[1]);if(!r||!n||Number.isNaN(o))return;const i={};return n.split(";").map((e=>e.trim())).forEach((e=>{const[t,...r]=e.split("=");i[t]=r.join("=")})),{payloadType:o,parameters:i}})).filter((e=>!!e))}function a(e,t){const r=t?.match(/a=rtpmap:([\d]+) (.*?)\/([\d]+)/);let n;return t=t?.toLowerCase(),t?.includes("mpeg4")?n="aac":t?.includes("opus")?n="opus":t?.includes("pcma")?n="pcm_alaw":t?.includes("pcmu")?n="pcm_ulaw":t?.includes("pcm")?n="pcm":t?.includes("h264")?n="h264":t?.includes("h265")?n="h265":t||"audio"!==e||(n="pcm_alaw"),{line:t,codec:n,rawCodec:r?.[2],clock:parseInt(r?.[3]),payloadType:parseInt(r?.[1])}}t.parseFmtp=s,t.parseRtpMap=a;const c="a=control:",u="a=rtpmap:";function d(e){const t=e.find((e=>e.startsWith(c)))?.substring(c.length),r=e.find((e=>e.startsWith(u))),n=i(e[0]);let o=a(n.type,r).codec;const d=e.filter((e=>e.startsWith(u))).map((e=>a(n.type,e)));let p;for(const t of["sendonly","sendrecv","recvonly","inactive"]){if(e.find((e=>e==="a="+t))){p=t;break}}const l={...n,fmtp:s(e),lines:e,rtpmaps:d,contents:e.join("\r\n"),control:t,codec:o,direction:p,toSdp:()=>l.lines.join("\r\n")};return l}t.parseMSection=d,t.parseSdp=function(e){const t=e.split("\n").map((e=>e.trim())),r=[],n=[];let o;for(const e of t)e.startsWith("m=")&&(o&&n.push(o),o=[]),o?o.push(e):r.push(e);o&&n.push(o);const i={header:{lines:r,contents:r.join("\r\n")},msections:n.map(d),toSdp:()=>[...i.header.lines,...i.msections.map((e=>e.lines)).flat()].join("\r\n")};return i},t.getSpsPps=function(e){const t=e?.fmtp?.[0]?.parameters?.["sprop-parameter-sets"]?.split(",");if(2!==t?.length)return{sps:void 0,pps:void 0};const[r,n]=t;return{sps:Buffer.from(r,"base64"),pps:Buffer.from(n,"base64")}}},5045:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r(9413),t)},6902:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AmcrestCameraClient=t.AmcrestEvent=void 0;const o=n(r(4988)),i=r(195);var s;!function(e){e.MotionStart="Code=VideoMotion;action=Start",e.MotionStop="Code=VideoMotion;action=Stop",e.AudioStart="Code=AudioMutation;action=Start",e.AudioStop="Code=AudioMutation;action=Stop",e.TalkInvite="Code=_DoTalkAction_;action=Invite",e.TalkHangup="Code=_DoTalkAction_;action=Hangup",e.TalkPulse="Code=_DoTalkAction_;action=Pulse",e.AlarmIPCStart="Code=AlarmIPC;action=Start",e.AlarmIPCStop="Code=AlarmIPC;action=Stop",e.PhoneCallDetectStart="Code=PhoneCallDetect;action=Start",e.PhoneCallDetectStop="Code=PhoneCallDetect;action=Stop",e.DahuaTalkInvite="Code=CallNoAnswered;action=Start",e.DahuaTalkHangup="Code=PassiveHungup;action=Start",e.DahuaCallDeny="Code=HungupPhone;action=Pulse",e.DahuaTalkPulse="Code=_CallNoAnswer_;action=Pulse"}(s=t.AmcrestEvent||(t.AmcrestEvent={}));t.AmcrestCameraClient=class{constructor(e,t,r,n){this.ip=e,this.console=n,this.digestAuth=new o.default({username:t,password:r})}async checkTwoWayAudio(){return(await this.digestAuth.request({httpsAgent:i.amcrestHttpsAgent,method:"GET",responseType:"text",url:`http://${this.ip}/cgi-bin/devAudioOutput.cgi?action=getCollect`})).data.includes("result=1")}async getDeviceInfo(){return(0,i.getDeviceInfo)(this.digestAuth,this.ip)}async jpegSnapshot(){const e=await this.digestAuth.request({httpsAgent:i.amcrestHttpsAgent,method:"GET",responseType:"arraybuffer",url:`http://${this.ip}/cgi-bin/snapshot.cgi`});return Buffer.from(e.data)}async listenEvents(){const e=`http://${this.ip}/cgi-bin/eventManager.cgi?action=attach&codes=[All]`;console.log("preparing event listener",e);const t=(await this.digestAuth.request({httpsAgent:i.amcrestHttpsAgent,method:"GET",responseType:"stream",url:e})).data;return t.socket.setKeepAlive(!0),t.on("data",(e=>{const r=e.toString(),n=r.split(";");let o;try{for(const e of n)e.startsWith("index")&&(o=e.split("=")[1]?.trim())}catch(e){this.console.error("error parsing index",r)}for(const e of Object.values(s))-1!==r.indexOf(e)&&t.emit("event",e,o,r)})),t}async enableContinousRecording(e){for(let t=0;t<7;t++){const r=`http://${this.ip}/cgi-bin/configManager.cgi?action=setConfig&Record[${e-1}].TimeSection[${t}][0]=1 00:00:00-23:59:59`,n=await this.digestAuth.request({httpsAgent:i.amcrestHttpsAgent,method:"POST",url:r});this.console.log(n.data)}}}},6360:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const a=r(4921),c=r(6521),u=i(r(7954)),d=s(r(2081)),p=r(2781),l=r(4112),h=r(9025),f=r(6902),m=r(195),{mediaManager:g}=u.default,y="Amcrest Doorbell",v="Dahua Doorbell";function S(e,t,r){const n=e.split("\n").find((e=>e.startsWith(`${t}.${r}`)));if(!n)return;return n.split("=")[1]}class b extends h.RtspSmartCamera{constructor(e,t){super(e,t),this.onvifIntercom=new l.OnvifIntercom(this),"true"===this.storage.getItem("amcrestDoorbell")&&(this.storage.setItem("doorbellType",y),this.storage.removeItem("amcrestDoorbell")),this.updateDeviceInfo()}getRecordingStreamCurrentTime(e){throw new Error("Method not implemented.")}getRecordingStreamThumbnail(e){throw new Error("Method not implemented.")}async getRecordingStream(e){const t=new Date(e.startTime),r=(t.getMonth()+1).toString().padStart(2,"0"),n=t.getDate().toString().padStart(2,"0"),o=t.getFullYear(),i=t.getHours().toString().padStart(2,"0"),s=t.getMinutes().toString().padStart(2,"0"),a=t.getSeconds().toString().padStart(2,"0"),c=`rtsp://${this.getRtspAddress()}/cam/playback?channel=1&starttime=${o}_${r}_${n}_${i}_${s}_${a}`,u=this.addRtspCredentials(c);return this.createMediaStreamUrl(u,void 0)}getRecordingStreamOptions(){return this.getVideoStreamOptions()}async updateDeviceInfo(){const e=this.storage.getItem("ip");if(!e)return;const t=`http://${e}`,r={...this.info,ip:e,managementUrl:t},n=[{action:"getVendor",replace:"vendor=",parameter:"manufacturer"},{action:"getSerialNo",replace:"sn=",parameter:"serialNumber"},{action:"getDeviceType",replace:"type=",parameter:"model"},{action:"getSoftwareVersion",replace:"version=",parameter:"firmware"}];for(const e of n)try{const t=await this.getClient().digestAuth.request({url:`http://${this.getHttpAddress()}/cgi-bin/magicBox.cgi?action=${e.action}`}),n=String(t.data).replace(e.replace,"").trim();r[e.parameter]=n}catch(t){this.console.error("Error getting device parameter",e.action,t)}this.info=r}async setVideoStreamOptions(e){if(!e.id?.startsWith("channel"))throw new Error("invalid id");const t=parseInt(this.getRtspChannel())||1,r=parseInt(e.id?.substring("channel".length))-1,n=`Encode[${t-1}].${"channel0"===e.id?"MainFormat":"ExtraFormat"}[${r}]`,o=new URLSearchParams;if(e.video?.bitrate){let t=e?.video?.bitrate;if(!t)return;t=Math.round(t/1e3),o.set(`${n}.Video.BitRate`,t.toString())}if("h264"===e.video?.codec&&o.set(`${n}.Video.Compression`,"H.264"),"h265"===e.video?.codec&&o.set(`${n}.Video.Compression`,"H.265"),e.video?.width&&e.video?.height&&o.set(`${n}.Video.resolution`,`${e.video.width}x${e.video.height}`),e.video?.fps&&(o.set(`${n}.Video.FPS`,e.video.fps.toString()),e.video?.idrIntervalMillis&&o.set(`${n}.Video.GOP`,(e.video.fps*e.video?.idrIntervalMillis/1e3).toString())),e.video?.bitrateControl&&o.set(`${n}.Video.BitRateControl`,"variable"===e.video.bitrateControl?"VBR":"CBR"),![...o.keys()].length)return;const i=await this.getClient().digestAuth.request({url:`http://${this.getHttpAddress()}/cgi-bin/configManager.cgi?action=setConfig&${o}`});this.console.log("reconfigure result",i.data)}getClient(){return this.client||(this.client=new f.AmcrestCameraClient(this.getHttpAddress(),this.getUsername(),this.getPassword(),this.console)),this.client}async listenEvents(){const e=new f.AmcrestCameraClient(this.getHttpAddress(),this.getUsername(),this.getPassword(),this.console),t=await e.listenEvents(),r=this.storage.getItem("doorbellType"),n=this.storage.getItem("callerID"),o="true"===this.storage.getItem("multipleCallIds");let i;return t.on("event",((e,t,s)=>{const a=this.getRtspChannel();if(a){if((parseInt(t)+1).toString()!==a)return}e===f.AmcrestEvent.MotionStart?this.motionDetected=!0:e===f.AmcrestEvent.MotionStop?this.motionDetected=!1:e===f.AmcrestEvent.AudioStart?this.audioDetected=!0:e===f.AmcrestEvent.AudioStop?this.audioDetected=!1:e===f.AmcrestEvent.TalkInvite||e===f.AmcrestEvent.PhoneCallDetectStart||e===f.AmcrestEvent.AlarmIPCStart||e===f.AmcrestEvent.DahuaTalkInvite?e===f.AmcrestEvent.DahuaTalkInvite&&s&&o?s.includes(n)&&(this.binaryState=!0):this.binaryState=!0:e===f.AmcrestEvent.TalkHangup||e===f.AmcrestEvent.PhoneCallDetectStop||e===f.AmcrestEvent.AlarmIPCStop||e===f.AmcrestEvent.DahuaCallDeny||e===f.AmcrestEvent.DahuaTalkHangup?this.binaryState=!1:e===f.AmcrestEvent.TalkPulse&&r===y?s.includes("Invite")?this.binaryState=!0:s.includes("Hangup")&&(this.binaryState=!1):e===f.AmcrestEvent.DahuaTalkPulse&&r===v&&(clearTimeout(i),i=setTimeout((()=>this.binaryState=!1),3e3),this.binaryState=!0)})),t}async getOtherSettings(){const e=await super.getOtherSettings();e.push({title:"Doorbell Type",choices:["Not a Doorbell",y,v],description:"If this device is a doorbell, select the appropriate doorbell type.",value:this.storage.getItem("doorbellType")||"Not a Doorbell",key:"doorbellType"});const t=this.storage.getItem("doorbellType"),r=t===y||t===v;let n=this.storage.getItem("twoWayAudio");const o=["Amcrest","ONVIF"];r||o.unshift("None"),n=o.find((e=>e===n)),n||(n=r?"Amcrest":"None"),t==v&&e.push({title:"Multiple Call Buttons",key:"multipleCallIds",description:"Some Dahua Doorbells integrate multiple Call Buttons for apartment buildings.",type:"boolean",value:("true"===this.storage.getItem("multipleCallIds")).toString()});return this.storage.getItem("multipleCallIds")&&e.push({title:"Caller ID",key:"callerID",description:"Caller ID",type:"number",value:this.storage.getItem("callerID")}),e.push({title:"Two Way Audio",value:n,key:"twoWayAudio",description:"Amcrest cameras may support both Amcrest and ONVIF two way audio protocols. ONVIF generally performs better when supported.",choices:o}),e}async takeSmartCameraPicture(e){return this.createMediaObject(await this.getClient().jpegSnapshot(),"image/jpeg")}async getUrlSettings(){return[{key:"rtspChannel",title:"Channel Number Override",subgroup:"Advanced",description:"The channel number to use for snapshots and video. E.g., 1, 2, etc.",placeholder:"1",value:this.storage.getItem("rtspChannel")},...await super.getUrlSettings()]}getRtspChannel(){return this.storage.getItem("rtspChannel")}createRtspMediaStreamOptions(e,t){const r=super.createRtspMediaStreamOptions(e,t);return r.tool="scrypted",r}async getConstructedVideoStreamOptions(){const e=this.getClient();return this.videoStreamOptions||(this.videoStreamOptions=(async()=>{let t;try{t=(await e.digestAuth.request({url:`http://${this.getHttpAddress()}/cgi-bin/magicBox.cgi?action=getProductDefinition&name=MaxExtraStream`,responseType:"text",httpsAgent:m.amcrestHttpsAgent})).data.split("=")[1].trim(),this.storage.setItem("maxExtraStreams",t.toString())}catch(e){this.console.error("error retrieving max extra streams",e),t=this.storage.getItem("maxExtraStreams")}const r=parseInt(t)||1,n=parseInt(this.getRtspChannel())||1,o=[...Array(r+1).keys()].map((e=>this.createRtspMediaStreamOptions(`rtsp://${this.getRtspAddress()}/cam/realmonitor?channel=${n}&subtype=${e}`,e)));try{const t=await e.digestAuth.request({url:`http://${this.getHttpAddress()}/cgi-bin/encode.cgi?action=getConfigCaps&channel=0`,responseType:"text",httpsAgent:m.amcrestHttpsAgent});this.console.log(t.data);const r=await e.digestAuth.request({url:`http://${this.getHttpAddress()}/cgi-bin/configManager.cgi?action=getConfig&name=Encode`,responseType:"text",httpsAgent:m.amcrestHttpsAgent});this.console.log(r.data);for(let e=0;e<o.length;e++){const i=o[e];let s,a;0===e?(s=`caps[${n-1}].MainFormat[0]`,a=`table.Encode[${n-1}].MainFormat[0]`):(s=`caps[${n-1}].ExtraFormat[${e-1}]`,a=`table.Encode[${n-1}].ExtraFormat[${e-1}]`);const c=S(r.data,a,"Video.Compression")?.replace(".","")?.toLowerCase()?.trim();let u=S(r.data,a,"Audio.Compression")?.replace(".","")?.toLowerCase()?.trim();u?.includes("aac")?u="aac":u.includes("g711a")?u="pcm_alaw":u.includes("g711u")?u="pcm_ulaw":u.includes("g711")&&(u="pcm"),i.audio&&(i.audio.codec=u),i.video.codec=c;const d=S(r.data,a,"Video.Width"),p=S(r.data,a,"Video.Height");d&&p&&(i.video.width=parseInt(d),i.video.height=parseInt(p));const l=S(t.data,s,"Video.BitRateOptions");if(!l)continue;const h=S(r.data,a,"Video.BitRate");if(!h)continue;const[f,m]=l.split(",");f&&m&&(i.video.bitrate=1e3*parseInt(h),i.video.maxBitrate=1e3*parseInt(m),i.video.minBitrate=1e3*parseInt(f))}}catch(e){this.console.error("error retrieving stream configurations",e)}return o})()),this.videoStreamOptions}async putSetting(e,t){if("continuousRecording"===e)if("true"===t)try{await this.getClient().enableContinousRecording(parseInt(this.getRtspChannel())||1),this.storage.setItem("continuousRecording","true")}catch(e){this.log.a("There was an error enabling continuous recording."),this.console.error("There was an error enabling continuous recording.",e)}else this.storage.removeItem("continuousRecording");this.client=void 0,this.videoStreamOptions=void 0,super.putSetting(e,t);const r=this.storage.getItem("doorbellType"),n=r===y||r===v,o="true"===this.storage.getItem("twoWayAudio")||"ONVIF"===this.storage.getItem("twoWayAudio")||"Amcrest"===this.storage.getItem("twoWayAudio"),i=this.provider.getInterfaces();let s;n&&(s=u.ScryptedDeviceType.Doorbell,i.push(u.ScryptedInterface.BinarySensor)),(n||o)&&i.push(u.ScryptedInterface.Intercom);"true"===this.storage.getItem("continuousRecording")&&i.push(u.ScryptedInterface.VideoRecorder),this.provider.updateDevice(this.nativeId,this.name,i,s),this.updateDeviceInfo()}async startIntercom(e){if("ONVIF"===this.storage.getItem("twoWayAudio")){const t=(await this.getConstructedVideoStreamOptions())[0],r=new URL(t.url);return r.searchParams.set("proto","Onvif"),this.onvifIntercom.url=r.toString(),this.onvifIntercom.startIntercom(e)}const t=this.getRtspChannel()||"1",r=await g.convertMediaObjectToBuffer(e,u.ScryptedMimeTypes.FFmpegInput),n=JSON.parse(r.toString()).inputArguments.slice();n.unshift("-hide_banner"),n.push("-vn","-acodec","aac","-f","adts","pipe:3"),this.console.log("ffmpeg intercom",n);const o=await g.getFFmpegPath();this.cp=d.default.spawn(o,n,{stdio:["pipe","pipe","pipe","pipe"]}),this.cp.on("exit",(()=>this.cp=void 0)),(0,a.ffmpegLogInitialOutput)(this.console,this.cp);const i=this.cp.stdio[3];(async()=>{const e=`http://${this.getHttpAddress()}/cgi-bin/audio.cgi?action=postAudio&httptype=singlepart&channel=${t}`;this.console.log("posting audio data to",e);const r=new p.PassThrough;this.getClient().digestAuth.request({method:"POST",url:e,headers:{"Content-Type":"Audio/AAC","Content-Length":"9999999"},httpsAgent:m.amcrestHttpsAgent,data:r});try{for(;;){const e=await(0,c.readLength)(i,1024);r.push(e)}}catch(e){}finally{this.console.log("audio finished"),r.end()}this.stopIntercom()})()}async stopIntercom(){if("ONVIF"===this.storage.getItem("twoWayAudio"))return this.onvifIntercom.stopIntercom();this.cp?.kill(),this.cp=void 0}showRtspUrlOverride(){return!1}}class w extends h.RtspProvider{getAdditionalInterfaces(){return[u.ScryptedInterface.VideoCameraConfiguration,u.ScryptedInterface.Camera,u.ScryptedInterface.AudioSensor,u.ScryptedInterface.MotionSensor]}async createDevice(e,t){const r=`${e.ip}:${e.httpPort||80}`;let n={};const o=e.username?.toString(),i=e.password?.toString();let s;if(!("true"===e.skipValidate)){const t=new f.AmcrestCameraClient(r,o,i,this.console);try{const r=await t.getDeviceInfo();e.newCamera=r.deviceType,n.model=r.deviceType,n.serialNumber=r.serialNumber}catch(e){throw this.console.error("Error adding Amcrest camera",e),e}try{await t.checkTwoWayAudio()&&(s="ONVIF")}catch(e){this.console.warn("Error probing two way audio",e)}}e.newCamera||="Amcrest Camera",t=await super.createDevice(e,t);const a=await this.getDevice(t);return a.info=n,a.putSetting("username",o),a.putSetting("password",i),a.setIPAddress(e.ip?.toString()),a.setHttpPortOverride(e.httpPort?.toString()),s&&a.putSetting("twoWayAudio",s),t}async getCreateDeviceSettings(){return[{key:"username",title:"Username"},{key:"password",title:"Password",type:"password"},{key:"ip",title:"IP Address",placeholder:"192.168.2.222"},{key:"httpPort",title:"HTTP Port",description:"Optional: Override the HTTP Port from the default value of 80",placeholder:"80"},{key:"skipValidate",title:"Skip Validation",description:"Add the device without verifying the credentials and network settings.",type:"boolean"}]}createCamera(e){return new b(e,this)}}t.default=w},195:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getDeviceInfo=t.amcrestHttpsAgent=void 0;const o=n(r(5687));t.amcrestHttpsAgent=new o.default.Agent({rejectUnauthorized:!1}),t.getDeviceInfo=async function(e,r){const n=(await e.request({httpsAgent:t.amcrestHttpsAgent,method:"GET",responseType:"text",url:`http://${r}/cgi-bin/magicBox.cgi?action=getSystemInfo`})).data.split("\n"),o={};for(const e of n){let t=e.indexOf("=");-1===t&&(t=e.length);const r=e.substring(0,t),n=e.substring(t+1);o[r]=n.trim()}return{deviceType:o.deviceType,hardwareVersion:o.hardwareVersion,serialNumber:o.serialNumber}}},2372:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CameraProviderBase=t.CameraBase=void 0;const a=s(r(1765)),c=i(r(7954)),u=r(6113),d=s(r(5687)),{deviceManager:p,mediaManager:l}=c.default,h=new d.default.Agent({rejectUnauthorized:!1});class f extends c.ScryptedDeviceBase{constructor(e,t){super(e),this.provider=t}async takePictureUrl(e){this.snapshotAuth||(this.snapshotAuth=new a.default({username:this.getUsername(),password:this.getPassword()}));const t=await this.snapshotAuth.request({httpsAgent:h,method:"GET",responseType:"arraybuffer",url:e});return l.createMediaObject(Buffer.from(t.data),t.headers["Content-Type"]||"image/jpeg")}async takePicture(e){return this.pendingPicture||(this.pendingPicture=this.takePictureThrottled(e),this.pendingPicture.finally((()=>this.pendingPicture=void 0))),this.pendingPicture}async getPictureOptions(){}async getVideoStreamOptions(){return this.getRawVideoStreamOptions()}isAudioDisabled(){return"true"===this.storage.getItem("noAudio")}async getVideoStream(e){const t=await this.getVideoStreamOptions(),r=t?.find((t=>t.id===e?.id))||this.getDefaultStream(t);return this.createVideoStream(r)}async getUrlSettings(){return[]}getUsername(){return this.storage.getItem("username")}getPassword(){return this.storage.getItem("password")}async getOtherSettings(){return[]}getDefaultStream(e){return e?.[0]}async getStreamSettings(){return[]}getUsernameDescription(){return"Optional: Username for snapshot http requests."}getPasswordDescription(){return"Optional: Password for snapshot http requests."}async getSettings(){const e=[{key:"username",title:"Username",value:this.getUsername(),description:this.getUsernameDescription()},{key:"password",title:"Password",value:this.getPassword(),type:"password",description:this.getPasswordDescription()},...await this.getUrlSettings(),...await this.getStreamSettings(),...await this.getOtherSettings(),{key:"noAudio",title:"No Audio",description:"Enable this setting if the camera does not have audio or to mute audio.",type:"boolean",value:this.isAudioDisabled().toString()}];for(const t of e)t.group=this.provider.name.replace("Plugin","").trim(),t.subgroup||="General";return e}async putSettingBase(e,t){if("defaultStream"===e){const e=(await this.getVideoStreamOptions()).find((e=>e.name===t));this.storage.setItem("defaultStream",e?.id||"")}else this.storage.setItem(e,t.toString());this.snapshotAuth=void 0,this.onDeviceEvent(c.ScryptedInterface.Settings,void 0)}async putSetting(e,t){this.putSettingBase(e,t)}}t.CameraBase=f;class m extends c.ScryptedDeviceBase{constructor(e){super(e),this.devices=new Map;for(const e of p.getNativeIds())e&&this.getDevice(e)}async createDevice(e,t){t||=(0,u.randomBytes)(4).toString("hex");const r=e.newCamera?.toString()||"New Camera";return await this.updateDevice(t,r,this.getInterfaces()),t}async getCreateDeviceSettings(){return[{key:"newCamera",title:"Add Camera",placeholder:"Camera name, e.g.: Back Yard Camera, Baby Camera, etc"}]}getAdditionalInterfaces(){return[]}getInterfaces(){return[c.ScryptedInterface.VideoCamera,c.ScryptedInterface.Settings,...this.getAdditionalInterfaces()]}updateDevice(e,t,r,n){return p.onDeviceDiscovered({nativeId:e,name:t,interfaces:r,type:n||c.ScryptedDeviceType.Camera,info:p.getNativeIds().includes(e)?p.getDeviceState(e)?.info:void 0})}getDevice(e){let t=this.devices.get(e);return t||(t=this.createCamera(e),t&&this.devices.set(e,t)),t}async releaseDevice(e,t){this.devices.delete(t)}}t.CameraProviderBase=m},4112:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.OnvifIntercom=void 0;const a=i(r(7954)),c=r(7030),u=r(1853),d=r(4921),p=s(r(2081)),l=r(400),h=s(r(6113)),{mediaManager:f}=a.default,m=[];function g(e,t){m.push({ffmpegCodec:e,sdpName:t})}g("pcm_mulaw","PCMU"),g("pcm_alaw","PCMA"),g("pcm_s16be","L16"),g("adpcm_g726","G726"),g("aac","MPEG4-GENERIC");const y=/a=rtpmap:\s*(\d+) (.*?)\/(\d+)/g;function*v(e){for(const t of e.matchAll(y)){const[e,r,n,o,i,s]=t;yield{payloadType:r,sdpName:n,sampleRate:o,channels:s}}}const S="www.onvif.org/ver20/backchannel";t.OnvifIntercom=class{constructor(e){this.camera=e}async checkIntercom(){const e=this.camera.storage.getItem("username"),t=this.camera.storage.getItem("password"),r=new URL(this.url);r.username=e,r.password=t,this.intercomClient=new c.RtspClient(r.toString()),this.intercomClient.console=this.camera.console,await this.intercomClient.options();const n=await this.intercomClient.describe({Require:S});this.camera.console.log("ONVIF Backchannel SDP:"),this.camera.console.log(n.body?.toString());const o=(0,u.parseSdp)(n.body.toString()).msections.find((e=>"audio"===e.type&&"sendonly"===e.direction));if(!o)throw new Error("ONVIF audio backchannel not found");return o}async startIntercom(e){await this.stopIntercom();const t=await this.checkIntercom();if(!t)throw new Error("ONVIF audio backchannel not found");const r=await(0,l.reserveUdpPort)(),n=r+1;let o,i,s;try{const e={Require:S,Transport:`RTP/AVP;unicast;client_port=${r}-${n}`},a=await this.intercomClient.request("SETUP",e,t.control);s=(0,c.parseSemicolonDelimited)(a.headers.transport),this.intercomClient.session=a.headers.session.split(";")[0],o=this.camera.getIPAddress();const{server_port:u}=s,d=u.split("-");i=parseInt(d[0])}catch(e){this.camera.console.error("onvif udp backchannel failed, falling back to tcp",e);const r={Require:S,Transport:"RTP/AVP/TCP;unicast;interleaved=0-1"},n=await this.intercomClient.request("SETUP",r,t.control);s=(0,c.parseSemicolonDelimited)(n.headers.transport),this.intercomClient.session=n.headers.session.split(";")[0],o="127.0.0.1";const a=await(0,l.createBindZero)("udp4");this.intercomClient.client.on("close",(()=>a.server.close())),i=a.port,a.server.on("message",(e=>{this.intercomClient.send(e,0)}))}this.camera.console.log("backchannel transport",s);const u=await f.convertMediaObjectToJSON(e,a.ScryptedMimeTypes.FFmpegInput),g=[...v(t.contents)];let y,b,w;for(const e of g)if(b=m.find((t=>t.sdpName?.toLowerCase()===e.sdpName.toLowerCase())),b){y=e;break}if(!y)throw new Error("no supported codec was found for back channel");w=s.ssrc?Buffer.from(s.ssrc,"hex"):h.default.randomBytes(4);const _=w.readInt32BE(0),P=["-hide_banner",...u.inputArguments,"-vn","-acodec",b.ffmpegCodec,"-ar",y.sampleRate,"-ac",y.channels||"1","-payload_type",y.payloadType,"-ssrc",_.toString(),"-f","rtp",`rtp://${o}:${i}?localrtpport=${r}&localrtcpport=${n}`];(0,d.safePrintFFmpegArguments)(this.camera.console,P);const T=p.default.spawn(await f.getFFmpegPath(),P);(0,d.ffmpegLogInitialOutput)(this.camera.console,T),await this.intercomClient.play({Require:S}),this.camera.console.log("intercom playing")}async stopIntercom(){this.intercomClient?.client?.destroy(),this.intercomClient=void 0}}},9025:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RtspProvider=t.RtspSmartCamera=t.RtspCamera=void 0;const a=i(r(7954)),c=r(2372),u=s(r(7310)),d=r(2808),{mediaManager:p}=a.default;class l extends c.CameraBase{takePictureThrottled(e){throw new Error("The RTSP Camera does not provide snapshots. Install the Snapshot Plugin if snapshots are available via an URL.")}createRtspMediaStreamOptions(e,t){return{id:`channel${t}`,name:`Stream ${t+1}`,url:e,container:"rtsp",video:{},audio:this.isAudioDisabled()?null:{}}}getChannelFromMediaStreamOptionsId(e){return e.substring("channel".length)}getRawVideoStreamOptions(){let e=[];try{e=JSON.parse(this.storage.getItem("urls"))}catch(t){const r=this.storage.getItem("url");r&&(e.push(r),this.storage.setItem("urls",JSON.stringify(e)),this.storage.removeItem("url"))}const t=e.filter((e=>!!e)).map(((e,t)=>this.createRtspMediaStreamOptions(e,t)));if(t.length)return t}addRtspCredentials(e){const t=u.default.parse(e);this.console.log("stream url",e);const r=this.storage.getItem("username"),n=this.storage.getItem("password");if(r){const e=`${r}:${n||""}`;t.auth=e}return u.default.format(t)}createMediaStreamUrl(e,t){const r={url:e,mediaStreamOptions:t};return this.createMediaObject(r,a.ScryptedMimeTypes.MediaStreamUrl)}async createVideoStream(e){if(!e)throw new Error("video streams not set up or no longer exists.");const t=this.addRtspCredentials(e.url);return this.createMediaStreamUrl(t,e)}getUsernameDescription(){}getPasswordDescription(){}async getRtspUrlSettings(){return[{key:"urls",title:"RTSP Stream URL",description:"An RTSP Stream URL provided by the camera.",placeholder:"rtsp://192.168.1.100[:554]/channel/101",value:this.getRawVideoStreamOptions()?.map((e=>e.url)),multiple:!0}]}async getOtherSettings(){const e=[];return e.push({subgroup:"Advanced",key:"debug",title:"Debug Events",description:"Log all events to the console. This will be very noisy and should not be left enabled.",value:"true"===this.storage.getItem("debug"),type:"boolean"}),e}async getUrlSettings(){return[...await this.getRtspUrlSettings()]}async putRtspUrls(e){this.storage.setItem("urls",JSON.stringify(e.filter((e=>!!e))))}async putSettingBase(e,t){"urls"===e?this.putRtspUrls(t):super.putSettingBase(e,t)}}t.RtspCamera=l;t.RtspSmartCamera=class extends l{constructor(e,t){super(e,t),this.lastListen=0,this.listenLoop()}resetSensors(){this.interfaces.includes(a.ScryptedInterface.MotionSensor)&&(this.motionDetected=!1),this.interfaces.includes(a.ScryptedInterface.AudioSensor)&&(this.audioDetected=!1),this.interfaces.includes(a.ScryptedInterface.TamperSensor)&&(this.tampered=!1),this.interfaces.includes(a.ScryptedInterface.BinarySensor)&&(this.binaryState=!1)}async listenLoop(){if(this.resetSensors(),this.lastListen=Date.now(),this.listener)return;let e;const t=this.listener=this.listenEvents();let r;const n=()=>{t===this.listener&&(this.listener=void 0),clearTimeout(r),e?.destroy();const n=Date.now()-this.lastListen;setTimeout((()=>this.listenLoop()),n>1e4?0:1e4)};try{e=await this.listener}catch(e){return this.console.error("listen loop connection failed, restarting listener.",e.message),void n()}const o=()=>{clearTimeout(r),r=setTimeout((()=>{this.console.error("listen loop 5m idle timeout, destroying listener."),n()}),3e5)};o(),e.on("data",(e=>{"true"===this.storage.getItem("debug")&&this.console.log("debug event:\n",e.toString()),o()})),e.on("close",(()=>{this.console.error("listen loop closed, restarting listener."),n()})),e.on("error",(e=>{this.console.error("listen loop error, restarting listener.",e),n()}))}async putSetting(e,t){this.putSettingBase(e,t),this.listener.then((e=>e.emit("error",new Error("new settings"))))}async takePictureThrottled(e){return this.takeSmartCameraPicture(e)}async getRtspUrlSettings(){return[{key:"urls",title:"RTSP Stream URL Override",description:"Override the RTSP Stream URL provided by the camera.",placeholder:"rtsp://192.168.1.100[:554]/channel/101",value:this.getRawVideoStreamOptions()?.map((e=>e.url)),multiple:!0}]}async getUrlSettings(){const e=[{key:"ip",title:"IP Address",placeholder:"192.168.1.100",value:this.storage.getItem("ip")},...this.getHttpPortOverrideSettings(),...this.getRtspPortOverrideSettings()];if(this.showRtspUrlOverride()){const t=this.storage.getItem("rtspUrlOverride");t&&(await this.putRtspUrls([t]),this.storage.removeItem("rtspUrlOverride")),e.push(...await this.getRtspUrlSettings())}return e}getHttpPortOverrideSettings(){return this.showHttpPortOverride()?[{key:"httpPort",subgroup:"Advanced",title:"HTTP Port Override",placeholder:"80",value:this.storage.getItem("httpPort")}]:[]}showHttpPortOverride(){return!0}getRtspPortOverrideSettings(){return this.showRtspPortOverride()?[{key:"rtspPort",subgroup:"Advanced",title:"RTSP Port Override",placeholder:"554",value:this.storage.getItem("rtspPort")}]:[]}showRtspPortOverride(){return!0}showRtspUrlOverride(){return!0}getHttpAddress(){return`${this.getIPAddress()}:${this.storage.getItem("httpPort")||80}`}setHttpPortOverride(e){this.storage.setItem("httpPort",e||"")}getRtspUrlOverride(){if(this.showRtspUrlOverride())return this.storage.getItem("rtspUrlOverride")}getIPAddress(){return this.storage.getItem("ip")}setIPAddress(e){return this.storage.setItem("ip",e)}getRtspAddress(){return`${this.getIPAddress()}:${this.storage.getItem("rtspPort")||554}`}async getVideoStreamOptions(){if(this.showRtspUrlOverride()){const e=await super.getVideoStreamOptions();if(e)return e}return this.constructedVideoStreamOptions||(this.constructedVideoStreamOptions=(0,d.timeoutPromise)(5e3,this.getConstructedVideoStreamOptions()).finally((()=>{this.constructedVideoStreamOptions=void 0}))),this.constructedVideoStreamOptions}putSettingBase(e,t){return this.constructedVideoStreamOptions=void 0,super.putSettingBase(e,t)}};class h extends c.CameraProviderBase{createCamera(e){return new l(e,this)}}t.RtspProvider=h},7189:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.listenZeroSingleClient=t.listenZero=t.ListenZeroSingleClientTimeoutError=void 0;const o=r(2361),i=n(r(1808));class s extends Error{constructor(){super("timeout waiting for client")}}async function a(e,t){return e.listen(0,t),await(0,o.once)(e,"listening"),e.address().port}t.ListenZeroSingleClientTimeoutError=s,t.listenZero=a,t.listenZeroSingleClient=async function(e){const t=new i.default.Server,r=await a(t,e),n=new Promise(((e,r)=>{const n=setTimeout((()=>{t.close(),r(new s)}),3e4);t.on("connection",(r=>{t.close(),clearTimeout(n),e(r)}))}));n.catch((()=>{}));let o=e;return o&&"0.0.0.0"!==o||(o="127.0.0.1"),{server:t,url:`tcp://${o}:${r}`,host:o,port:r,clientPromise:n}}},1795:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.safePrintFFmpegArguments=t.ffmpegLogInitialOutput=t.safeKillFFmpeg=void 0;const o=n(r(7282)),i=["decode_slice_header error","no frame!","non-existing PPS"];t.safeKillFFmpeg=function(e){if(e){try{e.stdin.write("q\n")}catch(e){}setTimeout((()=>{e.kill(),setTimeout((()=>{e.kill("SIGKILL")}),2e3)}),2e3)}},t.ffmpegLogInitialOutput=function(e,t,r,n){if(!e)return;const s=!!o.default.env.SCRYPTED_FFMPEG_NOISY||!!n?.getItem("SCRYPTED_FFMPEG_NOISY");function a(e){const n=o=>{const a=o.toString();for(const e of i)if(-1!==a.indexOf(e))return;if(!(s||r||-1===a.indexOf("frame=")&&-1===a.indexOf("size=")))return e(a),e("video/audio detected, discarding further input"),t.stdout.removeListener("data",n),void t.stderr.removeListener("data",n);e(a)};return n}t.stdout?.on("data",a(e.log)),t.stderr?.on("data",a(e.error)),t.on("exit",(()=>e.log("ffmpeg exited")))},t.safePrintFFmpegArguments=function(e,t){if(!e)return;const r=[];let n=!1;for(const e of t){try{if(n){const t=new URL(e);r.push(`${t.protocol}[REDACTED]`)}else r.push(e)}catch(t){r.push(e)}n="-i"===e}e.log(r.join(" "))}},9413:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sleep=void 0,t.sleep=async function(e){await new Promise((t=>setTimeout(t,e)))}},9491:e=>{"use strict";e.exports=require("assert")},2081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},1891:e=>{"use strict";e.exports=require("dgram")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},7282:e=>{"use strict";e.exports=require("process")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},1945:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});const n=require("os");function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){var t="function"==typeof Map?new Map:void 0;return s=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return a(e,arguments,d(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),u(n,e)},s(e)}function a(e,t,r){return a=c()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&u(o,r.prototype),o},a.apply(null,arguments)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function u(e,t){return u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},u(e,t)}function d(e){return d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},d(e)}let p=function(e){function t(e,r,...n){var o,s,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e instanceof Array||(n=(void 0===r?[]:[r]).concat(n),r=e,e=[]),s=this,(o=!(a=d(t).call(this,r))||"object"!=typeof a&&"function"!=typeof a?i(s):a).code=r||"E_UNEXPECTED",o.params=n,o.wrappedErrors=e,o.name=o.toString(),Error.captureStackTrace&&Error.captureStackTrace(i(o),o.constructor),o}var r,s,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),r=t,(s=[{key:"toString",value:function(){return(this.wrappedErrors.length?this.wrappedErrors[this.wrappedErrors.length-1].stack+n.EOL:"")+this.constructor.name+": "+this.code+" ("+this.params.join(", ")+")"}}])&&o(r.prototype,s),a&&o(r,a),t}(s(Error));function l(e){return e instanceof p||e.constructor&&e.constructor.name&&e.constructor.name.endsWith("Error")&&"string"==typeof e.code&&h(e.code)&&e.params&&e.params instanceof Array}function h(e){return/^([A-Z0-9_]+)$/.test(e)}p.wrap=function(e,t,...r){let n=null;const o=h(e.message),i=(e.wrappedErrors||[]).concat(e);return t||(t=o?e.message:"E_UNEXPECTED"),e.message&&!o&&r.push(e.message),n=new p(i,t,...r),n},p.cast=function(e,...t){return l(e)?e:p.wrap.apply(p,[e].concat(t))},p.bump=function(e,...t){return l(e)?p.wrap.apply(p,[e,e.code].concat(e.params)):p.wrap.apply(p,[e].concat(t))};const f=p},8593:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')},532:e=>{"use strict";e.exports=JSON.parse('{"name":"axios","version":"0.21.4","description":"Promise based HTTP client for the browser and node.js","main":"index.js","scripts":{"test":"grunt test","start":"node ./sandbox/server.js","build":"NODE_ENV=production grunt build","preversion":"npm test","version":"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json","postversion":"git push && git push --tags","examples":"node ./examples/server.js","coveralls":"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js","fix":"eslint --fix lib/**/*.js"},"repository":{"type":"git","url":"https://github.com/axios/axios.git"},"keywords":["xhr","http","ajax","promise","node"],"author":"Matt Zabriskie","license":"MIT","bugs":{"url":"https://github.com/axios/axios/issues"},"homepage":"https://axios-http.com","devDependencies":{"coveralls":"^3.0.0","es6-promise":"^4.2.4","grunt":"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1","karma":"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2","minimist":"^1.2.0","mocha":"^8.2.1","sinon":"^4.5.0","terser-webpack-plugin":"^4.2.3","typescript":"^4.0.5","url-search-params":"^0.10.0","webpack":"^4.44.2","webpack-dev-server":"^3.11.0"},"browser":{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},"jsdelivr":"dist/axios.min.js","unpkg":"dist/axios.min.js","typings":"./index.d.ts","dependencies":{"follow-redirects":"^1.14.0"},"bundlesize":[{"path":"./dist/axios.min.js","threshold":"5kB"}]}')}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n=r(6360),o=exports="undefined"==typeof exports?{}:exports;for(var i in n)o[i]=n[i];n.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();
//# sourceMappingURL=main.nodejs.js.map